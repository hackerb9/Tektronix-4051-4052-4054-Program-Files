65000 REM APPEND (BINARY TO ASCII)  @EDITPROG/MAIN65002 REM APPEND (ASCII TO BINARY)65004 REM APPEND (RESTORE 65000-65004)65006 REM EDITPROG: Changes strings in multiple program files.65008 REM John Harms (Tektronix), Apr 83.65010 REM65012 REM D= Output Device, S= Scratch Unit (this prog), P= Program Unit65014 REM DATA= Files to Edit.  Strings to edit start in line 65300.65016 REM LIMITS: No programs with line numbers > 64999.65018 REM NOTE: Uppercase chars not equal to lowercase (due to NOCASE).65020 INIT 65022 D=5165024 S=065026 P=165028 RESTORE 6505265030 REM65050 REM*S-- BEGIN FILENAMES --65052 DATA "FILENAME1","FILENAME2","WILDCARDS","OK*.*","ETC"65054 DATA "TERMINATE","WITH","NULL","NAME",""65100 REM65102 REM*S-- END OF FILENAMES --65104 SET NOCASE 65106 DIM A$(500),B$(500),F$(72),S$(72),R$(72),L$(2000),O$(72),W$(160)65108 DIM C$(3),H$(2)65110 C=065112 H$=CHR(8)65114 H$=H$&"_"65116 IF D<>33 THEN 6512065118 FIND 265120 CALL "MOUNT",S,A$65122 CALL "MOUNT",P,A$65124 CALL "TIME",A$65126 IF D<>32 THEN 6513065128 PAGE 65130 PRINT @D:"                    EDITPROG    ";A$;"

"65132 REM*SGET FILENAME (MAY INCLUDE WILDCARDS)65134 READ G$65136 IF G$="" THEN 6518865138 CALL "UNIT",P65140 OPEN G$,"G";9,"R",B$65142 IF B$<>"" THEN 6515065144 PRINT @D:"

---- FILE MATCH NOT FOUND: ";G$65146 GO TO 6513465148 REM*SEDIT FILE(S)65150 F$=SEG(B$,189,59)65152 F$=REP("",LEN(F$),1)65154 F$="@"&F$65156 CALL "NEXT",9,B$65158 GOSUB 6522265160 CALL "UNIT",S65162 KILL "@EDITPROG/TEMP2"65164 CALL "FILE",S,"@EDITPROG/TEMP1",A$65166 A$=SEG(A$,22,9)65168 CREATE "@EDITPROG/TEMP2","A";VAL(A$),065170 GOSUB 6525265172 IF C3 THEN 6517865174 DELETE 6500265176 GO TO 6518065178 GOSUB 6548265180 GOSUB 6550265182 IF B$="" THEN 6513465184 GO TO 6515065186 REM*SEDITING FINISHED65188 CALL "UNIT",S65190 KILL "@EDITPROG/TEMP*"65192 PRINT "";65194 PRINT @D:"
DONE."65196 IF D=32 THEN 6520065198 PRINT @D:""65200 END 65220 REM*RCONVERT_TO_ASCII(F$,D,S,P:C:)65222 C=C+165224 PRINT @D:"

*****>   ";C;") FILE: ";F$;"
"65226 CALL "UNIT",P65228 DELETE 1,6499965230 APPEND F$;65000,065232 CALL "UNIT",S65234 KILL "@EDITPROG/TEMP1"65236 SAVE "@EDITPROG/TEMP1","A";1,6499965238 RETURN 65250 REM*REDIT_STRINGS(D,S::C3)65252 CALL "UNIT",S65254 OPEN "@EDITPROG/TEMP1";1,"R",A$65256 OPEN "@EDITPROG/TEMP2";2,"F",A$65258 C3=065260 IF TYP(1)=1 THEN 6537665262 INPUT #1:L$65264 O$=L$65266 C2=065268 REM S$=SEARCH STRING, R$=REPLACEMENT STRING65270 REM GOSUB EDIT_LINE (65450) with each pair65272 REM65300 REM*S-- BEGIN REPLACEMENT --65302 S$="First search string"65304 R$="First replacement string"65306 GOSUB 6545065308 S$="Second search string"65310 R$="Second replacement string"65312 GOSUB 6545065350 REM65352 REM*S-- REPLACEMENT DONE --65354 IF LEN(L$)<=72 THEN 6536665356 PRI @D:"******** NEXT LINE TOO LONG (ORIGINAL UNCHANGED ON FILE)"65358 L$=SEG(L$,1,72)65360 GOSUB 6539265362 PRINT #2:O$65364 GO TO 6526065366 IF NOT(C2) THEN 6537265368 GOSUB 6539265370 C3=165372 PRINT #2:L$65374 GO TO 6526065376 CLOSE 165378 CLOSE 265380 RETURN 65390 REM*RPRINT_LINE(L$,D::)65392 W$=L$65394 FOR R1=LEN(W$) TO 1 STEP -165396 C$=SEG(W$,R1,1)65398 IF C$=>" " THEN 6540665400 C$=CHR(ASC(C$)+64)65402 C$=C$&H$65404 W$=REP(C$,R1,1)65406 NEXT R165408 PRINT @D:W$65410 RETURN 65450 REM*REDIT_LINE(S$,R$:L$,C2:C1)65452 C1=065453 R1=165454 R1=POS(L$,S$,R1)65456 IF NOT(R1) THEN 6546465458 L$=REP(R$,R1,LEN(S$))65459 R1=R1+LEN(R$)65460 C1=165462 GO TO 6545465464 C2=C2 OR C165466 RETURN 65480 REM*RCONVERT_TO_BINARY(F$::)65482 CALL "UNIT",S65484 DELETE 1,6499965486 APPEND "@EDITPROG/TEMP2","A";65002,065488 CALL "UNIT",P65490 SAVE F$;1,6499965492 RETURN 65500 REM*RRESTORE_APPEND_LOCATIONS(S::)65502 CALL "UNIT",S65504 APPEND "@EDITPROG/RESTORE";65004,065506 RETURN 