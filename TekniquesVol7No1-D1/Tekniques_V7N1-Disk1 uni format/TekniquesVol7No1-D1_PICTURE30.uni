1 REM                {PICTURE30  V-3A   2-MAY-83}           FILE 62 GO TO 1004 GO TO 8508 O1=329 GO TO 1753012 Z0=013 RETURN 16 S(8)=117 RETURN 20 S(28)=021 RETURN 44 CLOSE 45 PAGE 46 CHARSIZE 447 GO TO 37048 O1=449 GO TO 1753052 Z0=153 RETURN 56 S(8)=057 RETURN 60 S(28)=161 RETURN 80 UNIT 081 CLOSE 82 KILL T$83 PAGE 84 CHARSIZE 485 PRINT "File: ";T$;" is Killed."86 END 90 REM CONCEPT BY: CONNIE BREITHAUPT  TEKTRONIX  ROCKVILLE,MD91 REM92 REM RECODED BY: J A LOUGHRAN, E H SCHADLER, A J YERMAN93 REM             GENERAL ELECTRIC CORPORATE R&D94 REM             BUILDING 37-265, SCHENECTADY, NY 1234595 REM96 REM PLEASE REPORT ANY PROBLEMS TO JIM LOUGHRAN, 518-385-5025100 INIT 110 DEF FNA(X9)=(X9*R(25)-Y9*R(24))*R(5)*R(1)+X3115 DEF FNB(Y9)=(Y9*R(25)+X9*R(24))*R(4)*R(1)+Y3120 DEF FNC(X9)=(X9*R(27)*R(21)-Y9*R(26))*R(23)125 DEF FND(Y9)=(Y9*R(27)+X9*R(26)*R(21))*R(22)130 DEF FNE(X0)=X0+2*(R(29)-2)*(X0-P2(1))135 DEF FNF(Y0)=Y0-2*(R(29)-1)*(Y0-P3(1))140 DEF FNI(X0)=G0*(INT(X0/G0)+1*(X0-G0*INT(X0/G0)>G0/2))145 DEF FNH(X0)=FNI(X0)*(S(8)=1)+(S(8)=0)*INT(10*X0+0.5)/10150 DEF FNZ(Y0)=G1*(INT(Y0/G1)+1*(Y0-G1*INT(Y0/G1)>G1/2))155 DEF FNV(Y0)=FNZ(Y0)*(S(8)=1)+(S(8)=0)*INT(10*Y0+0.5)/10190 DIM D$(160),F$(60),M$(30),T$(60),Z$(1)200 DIM C3(20),C4(20),P(2,20),P2(20),P3(20),P8(2),R(29),S(29),V(4)210 PAGE 220 FOR I0=1 TO 10230 PRINT @32,21:55,50240 PRINT "PICTURE30"250 NEXT I0260 CALL "WAIT",1270 PAGE 275 CHARSIZE 4280 PRINT "

Is sub-PDB Library Disc on Unit 1? ";290 INPUT A$300 IF A$<>"Y" THEN 360320 CALL "MOUNT",1,A$340 F1=0350 GO TO 370360 F1=1370 PRINT "

Insert Another Working Disk in Drive #0 if Desired. ";380 INPUT Z$390 CALL "MOUNT",0,D$400 D$=SEG(D$,74,9)410 Z1=VAL(D$)420 IF Z1>25600 THEN 460430 PRINT "

This Floppy Disk is nearly full."440 PRINT "	It will not accept a new Picture but"450 PRINT "	old Pictures can be accessed."460 PRINT "

Indicate name of desired PDB File: ";470 INPUT B$480 IF LEN(B$)>15 THEN 460490 GOSUB 7000500 IF E1<>0 THEN 460502 T$="/PDB/"&B$504 PRINT "

Enter a Library name for File: ";506 INPUT B$508 IF B$="" THEN 504510 T$=B$&T$512 T$="@"&T$514 IF LEN(T$)>59 THEN 460520 UNIT 0530 CALL "FILE",0,T$,D$540 IF LEN(D$)=0 THEN 600550 OPEN T$;1,"F",D$560 READ #1,1:P5570 PRINT "

File ";T$;" is open for editing!"580 P5=P5+1590 GO TO 660600 IF Z1<25600 THEN 370605 CREATE T$,"U";2,256610 OPEN T$;1,"F",D$620 WRITE #1,1:0630 WRITE #1,2:"  "640 PRINT "

File ";T$;" is created!"650 P5=1660 DATA 32,50,50,100,100,0,4000,0,4000,1,0,0670 DATA 1,0,1,1,1,10,1,1,0,50,35,0,50,0,45,20,0,0,250,0,1,1,1,0,1,0,1680 DATA 0,0,0,0,"",2000,2000,0,0,1690 RESTORE 660700 READ O1,G0,G1,N4,M4,W1,W2,W3,W4,T2,Z0,Z1710 READ S,A2,A3,F$,X3,Y3,C2,H1,A1715 CHARSIZE 2730 CALL "WAIT",2740 R=S750 P=0770 M0=0790 WINDOW W1,W2,W3,W4800 VIEWPORT 20,120,0,100810 T1=0.02*(W2-W1)820 SET DEGREES 830 GOSUB 2550850 GOSUB 14120860 GO TO 880870 GOSUB 14100880 M0=0890 RINIT 900 REM PARSE COMMAND905 IF S(8)=1 THEN 920910 PRINT S(7);">";915 GO TO 925920 PRINT S(7);"+>";925 SET KEY 930 INPUT A$935 SET NOKEY 940 R=S945 B$=SEG(A$,1,3)946 IF LEN(B$)<>3 THEN 1030947 IF B$="DIS" AND O1<>32 THEN 1030950 K$="RESPAUENDCHGTRASELINSLISDISWINDELPLOREPDIGCOMMAG"960 P0=INT((POS(K$,B$,1)+2)/3)970 IF P0=0 OR LEN(A$)=0 THEN 1030980 GO TO P0 OF 1060,1090,1100,1150,1220,1510,3220990 GO TO P0-7 OF 5180,6000,6490,6610,18210,8010,15930,1000,9110995 GO TO 10301000 GOSUB 200001020 GO TO 8501030 GOSUB 141001040 PRINT A$;" ?"1050 GO TO 8701060 CLOSE 1070 PAGE 1075 CHARSIZE 41080 GO TO 3701090 STOP 1100 CLOSE 1110 RINIT 1115 GOSUB 141001120 PRINT "Session Complete!"1125 CHARSIZE 41130 CALL "WAIT",21135 PAGE 1140 END 1150 B$=SEG(A$,5,3)1160 IF B$="POL" THEN 157701170 IF LEN(B$)=3 THEN 11901180 GO TO 8701190 M0=11200 GO TO 66101210 REM PARSE TRANSLATE1220 B$=SEG(A$,5,3)1230 P0=(POS("LINPDBCIRPOL",B$,1)+2)/31240 IF P0<>INT(P0) THEN 10301250 B$=SEG(A$,9,LEN(A$)-8)1260 GOSUB 68101270 IF E1<>0 THEN 8701280 N1=VAL(B$)1290 IF N1-INT(N1)<>0 THEN 10301300 IF N1<1 OR N1>100 THEN 10301310 REM CHANGE LOCATOR1320 M0=41330 GO TO 66101340 POINTER X1,Y1,Z$1350 IF Z$<>"=" THEN 13901360 N3=N41370 M3=M41380 GO TO 14601390 X2=FNH(X1)1395 Y2=FNV(Y1)1400 POINTER X3,Y3,Z$1420 X3=FNH(X3)1430 Y3=FNV(Y3)1440 N3=X3-X21450 M3=Y3-Y21460 GO TO 124201500 REM PARSE SELECT1510 B$=SEG(A$,5,3)1520 IF LEN(B$)<>3 THEN 10301530 K$="FONDSHTOLARWOUTHGTANGLAYITLGRDTRAWINXHAPDBDIGPAG"1540 P0=INT((POS(K$,B$,1)+2)/3)1550 IF P0=0 THEN 10301560 GO TO P0-8 OF 2160,2280,2670,2800,2950,3080,16010,18501570 B$=SEG(A$,9,LEN(A$)-8)1580 GOSUB 68101590 IF E1<>0 THEN 10301600 Q5=VAL(B$)1610 IF Q5-INT(Q5)<>0 THEN 10301620 GO TO P0 OF 1660,1720,1750,1820,17510,2100,2130,22501630 GO TO 10301650 REM SET PARAMETERS1660 IF Q5<0 OR Q5>12 THEN 10301670 S(6)=Q51680 GO TO 8701720 IF Q5<0 OR Q5>5 THEN 10301730 S(9)=Q51740 GO TO 8701750 IF Q5<0 OR Q5>1000 THEN 10301760 IF Q5<>0 THEN 17901770 T2=11780 T1=0.02*(W2-W1)1785 GO TO 8701790 T1=Q51800 T2=01810 GO TO 8701820 IF Q5<0 OR Q5>1000 THEN 10301830 S(10)=Q51840 GO TO 8701850 B$=SEG(A$,9,2)1860 IF B$="ON" THEN 18901870 IF B$="OF" THEN 19101880 GO TO 10301890 Z0=01900 GO TO 8701910 Z0=11920 GO TO 8702100 IF Q5<=0 OR Q5>1000 THEN 10302110 S(13)=Q52120 GO TO 8702130 IF Q5<0 OR Q5>360 THEN 10302140 S(12)=Q52150 GO TO 8702160 B$=SEG(A$,9,2)2170 IF B$="ON" THEN 22002180 IF B$="OF" THEN 22202190 GO TO 10302200 S(14)=12210 GO TO 8702220 S(14)=02230 GO TO 8702250 IF Q5<1 OR Q5>100 THEN 10302260 S(7)=Q52270 GO TO 8702280 B$=SEG(A$,9,2)2290 IF B$="ON" THEN 24902300 IF B$="OF" THEN 25202310 A$=SEG(A$,9,LEN(A$)-8)2320 B$=A$2330 GOSUB 72302340 IF E1<>0 THEN 10302350 Q5=VAL(B$)2360 IF Q5<=0 OR Q5>1000 THEN 10302370 IF P1=0 THEN 24602380 B$=A$2390 GOSUB 68102400 IF E1<>0 THEN 10302410 Q6=VAL(B$)2420 IF Q6<=0 OR Q6>1000 THEN 10302430 G0=Q52440 G1=Q62450 GO TO 8702460 G1=Q52470 G0=Q52475 GO TO 8702490 S(8)=12510 GO TO 8702520 S(8)=02530 GO TO 8702550 MOVE W1,W32560 ROPEN 1002570 VISIBILITY 100,02580 FOR I9=0 TO 92590 FOR I8=0 TO 92600 RDRAW 0,02610 RMOVE G0,02620 NEXT I82630 RMOVE -10*G0,G12640 NEXT I92650 RCLOSE 2660 RETURN 2670 A$=SEG(A$,9,LEN(A$)-8)2680 GOSUB 72302690 IF E1<>0 OR E2<>0 THEN 10302700 Q5=VAL(B$)2710 IF ABS(Q5)>1000 THEN 10302720 B$=A$2730 GOSUB 68102740 IF E1<>0 THEN 10302750 Q6=VAL(B$)2760 IF ABS(Q6)>1000 THEN 10302770 N4=Q52780 M4=Q62790 GO TO 8702800 POINTER W1,W3,Z$2810 POINTER W2,W4,Z$2820 W1=0 MAX FNH(W1)2830 W2=FNH(W2)2840 W3=0 MAX FNV(W3)2845 W4=FNV(W4)2850 IF W2-W1>W4-W3 THEN 28802860 W2=W1+(W4-W3)2870 GO TO 29002880 W4=W3+(W2-W1)2890 IF T2<>0 THEN 29102900 T1=0.02*(W2-W1)2910 WINDOW W1,W2,W3,W42920 GOSUB 25502940 GO TO 8502950 A$=SEG(A$,9,LEN(A$)-8)2960 GOSUB 72302970 IF E1<>0 OR E2<>0 THEN 10302980 Q5=VAL(B$)2990 IF Q5<0 OR Q5>360 THEN 10303000 B$=A$3010 GOSUB 68103020 IF E1<>0 THEN 10303030 Q6=VAL(B$)3040 IF Q6<=0 OR Q6>100 THEN 10303050 S(15)=Q53060 S(16)=Q63070 GO TO 8703080 A$=SEG(A$,9,LEN(A$)-8)3090 GOSUB 72303100 IF E1<>0 OR E2<>0 THEN 10303110 Q5=VAL(B$)3120 IF Q5<0 OR Q5>360 THEN 10303130 B$=A$3140 GOSUB 68103150 IF E1<>0 THEN 10303160 Q6=VAL(B$)3170 IF Q6<=0 OR Q6>100 THEN 10303180 S(2)=Q53190 S(1)=Q63200 GO TO 8703210 REM PARSE INSERT3220 B$=SEG(A$,5,3)3225 IF LEN(B$)<>3 THEN 10303230 A9=(POS("LINLABXHAPDBARWCIRPOLKBD",B$,1)+2)/33240 IF A9<>INT(A9) THEN 10303250 GO TO A9 OF 3790,4050,4310,4520,3710,3280,14400,172103260 GO TO 10303270 REM INSERT CIRCLE3280 X4=(W1+W2)/23290 Y4=(W3+W4)/23320 MOVE X4,Y43325 ROPEN 13330 VISIBILITY 1,03335 GOSUB 135503340 RCLOSE 3350 GOSUB 170103360 M$="FCA########L#########12SRWYX"3370 GOSUB 48903390 GOSUB 171103400 VISIBILITY 1,13410 VISIBILITY 99,13412 X4=X33414 Y4=Y33420 GO TO C2 OF 13810,870,34903430 GO TO 33203490 FOR A0=1 TO 13500 FOR I8=17 TO 183510 MOVE X4,Y43520 ROPEN 23530 DRAW X4,Y43540 RCLOSE 3550 VISIBILITY 2,13560 CURSOR 23570 POINTER X1,Y1,Z$3580 IF Z$="C" THEN 36403590 X9=X1-X43600 Y9=Y1-Y43610 GOSUB 138903620 R(I8)=INT(100*(X0-R(20)))/1003630 NEXT I83640 NEXT A03642 RDELETE 23644 CURSOR 03646 POINTER X1,Y1,Z$3650 IF Z$="C" THEN 8703660 IF ABS(R(18)-R(17))>1 THEN 36803670 R(18)=R(17)3680 GO TO 33203700 REM INSERT ARROW3710 A7=23720 GO TO 38003730 GOSUB 121403740 VISIBILITY 1,03760 IF M0<>0 THEN 8703770 GO TO 38003780 REM INSERT LINE3790 A7=13800 M$="#CM########L#D"3805 GOSUB 165303810 GOSUB 48903820 GO TO C2 OF 3810,870,38303825 GO TO 38103830 X1=X33840 Y1=Y33845 MOVE X1,Y13850 ROPEN 13860 DRAW X1,Y13870 RCLOSE 3880 VISIBILITY 1,13890 GOSUB 170103900 M$="#CMF#######L#D^>"3910 GOSUB 48903915 GOSUB 171103920 GO TO C2 OF 3900,870,3830,39403930 GO TO 39003940 X2=X33950 Y2=Y33960 IF X1=X2 AND Y1=Y2 THEN 8703970 IF A7=2 THEN 37303980 GOSUB 73403990 IF M0<>0 THEN 8704000 X1=X24010 Y1=Y24020 GO TO 38454040 REM INSERT LABEL4050 C$=SEG(A$,9,LEN(A$)-8)4060 IF LEN(C$)<>0 THEN 40904070 B$=C$4080 GO TO 10304090 X3=W1+(W2-W1)/54100 Y3=(W3+W4)/24110 X1=X34120 Y1=Y34130 MOVE X3,Y34140 ROPEN 14150 VISIBILITY 1,14160 CURSOR 14170 GOSUB 88804180 RCLOSE 4190 M$="FCE#######TL####RHI"4200 GOSUB 48904210 GO TO C2 OF 4230,870,42604220 GO TO 41304230 X1=X34240 Y1=Y34250 GO TO 74604260 GOSUB 141004270 PRINT "NEW LABEL ";4280 INPUT C$4285 IF C$="C" THEN 8704290 GO TO 40604300 REM INSERT XHATCH4310 P=04320 POINTER X1,Y1,Z$4330 IF Z$="C" THEN 8704340 A9=74350 GOSUB 129004370 IF E6<>0 THEN 43204380 READ #1,Z3:C1,R(7),X2,Y2,C34390 GOSUB 196104400 FOR I7=1 TO N04410 P(1,I7)=P2(I7)4420 P(2,I7)=P3(I7)4430 NEXT I74440 IF P(1,1)=P(1,N0) AND P(2,1)=P(2,N0) THEN 44804450 GOSUB 141004460 PRINT "Open Polygon!"4470 GO TO 8704480 N0=N0-14490 GOSUB 100804500 GO TO 78504510 REM INSERT sub-PDB4520 F$=SEG(A$,9,LEN(A$)-8)4530 IF LEN(F$)=0 OR LEN(F$)>15 THEN 46104540 F$="/PDB/"&F$4550 GOSUB 141004560 PRINT "Library name? ";4570 INPUT B$4580 B$="@"&B$4590 F$=B$&F$4600 IF F$<>T$ THEN 46404610 GOSUB 141004620 PRINT "Invalid Name!"4630 GO TO 8704640 GOSUB 105804650 IF LEN(D$)=0 THEN 8704655 M$="FCM##SR#YX#L#"4660 GOSUB 141004670 PRINT "Center Cursor"4675 AXIS 0.5*(W2-W1),0.5*(W4-W3)4680 POINTER X3,Y3,Z$4685 IF Z$="C" THEN 8704690 MOVE X3,Y34700 ROPEN 14710 VISIBILITY 1,14720 GOSUB 107204730 RCLOSE 4750 CURSOR 14760 GOSUB 48904770 GO TO C2 OF 12050,8704780 GO TO 46904880 REM POINTER & OPERATORS4890 R(28)=04895 POINTER X3,Y3,K$4896 Z$=K$4900 X3=0 MAX FNH(X3)4905 X3=X3 MIN W24910 Y3=0 MAX FNV(Y3)4915 Y3=Y3 MIN W44920 C2=POS(M$,K$,1)4930 IF LEN(K$)=0 THEN 48954940 GO TO C2 OF 5100,5120,5130,5130,51304950 IF C2=0 THEN 48904960 D$=" SCALE ANGLE WIDTHY FCTRX FCTRA FONTLAYER  GRID  DASH A HEAD"4970 D$=D$&" A ANGTX ANGTX HGTITALIC X ANGX DISP ANG 1 ANG 2RADIUS"4980 D$=D$&" C ANG C WIDC YFCTC XFCT"4990 K$=SEG(D$,(C2-6)*6+1,6)5000 GOSUB 141005010 ROPEN 105020 PRINT "

";K$;" IS NOW = ";R(C2-5);" ENTER NEW ";K$;" ";5030 RCLOSE 5035 PRINT Z$;"= ";5040 INPUT R(C2-5)5050 RDELETE 105060 R(24)=SIN(R(2))5070 R(25)=COS(R(2))5080 RETURN 5090 REM FIX/CANCEL OBJECT5100 FIX 15110 RETURN 5120 RINIT 5130 RETURN 5170 REM LIST PARAMETERS5180 B$=SEG(A$,5,3)5190 IF B$="PAR" THEN 52305200 IF B$="PDB" THEN 55605210 GO TO 10305230 PRINT "
PARAMETERS
"5240 PRINT "LAB:"5250 PRINT " HGT: ";INT(S(13)*100)/1005260 PRINT " ANG: ";INT(S(12)*100)/1005265 PRINT " FON: ";INT(S(6))5270 IF S(14)=0 THEN 53005280 PRINT " ITL: ON"5290 GO TO 53105300 PRINT " ITL: OFF"5310 PRINT "XHA:"5315 PRINT " ANG: ";INT(S(15)*100)/1005320 PRINT " DIS: ";INT(S(16)*100)/1005330 PRINT "PDB:"5340 PRINT " ROT: ";INT(S(2)*100)/1005350 PRINT " SCA: ";INT(S(1)*100)/1005360 PRINT "DEV:"5370 PRINT " OUT: ";O15380 PRINT "TRA :"5390 PRINT " X INC: ";N45400 PRINT " Y INC: ";M45410 PRINT "LAY:  ";S(7)5420 PRINT "DSH:  ";S(9)5430 PRINT "TOL:  ";INT(T1*100)/1005440 PRINT "GRD:  ";INT(G0*100)/100;" ";INT(G1*100)/1005450 IF S(8)=0 THEN 54805460 PRINT "GRD:  ON"5470 GO TO 54905480 PRINT "GRD:  OFF"5490 PRINT "WIN: ";INT(W1*100)/100;" ";INT(W2*100)/100;" ";5500 PRINT INT(W3*100)/100;" ";INT(W4*100)/1005510 PRINT "MAG: ";A15520 INPUT Z$5540 GO TO 8505550 REM LIST PDB5560 READ #1,1:I85570 IF I8=>1 THEN 56105580 GOSUB 141005590 PRINT "Data Base is empty!"5600 GO TO 8705610 PRINT @O1:"
PDB:  ";T$;"
"5620 FOR I9=2 TO I8+15630 READ #1,I9:C15640 GO TO C1 OF 5750,5780,5820,5890,5710,5670,59405650 PRINT @O1:I9;" %";C1;" ERROR IN THIS RECORD!"5660 GO TO 59605670 READ #1,I9:C1,R(7),X1,Y1,R(19),R(17),R(18),R(20),R(21),R(23),R(22)5680 PRINT @O1:I9;" *";C1;" ";R(7);" ";X1;" ";Y1;" ";R(19);" ";R(17);5690 PRINT @O1:" ";R(18);" ";R(20);" ";R(21);" ";R(23);" ";R(22)5700 GO TO 59605710 READ #1,I9:C1,R(7),X1,Y1,X2,Y2,R(11),R(10)5720 PRINT @O1:I9;" *";C1;" ";R(7);" ";X1;" ";Y1;" ";X2;" ";Y2;" ";5730 PRINT @O1:R(11);" ";R(10)5740 GO TO 59605750 READ #1,I9:C1,R(7),X1,Y1,X2,Y2,R(9)5760 PRINT @O1:I9;" *";C1;" ";R(7);" ";X1;" ";Y1;" ";X2;" ";Y2;" ";R(9)5770 GO TO 59605780 READ #1,I9:C1,R(7),X1,Y1,R(12),R(13),R(14),R(6),C$5790 PRINT @O1:I9;" *";C1;" ";R(7);" ";X1;" ";Y1;" ";R(12);" ";5800 PRINT @O1:R(13);" ";R(14);" ";R(6);" ";C$;" ";R(4);" ";R(5)5810 GO TO 59605820 READ #1,I9:C1,R(7),X1,Y1,N0,R(15),R(16),C45830 PRINT @O1:I9;" *";C1;" ";R(7);" ";X1;" ";Y1;" ";N0;" ";5840 PRINT @O1:R(15);" ";R(16)5845 IF O1=32 THEN 59605850 PRINT @O1: USING "/4(5(7D.6D)/)":C45855 GO TO 59605890 READ #1,I9:C1,R(7),X3,Y3,R(2),R(1),F$,R(4),R(5)5900 PRINT @O1:I9;" *";C1;" ";R(7);" ";X3;" ";Y3;" ";R(2);" ";R(1);" ";5910 PRINT @O1:F$;" ";R(4);" ";R(5)5920 GO TO 59605940 READ #1,I9:C1,R(7),X1,Y1,C35945 PRINT @O1:I9;" *";C1;" ";R(7);" ";X1;" ";Y15950 IF O1=32 THEN 59605955 PRINT @O1: USING "/4(5(7D.6D)/)":C35960 NEXT I95965 IF O1<>32 THEN 59805970 INPUT Z$5975 GO TO 8505980 PRINT @O1:""5985 O1=325990 GO TO 8506000 REM DISPLAY6010 B$=SEG(A$,5,3)6020 Z1=16030 K$="ALLGRDLAYAXSMIRORG"6035 IF LEN(B$)<3 THEN 8506040 P0=INT((POS(K$,B$,1)+2)/3)+16050 GO TO P0 OF 1030,6170,6220,6070,6220,6070,60706070 B$=SEG(A$,9,LEN(A$)-8)6075 IF P0=7 AND B$="" THEN 61506080 GOSUB 68106090 IF E1<>0 THEN 10306100 L2=VAL(B$)6110 IF L2-INT(L2)<>0 OR L2<1 OR L2>100 THEN 10306120 GO TO P0-5 OF 19010,192106130 GOSUB 95706140 GO TO 8706150 Z1=06160 GO TO 192106170 Z0=06175 Z1=06180 GOSUB 95706190 GO TO 8706210 REM DRAW AXIS/GRID n6220 G2=G06230 G3=G16240 B$=SEG(A$,9,LEN(A$)-8)6250 IF LEN(B$)=0 THEN 10306260 G4=INT(VAL(B$))6270 IF G4<1 OR G4>100 THEN 10306280 G0=FNI(G0*G4)6290 G1=FNZ(G1*G4)6300 IF P0=3 THEN 63406310 AXIS G0,G16320 AXIS -G0,-G1,W2,W46330 GO TO 64506340 GOSUB 25506350 FOR A0=1 TO 16360 FOR I9=INT(W1/G0)+1 TO INT(W2/G0)+1 STEP 106370 IF I9*G0>W2-G0 THEN 64406380 FOR I8=INT(W3/G1)+1 TO INT(W4/G1)+1 STEP 106390 IF I8*G1>W4-G1 THEN 64306400 STPOINT 100,I9*G0,I8*G16410 FIX 1006420 NEXT I86430 NEXT I96440 NEXT A06450 G0=G26460 G1=G36470 GO TO 8706480 REM WINDOW6490 B$=SEG(A$,5,3)6500 Z1=06510 IF B$="ZOM" THEN 28006520 IF B$="ALL" THEN 65406530 GO TO 10306540 Z1=06550 W1=06560 W2=40006570 W3=06580 W4=40006590 GO TO 29006600 REM PARSE CHANGE/DELETE, FIND OBJECT6610 B$=SEG(A$,5,3)6615 IF LEN(B$)<>3 THEN 10306620 A9=(POS("LINLABXHAPDBARWCIRPOL",B$,1)+2)/36630 Q5=T16640 MOVE (W1+W2)/2,(W3+W4)/26650 ROPEN 16660 VISIBILITY 1,16670 CURSOR 16680 GOSUB 75456690 RCLOSE 6700 POINTER X1,Y1,Z$6710 IF Z$="C" THEN 8706720 GOSUB 129006725 RDELETE 16730 IF E6<>0 THEN 8706740 GOSUB A9 OF 7710,7640,7780,13405,13470,14330,150306750 GO TO M0 OF 6790,6790,6790,67706760 GO TO 8706770 CURSOR 06780 GO TO 13406790 GO TO A9 OF 3790,4090,4310,4600,4010,3280,151906800 REM NUMERIC CHECK ON B$6810 E1=06830 IF LEN(A$)<>0 THEN 68806850 GOSUB 141006860 PRINT "Missing value!"6865 E1=16870 GO TO 69806880 FOR I9=1 TO LEN(B$)6890 Z$=SEG(B$,I9,1)6900 IF Z$=>"0" AND Z$<="9" OR Z$="." OR Z$="-" OR Z$=" " THEN 69506910 E1=16920 I9=LEN(B$)6950 NEXT I96980 RETURN 6990 REM ALPHANUMERIC CHECK ON FILE NAME7000 E1=17010 P1=POS(B$,".",1)7015 P0=LEN(B$)-P17020 IF P1>11 OR (P1=0 AND LEN(B$)>10) OR (P1<>0 AND P0>4) THEN 71307030 E1=07040 FOR I9=1 TO LEN(B$)7050 IF I9=P1 THEN 71207060 Z$=SEG(B$,I9,1)7070 IF I9=1 OR I9=P1+1 AND (Z$<"A" OR Z$>"Z") THEN 70907080 IF Z$=>"A" AND Z$<="Z" OR (Z$=>"0" AND Z$<="9") THEN 71207090 E1=17100 PRINT B$;" ?"7110 I9=LEN(B$)7120 NEXT I97130 RETURN 7220 REM DETERMINE POSITION OF `,` IN B$7230 E2=07240 P1=POS(A$,",",1)7250 IF P1<>0 THEN 72807260 E2=17265 GOSUB 68107270 GO TO 73207280 B$=SEG(A$,1,P1-1)7290 GOSUB 68107300 IF E1=1 THEN 73207310 A$=SEG(A$,P1+1,LEN(A$)-P1+1)7320 RETURN 7330 REM DRAW AND STORE LINE7340 MOVE X1,Y17350 GO TO M0 OF 7390,7390,7360,8707360 P5=P5+17370 Z3=P57380 WRITE #1,1:P5-17390 WRITE #1,Z3:1,R(7),X1,Y1,X2,Y2,R(9)7400 IF R(9)=0 THEN 74307410 GOSUB 82407420 RETURN 7430 DRAW X2,Y27440 RETURN 7450 REM STORE LABEL7460 GO TO M0 OF 7500,7500,7470,8707470 P5=P5+17480 Z3=P57490 WRITE #1,1:P5-17500 WRITE #1,Z3:2,R(7),X1,Y1,R(12),R(13),R(14),R(6),C$7505 RDELETE 17510 GOSUB 140107515 IF NOT(M0) THEN 42607520 GO TO 8707530 REM DRAW Confirm/Locate BOX7540 Q5=T1/27542 GO TO 75707545 RMOVE -Q5/2,07550 RDRAW Q5,07555 RMOVE -Q5/2,Q5/27560 RDRAW 0,-Q57565 RMOVE 0,Q5/27570 RMOVE -Q5/2,-Q5/27575 RDRAW 0,Q57580 RDRAW Q5,07585 RDRAW 0,-Q57590 RDRAW -Q5,07600 RMOVE Q5/2,Q5/27610 PRINT "";7620 RETURN 7630 REM ALTER LABEL7640 READ #1,Z3:C1,R(7),X1,Y1,R(12),R(13),R(14),R(6),C$7650 MOVE X3-Q5/4,Y3-3*Q5/47660 PRINT "#";7670 IF M0<>0 THEN 76907680 WRITE #1,Z3:C1,0,X1,Y1,R(12),R(13),R(14),R(6),C$7690 RETURN 7700 REM ALTER LINE7710 READ #1,Z3:C1,R(7),X1,Y1,X2,Y2,R(9)7720 MOVE (X3+X1)/2-Q5/4,(Y3+Y1)/2-3*Q5/47730 PRINT "#";7740 IF M0<>0 THEN 77607750 WRITE #1,Z3:C1,0,X1,Y1,X2,Y2,R(9)7760 RETURN 7770 REM ALTER XHA7780 READ #1,Z3:C1,R(7),X1,Y1,N0,R(15),R(16),C47785 GOSUB 198107790 MOVE X1-Q5/4,Y1-3*Q5/47800 PRINT "#";7810 IF M0<>0 THEN 78307815 GOSUB 197107820 WRITE #1,Z3:C1,0,P(1,1),P(2,1),N0,R(15),R(16),C47830 RETURN 7840 REM DRAW AND STORE XHA7850 IF M0<>0 THEN 78857860 P5=P5+17870 Z3=P57880 WRITE #1,1:P5-17885 GOSUB 197107890 WRITE #1,Z3:3,R(7),P(1,1),P(2,1),N0,S(15),S(16),C47895 IF M0=0 THEN 79107900 GOSUB 100807910 GOSUB 140107920 GO TO 8708000 REM REPEAT CIRCLE/POLYGON8010 B$=SEG(A$,5,3)8020 IF LEN(B$)<>3 THEN 10308030 IF B$="CIR" OR B$="POL" THEN 80508040 GO TO 10308050 M0=38060 GO TO 66108230 REM DRAW DASHED LINE8240 MOVE @O1:X1,Y18242 IF R(9)>0 THEN 82508244 RDRAW @O1:X2-X1,Y2-Y18246 GO TO 88308250 S5=(W2-W1)/1008260 S6=(W4-W3)/1008270 D5=(X2-X1)/S58280 D6=(Y2-Y1)/S68290 D7=SQR(D5^2+D6^2)8300 IF ABS(D6)<0.2 AND ABS(D5)<0.2 THEN 88308310 U5=D5/D7*S58320 U6=D6/D7*S68330 U7=2*U58340 U8=2*U68350 I0=ABS(U5) MAX ABS(U6)8360 I7=08370 GO TO R(9) OF 8390,8470,8550,8630,87308380 GO TO 88208390 I7=ABS(X2-X1-U5*2) MAX ABS(Y2-Y1-U6*2)8400 I7=INT(I7/(2*I0))8410 FOR I9=0 TO I78420 RDRAW @O1:U5,U68430 RMOVE @O1:U5,U68440 NEXT I98450 I7=I7*2+28460 GO TO 88208470 I7=ABS(X2-X1-U5) MAX ABS(Y2-Y1-U6)8480 I7=INT(I7/I0)8490 FOR I9=0 TO I78500 RDRAW @O1:0,08510 RMOVE @O1:U5,U68520 NEXT I98530 I7=I7+18540 GO TO 88208550 I7=ABS(X2-X1-U5*3) MAX ABS(Y2-Y1-U6*3)8560 I7=INT(I7/(3*I0))8570 FOR I9=0 TO I78580 RDRAW @O1:U7,U88590 RMOVE @O1:U5,U68600 NEXT I98610 I7=I7*3+38620 GO TO 88208630 I7=ABS(X2-X1-U5*3) MAX ABS(Y2-Y1-U6*3)8640 I7=INT(I7/(3*I0))8650 FOR I9=0 TO I78660 RDRAW @O1:U5,U68670 RMOVE @O1:U5,U68680 RDRAW @O1:0,08690 RMOVE @O1:U5,U68700 NEXT I98710 I7=I7*3+38720 GO TO 88208730 I7=ABS(X2-X1-U5*5) MAX ABS(Y2-Y1-U6*5)8740 I7=INT(I7/(5*I0))8750 FOR I9=0 TO I78760 RDRAW @O1:U7,U88770 RMOVE @O1:U5,U68780 RDRAW @O1:U5,U68790 RMOVE @O1:U5,U68800 NEXT I98810 I7=I7*5+58820 RDRAW @O1:X2-X1-I7*U5,Y2-Y1-I7*U68830 X1=X28840 Y1=Y28850 RETURN 8860 REM ROM CHARACTER GENERATOR8870 MOVE @O1:X1,Y18880 CALL "LRESET"8890 CALL "LQUAL",08900 CALL "LSMOTH",0.778910 CALL "LSCALE",ABS(R(13))*R(5),ABS(R(13))*R(4)8920 IF R(14)=0 THEN 89408930 CALL "LSLANT",158940 CALL "LROT",R(12)8950 CALL "LMFONT",08960 CALL "LAFONT",R(6)8970 IF SGN(R(13))=-1 THEN 90008980 CALL "LETEVN",O1;C$8990 GO TO 90109000 CALL "LVERTI",O1;C$9010 GIN @O1:X5,Y59020 RETURN 9100 REM MAGNIFY A POINT9110 B$=SEG(A$,5,3)9120 GOSUB 68109130 IF E1 THEN 10309140 A1=VAL(B$)9150 IF A1=1 THEN 65509160 IF A1<1 OR A1>20 OR 2000/A1<>INT(2000/A1) THEN 10309170 POINTER X3,Y3,Z$9180 IF Z$<>"C" THEN 92109190 A1=19200 GO TO 65509210 X3=0 MAX FNH(X3)9220 X3=X3 MIN 40009230 Y3=0 MAX FNV(Y3)9240 Y3=Y3 MIN 40009250 W1=X3-2000/A19260 W2=X3+2000/A19270 W3=Y3-2000/A19280 W4=Y3+2000/A19290 IF W1<0 OR W3<0 OR W2>4000 OR W4>4000 THEN 93109300 GO TO 29009310 PRINT @32,21:0,O39320 ROPEN 109330 PRINT "

CLIPPING IS POSSIBLE!'RETURN' TO CONTINUE. ";9340 RCLOSE 9350 BLINK 10,0.5,0.59360 INPUT Z$9370 RDELETE 109380 GO TO 29009560 REM REDRAW PDB9570 IF Z0=1 THEN 96109590 PAGE 9600 O3=979610 GOSUB 142009620 IF P5<=1 THEN 100309630 GO TO 96759640 PRINT @O1,32:"AS",1,19660 PRINT @O1,32:"AX"9670 PRINT @O1,32:"AS",A2,A39675 ON EOF (1) THEN 100359676 FOR A0=1 TO 19677 FOR I5=2 TO P59680 READ #1,I5:C1,R(7)9690 IF R(7)=0 THEN 100009700 IF Z1<>1 THEN 97209710 IF R(7)<>L2 THEN 100009720 GO TO C1 OF 9830,9790,9860,9890,9940,9760,99709730 GOSUB 141009740 PRINT "Data Base Error at Record ";I5;"!"9745 WRITE #1,I5:1,09750 GO TO 100009760 READ #1,I5:C1,R(7),X4,Y4,R(19),R(17),R(18),R(20),R(21),R(23),R(22)9770 GOSUB 135409780 GO TO 100009790 READ #1,I5:C1,R(7),X1,Y1,R(12),R(13),R(14),R(6),C$9800 MOVE @O1:X1,Y19810 GOSUB 88709820 GO TO 100009830 READ #1,I5:C1,R(7),X1,Y1,X2,Y2,R(9)9840 GOSUB 82409850 GO TO 100009860 READ #1,I5:C1,R(7),X1,Y1,N0,R(15),R(16),C49865 GOSUB 198109870 GOSUB 100809880 GO TO 100009890 READ #1,I5:C1,R(7),X3,Y3,R(2),R(1),F$,R(4),R(5)9900 GOSUB 105809910 IF LEN(D$)=0 THEN 100009920 GOSUB 107109930 GO TO 100009940 READ #1,I5:C1,R(7),X1,Y1,X2,Y2,R(11),R(10)9950 GOSUB 122409960 GO TO 100009970 GOSUB 148609980 RDELETE 210000 C2=I510005 NEXT I510010 NEXT A010015 IF O1=32 OR H1<>3 THEN 1002510020 PRINT @O1,32:"AY"10025 OFF EOF (1)10030 RETURN 10035 WRITE #1,1:C2-110040 P5=C210045 GO TO 1001010070 REM GENERATE & DRAW XHA10080 MOVE @O1:0,010090 DELETE W7,U010100 DIM W7(2,N0+1),U0(N0)10110 X5=010120 Y5=010130 Q5=1.0E+30710140 Q6=-1.0E+30710150 S9=SIN(R(15))10160 C9=COS(R(15))10170 FOR I0=1 TO N010180 W7(1,I0)=P(1,I0)*C9+P(2,I0)*S910190 W7(2,I0)=-P(1,I0)*S9+P(2,I0)*C910200 Q5=Q5 MIN W7(2,I0)10210 Q6=Q6 MAX W7(2,I0)10220 NEXT I010230 W7(1,N0+1)=W7(1,1)10240 W7(2,N0+1)=W7(2,1)10250 Y0=Q5+0.5*R(16)10260 IF Y0>Q6 THEN 1056010270 K0=010280 FOR I0=1 TO N010290 Q7=W7(2,I0) MIN W7(2,I0+1)10300 IF Y0<Q7 THEN 1043010310 W0=W7(2,I0) MAX W7(2,I0+1)10320 IF Y0=>W0 THEN 1043010330 X1=(W7(2,I0)-Y0)*(W7(1,I0)-W7(1,I0+1))/(W7(2,I0)-W7(2,I0+1))10340 X1=W7(1,I0)-X110350 K0=K0+110360 J0=K010370 IF J0=1 THEN 1042010380 IF U0(J0-1)=>X1 THEN 1042010390 U0(J0)=U0(J0-1)10400 J0=J0-110410 GO TO 1037010420 U0(J0)=X110430 NEXT I010440 FOR I0=1 TO K010450 P8(1)=U0(I0)*C9-Y0*S910460 P8(2)=U0(I0)*S9+Y0*C910470 IF 2*INT(0.5*I0)-I0>-0.1 THEN 1050010480 RMOVE @O1:P8(1)-X5,P8(2)-Y510490 GO TO 1051010500 RDRAW @O1:P8(1)-X5,P8(2)-Y510510 X5=P8(1)10520 Y5=P8(2)10530 NEXT I010540 Y0=Y0+R(16)10550 GO TO 1026010560 RETURN 10570 REM FIND sub-PDB10580 IF F1=1 THEN 1064010590 D9=110600 CALL "UNIT",D910610 CALL "FILE",D9,F$,D$10620 IF LEN(D$)<>0 THEN 1069010630 IF D9=0 THEN 1066010640 D9=010650 GO TO 1060010660 GOSUB 1410010670 PRINT "sub-PDB ";F$;" does not exist!"10690 RETURN 10700 REM INSERT sub-PDB10710 MOVE @O1:X3,Y310720 CALL "UNIT",D910730 CLOSE 210740 OPEN F$;2,"R",D$10750 READ #2,1:P710760 IF P7=>1 THEN 1080010770 GOSUB 1410010780 PRINT "sub-PDB ";F$;" is empty!"10790 RETURN 10800 IF R(4)=R(5) THEN 1081010805 R(2)=010810 R(24)=SIN(R(2))10815 R(25)=COS(R(2))10820 FOR I8=2 TO P7+110830 READ #2,I8:C1,R(7)10840 IF R(7)<>1 THEN 1087010850 GOSUB C1 OF 11470,11370,11720,11630,11220,11100,1092010870 NEXT I810880 R(7)=S(7)10890 UNIT 010900 CLOSE 210910 RETURN 10920 READ #2,I8:C1,R(7),X1,Y1,C310925 GOSUB 1961010930 IF N0<2 THEN 1106010940 FOR I9=1 TO N010950 X9=P2(I9)10960 Y9=P3(I9)10970 GOSUB 1186010980 P2(I9)=X010990 P3(I9)=Y011000 NEXT I911010 RMOVE @O1:P2(1)-X3,P3(1)-Y311020 FOR I9=1 TO N0-111030 RDRAW @O1:P2(I9+1)-P2(I9),P3(I9+1)-P3(I9)11040 NEXT I911050 RMOVE @O1:X3-P2(N0),Y3-P3(N0)11060 RETURN 11100 READ #2,I8:C1,R(7),X9,Y9,R(19),R(17),R(18),R(20),R(21),R(23),R(22)11110 GOSUB 1186011120 X4=X011130 Y4=Y011140 R(19)=R(19)*R(1)11150 R(20)=R(20)+R(2)11160 R(22)=R(22)*R(4)11170 R(23)=R(23)*R(5)11180 RMOVE @O1:X4-X3,Y4-Y311190 GOSUB 1355011200 RMOVE @O1:X3-X6-X4,Y3-Y6-Y411210 RETURN 11220 READ #2,I8:C1,R(7),X9,Y9,X2,Y2,R(11),R(10)11230 GOSUB 1186011240 X1=X011250 Y1=Y011260 X9=X211270 Y9=Y211280 GOSUB 1186011290 X2=X011300 Y2=Y011310 R(10)=R(10)*R(1)11330 RMOVE @O1:X1-X3,Y1-Y311340 GOSUB 1225011350 RMOVE @O1:X3-X2,Y3-Y211360 RETURN 11370 READ #2,I8:C1,R(7),X9,Y9,R(12),R(13),R(14),R(6),C$11380 GOSUB 1186011390 X1=X011400 Y1=Y011410 RMOVE @O1:X1-X3,Y1-Y311420 R(12)=R(12)+R(2)11430 R(13)=R(13)*R(1)11440 GOSUB 888011450 RMOVE @O1:X3-X5,Y3-Y511460 RETURN 11470 READ #2,I8:C1,R(7),X9,Y9,X2,Y2,R(9)11480 GOSUB 1186011490 X1=X011500 Y1=Y011510 X9=X211520 Y9=Y211530 GOSUB 1186011540 X2=X011550 Y2=Y011560 RMOVE @O1:X1-X3,Y1-Y311570 IF R(9)=0 THEN 1160011580 GOSUB 825011590 GO TO 1161011600 RDRAW @O1:X2-X1,Y2-Y111610 RMOVE @O1:X3-X2,Y3-Y211620 RETURN 11630 VISIBILITY 1,111640 GOSUB 1410011650 PRINT ""11660 ROPEN 111670 PRINT "CAN'T NEST PDB'S "11680 RCLOSE 11690 CALL "WAIT",211700 RDELETE 111710 RETURN 11720 READ #2,I8:C1,R(7),X1,Y1,N0,R(15),R(16),C411725 GOSUB 1981011730 FOR I6=1 TO N0+111740 X9=P(1,I6)11750 Y9=P(2,I6)11760 GOSUB 1186011770 P(1,I6)=X011780 P(2,I6)=Y011790 NEXT I611800 R(15)=R(15)+R(2)11810 R(16)=R(16)*R(1)11820 RMOVE @O1:-X3,-Y311830 GOSUB 1009011840 RMOVE @O1:X3-X5,Y3-Y511850 RETURN 11860 X9=X9-200011870 Y9=Y9-200011880 X0=FNA(X9)11890 Y0=FNB(Y9)11900 RETURN 12040 REM STORE sub-PDB12050 GO TO M0 OF 12090,12090,12060,1206012060 P5=P5+112070 Z3=P512080 WRITE #1,1:P5-112090 WRITE #1,Z3:4,R(7),X3,Y3,R(2),R(1),F$,R(4),R(5)12100 IF M0=4 THEN 1212012110 GO TO 475012120 RETURN 12130 REM STORE ARROW12140 GO TO M0 OF 12180,12180,12150,87012150 P5=P5+112160 Z3=P512170 WRITE #1,1:P5-112180 WRITE #1,Z3:5,R(7),X1,Y1,X2,Y2,R(11),R(10)12200 GOSUB 1224012210 GOSUB 1401012220 RETURN 12230 REM DRAW ARROW12240 MOVE @O1:X1,Y112250 V0=SQR((X1-X2)^2+(Y1-Y2)^2)12260 IF V0=0 THEN 1240012270 B3=R(10)*(X1-X2)/V012280 B4=R(10)*(Y1-Y2)/V012290 S9=SIN(R(11))12300 H9=COS(R(11))12310 B5=+B4*S9-B3*H912320 B6=-B4*H9-B3*S912330 RMOVE @O1:B5,B612340 RDRAW @O1:-B5,-B612350 B5=-B4*S9-B3*H912360 B6=-B4*H9+B3*S912370 RDRAW @O1:B5,B612380 RMOVE @O1:-B5,-B612390 RDRAW @O1:X2-X1,Y2-Y112400 RETURN 12410 REM TRANSLATE AND STORE LINE/PDB/CIR/POL12420 GO TO P0 OF 12430,12450,12480,1250012430 READ #1,Z3:C1,R(7),X7,Y7,X8,Y8,R(9)12440 GO TO 1252012450 READ #1,Z3:C1,R(7),X3,Y3,R(2),R(1),F$,R(4),R(5)12460 GOSUB 1057012470 GO TO 1252012480 READ #1,Z3:C1,R(7),X4,Y4,R(19),R(17),R(18),R(20),R(21),R(23),R(22)12490 GO TO 1252012500 I5=Z312510 GOSUB 1486012520 FOR I6=1 TO N112530 GO TO P0 OF 12540,12610,12650,1270012540 X1=X7+N3*I612550 Y1=Y7+M3*I612560 X2=X8+N3*I612570 Y2=Y8+M3*I612580 MOVE @O1:X1,Y112590 GOSUB 736012600 GO TO 1273012610 X3=X3+N312620 Y3=Y3+M312630 GOSUB 1205012640 GO TO 1273012650 X4=X4+N312660 Y4=Y4+M312670 GOSUB 1354012680 GOSUB 1381012690 GO TO 1273012700 X3=X1+N312710 Y3=Y1+M312720 GOSUB 1519012730 NEXT I612740 GOSUB 1401012750 GO TO 87012890 REM FIND CLOSEST OBJECT12900 E6=012910 IF P5>0 THEN 1296012920 GOSUB 1410012930 PRINT "Data Base is empty!"12940 E6=112950 GO TO 1339012960 Z3=012970 V0=212980 FOR I9=V0 TO P512990 READ #1,I9:C1,R(7)13000 IF R(7)=0 OR C1<>A9 THEN 1309013010 GO TO A9 OF 13020,13050,13050,13050,13020,13050,1305013020 READ #1,I9:C1,R(7),X2,Y2,X3,Y313030 IF ABS(X2-X1) MAX ABS(Y2-Y1)>G0 MIN T1 THEN 1306013040 GO TO 1307013050 READ #1,I9:C1,R(7),X3,Y313060 IF ABS(X3-X1) MAX ABS(Y3-Y1)>G1 MIN T1 THEN 1309013070 Z3=I913080 I9=P513090 NEXT I913100 IF Z3<>0 THEN 1317013110 GOSUB 1410013120 E6=113130 D$=" LINE  LABEL  X-HATCHSUB-PDB ARROW CIRCLE POLYGON"13140 K$=SEG(D$,A9*7-6,7)13150 PRINT "No ";K$;" found within Tolerance!"13160 GO TO 1339013170 GO TO A9 OF 13180,13200,13200,13200,13180,13200,1320013180 MOVE (X2+X3)/2,(Y2+Y3)/213190 GO TO 1321013200 MOVE X3,Y313210 ROPEN 113220 VISIBILITY 1,113230 GOSUB 754013240 RCLOSE 13250 BLINK 1,0.2,0.213260 GOSUB 1410013270 PRINT "Layer:";R(7);" Confirm: ";13280 INPUT Z$13290 Z$=SEG(Z$,1,1)13300 IF Z$="C" THEN 1338013310 IF Z$="Y" THEN 1337013320 V0=Z3+113330 RDELETE 113340 Z3=013350 IF V0<=P5 THEN 1298013360 GO TO 1311013370 FIX 113380 RDELETE 113390 RETURN 13400 REM ALTER sub-PDB13405 READ #1,Z3:C1,R(7),X3,Y3,R(2),R(1),F$,R(4),R(5)13410 MOVE X3-Q5/4,Y3-3*Q5/413420 PRINT "#";13430 IF M0<>0 THEN 1345013440 WRITE #1,Z3:C1,0,X3,Y3,R(2),R(1),F$,R(4),R(5)13450 RETURN 13460 REM ALTER ARROW13470 READ #1,Z3:C1,R(7),X1,Y1,X2,Y2,R(11),R(10)13480 MOVE X3-Q5/4,Y3-3*Q5/413490 PRINT "#";13500 IF M0<>0 THEN 1352013510 WRITE #1,Z3:C1,0,X1,Y1,X2,Y2,R(11),R(10)13520 RETURN 13530 REM DRAW CIRCLE13540 MOVE @O1:X4,Y413550 IF R(18)<0 OR R(18)<=R(17) THEN 1356013555 GO TO 1356513560 R(18)=R(18)+36013565 R(26)=SIN(R(20))13570 R(27)=COS(R(20))13575 P0=(R(21)=1)+(R(22)=1)+(R(23)=1)13580 IF P0<>3 THEN 1360013585 CALL "ARC2",O1;X4,Y4,R(19),R(17)+R(20),R(18)+R(20)13590 GO TO 1374013600 X9=COS(R(17))*R(19)13610 Y9=SIN(R(17))*R(19)13620 X5=FNC(X9)13630 Y5=FND(Y9)13640 RMOVE @O1:X5,Y513650 FOR I9=R(17)+5 TO R(18) STEP 813660 X9=COS(I9)*R(19)13670 Y9=SIN(I9)*R(19)13680 X6=FNC(X9)13690 Y6=FND(Y9)13700 RDRAW @O1:X6-X5,Y6-Y513710 X5=X613720 Y5=Y613730 NEXT I913740 X9=COS(R(18))*R(19)13750 Y9=SIN(R(18))*R(19)13760 X6=FNC(X9)13770 Y6=FND(Y9)13775 IF P0=3 THEN 1379013780 RDRAW @O1:X6-X5,Y6-Y513790 RETURN 13800 REM STORE CIRCLE13810 GO TO M0 OF 13850,13850,13820,1382013820 P5=P5+113830 Z3=P513840 WRITE #1,1:P5-113850 WRITE #1,Z3:6,R(7),X4,Y4,R(19),R(17),R(18),R(20),R(21),R(23),R(22)13860 GO TO M0 OF 870,870,3350,1388013870 GO TO 328013880 RETURN 13885 REM ANGLE ADJUSTMENT13890 IF X9<0 THEN 1398013900 IF X9<>0 THEN 1396013910 IF Y9<0 THEN 1394013920 R(17)=9013930 GO TO 1399013940 X0=27013950 GO TO 1399013960 X0=ATN(Y9/X9)13970 GO TO 1399013980 X0=ATN(Y9/X9)+18013990 RETURN 14000 REM CHECK DISK SPACE14010 CALL "MOUNT",0,D$14015 D$=SEG(D$,74,9)14020 Z1=VAL(D$)14025 IF Z1>12800 THEN 1408014030 Z1=INT(Z1/256)14040 GOSUB 1410014050 PRINT "Disc nearly full."14060 GOSUB 1410014070 PRINT "Records left:";Z114080 RETURN 14090 REM PROMPT POSITION14100 O3=O3-1.42514110 IF O3>6 THEN 1414014120 O3=97.42514130 PAGE 14135 GOSUB 1421014140 PRINT @32,21:0,O314150 RETURN 14200 REM DRAW VIEWPORT14210 IF O1<>32 THEN 1424014220 PRINT @32,21:20,014230 PRINT @32,20:120,0,120,100,20,100,20,014240 IF A1=1 THEN 1427014250 PRINT @32,21:122,9614260 PRINT "MAG= ";A114270 RETURN 14320 REM ALTER CIRCLE14330 READ #1,Z3:C1,R(7),X3,Y3,R(19),R(17),R(18),R(20),R(21),R(23),R(22)14340 MOVE X3-Q5/4,Y3-3*Q5/414350 PRINT "#";14360 IF M0<>0 THEN 1438014370 WRITE #1,Z3:C1,0,X3,Y3,R(19),R(17),R(18),R(20),R(21),R(23),R(22)14380 RETURN 14390 REM INSERT POLYGON14400 M$="#CM########L"14410 RINIT 14420 C2=014430 GOSUB 1653014440 P2=-10014450 P3=-10014460 I8=114470 ROPEN 214480 RCLOSE 14490 VISIBILITY 2,114500 IF C2=4 THEN 1455014510 IF R(28) THEN 1613014520 GOSUB 489014530 GO TO C2 OF 14520,16290,1455014540 GO TO 1452014550 P2(I8)=X314560 P3(I8)=Y314565 STPOINT 2,X3,Y314570 IF R(28) THEN 1618014580 STPOINT 1,X3,Y314590 ROPEN 114600 DRAW X3,Y314610 RCLOSE 14620 VISIBILITY 1,114630 GOSUB 1701014640 M$="#CFBE"14650 GOSUB 489014660 GOSUB 1711014670 GO TO C2 OF 14400,16290,14750,14680,1440014680 I8=I8+114690 P2(I8)=X314700 P3(I8)=Y314705 IF P2(I8)=P2(I8-1) AND P3(I8)=P3(I8-1) THEN 1474014710 RAPPEND 214720 DRAW X3,Y314730 RCLOSE 14740 IF I8<19 THEN 1457014750 IF I8<2 THEN 1457014760 FIX 214770 GO TO 1510014780 REM TRANSFORM TABLET COORDINATES14790 C2=POS("2481",K$,1)14800 X3=0 MAX (INT(X3+0.5)-C5)*C714810 Y3=0 MAX (INT(Y3+0.5)-C6)*C814820 X3=FNH(X3) MIN W214830 Y3=FNV(Y3) MIN W414840 RETURN 14850 REM DRAW POLYGON14860 READ #1,I5:C1,R(7),X1,Y1,C314865 GOSUB 1961014870 MOVE @O1:P2(1),P3(1)14880 ROPEN 214890 VISIBILITY 2,114895 IF M0=2 THEN 1491014900 CURSOR 214910 I8=114920 RDRAW @O1:P2(I8+(P2(2)=>0))-P2(I8),P3(I8+(P3(2)=>0))-P3(I8)14940 I8=I8+114950 IF P2(I8+1)<0 AND P3(I8+1)<0 OR I8=19 THEN 1497014960 GO TO 1492014970 RCLOSE 14975 IF M0=2 AND C2=3 THEN 1499014980 IF M0 THEN 1500014990 FIX 215000 RETURN 15020 REM READ POLYGON15030 READ #1,Z3:C1,R(7),X1,Y1,C315035 GOSUB 1961015040 MOVE X1-Q5/4,Y1-Q5*3/415050 PRINT "#";15060 IF M0<>0 THEN 1508015065 GOSUB 1951015070 WRITE #1,Z3:C1,0,X1,Y1,C315080 RETURN 15090 REM STORE POLYGON15100 GO TO M0 OF 15135,15135,15110,1511015110 P5=P5+115120 Z3=P515130 WRITE #1,1:P5-115135 GOSUB 1951015140 WRITE #1,Z3:7,R(7),P2(1),P3(1),C315150 RDELETE 215160 GO TO M0 OF 870,870,15210,1517515170 GO TO 1444015175 RETURN 15180 REM ALTER POLYGON15190 IF M0=2 THEN 1543015192 C3=P215194 C4=P315200 M$="##CFPSR#YX#L"15210 GOSUB 1487015220 GOSUB 489015230 GO TO C2-2 OF 870,15260,15250,15260,15260,870,15260,1526015240 GO TO 1522015250 GOSUB 1636015260 FOR I9=1 TO I815270 X9=C3(I9)-C3(1)15280 Y9=C4(I9)-C4(1)15290 GOSUB 1645015300 P2(I9)=X015310 P3(I9)=Y015320 NEXT I915330 IF C2=4 THEN 1539015340 MOVE X3,Y315350 ROPEN 215370 GOSUB 1489015380 GO TO 1522015390 FIX 215400 GO TO 1510015420 REM POLYGON POINT CHANGE15430 C3=015435 C4=015437 X8=015440 M$="##FCB"15445 GOSUB 489015450 GO TO C2-2 OF 15710,15730,1546015455 GO TO 1544515460 FUZZ 315465 X7=X3=P2(1)15470 Y7=Y3=P3(1)15475 X7=X7*Y715480 IF NOT(X7) THEN 1550515485 X8=X3=P2(N0)15490 Y8=Y3=P3(N0)15495 X8=X8*Y815500 IF X7 AND X8 THEN 1560015505 C3=X3=P215510 C4=Y3=P315520 C3=C3*C415530 FOR A0=1 TO 115540 FOR I8=1 TO N015550 IF C3(I8)=1 THEN 1557015560 NEXT I815570 NEXT A015580 IF I8<=N0 THEN 1560015590 GO TO 1543015600 FUZZ 1215610 MOVE @O1:X3-0.25*Q5,Y3-0.85*Q515620 PRINT "*";15630 GOSUB 489015640 GO TO C2-2 OF 15650,870,1565015645 GO TO 1563015650 IF NOT(X7) OR NOT(X8) THEN 1569015655 P2(1)=X315660 P3(1)=Y315665 P2(N0)=X315670 P3(N0)=Y315680 GO TO 1571015690 P2(I8)=X315700 P3(I8)=Y315710 GOSUB 1487015720 GO TO C2-2 OF 15100,870,1544515730 FUZZ 1215740 GO TO 87015760 REM POLYGON MOV/POI15770 B$=SEG(A$,9,3)15780 IF LEN(B$)<>3 THEN 103015790 K$="MOVPOI"15800 M0=INT((POS(K$,B$,1)+2)/3)15810 IF M0=0 THEN 103015820 GO TO 661015860 REM READ TABLET CURSOR15870 INPUT @8:X3,Y3,K$15880 IF K$="0" THEN 1592015890 PRINT ""15900 INPUT @8:X7,Y7,Z$15910 IF Z$<>"0" THEN 1590015920 RETURN 15925 REM MARK TABLET WORKSPACE15930 GOSUB 1410015935 PRINT "  LOWER LEFT"15940 GOSUB 1587015945 IF K$="0" THEN 1594015950 C5=INT(X3)15955 C6=INT(Y3)15960 GOSUB 1410015965 PRINT "  UPPER RIGHT"15970 GOSUB 1587015975 IF K$="0" THEN 1597015980 C7=(W2-W1)/(INT(X3)-C5)15985 C8=(W4-W3)/(INT(Y3)-C6)15990 GO TO 87016000 REM SELECT TABLET OR JOYSTICK16010 B$=SEG(A$,9,LEN(A$)-1)16020 IF B$="" THEN 103016030 R(28)=VAL(B$)16040 S(28)=R(28)16050 IF R(28)=0 OR R(28)=1 THEN 87016060 GO TO 103016110 REM POLYGON TABLET INPUT16130 GOSUB 1587016140 GOSUB 1479016150 STPOINT 99,X3,Y316160 IF C2=0 THEN 1613016170 GO TO C2 OF 14400,16290,14550,1455016180 GOSUB 1587016190 GOSUB 1479016200 IF C2<>0 THEN 1467016210 MOVE P2(I8),P3(I8)16220 VISIBILITY 1,016230 ROPEN 116240 DRAW X3,Y316250 RCLOSE 16260 VISIBILITY 1,116270 STPOINT 99,X3,Y316280 GO TO 1618016290 S(28)=016300 GO TO 87016350 REM POLYGON AXIS16360 GOSUB 1410016370 ROPEN 1016380 PRINT "

Mirror on X or Y axis?";16390 RCLOSE 16400 INPUT Z$16410 RDELETE 1016420 R(29)=POS("YX",Z$,1)16430 RETURN 16440 REM POLYGON ROTATE/MIRROR16450 X0=FNA(X9)16460 Y0=FNB(Y9)16470 IF R(29)=0 THEN 1650016480 X0=FNE(X0)16490 Y0=FNF(Y0)16500 RETURN 16520 REM BUILD CROSSHAIR16530 X3=(W1+W2)/216532 Y3=(W3+W4)/216535 MOVE X3,Y316540 ROPEN 9916550 VISIBILITY 99,016560 RMOVE -0.5*(W2-W1),016570 RDRAW W2-W1,016580 RMOVE -0.5*(W2-W1),-0.5*(W4-W3)16590 RDRAW 0,W4-W316600 RMOVE 0,-0.5*(W4-W3)16610 RCLOSE 16620 VISIBILITY 99,116630 BLINK 99,2,0.216640 IF R(28) THEN 1666016650 CURSOR 9916660 RETURN 17000 REM SET CURSOR17010 CURSOR 117020 CALL "ENDRAG"17030 GOSUB 1653517040 CALL "ENDRAG"17050 RETURN 17100 REM CLEAR CURSOR17110 CURSOR 117120 CALL "CLDRAG"17130 CURSOR 9917140 CALL "CLDRAG"17150 RETURN 17200 REM KEYBOARD LINE ENTRY17210 PAGE 17220 PRINT "LINES MAY BE ENTERED FROM THE KEYBOARD WITH CARE."17230 PRINT "THERE IS NO ERROR CHECKING!"17240 PRINT "
USE OUT OF RANGE DASH CODE TO ESCAPE LOOP."17250 PRINT "
ENTER DASH CODE (0-5): ";17260 INPUT R(9)17270 IF R(9)<0 OR R(9)>5 THEN 85017280 PRINT "ENTER LAYER NUMBER (1-100): ";17290 INPUT R(7)17300 PRINT "ENTER START POINT (X,Y): ";17310 INPUT X1,Y117320 PRINT "ENTER END POINT (X,Y): ";17330 INPUT X2,Y217340 P5=P5+117350 Z3=P517360 WRITE #1,1:P5-117370 WRITE #1,Z3:1,R(7),X1,Y1,X2,Y2,R(9)17380 GO TO 1725017500 REM PLOTTER SETUP17510 IF Q5-INT(Q5)<>0 THEN 103017520 O1=Q517530 SET NOKEY 17540 GO TO 1*(O1=4)+2*(O1=51)+3*(O1=32) OF 17580,17560,1756017550 GO TO 103017560 VIEWPORT 20,120,0,10017570 GO TO 87017580 PAGE 17590 PRINT "
SET PLOTTER MENU FOR: SHEET, SIZE, DRAFTING, HORIZONTAL";17600 PRINT " OR VERTICAL AND FULL PAGE."17610 PRINT @O1,32:"N"17620 PRINT "
USE NORMAL (N), MIRROR (M) OR SCALED (S) PLOTTING? ";17630 INPUT Z$17640 H1=POS("NMS",Z$,1)17650 IF H1=0 THEN 1762017660 IF H1<>2 THEN 1768017670 PRINT "	
HORIZONTAL C SIZE (17X22) SHEET BEST FOR THIS PLOT."17680 PRINT "
NORMAL (N) OR HORIZONTAL PLOT ON VERTICAL SHEET (V)? ";17690 INPUT Z$17700 H3=POS("NV",Z$,1)17710 IF H3=0 THEN 1768017720 IF H3=2 THEN 1806017730 IF H1=3 AND H3=2 THEN 1804017740 PRINT "
ENTER A SHEET SIZE (A,B OR C): ";17750 INPUT Z$17760 H2=POS("ABC",Z$,1)17770 IF H2=0 THEN 1759017780 IF H1<>3 THEN 1794017790 X8=10.5*(H2=1)+15.75*(H2=2)+21*(H2=3)17800 Y8=7.75*(H2=1)+10.25*(H2=2)+15.5*(H2=3)17810 PRINT "	
PLOTTING SPACE AVAILABLE IS ";X8;" X ";Y8;" INCHES."17820 PRINT "	(LARGEST X DIMENSION)X(SCALE) MUST FIT INTO THIS SPACE."17830 PRINT "	OVERSIZED PLOTS WILL BE CLIPPED AT THE TOP."17840 PRINT "
ENTER ORIGINAL WORKSPACE X,Y SIZE IN INCHES, SCALE : ";17850 INPUT X7,Y7,A417860 IF X7*A4<=X8 THEN 1791017870 PRINT "
TOO LARGE -- TRY AGAIN!"17880 PRINT "	SPACE NEEDED WOULD BE ";INT(100*X7*A4)/100;17890 PRINT " X ";INT(100*Y7*A4)/100;" INCHES."17900 GO TO 1759017910 A2=1*(1.042+0.141*(H2=2))*X7*A4/X817920 A3=1*Y7*A4/Y817930 GO TO 1801017940 PRINT "
ENTER A SCALE FACTOR (MAX OF 1 IS TYPICAL): ";17950 INPUT A217960 IF A2>1 THEN 1794017970 V(1)=68+9*(H2=2)-50*A2/H1+25*A2*(H1=2)17980 V(2)=68+9*(H2=2)+50*A2/H1+25*A2*(H1=2)17990 V(3)=50-50*A2/H1+25*A2*(H1=2)18000 V(4)=50+50*A2/H1+25*A2*(H1=2)18010 PRINT "	
PREPARE PLOTTER. 'RETURN' TO CONTINUE. ";18020 INPUT Z$18030 GO TO 85018040 PRINT "
SCALED PLOTS REQUIRE HORIZONTAL ORIENTATION!"18050 GO TO 1768018060 PRINT "	
SET 'INITIAL AXIS ORIENTATION' TO COLUMN 5 ON PLOTTER ";18070 PRINT "MENU CARD:"18080 PRINT "		VERTICAL X AND HORIZONTAL Y."18090 PRINT "	
ALSO SET 'PAGE ORIENTATION' TO 'VERTICAL'."18100 GO TO 1774018200 REM PLOT18210 IF O1=32 THEN 103018214 Z1=018220 B$=SEG(A$,5,3)18230 GOSUB 681018240 IF E1<>0 OR B$="" THEN 1828018250 L2=VAL(B$)18260 Z1=118270 IF L2=0 THEN 1758018280 GO TO H1 OF 18320,18380,1829018290 VIEWPORT 0,130,0,10018300 GOSUB 964018310 GO TO 1846018320 GO TO H3 OF 18330,1835018330 VIEWPORT V(1),V(2),V(3),V(4)18340 GO TO 1836018350 VIEWPORT V(4),V(3),V(1),V(2)18360 GOSUB 967518370 GO TO 1846018380 VIEWPORT V(1),V(2),V(3),V(4)18390 GOSUB 967518400 VIEWPORT V(1),V(2)-100*A2,V(3),V(4)18410 GOSUB 967518420 VIEWPORT V(1),V(2)-100*A2,V(3),V(4)-100*A218430 GOSUB 967518440 VIEWPORT V(1),V(2),V(3),V(4)-100*A218450 GOSUB 967518460 PRINT @O1,32:"AI"18470 GO TO 87019000 REM MIRROR DISPLAY19010 IF Z0=1 THEN 1903019020 PAGE 19030 GOSUB 1420019040 VIEWPORT 70,120,50,10019050 GOSUB 967519060 VIEWPORT 70,20,50,10019070 GOSUB 967519080 VIEWPORT 70,20,50,019090 GOSUB 967519100 VIEWPORT 70,120,50,019110 GOSUB 967519120 VIEWPORT 20,120,0,10019130 GO TO 87019200 REM DISPLAY ORIGINS19210 Q5=T1/219220 FOR I9=2 TO P519230 READ #1,I9:C1,R(7),X0,Y019240 IF R(7)=0 THEN 1931019250 IF Z1<>1 THEN 1927019260 IF R(7)<>L2 THEN 1931019270 MOVE X0-Q5/2,Y0-Q5/219280 RDRAW Q5,Q519290 RMOVE 0,-Q519300 RDRAW -Q5,Q519310 NEXT I919320 GO TO 87019500 REM PACK POLYGON DATA19510 C3=019515 FOR A0=1 TO 119520 FOR I7=1 TO 2019530 IF P2(I7)<0 AND P3(I7)<0 THEN 1955519540 C3(I7)=10*P2(I7)+10*P3(I7)/100000019550 NEXT I719555 NEXT A019560 RETURN 19600 REM UNPACK POLYGON DATA19610 P2=-10019620 P3=-10019625 FOR A0=1 TO 119630 FOR I7=1 TO 2019640 IF C3(I7)=0 THEN 1968519650 P2(I7)=0.1*INT(C3(I7))19660 P3(I7)=0.1*INT((C3(I7)-10*P2(I7))*1000000)+0.119670 N0=I719680 NEXT I719685 NEXT A019690 RETURN 19700 REM PACK XHATCH DATA19710 C4=019720 FOR I7=1 TO N0+119730 C4(I7)=10*P(1,I7)+10*P(2,I7)/100000019740 NEXT I719750 RETURN 19800 REM UNPACK XHATCH DATA19810 P=019820 FOR I7=1 TO N0+119830 P(1,I7)=0.1*INT(C4(I7))19840 P(2,I7)=0.1*INT((C4(I7)-10*P(1,I7))*1000000)+0.119850 NEXT I719860 RETURN 20000 REM COMPRESS20010 PAGE 20020 UNIT 020030 CHARSIZE 420040 CALL "MOUNT",0,D$20050 D$=SEG(D$,74,9)20060 Z1=VAL(D$)20070 IF Z1>512*P5+1000 THEN 2011020080 PRINT "This disc is too full for COMPRESS to operate."20090 PRINT "Copy ";T$;" to a new disc. Then compress and continue."20100 GO TO 2072020110 PRINT ""20120 PRINT @32,21:30,5020130 ROPEN 120140 PRINT "DO NOT INTERRUPT -- COMPRESS IN PROGRESS!"20150 RCLOSE 20160 VISIBILITY 1,120170 BLINK 1,0.5,0.520180 ON EOF (1) THEN 2060020190 READ #1,1:I520200 IF I5=>2 THEN 2023020210 PRINT "
EMPTY PDB FILE!"20220 GO TO 2070020230 CREATE "@COMPRESS.PDB","U";2,25620240 OPEN "@COMPRESS.PDB";3,"F",D$20250 WRITE #3,1:020260 WRITE #3,2:"  "20270 I9=220280 FOR A0=1 TO 120290 FOR I8=2 TO I5+120300 READ #1,I8:C1,L220310 PRINT ""20320 IF L2=0 THEN 2059020330 GO TO C1 OF 20350,20380,20410,20440,20470,20500,20530,2056020340 GO TO 2059020350 READ #1,I8:C1,L2,X1,Y1,X2,Y2,H120360 WRITE #3,I9:C1,L2,X1,Y1,X2,Y2,H120370 GO TO 2058020380 READ #1,I8:C1,L2,X1,Y1,H1,H2,H3,B1,C$20390 WRITE #3,I9:C1,L2,X1,Y1,H1,H2,H3,B1,C$20400 GO TO 2058020410 READ #1,I8:C1,L2,X1,Y1,H1,H2,H3,C420420 WRITE #3,I9:C1,L2,X1,Y1,H1,H2,H3,C420430 GO TO 2058020440 READ #1,I8:C1,L2,X1,Y1,H1,H2,F$,B1,B220450 WRITE #3,I9:C1,L2,X1,Y1,H1,H2,F$,B1,B220460 GO TO 2058020470 READ #1,I8:C1,L2,X1,Y1,X2,Y2,H1,H220480 WRITE #3,I9:C1,L2,X1,Y1,X2,Y2,H1,H220490 GO TO 2058020500 READ #1,I8:C1,L2,X1,Y1,H1,H2,B1,B2,B3,B4,B520510 WRITE #3,I9:C1,L2,X1,Y1,H1,H2,B1,B2,B3,B4,B520520 GO TO 2058020530 READ #1,I8:C1,L2,X1,Y1,C320540 WRITE #3,I9:C1,L2,X1,Y1,C320550 GO TO 2058020560 READ #1,I8:C1,L2,X1,Y1,H1,H2,F$,B1,B2,B320570 WRITE #3,I9:C1,L2,X1,Y1,H1,H2,F$,B1,B2,B320580 I9=I9+120590 NEXT I820600 NEXT A020610 CLOSE 120620 P5=I9-120630 WRITE #3,1:P5-120640 CLOSE 320650 KILL T$20660 COPY "@COMPRESS.PDB",0 TO T$,020670 KILL "@COMPRESS.PDB"20680 OPEN T$;1,"F",D$20690 PRINT "

Compress Complete!"20700 RINIT 20710 OFF EOF (1)20720 CHARSIZE 220730 CALL "WAIT",220740 RETURN 