1000 REM SORT1010 O=31020 RETURN 1030 PRINT "SORT


"1040 PRINT "WHICH ";F$;" TO SORT"1050 PRINT "(VOLUME NAME ONLY):";1060 INPUT Z$1070 IF LEN(Z$)=0 THEN 10001080 GOSUB 7501090 IF C1=0 THEN 10401100 W$=X$&Z$1110 V$=Z$1120 CALL "UNIT",U(1)1130 CALL "FILE",U(1),W$,Z$1140 IF LEN(Z$)<>0 THEN 11701150 PRINT F$;":    ";W$;"    NOT ON THIS DISC"1160 GO TO 10401170 OPEN W$;1,"R",Z$1180 READ #1:A$,R0,F91190 CLOSE 11200 PRINT "
SAVE SORTED ";F$;" (Y/N_):";1210 INPUT Z$1220 F6=0+POS(Z$,"Y",1)=11230 IF F6=0 THEN 14501240 PRINT "NAME:";V$;".S___";1250 INPUT Z$1260 IF LEN(Z$)=0 THEN 10401270 IF LEN(Z$)<=3 THEN 13001280 PRINT "ONLY THREE CHARACTERS ALLOWED"1290 GO TO 12401300 Z$="S"&Z$1310 GOSUB 7501320 IF C1=0 THEN 12401330 W$=REP(Y$,1,LEN(X$))1340 W$=W$&"."1350 W$=W$&Z$1360 CALL "FILE",U(1),W$,Z$1370 IF LEN(Z$)=0 THEN 14301380 PRINT F$;"    ";W$;"    ALLREADY EXISTS"1390 PRINT "OVERWRITE EXISTING FILE (Y/N_):";1400 INPUT Z$1410 IF NOT(POS(Z$,"Y",1)=1) THEN 12001420 KILL W$1430 CREATE W$;500,01440 OPEN W$;4,"F",Z$1450 DELETE D1460 DIM D(R0)1470 FOR I=1 TO R01480 D(I)=I1490 NEXT I1500 W$=Y$&V$1510 OPEN W$;2,"R",Z$1520 OPEN "@MVDL/RECORDINFO";3,"R",Z$1530 PRINT "
FIELD ITEMS:"1540 READ #3:J91550 DELETE O1,S1,S2,M$1560 DIM O1(J9+1),S1(J9),S2(J9),M$(12*3),S3(5)1570 O1=01580 FOR I=1 TO J9-(F9=0)1590 READ #3:Z$1600 PRINT "	";I;": ";Z$1610 NEXT I1620 I=01630 M$="JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC"1640 DATA 8,4,0,11,141650 RESTORE 16401660 READ S31670 F5=01680 PRINT "

SPECIFY ORDER OF SORT:"1690 PRINT "(END OF SPECIFICATION=0)
"1700 I=I+11710 IF I>J9-1+(F9=1) THEN 18701720 PRINT "	KEY-ITEM ";I;": ";1730 INPUT O1(I)1740 IF O1(I)-INT(O1(I))<>0 OR O1(I)<0 OR O1(I)>J9 THEN 17201750 IF O1(I)=0 AND O1(1)<>0 THEN 18701760 IF F9=0 AND O1(I)=12 THEN 18501770 IF O1(I)<>12 THEN 17001780 PRINT "		INCLUDE LINE NUMBERS (Y/N_):";1790 INPUT Z$1800 F5=F5+1*(POS(Z$,"Y",1)=1)1810 PRINT "		INCLUDE LEADING SPACES (Y/N_):";1820 INPUT Z$1830 F5=F5+2*(POS(Z$,"Y",1)=1)1840 GO TO 17001850 PRINT "REMARKS NOT INCLUDED"1860 GO TO 17201870 PRINT "
SORTING TO BE DONE IN ASCENDING(=1)"1880 PRINT "                      DESCENDING ORDER(=2) (1 OR 2):";1890 INPUT O1(J9+1)1900 IF O1(J9+1)-INT(O1(J9+1))<>0 OR O1(J9+1)<1 OR O1(J9+1)>2 THEN 18701910 FOR I=1 TO J91920 READ #3:S1(I),S2(I)1930 NEXT I1940 CLOSE 31950 PRINT "
SORTING"1960 REM1970 REM BUTTERFLY SORT APPROACH1980 REM B$,D$:RECORDS; V$,W$:FIELDS1990 K0=92000 T1=02010 K1=2*2^K0-12020 FOR K=1 TO K02030 K1=0.5*(K1-1)2040 IF K1+1>R0 THEN 21702050 FOR I=K1+1 TO R02060 READ #2,D(I):B$2070 L1=D(I)2080 FOR J=I-K1 TO 1 STEP -K12090 READ #2,D(J):D$2100 L2=D(J)2110 GOSUB 28402120 IF F7=1 THEN 21502130 D(J+K1)=L22140 NEXT J2150 D(J+K1)=L12160 NEXT I2170 NEXT K2180 PRINT "
SORT COMPLETED"2190 IF NOT(F6) THEN 22202200 PRINT "
SAVING SORTED FILE"2210 WRITE #4:O1,F5,D2220 PRINT "
PRESS [RETURN] TO CONTINUE:";2230 INPUT Z$2240 CLOSE 2250 R0=02260 RETURN 2270 REM FIND RECORD PART2280 IF O1(T1)<>1 AND O1(T1)<>12 THEN 23802290 P1=POS(B$,C$,S1(1))2300 P2=POS(D$,C$,S1(1))2310 IF O1(T1)=12 THEN 23502320 V$=SEG(B$,S1(O1(T1)),P1-S1(O1(T1)))2330 W$=SEG(D$,S1(O1(T1)),P2-S1(O1(T1)))2340 GO TO 24002350 V$=SEG(B$,P1,LEN(B$)-P1)2360 W$=SEG(D$,P2,LEN(D$)-P2)2370 GO TO 24002380 V$=SEG(B$,S1(O1(T1)),S2(O1(T1))-S1(O1(T1)))2390 W$=SEG(D$,S1(O1(T1)),S2(O1(T1))-S1(O1(T1)))2400 RETURN 2410 REM TIME SORT2420 T2=02430 T2=T2+12440 IF T2>5 THEN 25702450 I$=SEG(V$,S3(T2),3)2460 J$=SEG(W$,S3(T2),3)2470 P1=POS(M$,I$,1)2480 P2=POS(M$,J$,1)2490 IF NOT(P1 AND P2) THEN 25302500 V1=P12510 V2=P22520 GO TO 25502530 V1=VAL(I$)2540 V2=VAL(J$)2550 GOSUB 26102560 IF F7=-1 THEN 24302570 RETURN 2580 REM VALUE SORT2590 V1=VAL(V$)2600 V2=VAL(W$)2610 IF V1>V2 AND O1(J9+1)=1 OR (V1<V2 AND O1(J9+1)=2) THEN 26802620 IF V1<>V2 THEN 26502630 F7=-12640 GO TO 27002650 F7=02660 T1=02670 GO TO 27002680 F7=12690 T1=02700 RETURN 2710 REM ALPHA SORT2720 IF O1(T1)<>12 OR F5=3 THEN 27402730 GOSUB 29802740 IF V$>W$ AND O1(J9+1)=1 OR (V$<W$ AND O1(J9+1)=2) THEN 28102750 IF V$<>W$ THEN 27802760 F7=-12770 GO TO 28302780 F7=02790 T1=02800 GO TO 28302810 F7=12820 T1=02830 RETURN 2840 REM ARRANGE KIND OF SORT2850 T1=T1+12860 IF O1(T1)<>0 THEN 29002870 F7=12880 T1=02890 GO TO 29702900 GOSUB 22702910 IF O1(T1)<=5 OR O1(T1)=>9 THEN 29402920 GOSUB 24102930 GO TO 29502940 GOSUB 1+(O1(T1)=12 OR O1(T1)<=5) OF 2580,27102950 IF F7<>-1 THEN 29702960 GO TO 28502970 RETURN 2980 REM SORT NOT INCL. IN REMS2990 Z$=V$3000 GOSUB 30603010 V$=Z$3020 Z$=W$3030 GOSUB 30603040 W$=Z$3050 RETURN 3060 P0=POS(Z$,"REMARK",1)3070 IF NOT(P0) OR P0>7 THEN 31003080 P1=P0+53090 GO TO 31303100 P0=POS(Z$,"REM",1)3110 IF NOT(P0) THEN 31803120 P1=P0+23130 P0=1+(P0-1)*(F5=1)3140 Z$=REP("",P0,P1-P0+1)3150 IF NOT(POS(Z$," ",P0)=P0) OR F5=2 THEN 31803160 Z$=REP("",P0,1)3170 GO TO 31503180 RETURN 