1000 REM CREATE1010 O=21020 RETURN 1030 PRINT "CREATE


"1040 REM CHECK IF VOLUME DIRECTORY FILE ALLREADY CREATED1050 V$=SEG(A$,23,10)1060 V$=SEG(V$,1,10-(10-(POS(V$," ",1)-1)))1070 W$=X$&V$1080 CALL "FILE",U(1),W$,Z$1090 IF LEN(Z$)=0 THEN 11401100 PRINT "
";F$;":    ";W$;"    ALLREADY CREATED"1110 PRINT "OVERWRITE EXISTING FILE (Y/N_):";1120 INPUT Z$1130 IF NOT(POS(Z$,"Y",1)=1) THEN 10001140 REM DIR--->TAPE1150 PRINT "
SPECIFY TAPE-FILE # FOR DIRECTORY:";1160 INPUT D91170 FIND D91180 CALL "UNIT",U(2)1190 PRINT "
DIRECTORY ---> TAPE-FILE:";D91200 DIRECTORY @33:0,"@#"1210 CLOSE 1220 REM COUNT # OF FILES1230 F1=01240 R0=01250 PRINT "
COUNTING NUMBER OF FILES:";1260 FIND D91270 ON EOF (0) THEN 13201280 INPUT @33:B$1290 IF F1 THEN 13401300 R0=R0+11310 GO TO 12801320 F1=11330 RETURN 1340 PRINT "=";R01350 PRINT "
Include REMARK statements (Y/N_):";1360 INPUT Z$1370 F9=0+1*(POS(Z$,"Y",1)=1)1380 REM CREATE VOLUME INFO FILE, KILL EXISTING FILES1390 GOSUB 25701400 PRINT "
CREATING VOLUME INFO FILE"1410 CALL "UNIT",U(1)1420 W$=X$&V$1430 CREATE W$;169+4+2*9,01440 OPEN W$;1,"F",Z$1450 WRITE #1:A$,R0,F91460 CLOSE 11470 W$=Y$&V$1480 CREATE W$;R0+0,189+59+4+72+4+11490 OPEN W$;2,"F",Z$1500 R1=R01510 R0=01520 E$=""1530 REM SEARCH REMARK DEPENDING ON F91540 PRINT "
DIRECTORY ---> ";F$1550 F1=01560 FIND D91570 ON EOF (0) THEN 13201580 INPUT @33:B$1590 IF F1 THEN 17801600 IF F9=0 THEN 17601610 IF NOT(POS(B$,"SCRATCHLIB",1)) THEN 16401620 B$=REP("",1,11)1630 GO TO 16901640 IF NOT(POS(B$,"SYSLIB",1)) THEN 16801650 B$=REP("",1,7)1660 B$="$"&B$1670 GO TO 16901680 B$="@"&B$1690 V$=B$1700 CALL "FILE",U(2),V$,B$1710 IF LEN(B$)<>0 THEN 17401720 PRINT "SOURCE NOT MOUNTED IN UNIT:";U(2)1730 STOP 1740 F8=0+1*(POS(B$,"H",6)=6)+2*(POS(B$,"A",6)=6)1750 GO TO F8 OF 1900,23301760 REM NO PROGRAM FILE ---> REM=""1770 GO TO 18551780 REM ALL DONE1790 IF R0=R1 THEN 18301800 PRINT "
CREATE FAILED!"1810 PRI "# OF FILES ON SOURCE: ";R1;"RECORDS ON MVDL SYSTEM DISC: ";R01820 STOP 1830 CLOSE 1840 R0=01850 RETURN 1855 E$="BINARY DATA-FILE"1860 R0=R0+11870 B$=B$&E$1880 WRITE #2,R0:B$1890 GO TO 15801900 REM FILE IS HOST BINARY1910 DELETE A1920 DIM A(4)1930 CALL "UNIT",U(2)1940 OPEN V$;1,"R",Z$1950 PRINT V$1960 WBYTE @32:133,-11970 WBYTE @63,95:1980 WBYTE @64:1990 RBYTE A2000 WBYTE @63,95:2010 WBYTE @32:129,1,0,0,0,-2562020 WBYTE @64:2030 RBYTE B2040 IF B=-256 THEN 22902050 IF B=128 THEN 20702060 GO TO 20302070 REM NEW LINE FOUND2080 RBYTE B2090 DELETE A2100 DIM A(B)2110 RBYTE A2120 IF A(3)=164 THEN 21402130 GO TO 20302140 REM TRANSFER INTO PROGRAM LINE2150 E$=""2160 V1=A(1)*256+A(2)2170 V$=STR(V1)2180 V$=REP("",1,1)2190 E$=E$&V$2200 E$=E$&" REM"2210 FOR I=4 TO B-12220 IF A(I)>31 THEN 22502230 E$=E$&"_"2240 A(I)=A(I)+642250 IF A(I)>127 THEN 22802260 V$=CHR(A(I))2270 E$=E$&V$2280 NEXT I2290 WBYTE @63,95:2300 CLOSE 12310 CALL "UNIT",U(1)2320 GO TO 18602330 REM FILE IS ASCII2340 REM CHECK IF PROGRAM OR DATA2350 REM F7=INDICATOR CHAR IN LINE#2360 F7=02370 CALL "UNIT",U(2)2380 OPEN V$;1,"R",Z$2390 IF TYP(1)=1 THEN 25402400 INPUT #1:E$2410 P1=POS(E$," REM",1)=12420 IF P1 THEN 24502430 E$=""2440 GO TO 23902450 FOR I=1 TO P1-12460 Z$=SEG(E$,I,1)2470 IF VAL(Z$)<>0 THEN 24902480 F7=12490 NEXT I2500 IF NOT(F7) THEN 25302510 E$=""2520 GO TO 23902530 REM PROGRAM LINR WITH REM FOUND2540 CLOSE 12550 CALL "UNIT",U(1)2560 GO TO 18602570 REM KIL EXISTING FILES2580 CALL "UNIT",U(1)2590 W$=X$&V$2600 KILL W$2610 W$=Y$&V$2620 KILL W$2630 RETURN 