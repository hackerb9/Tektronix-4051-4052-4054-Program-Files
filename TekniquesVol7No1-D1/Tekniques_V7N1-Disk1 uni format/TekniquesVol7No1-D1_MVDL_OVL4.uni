1000 REM OUTPUT1010 O=41020 RETURN 1030 PRINT "OUTPUT


"1040 PRINT "OUTPUT DEVICE #:";1050 INPUT D91060 IF D9-INT(D9)<>0 OR D9<0 OR D9>71 THEN 10401070 PRINT "
NUMBER OF LINES PER PAGE:";1080 INPUT T91090 T2=01100 T3=01110 PRINT "
OUTPUT:"1120 PRINT "	1. ";F$;"(S)"1130 PRINT "	2. SORTED ";F$;"(S)";" (1/2):";1140 INPUT D81150 IF D8-INT(D8)<>0 OR D8<0 OR D8>2 THEN 11101160 REM PROVIDE F$NAME1170 PRINT "
NAME OF ";F$;":";1180 INPUT Z$1190 IF LEN(Z$)=0 THEN 10001200 IF NOT(POS(Z$,".",1)) THEN 12301210 PRINT "WITHOUT EXTENSIONS:";1220 GO TO 11801230 GOSUB 7501240 IF C1=0 THEN 11701250 W$=X$&Z$1260 V$=Z$1270 CALL "UNIT",U(1)1280 CALL "FILE",U(1),W$,Z$1290 IF LEN(Z$)<>0 THEN 13201300 PRINT F$;":   ";W$;"   NOT ON THIS DISC"1310 GO TO 11701320 OPEN W$;1,"R",Z$1330 READ #1:A$,R0,F91340 CLOSE 11350 IF D8=1 THEN 15501360 PRINT "NAME:";V$;".S___";1370 INPUT Z$1380 IF LEN(Z$)=0 THEN 11701390 IF LEN(Z$)<=3 THEN 14201400 PRINT "ONLY THREE CHARACTERS ALLOWED"1410 GO TO 13601420 Z$="S"&Z$1430 GOSUB 7501440 IF C1=0 THEN 13601450 Z$="."&Z$1460 Z$=V$&Z$1470 W$=Y$&Z$1480 CALL "FILE",U(1),W$,Z$1490 IF LEN(Z$)<>0 THEN 15201500 PRINT F$;":   ";W$;"   NOT ON THIS DISC"1510 GO TO 13601520 OPEN W$;4,"R",Z$1530 DELETE D1540 DIM D(R0)1550 V$=Y$&V$1560 OPEN V$;2,"R",Z$1570 OPEN "@MVDL/RECORDINFO";3,"R",Z$1580 READ #3:J91590 DELETE O1,S1,S21600 DIM O1(J9+1),S1(J9),S2(J9)1610 IF D8=1 THEN 16301620 READ #4:O1,F5,D1630 PRINT "
OUTPUT TO INCLUDE:"1640 PRINT "	1. ALL ITEMS"1650 PRINT "	2. SELECTABLE ITEMS IN ORDER OF SPECIFICATION (1/2):";1660 INPUT D71670 IF D7-INT(D7)<>0 OR D7<0 OR D7>2 THEN 16301680 GOSUB D7 OF 2120,17401690 PRINT @D9:"

NUMBER OF RECORDS IN ";W$;" :";R01700 PRINT "PRESS RETURN TO CONTINUE";1710 INPUT Z$1720 CLOSE 1730 RETURN 1740 REM OUTPUT SELECTED ITEMS IN ORDER OF SPECIFICATION1750 IF D8=2 THEN 17801760 D6=21770 GO TO 18301780 REM USE ORDER OF SORT? OR USER DEFINED1790 PRINT "
1. USE SAME PARAMATERS AS DEFINED FOR SORT, OR"1800 PRINT "2. DEFINE ITEM OUTPUT ORDER (1/2):";1810 INPUT D61820 IF D6-INT(D6)<>0 OR D6<0 OR D6>2 THEN 17901830 PRINT "
ITEM-NAMES TO BE SUPPLIED WITH OUTPUT (Y/N_):";1840 INPUT Z$1850 D5=0+1*(POS(Z$,"Y",1)=1)1860 GO TO D6=2 OF 18901870 GOSUB 28301880 GO TO 21201890 O1=01900 F5=01910 PRINT "SPECIFY ORDER OF ITEMS:"1920 PRINT "(END OF SPECIFICATION=0)
"1930 GOSUB 28301940 I=01950 I=I+11960 IF I>J9-1+F9=1 THEN 21201970 PRINT "	ITEM ";I;":";1980 INPUT O1(I)1990 IF O1(I)-INT(O1(I))<>0 OR O1(I)<0 OR O1(I)>J9 THEN 19702000 IF O1(I)=0 AND O1(1)<>0 THEN 21202010 IF F9=0 AND O1(I)=12 THEN 21002020 IF O1(I)<>12 THEN 19502030 PRINT "		INCLUDE LINE NUMBERS (Y/N_):";2040 INPUT Z$2050 F5=F5+1*(POS(Z$,"Y",1)=1)2060 PRINT "		INCLUDE LEADING SPACES (Y/N_):";2070 INPUT Z$2080 F5=F5+2*(POS(Z$,"Y",1)=1)2090 GO TO 19502100 PRINT "REMARKS NOT INCLUDED"2110 GO TO 19702120 REM CHECK # OF ITEMS SELECTED FOR LINE-TOTAL2130 GOSUB D7 OF 3190,30802140 REM READ RECORD DEPENDEND ON VOLUME OR SORTED- FILE2150 REM AND PRINT2160 GOSUB 27502170 GOSUB 27802180 FOR I=1 TO R02190 GOSUB D8 OF 2230,22602200 GOSUB D7 OF 2290,23702210 NEXT I2220 RETURN 2230 REM READ RECORD FROM VOLUME FILE,D8=12240 READ #2,I:B$2250 RETURN 2260 REM READ RECORD FROM SORTED FILE,D8=22270 READ #2,D(I):B$2280 RETURN 2290 REM PRINT WHOLE RECORD2300 T2=T2+T32310 IF T2<=T9 THEN 23402320 GOSUB 27402330 GO TO 23002340 PRINT @D9:B$2350 PRINT @D9:"
";2360 RETURN 2370 REM FIND RECORD PART AND PRINT2380 T2=T2+T32390 IF T2<=T9 THEN 24202400 GOSUB 27402410 GO TO 23802420 T1=12430 IF O1(T1)=0 THEN 25902440 IF O1(T1)<>1 AND O1(T1)<>12 THEN 25102450 P1=POS(B$,C$,S1(1))2460 IF O1(T1)=12 THEN 24902470 Z$=SEG(B$,S1(O1(T1)),P1-S1(O1(T1)))2480 GO TO 25302490 Z$=SEG(B$,P1+1,LEN(B$)-P1)2500 GO TO 25302510 R1=0+1*(S1(O1(T1))=S2(O1(T1)))2520 Z$=SEG(B$,S1(O1(T1)),S2(O1(T1))+R1-S1(O1(T1)))2530 IF O1(T1)<>12 OR F5=3 THEN 25502540 GOSUB 26102550 GOSUB D5=1 OF 29802560 T1=T1+12570 PRINT @D9:Z$2580 GO TO 24302590 PRINT @D9:"
";2600 RETURN 2610 P0=POS(Z$,"REMARK",1)2620 IF NOT(P0) OR P0>7 THEN 26502630 P1=P0+52640 GO TO 26802650 P0=POS(Z$,"REM",1)2660 IF NOT(P0) THEN 27302670 P1=P0+22680 P0=1+(P0-1)*(F5=1)2690 Z$=REP("",P0,P1-P0+1)2700 IF NOT(POS(Z$," ",P0)=P0) OR F5=2 THEN 27302710 Z$=REP("",P0,1)2720 GO TO 27002730 RETURN 2740 REM CHECK NUMBER OF LINES PER PAGE2750 PRINT @D9:"";2760 T2=02770 RETURN 2780 REM PRINT HEADING2790 PRINT @D9:A$2800 PRINT @D9:"

";2810 T2=T2+52820 RETURN 2830 REM ITEM SELECTION,PRESENT ITEMS2840 D$=""2850 FOR I=1 TO J9-(F9=0)2860 READ #3:Z$2870 D$=D$&Z$2880 D$=D$&"^"2890 IF D6=1 THEN 29102900 PRINT "	";I;".";Z$2910 NEXT I2920 PRINT "
"2930 FOR I=1 TO J92940 READ #3:S1(I),S2(I)2950 NEXT I2960 CLOSE 32970 RETURN 2980 REM SUPPLIE ITEM-NAMES2990 T4=03000 P2=03010 T4=T4+13020 P1=P23030 P2=POS(D$,"^",P1+1)3040 IF T4<>O1(T1) THEN 30103050 I$=SEG(D$,P1+1,P2-(P1+1))3060 PRINT @D9:I$;": ";3070 RETURN 3080 REM FIN #OF ITEMS TO BE PRESENTED3090 T3=03100 IF O1(1)=0 THEN 31603110 FOR J=1 TO J93120 IF O1(J)=0 THEN 31703130 T3=T3+13140 NEXT J3150 T3=T3+13160 RETURN 3170 J=J93180 GO TO 31403190 REM # OF LINES IN WHOLE RECORD+13200 T3=4+1*(F9=1)+13210 RETURN 