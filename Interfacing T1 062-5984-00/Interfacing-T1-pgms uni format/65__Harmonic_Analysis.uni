100 PAGE 110 PRINT "                **************************************"120 PRINT "                *                                    *"130 PRINT "                *  AUTOMATED HARMONIC ANALYSIS DEMO  *"140 PRINT "                *                                    *"150 PRINT "                **************************************"160 Z=Z9170 PRINT @Z:"GRA ON;GRA OFF"180 PRINT "

ENTER FREQUENCY OF FUNDAMENTAL IN MHZ: ";190 INPUT F1200 LET F1=F1*1000000220 PRINT "ENTER NUMBER OF HARMONICS DESIRED: ";230 INPUT H240 DELETE A250 DELETE B260 DIM A(H+1,2)270 DIM B(H+1)280 REM FIND AMPLITUDES OF SIGNALS"290 PRINT "EXAMINING SIGNALS..."300 FOR I=1 TO H+1310 F=F1*I320 GOSUB 1000330 A(I,1)=F340 A(I,2)=Y350 NEXT I360 REM GENERATE NORMALIZED VALUES OF AMPLITUDE370 FOR I=1 TO H+1380 B(I)=A(I,2)-A(1,2)390 NEXT I400 REM GENERATE GRAPHICS405 PAGE 410 WINDOW 0,130,0,100420 VIEWPORT 0,130,0,100440 MOVE 0,0450 DRAW 0,100460 DRAW 130,100470 DRAW 130,0480 DRAW 0,0490 HOME 495 PRINT "

                  -- HARMONIC DISTORTION ANALYSIS --"500 PRINT "

   FREQ       AMPL      REL. DB"510 PRINT "   ----       ----      -------
"520 FOR I=1 TO H+1530 PRINT "  ";A(I,1);532 PRINT USING 535:A(I,2),B(I)535 IMAGE (3X),(5D.2D),(3X),(5D.2D)540 NEXT I550 WINDOW 0,130,0,100560 VIEWPORT 75,120,45,85570 MOVE -45,98580 PRINT "     0db"590 MOVE -45,78600 PRINT "   -20db"610 MOVE -45,58620 PRINT "   -40db"630 MOVE -45,38640 PRINT "   -60db"650 MOVE -45,18660 PRINT "   -80db"670 X=2680 AXIS 120/(H+1),10,2,0690 FOR I=1 TO H+1700 MOVE X,0710 DRAW X,100-B(I)*-1720 DRAW X+120/(H+1),100-B(I)*-1730 DRAW X+120/(H+1),0740 X=X+120/(H+1)750 NEXT I760 PRINT 769 PRINT 770 PRINT "                                               - HARMONICS -"780 REM COMPUTE TOTAL HARMONIC DISTORTION790 D=0800 FOR I=2 TO H+1810 W=10^(B(I)/10)820 D=D+W830 NEXT I840 H1=SQR(D)*100850 H1=INT(H1)860 PRINT 865 PRINT "






"870 PRINT "             TOTAL HARMONIC DISTORTION EQUALS ";H1;" PERCENT"880 PRINT @Z:"RDO 'TOTAL HARMONIC DISTORTION'"890 LET Q$=STR(H1)900 LET Z$="EQUALS "&Q$910 LET Z$=Z$&" PERCENT"920 PRINT @Z:"RDO '";Z$930 PRINT "
            DO YOU WANT TO DO ANOTHER ANALYSIS (YES OR NO)";940 INPUT Q$950 Q$=SEG(Q$,1,1)960 IF Q$="N" THEN 1300970 PAGE 980 GO TO 220990 END 1000 S=10000001010 PRINT @Z:"WFMPRE WFID:FULL"1020 PRINT @Z:"AVI ON;BVI ON;SAV OFF;ARE ON;VID OFF;DEL OFF"1030 PRINT @Z:"SPA 1M;;FRE ";F;";REF +20;VRT LOG:10;RDO NOR;"1040 T=1201050 PRINT @Z:"SPA ";S;";SIG;SIG;WAIT;FIB ";T;";POI?"1060 INPUT @Z:N,M1070 IF M=0 THEN 11601080 IF S<=20000 THEN 12101090 PRINT @Z:"CEN;SIG;SIG;WAIT;FMA;TOP;CEN;VRT LOG:2;FRC ";F1100 IF S<=50000 THEN 11301110 S=S/201120 GO TO 10401130 S=S/51140 PRINT @Z:"RESk PRINT  10KHZ"1150 GO TO 10401160 PRINT @Z:"REF?"1170 INPUT @Z:R1180 IF R<-40 THEN 12201190 PRINT @Z:"VRT LOG:10; REF DEC"1200 GO TO 10401210 PRINT @Z:"CEN;SIG;SIG;WAIT"1220 PRINT @Z:"WFMPRE?"1230 INPUT @Z:X4,X3,X2,X1,Y3,Y2,Y11240 X=F1250 Y=Y1+Y2*(M-Y3)1260 RETURN 1270 POLL K,L;Z1280 PRINT L1290 RETURN 1300 REM RETURN TO MASTER MENU1310 DELETE Z,F1,H,A,B,F,Y,D,W,H1,Q$,Z$,S,N,M,R,K,L1320 DELETE X1,X2,X3,X4,Y1,Y2,Y31330 F1=11340 GO TO 90011350 REM END OF FILE TO BE DELETED9000 REM END OF FILE TFO BE DELETED