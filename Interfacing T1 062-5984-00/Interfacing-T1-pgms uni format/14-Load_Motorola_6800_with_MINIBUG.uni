90 REM *TAPE FORMATTER TO LOAD MOTOROLA 6800 MICRO W/MINIBUG CONTROL*92 REM 51/00-8013/095 PAGE 100 INIT 110 DIM A$(256),B$(4)115 PRINT "INSERT YOUR DATA TAPE!."120 PRINT "INPUT FILE NUMBER ";130 INPUT N1132 PRINT "CONFIRM THAT FILE ";N1;" IS THE DATA FILE ";133 PRINT "TO BE WRITTEN TO:  Y OR N?"135 INPUT N$136 IF N$<>"Y" OR N$<>"y" THEN 95140 FIND N1150 A$="S1"160 B$="  "170 A$=A$&B$180 B$=""190 PRINT "INPUT STARTING ADDRESS ";200 INPUT B$210 A$=A$&B$220 B$=""230 T1=3240 PRINT "INPUT CODE STRING NOT EXCEEDING 72 CHARACTERS PER ENTRY"250 PRINT "  TOTAL STRING LENGTH NOT TO EXCEED 248 CHARACTERS "260 PRINT "  IF INPUT IS LESS THAN 72,PROGRAM CONSIDERS STRING ENDED"270 PRINT "         ENTER FIRST PART OF STRING"280 FOR I=1 TO 4290 INPUT D$300 A$=A$&D$310 T1=T1+LEN(D$)/2320 IF LEN(D$)<72 THEN 360330 PRINT "NEXT PART OF STRING?"340 NEXT I350 REM CONVERT BYTE COUNT TO HEX -- DO NO COMPLEMENT (K=0)360 K=0370 T=T1380 GOSUB 940390 A$=REP(B$,3,1)400 A$=REP(C$,4,1)410 G=LEN(A$)420 T=0430 GOSUB 710440 REM SET K=1 FOR 1'S COMPLEMENT OF CHECKSUM450 K=1460 GOSUB 940470 A$=A$&B$480 A$=A$&C$490 PRINT "IF ANOTHER RECORD IS TO BE ENTERED ON FILE, ENTER 'Y'; "500 PRINT "OTHERWISE PRESS 'RETURN' ";510 INPUT B$520 IF B$="" THEN 560530 PRINT A$540 PRINT @33:A$550 GO TO 150560 B$="S9"570 A$=A$&B$580 PRINT A$590 PRINT @33:A$600 PRINT "DO YOU WISH TO LOAD M6800 FROM FILE? Y IF YES,N IF NO ";610 INPUT B$620 IF B$<>"Y" THEN 700630 CALL "RATE",300,4,0640 CALL "TSTRIN"," ","",""650 CALL "RSTRIN","","",""660 CALL "MARGIN",0,0,0670 CALL "EOLCHR",13,"L",0680 FIND N1690 CALL "DTSEND"700 END 710 REM *** COMPUTE CHECKSUM *****720 T=0730 FOR I=3 TO G STEP 2740 B$=SEG(A$,I,1)750 C$=SEG(A$,I+1,1)760 X=ASC(B$)770 Y=ASC(C$)780 IF X>57 THEN 810790 X=(X-48)*16800 GO TO 820810 X=(X-55)*16820 IF Y>57 THEN 850830 Y=Y-48840 GO TO 860850 Y=Y-55860 T=T+X+Y870 NEXT I880 IF T<256 THEN 930890 FOR I=1 TO 64900 T=T-256910 IF T<=256 THEN 930920 NEXT I930 RETURN 940 REM *** CONVERT DECIMAL TO HEX AND CODE FOR ASCII ***950 N=0960 FOR I=1 TO 16970 T=T-16980 N=N+1990 IF T<=0 THEN 10101000 NEXT I1010 IF T=0 THEN 10401020 T=T+161030 N=N-11040 IF K=0 THEN 10701050 N=15-N1060 T=15-T1070 IF N>9 THEN 11001080 B$=CHR(N+48)1090 GO TO 11101100 B$=CHR(N+55)1110 IF T>9 THEN 11401120 C$=CHR(T+48)1130 GO TO 11501140 C$=CHR(T+55)1150 RETURN 