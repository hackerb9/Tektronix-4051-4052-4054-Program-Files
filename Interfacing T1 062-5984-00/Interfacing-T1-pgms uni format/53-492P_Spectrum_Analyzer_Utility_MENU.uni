1 ON SRQ THEN 370100 DELETE 9001,9009105 FIND 4110 APPEND 9000120 WINDOW 0,130,0,100130 VIEWPORT 0,130,0,100140 DIM A$(1)150 PAGE 160 PRINT "IS THERE A 492P AVAILABLE FOR THIS DEMONSTRATION?(YES,NO)"170 INPUT A$180 IF A$="Y" THEN 250190 IF A$="N" THEN 230200 REM ELSE IMPROPER ANSWER210 PRINT "PLEASE ANSWER YES OR NO"220 GO TO 160230 Z9=100240 GO TO 400250 PRINT "ENTER 492P GPIB ADDRESS"260 INPUT Z9270 IF Z9>30 THEN 300280 IF Z9<0 THEN 300290 GO TO 320300 PRINT "GPIB ADDRESS IS OUT OF LIMITS"310 GO TO 250320 DELETE O$330 DIM O$(40)340 PRINT @Z9:"ID?"350 INPUT @Z9:O$360 GO TO 400370 POLL G,H;Z9380 PRINT H390 RETURN 400 REM PROGRAM TO DISPLAY TITLE PAGE, DEMO MENU, & PERFORM DEMOS #2&3410 H$="<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><"420 H$=H$&"><><><><><>"430 I$="<>                                                            "440 I$=I$&"        <>"450 J$="<>              TEK 492P SPECTRUM ANALYZER DEMONSTRATION      "460 J$=J$&"        <>"470 K$="<>   DEMONSTRATION   TITLE                                    "480 K$=K$&"        <>"490 REM OBTAIN MENU TEXT 500 DIM M$(1000)510 FIND 3520 READ @33:M$530 PAGE 540 FOR I=1 TO 10550 REM PRINT MENU HEADING560 GO TO I OF 570,590,610,590,570,590,590,630,590,590570 PRINT H$580 GO TO 640590 PRINT I$600 GO TO 640610 PRINT J$620 GO TO 640630 PRINT K$640 NEXT I650 REM PRINT TEXT660 M=LEN(M$)670 REM I9= # OF MENU ITEMS IN M$680 I9=INT(M/40)690 FOR I=1 TO I9700 S=1+(I-1)*40710 REM DETERMINE SPACING OF EACH MENU LINE720 REM N$= MENU ITEM NUMBER (1 OR 2 DIGITS)730 DIM N$(2)740 N$=STR(I)750 N=LEN(N$)760 S$=SEG(M$,S,40)770 IF N>1 THEN 800780 L$="<>         "790 GO TO 810800 L$="<>        "810 L$=L$&N$820 L$=L$&"         "830 L$=L$&S$840 L$=L$&"         <>"850 PRINT L$860 NEXT I870 REM PRINT BOTTOM OF MENU880 FOR J=1 TO 3890 GO TO J OF 900,900,920900 PRINT I$910 GO TO 930920 PRINT H$930 NEXT J940 REM ***   ***   ***   ***   ***   ***   ***   ***   ***   ***   ***950 REM OBTAIN AND EXECUTE SELECTION960 PRINT "ENTER NUMBER OF DEMONSTRATION OF YOUR CHOICE  ";970 INPUT I980 GO TO I OF 1010,1040,1390,1650,1700,1760990 REM *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*1000 REM INTRODUCTION TO 492P GPIB INSTRUCTIONS: DEMO #11010 F1=71020 GO TO 16701030 REM *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*1040 REM COMPLETE LIST OF 492P COMMANDS: DEMO #21050 PAGE 1060 PRINT "              LIST OF 492P COMMANDS"1070 PRINT ""1080 PRINT "FRONT PANEL FUNCTIONS"1090 PRINT "   ARES            FREQ            REFLVL     "1100 PRINT "   AVIEW           FRQRNG          RESBW      "1110 PRINT "   BMINA           GRAT            RLMODE     "1120 PRINT "   BVIEW           IDENT           SAVEA      "1130 PRINT "   CLIP            MAXPWR          SIGSWP     "1140 PRINT "   CRSOR           MINATT          SPAN       "1150 PRINT "   DEGAUS          MXHLD           TIME       "1160 PRINT "   DELFR           PEAK            TRIG       "1170 PRINT "   EXMXR           PHSLK           TUNE       "1180 PRINT "   FINE            PLSTR           VIDFLT     "1190 PRINT "   FRCAL           REDOUT          VRTDSP     "1200 PRINT ""1210 PRINT "WAVEFORM DISPLAY FUNCTIONS"1220 PRINT "   CENSIG          LFTNXT          TOPSIG     "1230 PRINT "   CURVE           LORDO           RGTNXT     "1240 PRINT "   FIBIG           POINT           UPRDO      "1250 PRINT "   FMAX            RDOUT           WFMPRE     "1260 PRINT "   FMIN"1270 PRINT ""1280 PRINT "COMPREHENSIVE AND SYSTEM FUNCTIONS"1290 PRINT "   ADDR            ERCNT           RQS        "1300 PRINT "   INIT            ERR             SET        "1310 PRINT "   DATA            ID              WAIT       "1320 PRINT "   EOS"1330 PRINT ""1340 PRINT "PRESS RETURN TO DISPLAY MASTER MENU FOR NEXT DEMO SELECTION"1350 ON SRQ THEN 15901360 INPUT Z$1370 GO TO 5301380 REM *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*1390 REM PERFORM COMMANDS ON 492P: DEMO #31400 ON SRQ THEN 15901410 IF Z9<>100 THEN 14701420 PRINT "YOU INDICATED NO 492P IS AVAILABLE. SINCE IT IS REQUIRED "1430 PRINT "FOR THIS DEMO, PLEASE PRESS RETURN AND MAKE ANOTHER MENU "1440 PRINT "SELECTION."1450 INPUT Z$1460 GO TO 5301470 DELETE W$1480 DIM W$(4000)1490 PAGE 1500 PRINT "TO RETURN TO MASTER MENU FOR NEXT SELECTION, ENTER ""DONE"""1510 PRINT " ENTER GPIB COMMAND"1520 PRINT ">";1530 INPUT W$1540 IF W$="DONE" THEN 5101550 PRINT @Z9:W$1560 INPUT @Z9:W$1570 PRINT W$1580 GO TO 15201590 POLL G,H;Z91600 PRINT @Z9:"ERR?"1610 INPUT @Z9:W$1620 PRINT "";1630 RETURN 1640 REM *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*1650 REM ACQUIRE AND GRAPH WAVEFORMS: DEMO #41660 F1=51670 DELETE G,H,I,I9,J,M,N,S,A$,H$,I$,J$,K$,L$,M$,N$1680 DELETE S$,W$,Z$1690 GO TO 90011700 REM *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*1710 REM INTERNAL WAVEVORM PROCESSING: DEMO#51720 F1=61730 DELETE G,H,I,I9,J,M,N,S,A$,H$,I$,J$,K$,L$,M$,N$1740 DELETE S$,W$,Z$1750 GO TO 90011760 REM *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*1770 REM COMPUTE TOTAL HARMONIC DISTORTION:#61780 F1=131790 DELETE G,H,I,I9,J,M,N,S,A$,H$,I$,J$,K$,L$,M$,N$1800 DELETE S$,W$,Z$1810 GO TO 90019000 REM END OF FILE TO BE DELETED