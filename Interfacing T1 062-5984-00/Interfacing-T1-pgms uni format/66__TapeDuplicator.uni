1000 REM                     7-26-76     4924 TAPE DUPLICATOR1010 PRINT "	** TAPE DUPLICATOR (4924) **"1020 INIT 1030 PRINT @37,0:13,255,2551040 DATA 0,0,01050 DATA 0,0,01060 READ K1,K2,K3,K4,K5,K61070 DIM B$(1),C$(1),D$(45)1080 C$=CHR(13)1090 PRINT "

DO YOU WANT THE WHOLE TAPE DUPLICATED: ";1100 INPUT B$1110 DATA 1,255,0,0,0,0,11120 READ J2,J3,J4,J5,J6,J7,J01130 IF B$="Y" THEN 13001140 IF B$<>"N" THEN 10901150 J4=11160 PRINT "
	BEGIN WITH FILE # ";1170 INPUT J21180 J2=INT(J2)1190 PRINT "
	  END WITH FILE # ";1200 INPUT J31210 J3=INT(J3) MIN 2551220 IF J3<J2 OR J2<1 THEN 11601230 PRINT "
	YOU MAY TRANSFER MASTER FILES # ";J2;" TO ";J31240 PRINT "	INTO DIFFERENT FILES ON THE DUPLICATE(S)."1250 PRINT "
	TRANSFER # ";J2;" FROM THE MASTER TO # ";1260 INPUT J11270 IF J1<1 OR J1>260 THEN 12501280 J5=INT(J1)-J21290 REM1300 DIM A1(J3-J2+1)1310 A1=01320 PRINT "
DO YOU WANT THE DUPLICATE(S) VERIFIED: ";1330 INPUT B$1340 IF B$="Y" THEN 13701350 IF B$<>"N" THEN 13201360 J7=11370 K7=NOT(J7)1380 PRINT "
DO YOU WANT THE FILES ""MARK""'ED AUTOMATICALLY: ";1390 INPUT B$1400 IF B$="N" THEN 16001410 IF B$<>"Y" THEN 13801420 IF K3 THEN 15301430 PRINT "
	YOU MAY CHOOSE TO:"1440 PRINT "
	  1. HAVE THEM ""MARK""'ED THE SAME AS THE MASTER."1450 PRINT "
	  2. OR HAVE THEM ""MARK""'ED JUST ""LARGE ENOUGH""."1460 PRINT "	      (PLUS SOME FREE SPACE)"1470 PRINT "

	  ENTER YOUR CHOICE = ";1480 INPUT J11490 IF J1<>INT(J1) OR J1<1 OR J1>2 THEN 14701500 A5=01510 J0=01520 IF J1=1 THEN 16001530 J0=0.251540 PRINT "
	WHEN ""MARK""'ING, HOW MANY BYTES OF	FREE SPACE DO YOU";1550 PRINT " WANT ADDED TO	ALLOW ROOM FOR EXPANSION (EG 1000) = ";1560 INPUT A51570 A5=INT(A5)1580 IF A5<0 THEN 15401590 REM1600 PRI "PUT YOUR MASTER TAPE IN THE 4051 AND THE DUPLICATE IN THE ";1610 PRINT "4924.    (MAKE SURE THE MASTER IS ON SAFE AND THE";1620 PRINT " DUPLICATE IS NOT.)"1630 PRINT "

ENTER THE GPIB (IEC) DEVICE # FOR THE 4924 = ";1640 INPUT J91650 J9=INT(J9)1660 IF J9<1 OR J9>30 THEN 16301670 J8=331680 K1=NOT(NOT(K1))1690 K4=NOT(NOT(K4))1700 A3=MEMORY-2001710 DIM A$(A3)1720 ON SRQ THEN 33301730 REM                                 PREPARE FOR NEXT DUPLICATION1740 PRINT @J8,0:K1,K2,K31750 PRINT @J9,0:K4,K5,K6,K71760 IF J2+J5<>1 OR J0 THEN 17901770 FIND @J9:01780 MARK @J9:1,11790 A0=01800 FIND @J9:J2+J51810 PRINT "	BEGIN DUPLICATION

"1820 PRINT " MASTER    DUPLICATE      SIZE          FILE"1830 PRINT " FILE #     FILE #       MARKED         TYPE"1840 FOR J1=J2 TO J31845 E1=01850 A0=A0+11860 A6=J1+J51870 PRINT USING "L,5D,11D,S":J1,A61880 IF J0 THEN 23301890 IF J6 THEN 22901900 REM               FIND A1(A0), FOR MARKING -- CHECK FOR LAST FILE1910 IF K3 THEN 20501920 PRINT @J8,0:K1,K2,11930 FIND @J8:J11940 PRINT @J8,0:K1,K2,01950 INPUT %J8:D$1960 IF LEN(D$)<>42 THEN 29401970 IF POS(D$,"L",9)=9 THEN 25501980 IF POS(D$,"B",9)=9 AND POS(D$,"P",17)=17 AND J0=0.25 THEN 20451990 IF J0<>0 AND POS(D$,"N",9)<>9 AND POS(D$,"S",27)<>27 THEN 20502000 REM         MARK SAME SIZE2010 A$=SEG(D$,32,10)2020 A1(A0)=(2-K1)*128*VAL(A$)2030 GO TO 22902040 REM         MARK TO TRIM EXCESS2045 E1=12050 FIND @J8:J12060 K0=02070 K8=02080 K9=02090 A4=TYP(0)2100 ON EOF (0) THEN 22402110 GO TO A4+1 OF 2240,2240,2120,2170,22002120 INPUT %J8:A$2130 K0=K0+12140 K9=K9+LEN(A$)2150 GO TO 21202160 IF TYP(0)=4 THEN 22002165 IF E1 THEN 22342170 READ @J8:A22180 K8=K8+12190 GO TO 21602200 READ @J8:A$2210 K0=K0+12220 K9=K9+LEN(A$)2230 GO TO 21602234 A4=(K0+1)*(2-K1)*128+A52236 GO TO 22502240 A4=K9+K0+A5+(A4<>2)*(10*K8+K0)2250 A1(A0)=A4 MAX 12260 A4=(2-K1)*1282270 A1(A0)=(-INT(-A1(A0)/A4) MAX 3)*A42280 REM         MARK DUPLICATE2290 FIND @J9:A62300 MARK @J9:1,A1(A0)2310 GO TO 24302320 REM         DUPLICATE PRE-MARKED--FIND ITS SIZE2330 IF K6 THEN 24302340 FIND @J9:A62350 INPUT @J9,9:D$2360 IF LEN(D$)<>42 THEN 29402370 A$=SEG(D$,32,10)2380 A1(A0)=(2-K4)*128*VAL(A$)2390 IF POS(D$,"L",9)=9 THEN 25602400 IF POS(D$,"N",9)=9 THEN 24302410 KILL @J9:A62420 REM                                 CHECK MASTER HEADER FOR ABNL2430 ON EOF (0) THEN 30902440 PRINT USING "C15D,9X,S":A1(A0)2450 K9=122460 IF K3 THEN 28502470 IF NOT(J0) AND NOT(J6) THEN 25302480 PRINT @J8,0:K1,K2,12490 FIND @J8:J12500 PRINT @J8,0:K1,K2,02510 INPUT %J8:D$2520 IF LEN(D$)<>42 THEN 29402530 B$=SEG(D$,9,1)2540 GO TO POS("ABNL",B$,1)+1 OF 2940,2640,2640,3160,25502550 IF J0 THEN 25802560 PRINT "            ";(2-K4)*128*3;"         LAST"2570 GO TO 25902580 PRINT "LAST MASTER FILE"2590 A4=J12600 J1=J32610 J3=A4-12620 GO TO 31702630 REM                                     FIX HEADER FOR DUPLICATE2640 IF POS(D$,"S",27)<>27 THEN 26702650 PRINT "SECRET -- CAN'T TRANSFER"2660 GO TO 31702670 IF K6 THEN 27702680 IF NOT(J5) THEN 27202690 A$=STR(A6)2700 D$=REP("        ",1,8)2710 D$=REP(A$,1,LEN(A$))2720 IF J0=0 THEN 27702730 A4=-INT(-A1(A0)/((2-K4)*128))2740 A$=STR(A4 MAX 3)2750 D$=REP("        ",35,8)2760 D$=REP(A$,35,LEN(A$))2770 K9=12780 IF POS(D$,"P",17)=17 THEN 28002790 K9=122800 IF B$="A" THEN 28502810 IF K9=12 THEN 29302820 PRINT "BINARY PROGRAM"2825 E1=12830 GO TO 29702840 REM            DATA TRANSFER -- ASCII & BINARY (NUMERIC & STRING)2850 FIND @J9:A62860 FIND @J8:J12870 PRINT "ASCII"2880 INPUT %J8:A$2890 PRINT @J9:A$2900 IF LEN(A$)<A3 THEN 28802910 PRINT "
FATAL ERROR:  ASCII STRING TOO LONG TO INPUT."2920 GO TO 32902930 IF POS(D$,"D",17)=17 THEN 29602940 PRINT "
FATAL ERROR:  BAD HEADER:";D$;""2950 GO TO 32902960 PRINT "BINARY DATA"2965 E1=02970 FIND @J9:A62980 FIND @J8:J12990 IF TYP(0)=4 THEN 30302995 IF E1 THEN 30903000 READ @J8:A43010 WRITE @J9:A43020 GO TO 29903030 READ @J8:A$3040 WRITE @J9:A$3050 IF LEN(A$)<A3 THEN 29903060 PRINT "
FATAL ERROR:  BINARY STRING TOO LONG TO READ."3070 GO TO 32903080 REM                          ALL DATA TRANSFERRED--HEADER NOW???3090 IF K3 OR K6 THEN 31703100 PRINT @J9,0:K4,K5,1,K73110 FIND @J9:A63120 PRINT @J9:D$;C$;""3130 PRINT @J9,2:3140 PRINT @J9,0:K4,K5,0,K73150 GO TO 31703160 PRINT "NEW"3170 NEXT J13180 FIND @J9:03190 J6=13200 PRINT "
TRANSFER DONE"3210 PRINT "

DO YOU WANT TO MAKE ANOTHER COPY OF THE MASTER: ";3220 INPUT B$3230 IF B$="N" THEN 33203240 IF B$<>"Y" THEN 32103250 PRINT "

	      (MAKE SURE IT IS NOT ON SAFE!)"3260 PRINT "	PUT A NEW TAPE IN THE 4924 AND PRESS ""RETURN"":";3270 INPUT B$3280 GO TO 17403290 PRINT @J8,0:K1,K2,K33300 PRINT @J9,0:K4,K5,K6,K73310 FIND @J9:03320 END 3330 POLL K8,K9;J93340 INPUT @J9,30:K93350 PRINT @J9,0:K4,K5,K6,K73360 IF K9<>12 THEN 33903370 PRINT "
FATAL ERROR:  DUPLICATE FILE IS TOO SMALL."3380 GO TO 32903390 IF K9<>10 THEN 34203400 PRINT "
FATAL ERROR:  VERIFY (READ AFTER WRITE) ERROR"3410 GO TO 32903420 PRI "
FATAL ERROR:  MAG TAPE ERROR #";K9;"  (SEE 4924 REFN. MAN";3430 PRINT "UAL)"3440 GO TO 3290