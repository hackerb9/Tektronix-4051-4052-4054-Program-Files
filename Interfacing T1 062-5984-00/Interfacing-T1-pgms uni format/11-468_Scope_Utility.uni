1 ON SRQ THEN 100002 GO TO 1004 REM*** FK1 RESTART ***5 GOSUB 1006 END 8 REM*** FK2 ACQUIRE WAVEFORMS FORM 468 ***9 GOSUB 1020010 GOSUB 400011 RETURN 12 REM*** FK3 ACQUIRE WAVEFORMS FROM TAPE ***13 GOSUB 900014 RETURN 16 REM*** FK4 SAVE WAVEFORMS TO TAPE ***17 GOSUB 950018 RETURN 20 REM*** FK5 REDISPLAY WAVEFORMS ***21 GOSUB 1020022 GOSUB 436023 RETURN 24 REM*** FK6 OUTPUT TO SCREEN ***25 D=3226 RETURN 28 REM*** FK7 OUTPUT TO PLOTTER ***29 D=130 RETURN 100 REM*** INITIALIZATION ***110 INIT 120 ON SRQ THEN 10000130 REM*** SET ALTERNATE EOL TO <%> (ASCII 37) ***140 PRINT @37,0:37,255,255150 DIM A$(175),C$(20),X(512),E$(20),D$(20),K$(5),L$(5),M$(5),N$(5)160 DIM O$(5),P$(5),Q$(5),R$(5),S$(5),T$(5),X$(20),Y$(20),Z$(20)170 REM*** SET VALUES FOR X AXIS DATA POINTS ***180 FOR I=1 TO 512190 X(I)=I200 NEXT I210 DATA 32,1,0220 REM*** D=OUTPUT DEVICE J4=IS GRID DRAWN? ***230 READ D,J4,J6240 PRINT "
ENTER GPIB ADDRESS OF 468 (1-30) ";250 INPUT C$260 C$=C$&"A-1"270 J5=INT(VAL(C$))280 IF J5<1 OR J5>30 THEN 240282 PRINT "
POWER ON 468 OR CYCLE POWER AT THIS TIME!"284 WAIT 290 PRINT "
PRESS /RETURN/ TO START WAVEFORM ACQUISTION ";300 INPUT C$310 J4=1320 PAGE 330 REM*** CALL TO SUBROUTINE TO ACQUIRE DATA ***340 GOSUB 4000350 REM*** SET EOL TO <CR> (ASCII 13) ***360 PRINT @37,26:0370 HOME 380 RETURN 3000 REM*** SUBROUTINE TO DRAW SCOPE SCREEN ***3010 REM** DASH LINES REPRESENT DIGITIZED DATA AREA NOT ON 468 SCREEN *3020 REM*** DIGITIZED AREA IS 10.24cm IN BOTH HORZ. & VERT. ***3030 WINDOW 1,500,0,2553040 VIEWPORT 30,100,0,703050 FOR I=0 TO 103060 FOR J=7 TO 23 STEP 43070 MOVE @D:50*I+(I=0),J3080 DRAW @D:50*I+(I=0),J3090 NEXT J3100 MOVE @D:50*I+(I=0),273110 DRAW @D:50*I+(I=0),2273120 FOR J=231 TO 247 STEP 43130 MOVE @D:50*I+(I=0),J3140 DRAW @D:50*I+(I=0),J3150 NEXT J3160 NEXT I3170 FOR I=1 TO 500 STEP 63180 MOVE @D:I,33190 DRAW @D:I,33200 NEXT I3210 FOR I=1 TO 500 STEP 63220 MOVE @D:I,64.53230 DRAW @D:I,64.53240 NEXT I3250 FOR I=1 TO 500 STEP 63260 MOVE @D:I,189.53270 DRAW @D:I,189.53280 NEXT I3290 FOR I=1 TO 500 STEP 63300 MOVE @D:I,2523310 DRAW @D:I,2523320 NEXT I3330 FOR I=1 TO 93340 MOVE @D:1,25*I+23350 DRAW @D:500,25*I+23360 NEXT I3370 VIEWPORT 30,100,7.5,62.33380 AXIS @D:10,6.4,250,1273390 VIEWPORT 30,100,0,703400 MOVE @D:0,1863410 PRINT @D:"100%"3420 MOVE @D:0,173.23430 PRINT @D:"90%"3440 MOVE @D:0,73.33450 PRINT @D:"10%"3460 MOVE @D:0,60.53470 PRINT @D:"0%"3480 J4=03490 HOME @D:3500 PRINT @D:"


 COUPLING"3510 PRINT @D:" TIME/DIV"3520 PRINT @D:" VOLTS/DIV"3530 PRINT @D:" TRIGGER PT."3540 PRINT @D:" MAX VOLTS"3550 PRINT @D:" MIN VOLTS"3560 RETURN 4000 REM*** SUBROUTINE TO ACQUIRE DATA ***4010 E$=""4020 DELETE Y,Y1,Y2,Y3,X$,Y$,Z$4030 Q1=MEMORY4040 DATA " "," "," ","",04045 RESTORE 40404050 READ X$,Y$,Z$,A$,J64060 REM*** SET EOL TO <CR><B> ASCII(13,10) ***4070 PRINT @37,26:14080 REM*** UNTALK,UNLISTEN BUS, AND ISSUE DEVICE CLEAR ***4090 WBYTE @95,63,20:4100 REM*** ASSIGN 468 AS TALKER ***4110 WBYTE @64+J5:4120 REM*** GET HEADER USING ALTERNATE DELIMITER OF <%> ***4130 INPUT %J5:A$4140 REM*** CHECK TO MAKE SURE HEADER WAS RECEIVED ***4150 P=POS(A$,"WFID:",5)4160 IF P=0 THEN 41104170 REM*** FIND OUT WHICH CHANNEL DATA WAS FOR ***4180 D$=SEG(A$,P,10)4190 D$=D$&"A3"4200 D$=STR(VAL(D$))4210 REM*** CHECK IF CHANNEL HAS ALREADY BEEN CAPTURED ***4220 IF POS(E$,D$,1)=0 THEN 42404230 GO TO 43604240 E$=E$&D$4245 PRINT @37,26:04250 REM*** DETERMINE NUMBER OF POINTS IN WAVEFORM ***4260 P=POS(A$,"NR.PT:",15)4270 C$=SEG(A$,P+5,5)4280 B=VAL(C$)4285 DELETE Y4290 DIM Y(B)4300 REM*** CAPTURE W5EFORM ***4310 WBYTE @64+J5:4320 RBYTE H1,H2,Y,C1,E14330 REM*** SAVE DATA3**4340 GOSUB VAL(D$) OF 5000,5100,52004350 GO TO 41004360 REM*** GOSUB TO DRAW WAVEFORMS ***4365 WBYTE @95,63,20:4370 GOSUB LEN(X$)>5 OF 55004380 GOSUB LEN(Y$)>5 OF 60004390 GOSUB LEN(Z$)>5 OF 65004400 RETURN 4500 REM*** SUBROUTINE TO DRAW ACQUIRED WAVEFORM ***4510 GOSUB J4 OF 30004520 WINDOW 1,500,0,2554530 IF B=512 THEN 45504540 WINDOW 1,250,0,2554550 VIEWPORT 30,100,0,704560 MOVE @D:X(1),Y(1)4570 DRAW @D:X,Y4580 RETURN 4600 REM*** SUBROUTINE TO DRAW SAVED WAVEFORM ***4610 GOSUB J4 OF 30004620 WINDOW 1,500,0,2554630 IF B=512 THEN 46504640 WINDOW 1,250,0,2554650 VIEWPORT 30,100,0,704660 FOR I2=1 TO B STEP 3/(1+(B<300))4670 MOVE @D:X(I2),Y(I2)4680 DRAW @D:X(I2),Y(I2)4690 NEXT I24700 RETURN 5000 REM*** SUBROUTINE TO SAVE CHANNEL 1 DATA ***5010 DELETE X$,Y15020 Q1=MEMORY5030 DIM Y1(B),X$(LEN(A$)+5)5040 B1=B5050 Y1=Y5060 X$=A$5070 RETURN 5100 REM*** SUBROUTINE TO SAVE CHANNEL 2 DATA ***5110 DELETE Y$,Y25120 Q1=MEMORY5130 DIM Y2(B),Y$(LEN(A$)+5)5140 B2=B5150 Y2=Y5160 Y$=A$5170 RETURN 5200 REM*** SUBROUTINE TO SAVE ADD DATA ***5210 DELETE Z$,Y35220 Q1=MEMORY5230 DIM Y3(B),Z$(LEN(A$)+5)5240 B3=B5250 Y3=Y5260 Z$=A$5270 RETURN 5500 REM*** SUBROUTINE TO DRAW & ANALYZE CHANNEL 1 DATA ***5510 DELETE Y,A$5520 Q1=MEMORY5530 DIM Y(B1),A$(LEN(X$)+5)5540 Y=Y15550 B=B15560 A$=X$5570 GOSUB J6 OF 46005580 GOSUB NOT(J6) OF 45005590 GOSUB 70005600 HOME @D:5610 PRINT @D: USING "16X,27A":"CHANNEL 1_________"5620 IF J6=1 THEN 56505630 PRINT @D: USING "12X,8A":"ACQUIRED"5640 GO TO 56605650 PRINT @D: USING "22X,9A":"FROM TAPE"5660 U$=SEG(F$,1,13+(J6=1)*10)5670 GOSUB 85005680 RETURN 6000 REM*** SUBROUTINE TO DRAW & ANALYZE CHANNEL 2 DATA ***6010 DELETE Y,A$6020 Q1=MEMORY6030 DIM Y(B2),A$(LEN(Y$)+5)6040 Y=Y26050 B=B26060 A$=Y$6070 GOSUB J6 OF 46006080 GOSUB NOT(J6) OF 45006090 GOSUB 70006100 HOME @D:6110 PRINT @D: USING "36X,27A":"CHANNEL 2_________"6120 IF J6=1 THEN 61506130 PRINT @D: USING "32X,8A":"ACQUIRED"6140 GO TO 61606150 PRINT @D: USING "42X,9A":"FROM TAPE"6160 U$=SEG(F$,1,33+(J6=1)*10)6170 GOSUB 85006180 RETURN 6500 REM*** SUBROUTINE TO DRAW & ANALYZE CHANNEL ADD DATA ***6510 DELETE Y,A$6520 Q1=MEMORY6530 DIM Y(B3),A$(LEN(Z$)+5)6540 Y=Y36550 B=B36560 A$=Z$6570 GOSUB J6 OF 46006580 GOSUB NOT(J6) OF 45006590 GOSUB 70006600 HOME @D:6610 PRINT @D: USING "56X,36A":"ADD CHANNELS____________"6620 IF J6=1 THEN 66506630 PRINT @D: USING "52X,8A":"ACQUIRED"6640 GO TO 66606650 PRINT @D: USING "62X,9A":"FROM TAPE"6660 U$=SEG(F$,1,53+(J6=1)*10)6670 GOSUB 85006680 RETURN 7000 REM*** ANALYZE HEADER INFORMATION ***7010 WINDOW 0,130,0,1007020 VIEWPORT 0,130,0,1007030 F$="                                                            "7040 F$=F$&"     "7050 REM*** DETERMINE COUPLING ***7060 P=POS(A$,"WFID:",5)7070 K$=SEG(A$,P+10,3)7080 IF POS(K$,"""",1)=0 THEN 71007090 K$=SEG(K$,1,2)7100 REM*** DETERMINE X-INCREMENT ***7110 P=POS(A$,"XINCR:",30)7120 L$=SEG(A$,P+6,3)7130 IF POS(L$,",",1)=0 THEN 71607140 L$=SEG(L$,1,LEN(L$)-1)7150 GO TO 71307160 REM*** DETERMINE TRIGGER POINT ***7170 P=POS(A$,"PT.OFF:",45)7180 M$=SEG(A$,P+7,3)7190 IF POS(M$,",",1)=0 THEN 72107200 M$=SEG(M$,1,2)7210 REM*** DETERMINE X-UNITS ***7220 P=POS(A$,"XUNIT:",50)7230 N$=SEG(A$,P+6,2)7240 IF POS(N$,",",1)=0 THEN 72607250 N$=SEG(N$,1,1)7260 REM*** DETERMINE Y-MULIPLIER ***7270 P=POS(A$,"YMULT:",60)7280 O$=SEG(A$,P+6,3)7290 IF POS(O$,",",1)=0 THEN 73207300 O$=SEG(O$,1,LEN(O$)-1)7310 GO TO 72907320 REM*** DETERMINE GROUND REFERENCE ***7330 P=POS(A$,"YOFF:",70)7340 P$=SEG(A$,P+5,3)7350 IF POS(P$,",",1)=0 THEN 73807360 P$=SEG(P$,1,LEN(P$)-1)7370 GO TO 73507380 REM*** DETERMINE Y-UNITS ***7390 P=POS(A$,"YUNIT:",75)7400 Q$=SEG(A$,P+6,3)7410 IF POS(Q$,",",1)=0 THEN 74407420 Q$=SEG(Q$,1,LEN(Q$)-1)7430 GO TO 74107440 REM*** TIME/DIVISION ***7450 T1=(50*(B>500)+25*(B<300))*VAL(L$)7460 REM*** VOLTS/DIVISION ***7470 V1=25*VAL(O$)7480 REM*** TRIGGER TIME AFTER START OF SWEEP ***7490 T2=T1/(50*(B>500)+25*(B<300))*VAL(M$)7500 Y5=VAL(P$)7510 Y6=VAL(O$)7520 REM*** FIND MIN & MAX VOLTAGE LEVELS OF DISPLAYED WAVEFORMS ***7530 B4=500*(B>500)+250*(B<300)7540 V2=2567550 V3=-17560 FOR I1=1 TO B47570 V2=V2 MIN Y(I1)7580 V3=V3 MAX Y(I1)7590 NEXT I17600 V2=Y6*(V2-Y5)7610 V3=Y6*(V3-Y5)7620 RETURN 8000 REM*** CHANGE TIME REFERENCE ***8010 P=POS(" SMSUSNS",N$,1)8020 R$=SEG("SMSUSNS",P-2,2)8030 RETURN 8100 REM*** CHANGE VOLTAGE REFERENCE ***8110 P=POS(" VMVUVDIV",Q$,1)8120 S$=SEG("VMVUVDIV",P-2,2)8130 RETURN 8500 REM*** PRINT HEADER INFORMATION ***8510 PRINT @D:"
";U$;K$8520 R$=N$8530 IF T1<1000 THEN 85608540 T1=T1/10008550 GOSUB 80008560 PRINT @D: USING "FA,FD.2D,A,FA":U$;T1;" ";R$8570 S$=Q$8580 IF V1<1000 THEN 86108590 V1=V1/10008600 GOSUB 81008610 IF S$<>"UV" THEN 86308620 S$="UNK"8630 PRINT @D: USING "FA,FD.2D,A,FA":U$;V1;" ";S$8640 R$=N$8650 IF T2<1000 THEN 86808660 T2=T2/10008670 GOSUB 80008680 PRINT @D: USING "FA,FD.2D,A,FA":U$;T2;" ";R$8690 S$=Q$8700 IF ABS(V3)<1000 THEN 87308710 V3=V3/10008720 GOSUB 81008730 IF S$<>"UV" THEN 87508740 S$="UNK"8750 PRINT @D: USING "FA,FD.3D,A,FA":U$;V3;" ";S$8760 S$=Q$8770 IF ABS(V2)<1000 THEN 88008780 V2=V2/10008790 GOSUB 81008800 IF S$<>"UV" THEN 88208810 S$="UNK"8820 PRINT @D: USING "FA,FD.3D,A,FA":U$;V2;" ";S$8830 RETURN 9000 REM*** SUBROUTINE TO ACQUIRE WAVEFORMS FROM TAPE ***9010 PRINT "

"9020 J4=19030 PRINT @37,26:09040 F1=39050 FIND F19060 IF TYP(0)=0 THEN 91109070 READ @33:F$9080 PRINT "	";F1-2;")     ";F$9090 F1=F1+19100 GO TO 90509110 PRINT "
	ENTER NUMBER OF FILE WAVEFORMS ARE ON: ";9120 INPUT C$9130 C$=C$&"A-4"9140 F2=INT(VAL(C$)+2)9150 IF F2<3 OR F2>F1 THEN 91109160 FIND F29170 READ @33:F$9180 DELETE X$,Y$,Z$,Y1,Y2,Y39190 Q1=MEMORY9200 READ @33:A3,B19210 DIM X$(A3),Y1(B1)9220 READ @33:X$,Y19230 READ @33:A3,B29240 DIM Y$(A3),Y2(B2)9250 READ @33:Y$,Y29260 READ @33:A3,B39270 DIM Z$(A3),Y3(B3)9280 READ @33:Z$,Y39290 J6=19300 GOSUB 43609310 RETURN 9500 REM*** SUBROUTINE TO SAVE WAVE FORMS TO TAPE ***9510 PRINT "

"9520 J4=19530 PRINT @37,26:09540 PRINT @33,0:0,0,19550 F1=39560 FIND F19570 INPUT @33:F$9580 IF POS(F$," LAST ",1)<>0 THEN 96109590 F1=F1+19600 GO TO 95609610 PRINT @33,0:0,0,09620 FIND F19630 MARK 1,110009640 PRINT "

ENTER NAME YOU WISH TO STORE WAVEFORM UNDER"9650 INPUT F$9660 IF LEN(F$)=0 THEN 96409670 IF LEN(F$)<40 THEN 96909680 F$=SEG(F$,1,40)9690 FIND F19700 WRITE @33:F$9710 IF LEN(X$)>20 THEN 97609720 X$=" "9730 B1=19740 DIM Y1(1)9750 Y1=19760 A3=LEN(X$)+59770 WRITE @33:A3,B1,X$,Y19780 IF LEN(Y$)>20 THEN 98309790 Y$=" "9800 B2=19810 DIM Y2(1)9820 Y2=19830 A3=LEN(Y$)+59840 WRITE @33:A3,B2,Y$,Y29850 IF LEN(Z$)>20 THEN 99009860 Z$=" "9870 B3=19880 DIM Y3(1)9890 Y3=19900 A3=LEN(Z$)+59910 WRITE @33:A3,B3,Z$,Y39920 CLOSE @33:9930 RETURN 10000 REM*** 468 SRQ HANDLER ***10010 POLL A1,A2;J510020 IF A2<>65 THEN 1006010030 PRINT "

	POWER ON SRQ COMPLETE"10040 J4=110050 RETURN 10060 IF A2<>195 THEN 1009010070 REM*** TRANSMIT SRQ RETURN TO WHAT OPERATION IN PROCESS ***10080 RETURN 10090 IF A2<>196 THEN 1012010100 REM*** TALK ONLY MODE TRANSMIT SRQ GO ACQUIRE DATA10110 GOSUB 400010120 RETURN 10200 REM*** SUBROUTINE TO ERASE SCREEN ***10210 J4=110220 PAGE 10230 RETURN 10300 REM*** KEEP SRQ ENABLED ***10310 SET KEY 10320 ON SRQ THEN 1000010330 SET KEY 10340 WAIT 10350 GO TO 10300