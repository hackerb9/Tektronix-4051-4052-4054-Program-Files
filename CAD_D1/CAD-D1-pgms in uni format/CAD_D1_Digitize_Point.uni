1 PAGE 2 INIT 3 GO TO 1004 REM***FK1 MOVE OPERATION***5 D=216 RETURN 8 REM***FK2 DRAW OPERATION9 D=2010 RETURN 12 REM***FK3 OUTPUT TO PLOTTER***13 E=114 GOSUB 1615 RETURN 16 REM***FK4 REDISPLAY***17 PAGE 18 GOSUB 400019 RETURN 20 REM***FK5 SAVE TO INTERNAL TAPE DRIVE***21 GOSUB 450022 RETURN 24 REM***FK6 OUTPUT TO SCREEN***25 E=3226 GOSUB 1627 RETURN 28 REM***FK7 DRAW IN GRIDS***29 GOSUB 500030 RETURN 32 REM***FK8 END DIGITIZE***33 GOSUB 200034 GO TO 115036 REM***FK9 WINDOWING***37 GOSUB 550038 RETURN 40 REM***FK10 RESTART***41 GO TO 142 RETURN 44 REM***FK11 DELETE LINE***45 GOSUB 600046 RETURN 48 REM***FK12 SAVE TO DISC***49 GOSUB 650050 RETURN 52 REM***FK13 REDISPLAY FROM TAPE FILE***53 GOSUB 700055 RETURN 56 REM***FK14 REDISPLAY FROM DISC FILE***57 GOSUB 750059 RETURN 60 REM***FK15 SAVE PICTURE IN FORM FOR USE BY DRAFTING***61 GOSUB 820062 RETURN 64 REM***INIT Z7***65 Z7=Z66 RETURN 68 GOSUB 900069 RETURN 76 REM***FK 19 RESTORE ORIGINAL WINDOW77 WINDOW Z(1),Z(2),Z(3),Z(4)78 GOSUB 2479 RETURN 80 REM***FK 20 CONTINUE PRESENT DRAWING***81 GOSUB 2483 D=2184 GO TO 113099 REM *** 52/07-9547/0  POINT MODE DIGITIZE ***100 D=21110 E=32120 F=0130 DIM X(1500,3),Y(4,2),Z(4),Z7(4)140 X=0150 Y=0160 G=8170 Z=0175 R6=1180 SET DEGREES 190 SET KEY 200 SET CASE 320 PRINT "
HOLD IN ORIGIN BUTTON AND PRESS PEN AT LOWER"330 PRINT "     LEFT HAND CORNER OF PAPER. THEN RELEASE"340 PRINT "     ORIGIN BUTTON AND LIFT PEN. WHEN COMPLETE"350 PRINT "     PRESS /RETURN/ TO CONTINUE."360 INPUT A$370 INPUT @G:A,B,C$380 PAGE 390 PRINT "
	******** INSTRUCTIONS ********"400 PRINT "
PRESS PEN AT UPPER LEFT CORNER OF PAPER "410 INPUT @G:Y(1,1),Y(1,2),A$420 FOR K=1 TO 500430 NEXT K440 PRINT "
PRESS PEN AT LOWER LEFT CORNER OF PAPER "450 INPUT @G:Y(2,1),Y(2,2),A$460 FOR K=1 TO 500470 NEXT K480 PRINT "
PRESS PEN AT LOWER RIGHT CORNER OF PAPER "490 INPUT @G:Y(3,1),Y(3,2),A$500 FOR K=1 TO 500510 NEXT K520 PRINT "
PRESS PEN AT UPPER RIGHT CORNER OF PAPER "530 INPUT @G:Y(4,1),Y(4,2),A$540 H=(Y(1,2)-Y(2,2))^2+(Y(1,1)-Y(2,1))^2550 H=H^0.5560 L=(Y(2,2)-Y(3,2))^2+(Y(2,1)-Y(3,1))^2570 L=L^0.5580 M=(Y(1,2)-Y(3,2))^2+(Y(1,1)-Y(3,1))^2590 M=M^0.5600 P=ACS(H/M)+ACS(L/M)610 IF P<=92.5 AND P=>87.5 THEN 690620 PAGE 630 PRINT "

POINTS ENTERED FOR CORNERS SHOULD"640 PRINT "     FORM APPROXIMATELY RIGHT ANGLES"650 PRINT "

	***** TRY AGAIN *****"660 PRINT "

	      PRESS /RETURN/ TO CONTINUE";670 INPUT A$680 GO TO 380690 REM*** CALCULATING SKEW CORRECTION***700 A8=ATN((Y(2,2)-Y(3,2))/(Y(2,1)-Y(3,1)))710 IF A8>0 THEN 730720 A8=A8+360730 K1=COS(A8)740 K2=SIN(A8)750 REM***APPLY SKEW CORRECTION TO WINDOW***760 FOR L=1 TO 4770 X6=(Y(L,1)-Y(2,1))*K1+(Y(L,2)-Y(2,2))*K2780 Y(L,2)=(Y(L,2)-Y(2,2))*K1-(Y(L,1)-Y(2,1))*K2790 Y(L,1)=X6800 NEXT L810 REM***DETERMINE PROPER WINDOW***820 W=5000830 W1=-5000840 W2=5000850 W3=-5000860 FOR L=1 TO 4870 W=W MIN Y(L,1)880 W1=W1 MAX Y(L,1)890 W2=W2 MIN Y(L,2)900 W3=W3 MAX Y(L,2)910 NEXT L920 IF (W1-W)*(10/13)<=W3-W2 THEN 950930 W3=W2+(W1-W)*(10/13)940 GO TO 960950 W1=W+(W3-W2)*(13/10)960 Z(1)=W970 Z(2)=W1980 Z(3)=W2990 Z(4)=W3995 Z7=Z1000 DELETE 210,3101010 DELETE Y,W,W1,W2,W3,K,H,L,M,P,A,B,X6,C$1020 A=MEMORY1030 WINDOW Z(1),Z(2),Z(3),Z(4)1040 PAGE 1050 REM***INPUT OF MOVE/DRAW POINTS***1051 PRINT "PRESS UDK 1 FOR MOVE "1052 PRINT "PRESS UDK 2 FOR DRAW "1053 PRINT "PRESS UDK 8 FOR END, THEN INPUT 1 MORE POINT "1060 I=11065 F0=01070 INPUT @G:A,B,C$1075 IF F0 THEN 10651080 X(I,3)=D1090 X6=(A-Z(1))*K1+(B-Z(3))*K21100 X(I,2)=(B-Z(3))*K1-(A-Z(1))*K21110 X(I,1)=X61120 DRAW @E,X(I,3):X(I,1),X(I,2)1130 I=I+11140 IF I<1500 THEN 10701150 PAGE 1160 PRINT "

MAX NUMBER OF POINTS HAVE BEEN ENTERED"1170 PRINT "
	PRESS FUNCTION KEY #4 TO REDISPLAY DIAGRAM"1180 PRINT "
	PRESS FUNCTION KEY #5 TO SAVE TO INTERNAL TAPE DRIVE"1190 PRINT "
	PRESS FUNCTION KEY #12 TO SAVE TO DISC"1200 END 2000 IF R6=0 THEN 20202010 I=I-12020 F=12030 RETURN 4000 REM***REDISPLAY SUBROUTINE***4010 FOR J=1 TO I4020 DRAW @E,X(J,3):X(J,1),X(J,2)4030 NEXT J4040 RETURN 4500 REM***SAVE TO INTERNAL TAPE DRIVE SUBROUTINE***4510 PAGE 4520 PRINT "

ENTER FILE# TO WHICH YOU WISH TO SAVE DATA ";4530 INPUT L4540 SET NOKEY 4550 PRINT @33,0:0,0,14560 FIND L4570 INPUT @33:A$4580 PRINT @33,0:0,0,04590 SET KEY 4600 FIND L4610 L1=POS(A$,"NEW     ",1)4620 IF L1<>0 THEN 47104630 PRINT "

FILE #";L;" CONTAINS EITHER A PROGRAM OR"4640 PRINT "     DATA. SAVING TO THIS FILE WILL DESTROY"4650 PRINT "     WHAT IS THERE NOW!"4660 PRINT "
DO YOU STILL WISH TO SAVE DATA TO FILE #";L4670 PRINT "     ENTER (YES OR NO) ";4680 INPUT B$4690 IF ASC(B$)=89 OR ASC(B$)=121 THEN 47104700 GO TO 45204710 PRINT @33:I;Z;X;4720 PRINT "


	***** DONE *****"4730 RETURN 5000 REM***DRAW IN GRID ROUTINE***5010 G1=INT(ABS(Z7(1)-Z7(2))/13)5020 G2=INT(ABS(Z7(3)-Z7(4))/10)5030 FOR L=1 TO 135040 MOVE @E:Z7(1)+L*G1,Z7(3)5050 DRAW @E:Z7(1)+L*G1,Z7(4)5055 IF L>12 THEN 50705060 PRINT @E:"";G1*L+INT(Z7(1))5070 NEXT L5080 FOR L=1 TO 105090 MOVE @E:Z7(1),Z7(3)+L*G25100 DRAW @E:Z7(2),Z7(3)+L*G25105 IF L>9 THEN 51205110 PRINT @E:"";G2*L+INT(Z7(3))5120 NEXT L5130 RETURN 5500 REM***CHANGE WINDOW SUBROUTINE***5510 PAGE 5530 PRINT "

DISPLAY WINDOW IS ";Z5540 PRINT "     ENTER 4 VALUES FOR NEW WINDOW ";5550 INPUT Z75555 WINDOW Z7(1),Z7(2),Z7(3),Z7(4)5560 GOSUB 245580 RETURN 6000 REM***DELETE LINE SUBROUTINE***6010 R6=06020 GOSUB 246030 PRINT "PRESS PEN ON LINE YOU WISH TO REMOVE "6040 INPUT @G:X2,Y2,G$6050 X3=X2-106060 Y3=Y2-106070 X2=X2+106080 Y2=Y2+106090 FOR K=1 TO 16100 FOR J=1 TO I-16110 IF X(J+1,3)<>20 THEN 62606120 X4=X(J,1) MAX X(J+1,1)6130 X5=X(J,1) MIN X(J+1,1)6140 Y4=X(J,2) MAX X(J+1,2)6150 Y5=X(J,2) MIN X(J+1,2)6160 IF X4<X3 OR X5>X2 OR Y4<Y3 OR Y5>Y2 THEN 62606170 A1=(X(J,2)-X(J+1,2))/(X(J,1)-X(J+1,1))6180 A2=(X(J,2)-Y3)/(X(J,1)-X3)6190 A3=(X(J,2)-Y2)/(X(J,1)-X2)6200 IF A1>A2 MAX A3 OR A1<A2 MIN A3 THEN 62606210 X(J+1,3)=216215 PAGE 6220 GOSUB 246240 R6=16250 GO TO 62706260 NEXT J6270 NEXT K6280 DELETE A1,A2,A3,X2,X3,X4,X5,Y2,Y3,Y4,Y56290 IF R6=1 THEN 63206300 PRINT "
LINE NOT FOUND TRY AGAIN"6310 GO TO 60306320 RETURN 6500 REM***SAVE TO DISC***6510 GOSUB 81006520 CALL "MOUNT",0,A$6530 CALL "FILE",0,B$,A$6540 IF A$="" THEN 65906550 PRINT "

 FILE ";B$;" ALREADY EXIST. RENAME FILE."6560 CALL "WAIT",56570 GOSUB 81006580 GO TO 65206590 CREATE B$,"AU";1500*3*8+5*8+256,06600 OPEN B$;1,"F",A$6610 SET NOKEY 6620 PRINT #1:I;Z;X;6625 CLOSE 6630 SET KEY 6640 PRINT "

	DONE"6650 RETURN 7000 REM***REDISPLAY FROM INTERNAL TAPE FILE***7010 PAGE 7020 PRINT "
ENTER FILE NUMBER CONTAINING DATA TO BE DISPLAYED ";7030 INPUT A17040 FIND A17050 INPUT @33:I,Z,X7060 WINDOW Z(1),Z(2),Z(3),Z(4)7070 PAGE 7080 GOSUB 247100 RETURN 7500 REM***REDISPLAY FROM DISC FILE***7510 GOSUB 81007520 OPEN B$;1,"R",A$7530 INPUT #1:I,Z,X7535 CLOSE 7540 WINDOW Z(1),Z(2),Z(3),Z(4)7550 PAGE 7560 GOSUB 247570 RETURN 8000 REM***CHECK CORRECTNESS OF DISC FILE NAME***8010 SET CASE 8020 FOR L=1 TO LEN(B$)8030 Z$=SEG(B$,L,1)8040 IF L=1 AND (Z$<"A" OR Z$>"Z") THEN 80608050 IF Z$=>"A" AND Z$<="Z" OR (Z$=>"0" AND Z$<="9") THEN 80808060 P=18070 L=LEN(B$)8080 NEXT L8090 RETURN 8100 REM***ENTER FILE NAME***8110 PAGE 8120 P=08130 PRINT "

ENTER FILE NAME: __________";8140 INPUT B$8150 GOSUB 80008160 IF P=0 AND LEN(B$)<11 THEN 81908170 PRI "
ERROR IN FILE NAME DO NOT USE SPACES OR SPECIAL CHARACTERS"8175 CALL "WAIT",3.58180 GO TO 81008190 RETURN 8200 REM***SAVE PICTURE IN FORM FOR USE BY DRAFTING PROG***8210 GOSUB 81008220 B$=B$&"/PDB"8230 B$="@"&B$8240 CALL "MOUNT",0,A$8250 CALL "FILE",0,B$,A$8260 IF A$="" THEN 83208270 P=POS(B$,"/",1)-18280 A$=SEG(B$,2,P)8290 PRINT "

 FILE ";A$;" ALREADY EXIST. RENAME FILE."8300 CALL "WAIT",38310 GO TO 82108320 SET NOKEY 8330 CREATE B$,"U";2,4108340 OPEN B$;1,"F",A$8350 WRITE #1,1:I+18360 WRITE #1,2:"   "8370 K=28380 FOR J=2 TO I8390 IF X(J,3)=21 THEN 84208400 WRITE #1,K:1,1,0,X(J-1,1),X(J-1,2),X(J,1),X(J,2)8410 K=K+18420 NEXT J8430 WRITE #1,1:K-28440 CLOSE 8450 SET KEY 8460 PRINT "

	 *** DONE ***"8470 CALL "WAIT",28480 RETURN 9000 REM delete routine9005 F0=19010 I=I-19020 X(I,3)=219030 D=219040 GOSUB 249050 RETURN 