100 REM---PHONE COMPANY CABLE LAYOUT PROGRAM110 REM---UTILITY PROGRAM NUMBER 2120 REM---VERSION OF MAY 11, 1979  LEN OLSON (CONNIE)130 REM---140 REM---150 REM---CREATES A MASTER PARTS LIST, AND PROCESSES LISTS160 REM---FOR INDIVIDUAL STAKING SHEETS.170 REM---NOTE: PROGRAM ASSUMES PEDESTALS ARE CONSECUTIVELY NUMBERED180 REM *****190 REM ***** CONFIGURATION200 REM *****210 INIT 220 PAGE 230 FOR I1=1 TO 3240 PRINT @32,21:0,0250 PRINT @32,20:130,0,130,100,0,100,0,0260 PRINT @32,21:2.5,2.5270 PRINT @32,20:127.5,2.5,127.5,97.5,2.5,97.5,2.5,2.5280 PRINT @32,21:5,5290 PRINT @32,20:125,5,125,95,5,95,5,5300 NEXT I1310 MOVE 22,70320 PRINT "G. J.  O R P H A N   &   A S S O C I A T E S"330 MOVE 22,65340 PRINT "CONSULTING                         ENGINEERS"350 MOVE 45,50360 PRINT "CABLE LAYOUT PROGRAM"370 MOVE 45,35380 PRINT "**** ENTRY TASK ****"390 FOR I1=1 TO 750400 NEXT I1410 PAGE 420 D1=0430 D0=1440 M$=CHR(13)450 CALL "time",A$460 IF LEN(A$)>0 THEN 500470 PRINT "Enter the Date and Time (DD-MMM-YY HH:MM:SS): ";480 INPUT A$490 CALL "Settime",A$500 PRINT "
How many Disks are there in your System? ";510 INPUT J1520 IF J1=2 THEN 590530 IF J1<>1 THEN 500540 PRINT "
Insert the Floppy Disk into the Disk Unit.  Type <CR> ";550 PRINT "to continue. ";560 INPUT Z$570 CALL "MOUNT",0,Z$580 GO TO 670590 PRINT "
Insert the System Disk in Disk Unit #1 and the Job Disk "600 PRINT "in Disk Unit #0.  Type <CR> to continue. ";610 INPUT Z$620 CALL "MOUNT",0,Z$630 CALL "MOUNT",1,Z$640 REM *****650 REM ***** MASTER PARTS LIST660 REM *****670 PRINT "

"680 CALL "FILE",D1,"@MASTERLIST",B$690 IF B$="" THEN 900700 PRINT "
Do you want to add to the Master Parts List: ";710 INPUT A$720 PRINT "
"730 IF A$="N" THEN 770740 IF A$="Y" THEN 850750 PRINT "Please answer 'YES' or 'No'!
"760 GO TO 700770 PRINT "The following are the available Part Names:
"780 I5=1790 OPEN "@MASTERLIST";2,"F",B$800 READ #2,80:I1810 GOSUB 1510820 PRINT "

Type <CR> to continue. ";830 INPUT Z$840 GO TO 1610850 CLOSE 2860 OPEN "@MASTERLIST";2,"F",B$870 READ #2,80:I1880 I0=I1+1890 GO TO 990900 CREATE "@MASTERLIST","U";80,36910 OPEN "@MASTERLIST";2,"F",B$920 A8=80930 A9=31940 PRINT "
Space is being reserved for the Master Parts List!"950 GOSUB 8300960 WRITE #2,1:"BM70"970 WRITE #2,80:1980 I0=2990 I1=761000 IF I0=76 THEN 12501010 PRINT "Enter the Part Names for the Master Parts List:"1020 PRINT "(type <CR> to end input)
"1030 FOR I=I0 TO 761040 IF I>2 THEN 10601050 PRINT "  Part Name #1: BM70"1060 PRINT "  Part Name #";I;": ";1070 INPUT A$1080 IF LEN(A$)=0 THEN 12701090 IF LEN(A$)<30 THEN 11201100 PRINT "  A maximum of 29 characters is allowed!
"1110 GO TO 10601120 J1=01130 FOR I3=1 TO I-11140 READ #2,I3:Z$1150 IF Z$<>A$ THEN 11801160 J1=11170 I3=I-11180 NEXT I31190 IF J1=0 THEN 12301200 PRINT "  Part Name ";A$;" already is stored in the Master Parts ";1210 PRINT "List!
"1220 GO TO 10601230 WRITE #2,I:A$1240 NEXT I1250 PRINT "  Only 76 Part Names are allowed; all are specified!"1260 GO TO 14601270 IF I0<>I THEN 12901280 GO TO 14001290 PRINT "The following are the Part Names just entered: 
"1300 I5=I01310 I1=I-11320 GOSUB 15101330 PRINT "
Are all Part Names correct? ";1340 INPUT Z$1350 Z$=SEG(Z$,1,1)1360 IF Z$="Y" THEN 14001370 IF Z$<>"N" THEN 13301380 PAGE 1390 GO TO 9901400 I1=I-11410 WRITE #2,80:I11420 IF I1>1 THEN 14601430 PRINT "

The Master Parts List is empty except for Part 'BM70'!"1440 PRINT "
"1450 GO TO 8501460 PAGE 1470 PRINT "There are ";I1;" entries altogether, including 'BM70'. 
"1480 I5=11490 GOSUB 15101500 GO TO 15601510 FOR I6=I5 TO I11520 READ #2,I6:A$1530 PRINT A$1540 NEXT I61550 RETURN 1560 PRINT "

Type <CR> to continue. ";1570 INPUT A$1580 REM *****1590 REM ***** MASTER CABLE LIST1600 REM *****1610 CLOSE 21620 PAGE 1630 CALL "FILE",D1,"@CABLELIST",B$1640 IF B$="" THEN 18601650 PRINT "
Do you want to add to the Master Cable List: ";1660 INPUT A$1670 IF A$="N" THEN 17001680 IF A$="Y" THEN 18101690 PRINT "Please answer 'YES' or 'NO'!J"1700 PRINT "The following are the present Cable Types or Units:
"1710 K5=11720 CLOSE 21730 OPEN "@CABLELIST";2,"F",B$1740 READ #2,80:K11750 GOSUB 24501760 CLOSE 21770 PRINT "

Type <CR> to continue. ";1780 INPUT Z$1790 GO TO 25501800 GO TO 16501810 CLOSE 21820 OPEN "@CABLELIST";2,"F",B$1830 READ #2,80:K11840 K0=K1+11850 GO TO 19301860 CREATE "@CABLELIST","U";80,361870 OPEN "@CABLELIST";2,"F",B$1880 A8=801890 A9=311900 PRINT "
Space is being reserved for the Master Cable List!"1910 GOSUB 83001920 K0=11930 K1=761940 IF K0=76 THEN 21801950 PRINT "

Enter the Cable Types for the Master Cable List: "1960 PRINT "(type <CR> to end input)
"1970 FOR I=K0 TO 761980 PRINT "  Cable Type or Unit #";I;": ";1990 INPUT A$2000 IF LEN(A$)=0 THEN 22102010 IF LEN(A$)<30 THEN 20402020 PRINT "  A maximum of 29 characters is allowed!
"2030 GO TO 19802040 J1=02050 IF I<=1 THEN 21602060 FOR I3=1 TO I-12070 READ #2,I3:Z$2080 IF Z$<>A$ THEN 21102090 J1=12100 I3=I-12110 NEXT I32120 IF J1=0 THEN 21602130 PRINT "  ";A$;" already is stored in the Master ";2140 PRINT "Cable List!
"2150 GO TO 19802160 WRITE #2,I:A$2170 NEXT I2180 PRINT "  Only 76 Cable Types or Units are allowed; ";2190 PRINT "all are specified!
"2200 GO TO 24002210 IF K0<>I THEN 22302220 GO TO 23502230 PRINT "The following are the Cable Types or Units just ";2240 PRINT "entered:
"2250 K5=K02260 K1=I-12270 GOSUB 24502280 PRINT "

Are all Cable Types or Units correct? ";2290 INPUT Z$2300 Z$=SEG(Z$,1,1)2310 IF Z$="Y" THEN 23502320 IF Z$<>"N" THEN 22802330 PAGE 2340 GO TO 19302350 K1=I-12360 WRITE #2,80:K12370 IF K1<>0 THEN 24002380 PRINT "

The Master Cable List is empty!
"2390 GO TO 18102400 PAGE 2410 PRINT "There are ";K1;" entries altogether.
"2420 K5=12430 GOSUB 24502440 GO TO 25002450 FOR I6=K5 TO K12460 READ #2,I6:A$2470 PRINT A$2480 NEXT I62490 RETURN 2500 PRINT "


To continue, type <CR>. ";2510 INPUT A$2520 REM *****2530 REM ***** CUSTOMER CODE AND SHEET NUMBER2540 REM *****2550 CLOSE 22560 PRINT "Staking Sheet Information:
"2570 PRINT "
Indicate the Job or Customer Code for this job?"2580 PRINT "(type <CR> to end Task)                         ";2590 INPUT J$2600 PRINT "
"2610 IF LEN(J$)<>0 THEN 26402620 PRINT "


Early ending of this Task!"2630 END 2640 Y$=J$2650 IF LEN(J$)<=12 THEN 26802660 PRINT "Customer Code must be 12 or less characters in length!"2670 GO TO 25702680 B$=SEG(J$,1,1)2690 IF B$=>"A" AND B$<="Z" THEN 27212700 PRINT "The first character of the Customer Code must be ";2710 PRINT "Alphabetic!"2720 GO TO 25702721 G$="@"&J$2722 G$=G$&"/SHEETS"2723 CALL "FILE",D1,G$,B$2724 IF B$="" THEN 27392725 CLOSE 22726 OPEN G$;2,"F",B$2727 READ #2,1:C42728 PRINT "
Existing Sheet Numbers for Customer Code ";J$;" are:
"2729 FOR I1=2 TO C4+12730 READ #2,I1:N$2731 PRINT "  ";N$2732 NEXT I12733 PRINT "
"2734 CLOSE 22739 PRINT "
Indicate the Sheet or Page Number: ";2740 INPUT V$2750 IF LEN(V$)<>3 THEN 27902760 FOR I3=1 TO 32770 B$=SEG(V$,I3,1)2780 IF B$=>"0" AND B$<="9" THEN 28102790 PRINT "The Sheet Number must be 3 numeric digits."2800 GO TO 27302810 NEXT I32820 REM *****2830 REM ***** IF 'SHEETS' FILE DOESN'T EXIST, CREATE IT2840 REM ***** CHECK IF GIVEN SHEET NUMBER IS IN THE FILE, IF NOT,2850 REM *****   STORE IT2860 REM *****2870 B$="@"&J$2880 B$=B$&"/SHEETS"2890 CALL "FILE",D1,B$,Z$2900 IF Z$="" THEN 31402910 OPEN B$;2,"F",Z$2920 READ #2,1:Z32930 IF Z3=0 THEN 30302940 J2=02950 FOR J1=2 TO Z3+12960 READ #2,J1:Z$2970 IF Z$<>V$ THEN 30102980 Q7=J12990 J1=Z3+13000 J2=13010 NEXT J13020 IF J2=1 THEN 33403030 PRINT "
Space will now be reserved for Customer Code ";Y$;","3040 PRINT "Sheet ";V$;".  Okay? ";3050 INPUT Z$3060 Z$=SEG(Z$,1,1)3070 IF Z$="N" THEN 25503080 IF Z$="Y" THEN 31003090 GO TO 30303100 WRITE #2,Z3+2:V$3110 Q7=Z3+23120 WRITE #2,1:Z3+13130 GO TO 33403140 PRINT "
Space will now be reserved for Customer Code ";Y$;","3150 PRINT "Sheet ";V$;".  Okay? ";3160 INPUT Z$3170 Z$=SEG(Z$,1,1)3180 IF Z$="N" THEN 25503190 IF Z$="Y" THEN 32103200 GO TO 31303210 CREATE B$,"U";80,143220 OPEN B$;2,"F",Z$3230 A8=803240 A9=93250 GOSUB 83003260 WRITE #2,1:03270 WRITE #2,80:03280 Z3=03290 GO TO 31003300 REM *****3310 REM ***** CREATE THE 'PEDS', 'CABLES', 'SUMPARTS', AND THE3320 REM *****   'SUMCABLE' FILE IF THEY DON'T ALREADY EXIST3330 REM *****3340 CLOSE 23350 L$="@"&J$3360 L$=L$&"/S"3370 L$=L$&V$3380 O$=L$&"/PL/SUMCABLE"3390 P$=L$&"/PL/SUMPARTS"3400 N$=L$&"/PL/CABLES"3410 L$=L$&"/PL/PEDS"3420 CALL "FILE",D1,L$,Z$3430 IF Z$<>"" THEN 35303440 CREATE L$,"U";80,143450 OPEN L$;2,"F",Z$3460 A8=803470 A9=93480 GOSUB 83003490 FOR I4=1 TO 803500 WRITE #2,I4:03510 NEXT I43520 CLOSE 23530 CALL "FILE",D1,N$,Z$3540 IF Z$<>"" THEN 36803550 CREATE N$,"U";80,243560 OPEN N$;2,"F",Z$3570 A8=803580 A9=183590 GOSUB 83003600 FOR I4=1 TO 763610 WRITE #2,I4:0,03620 NEXT I43630 WRITE #2,77:" "3640 WRITE #2,78:" "3650 WRITE #2,79:03660 WRITE #2,80:03670 CLOSE 23680 CALL "FILE",D1,P$,Z$3690 IF Z$<>"" THEN 37903700 CREATE P$,"U";80,143710 OPEN P$;2,"F",Z$3720 A8=803730 A9=93740 GOSUB 83003750 FOR I4=1 TO 803760 WRITE #2,I4:03770 NEXT I43780 CLOSE 23790 CALL "FILE",D1,O$,Z$3800 IF Z$<>"" THEN 39003810 CREATE O$,"U";80,243820 OPEN O$;2,"F",Z$3830 A8=803840 A9=183850 GOSUB 83003860 FOR I4=1 TO 803870 WRITE #2,I4:0,03880 NEXT I43890 CLOSE 23900 OPEN L$;5,"F",Z$3910 OPEN N$;6,"F",Z$3920 OPEN P$;7,"F",Z$3930 OPEN O$;8,"F",Z$3940 OPEN "@MASTERLIST";3,"F",Z$3950 OPEN "@CABLELIST";4,"F",Z$3960 GO TO 40003970 REM *****3980 REM ***** PEDESTAL INFORMATION3990 REM *****4000 L$=J$&"/S"4010 D$=J$4020 L$=L$&V$4030 L$=L$&"/PL"4040 CALL "USERLIB",L$4050 PAGE 4060 READ #5,1:Q04070 IF Q0=0 THEN 41404080 PRINT "Existing Pedestal Names are:"4090 FOR I4=2 TO Q0+14100 READ #5,I4:C$4110 PRINT "  ";C$4120 NEXT I44130 PRINT "
"4140 PRINT "
Indicate desired Pedestal Number (type <CR> to end ";4150 PRINT "input): ";4160 CLOSE 24170 INPUT O$4180 IF LEN(O$)=0 THEN 54204190 M$=SEG(O$,1,1)4200 IF M$=>"0" AND M$<="9" THEN 42304210 PRINT "First character of the Pedestal Number must be numeric!"4220 GO TO 40604230 IF LEN(O$)<=3 THEN 42604240 PRINT "Pedestal Number must be 3 or less characters!"4250 GO TO 40604260 IF Q0=0 THEN 43504270 J1=04280 FOR I4=2 TO Q0+14290 READ #5,I4:C$4300 IF C$<>O$ THEN 43204310 J1=14320 I4=Q0+14330 NEXT I44340 IF J1=1 THEN 43504350 F$="PED"&O$4360 REM *****4370 REM ***** IF 'PED' FILE DOESN'T EXIST, CREATE IT4380 REM *****4390 READ #5,1:B14400 J1=04410 IF B1=0 THEN 44904420 FOR I4=2 TO B1+14430 READ #5,I4:B$4440 IF B$<>O$ THEN 44704450 J1=14460 I4=B1+14470 NEXT I44480 IF J1=1 THEN 45604490 PRINT "
Space will now be reserved for Pedestal ";O$;".  Okay? ";4500 INPUT Z$4510 Z$=SEG(Z$,1,1)4520 IF Z$="N" THEN 40604530 IF Z$="Y" THEN 45504540 GO TO 44904550 WRITE #5,B1+2:O$4560 CALL "FILE",D1,F$,B$4570 V5=14580 IF B$<>"" THEN 48104590 GO TO 46604600 PRINT "
Space will now be reserved for Pedestal ";O$;".  Okay? ";4610 INPUT Z$4620 Z$=SEG(Z$,1,1)4630 IF Z$="N" THEN 40604640 IF Z$<>"Y" THEN 46604650 GO TO 46004660 WRITE #5,1:B1+14670 CREATE F$,"U";80,144680 V5=04690 CLOSE 24700 OPEN F$;2,"F",B$4710 A8=804720 A9=94730 GOSUB 83004740 FOR I=1 TO 804750 WRITE #2,I:04760 NEXT I4770 GO TO 48604780 REM *****4790 REM ***** THE 'PED' FILE ALREADY EXISTS, SO IT WILL BE EDITTED4800 REM *****4810 PRINT "

Information for Pedestal ";O$;" already exists; it can ";4820 PRINT "be changed.

"4830 CLOSE 24840 OPEN F$;2,"F",A$4850 IF V5=0 THEN 48604860 READ #2,79:Q14870 IF V5=0 THEN 49104880 READ #2,79:M94890 PRINT "
Meter Reading is presently ";M9;".  This can be changed."4900 IF V5=1 THEN 49204910 PRINT "
"4920 PRINT "Indicate Meter Reading for Pedestal ";O$;": ";4930 INPUT M94940 PAGE 4950 WRITE #2,79:M94960 IF V5=0 THEN 49804970 GO TO 50004980 PRINT "
"4990 GO TO 51005000 READ #3,80:I95010 PRINT "
The presently indicated Part Names and quantities are:
"5020 FOR I8=1 TO I95030 READ #2,I8:I75040 IF I7=0 THEN 50705050 READ #3,I8:C$5060 PRINT "  ";C$;" - ";I75070 NEXT I85080 PRINT "
These can be changed, or they can be deleted by typing ";5090 PRINT "'0' for          it's Quantity.
"5100 PRINT "
Indicate a Designation Standard:"5110 PRINT "(type <CR> to end input):        ";5120 INPUT P$5130 PRINT "
"5140 IF LEN(P$)=0 THEN 53405150 READ #3,80:I15160 FOR I=1 TO I15170 READ #3,I:A$5180 IF A$=P$ THEN 52405190 NEXT I5200 PRINT P$;" isn't in the Master Parts List!"5210 GO TO 51005220 REM--A HIT5230 PRINT "The presently indicated Part Names are: "5240 READ #2,I:Q15250 IF Q1=0 THEN 52605260 PRINT "Indicate quantity: ";5270 INPUT Q05280 READ #2,I:Q25290 WRITE #2,I:Q05300 READ #7,I:Q85310 WRITE #7,I:Q8-Q2+Q05320 GO TO 51005330 I6=05340 READ #2,1:A15350 IF A1<>0 THEN 40505360 PRINT "BM70 has not yet been entered for this pedestal!  ";5370 PRINT "Please do so."5380 GO TO 51005390 REM *****5400 REM ***** CABLE TYPES & ADJOINING  PEDESTALS5410 REM *****5420 PAGE 5430 CLOSE 15440 READ #6,1:Q05450 IF Q0=0 THEN 55105460 PRINT "Existing Cable Names are:"5470 FOR I4=2 TO Q0+15480 READ #6,I4:C$5490 PRINT "  ";C$5500 NEXT I45510 PRINT "
Indicate desired Cable Name (type <CR> to end input): ";5520 INPUT N$5530 IF LEN(N$)=0 THEN 82105540 IF LEN(N$)<>0 AND LEN(N$)<=3 THEN 55705550 PRINT "Cable Name must be 3 characters or less!"5560 GO TO 54305570 IF Q0=0 THEN 56605580 J1=05590 FOR I4=2 TO Q0+15600 READ #6,I4:C$5610 IF C$<>N$ THEN 56305620 J1=15630 I4=Q0+15640 NEXT I45650 IF J1=1 THEN 57305660 PRINT "
Space will now be reserved for Cable Name ";N$;".  ";5670 PRINT "Okay? ";5680 INPUT Z$5690 Z$=SEG(Z$,1,1)5700 IF Z$="N" THEN 54405710 IF Z$="Y" THEN 57305720 GO TO 56605730 E$="CABLE"&N$5740 T0=05750 REM *****5760 REM ***** CHECK IF 'CABLE' FILE EXISTS, IF NOT CREATE IT5770 REM *****5780 READ #6,1:Q05790 IF Q0=0 THEN 58805800 J1=05810 FOR I4=2 TO Q0+15820 READ #6,I4:C$5830 IF C$<>N$ THEN 58605840 J1=15850 I4=Q0+15860 NEXT I45870 IF J1=1 THEN 59005880 WRITE #6,1:Q0+15890 WRITE #6,Q0+2:N$5900 CALL "FILE",D1,E$,B$5910 IF B$<>"" THEN 60205920 CLOSE 15930 CREATE E$,"U";80,245940 OPEN E$;1,"F",Z$5950 P0=15960 A8=805970 A9=185980 GOSUB 84005990 FOR I4=1 TO 806000 WRITE #1,I4:0,06010 NEXT I46020 CLOSE 16030 OPEN E$;1,"F",Z$6040 IF B$<>"" THEN 69106050 GOSUB 60706060 GO TO 63006070 PRINT "
Indicate adjoining Pedestal Numbers, typing a <CR> ";6080 PRINT "after each Number."6090 PRINT "*OR* Type a <CR> to get a list of defined Pedestal Numbers."6100 INPUT N$6110 IF LEN(N$)=0 THEN 62306120 Z$=N$6130 GOSUB 85106140 IF J1=0 THEN 60706150 INPUT M$6160 Z$=M$6170 GOSUB 85106180 IF J1=0 THEN 60706190 IF LEN(M$)=0 THEN 60706200 IF N$<>M$ THEN 62906210 PRINT "Pedestal Names can not be the same!"6220 GO TO 60706230 READ #5,1:A06240 FOR I0=2 TO A0+16250 READ #5,I0:A$6260 PRINT A$6270 NEXT I06280 GO TO 60706290 RETURN 6300 WRITE #1,77:N$6310 WRITE #1,78:M$6320 WRITE #1,79:06330 WRITE #1,80:06340 PRINT "
How much In-Line Trenching? ";6350 INPUT C36360 READ #1,79:C06370 WRITE #1,79:C36380 READ #8,79:C46390 WRITE #8,79:C4-C0+C36400 GOSUB 86306410 PAGE 6420 PRINT "
Indicate Cable Type: "6430 PRINT "(type <CR> to end input)";6440 INPUT N$6450 IF LEN(N$)=0 THEN 66706460 PRINT "
"6470 GOSUB 64906480 GO TO 65906490 READ #4,80:A06500 J1=06510 FOR I0=1 TO A06520 READ #4,I0:A$6530 IF A$<>N$ THEN 65706540 J1=16550 I9=I06560 I0=A06570 NEXT I06580 RETURN 6590 IF J1=0 THEN 66506600 READ #1,I9:C1,C26610 WRITE #1,I9:T0,C26620 READ #8,I9:C3,C26630 WRITE #8,I9:C3-C1+T0,C26640 GO TO 64206650 PRINT "Cable Type doesn't exist in Master Cable List!"6660 GO TO 64206670 PRINT "


"6680 PRINT "
Indicate Construction Unit: "6690 PRINT "(type <CR> to end input)    ";6700 INPUT N$6710 PRINT "
"6720 IF LEN(N$)=0 THEN 69006730 GOSUB 64906740 IF J1=1 THEN 67806750 PRINT "This Construction Unit doesn't exist in the Master ";6760 PRINT "Cable List!"6770 GO TO 66806780 READ #1,I9:Q06790 IF Q0=0 THEN 68306800 PRINT N$;" is the main Cable Type; it can not be a Construction ";6810 PRINT "Unit! "6820 GO TO 66806830 PRINT "Indicate Length: ";6840 INPUT C36850 READ #1,I9:C5,C86860 WRITE #1,I9:C5,C36870 READ #8,I9:C5,C76880 WRITE #8,I9:C5,C7-C8+C36890 GO TO 66806900 GO TO 54206910 PRINT "
This Cable Name has already been defined.  The infor";6920 PRINT "mation              for Cable ";N$;" can be changed. "6930 READ #1,77:N$6940 READ #1,78:M$6950 READ #1,79:C56960 READ #1,80:C66970 PRINT "
The adjoining Pedestal Names are presently indicated to ";6980 PRINT "be ";N$6990 PRINT "and ";M$;".  Do you want to change them? ";7000 INPUT Z$7010 Z$=SEG(Z$,1,1)7020 IF Z$="N" THEN 70907030 IF Z$="Y" THEN 70507040 GO TO 69707050 GOSUB 60707060 WRITE #1,77:N$7070 WRITE #1,78:M$7080 WRITE #1,79:C57090 READ #1,79:C47100 PRINT "
In-Line Trenching is presently ";C4;".  Do you want to ";7110 PRINT "change this? ";7120 INPUT Z$7130 Z$=SEG(Z$,1,1)7140 IF Z$="N" THEN 72307150 IF Z$="Y" THEN 71707160 GO TO 71007170 PRINT "In-Line Trenching: ";7180 INPUT C37190 READ #1,79:C47200 WRITE #1,79:C37210 READ #8,79:C07220 WRITE #8,79:C0-C4+C37230 GOSUB 86307240 READ #4,80:C47250 FOR I1=1 TO C47260 READ #1,I1:C37270 IF C3=0 THEN 73107280 WRITE #1,I1:T0,07290 READ #8,I1:C7,C87300 WRITE #8,I1:C7-C3+T0,C87310 NEXT I17320 PRINT "Cable Types presently indicated are:
"7330 READ #4,80:C47340 FOR I1=1 TO C47350 READ #1,I1:C37360 IF C3=0 THEN 73907370 READ #4,I1:N$7380 PRINT "  ";N$7390 NEXT I17400 PRINT "
To modify the Cable Types, ALL desired Cable Types must ";7410 PRINT "be indicated."7420 PRINT "Do you want to modify the Cable Types? ";7430 INPUT Z$7440 Z$=SEG(Z$,1,1)7450 IF Z$="N" THEN 78107460 IF Z$="Y" THEN 74807470 GO TO 74207480 PRINT "
"7485 READ #4,80:C47490 FOR I1=1 TO C47500 READ #1,I1:C37510 IF C3=0 THEN 75507520 WRITE #1,I1:0,07530 READ #8,I1:C7,C87540 WRITE #8,I1:C7-C3,C87550 NEXT I17560 PRINT "
Indicate Cable Type:"7570 PRINT "(type <CR> to end input)";7580 INPUT N$7590 IF LEN(N$)=0 THEN 78107600 PRINT "
"7610 J1=07615 READ #4,80:C47620 FOR I1=1 TO C47630 READ #4,I1:M$7640 IF N$<>M$ THEN 76807650 I9=I17660 I1=C47670 J1=17680 NEXT I17690 IF J1=1 THEN 77207700 PRINT "This Cable Type does not exist in the Master Cable List!"7710 GO TO 75607720 READ #1,I9:C1,C27730 IF C2=0 THEN 77707740 PRINT N$;" has been indicated as a Construction Unit with ";7750 PRINT "length ";C27760 PRINT "It will no longer be a Construction Unit!"7770 WRITE #1,I9:T0,07780 READ #8,I9:C3,C47790 WRITE #8,I9:C3-C1+T0,C4-C27800 GO TO 75607810 PRINT "The Construction Units presently indicated are:
"7820 READ #4,80:C37830 FOR I4=1 TO C37840 READ #1,I4:C4,C57850 IF C5=0 THEN 78807860 READ #4,I4:N$7870 PRINT "     ";N$;" - ";C57880 NEXT I47890 PRINT "
A Construction Units can be deleted by indicating ";7900 PRINT "'0' for its"7910 PRINT "Length.  Do you want to modify the Construction ";7920 PRINT "Units?  ";7930 INPUT Z$7940 Z$=SEG(Z$,1,1)7950 IF Z$="N" THEN 82007960 IF Z$="Y" THEN 79807970 GO TO 78907980 PRINT "
Indicate a Construction Unit: "7990 PRINT "(type <CR> to end input)       ";8000 INPUT N$8010 IF LEN(N$)=0 THEN 82008020 PRINT "
"8030 GOSUB 64908040 IF J1=1 THEN 80808050 PRINT "This Construction Operation doesn't exist as a ";8060 PRINT "Cable Type         in the Master Cable List!"8070 GO TO 79808080 READ #1,I9:Q08090 IF Q0=0 THEN 81308100 PRINT N$;" is the main Cable Type; it can not be a Construction ";8110 PRINT "Unit!"8120 GO TO 79808130 PRINT "Indicate Length: ";8140 INPUT C38150 READ #1,I9:C4,C58160 WRITE #1,I9:C4,C38170 READ #8,I9:C4,C88180 WRITE #8,I9:C4,C8-C5+C38190 GO TO 79808200 GO TO 54208210 CLOSE 8220 PRINT "

End of Task!  To get a Summary of Customer Code ";Y$;8230 PRINT ","8240 PRINT "Sheet ";V$;", use the REPORT Task."8250 END 8260 REM *****8270 REM ***** SUBROUTINES8280 REM *****8290 REM ***** SUBROUTINE TO FILL RECORDS WITH BLANKS8300 DELETE D$8310 PRINT "
WORKING!!!
"8320 D$=" "8330 FOR I4=2 TO A98340 D$=D$&" "8350 NEXT I48360 FOR I4=1 TO A88370 WRITE #2,I4:D$8380 NEXT I48390 RETURN 8400 DELETE D$8410 PRINT "
WORKING!!!
"8420 D$=" "8430 FOR I4=2 TO A98440 D$=D$&" "8450 NEXT I48460 FOR I4=1 TO A88470 WRITE #1,I4:D$8480 NEXT I48490 RETURN 8500 REM ***** SUBROUTINE TO CHECK IF Z$ IS A PEDESTAL NAME8510 READ #5,1:A58520 J1=08530 FOR I5=2 TO A5+18540 READ #5,I5:P$8550 IF P$<>Z$ THEN 85808560 J1=18570 I5=A5+18580 NEXT I58590 IF J1=1 THEN 86108600 PRINT Z$;" is not a Pedestal Name!"8610 RETURN 8620 REM ***** SUBROUTINE TO CALCULATE CABLE LENGTH8630 CLOSE 28640 READ #1,77:N$8650 READ #1,78:M$8660 READ #1,79:C58670 Z$="PED"&N$8680 OPEN Z$;2,"R",B$8690 READ #2,1:B18700 READ #2,79:M18710 CLOSE 28720 Z$="PED"&M$8730 OPEN Z$;2,"R",B$8740 READ #2,1:B28750 READ #2,79:M28760 CLOSE 28770 T0=2*8+B1+B2+ABS(M2-M1)+C58780 RETURN 