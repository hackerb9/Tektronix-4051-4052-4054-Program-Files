1 GOSUB 209702 GO TO 1004 GO TO 9005 RETURN 20 CLOSE 121 OPEN T$;1,"F",Z$22 RETURN 24 FIND 125 SAVE 26 RETURN 39 REM ****** SAV PROGRAM ON DRIVE 040 CALL "TIME",Z$41 Q$=SEG(Z$,4,3)42 W$=SEG(Z$,1,2)43 Q$=Q$&W$44 Q$=Q$&"/"45 W$=SEG(Z$,11,2)46 Q$=Q$&"T"47 Q$=Q$&W$48 Q$="@DRAFTING/"&Q$49 CALL "UNIT",050 SAVE Q$51 PRINT Q$;" is stored!"52 END 100 INIT 110 DIM P(2,20),P8(2),H$(257),I$(513),N$(2279)120 DIM E$(1),G$(1),R$(1),W$(15),V$(15),J$(15)130 DIM F$(15),Z$(1),U$(405)140 U$="                                                  "150 U$=U$&U$160 U$=U$&U$170 U$=U$&U$180 U$=U$&"     "190 O2=RND(0)200 IF O2>0.8 THEN 240210 O2=2220 O4=2.85230 GO TO 280240 O2=4250 O4=1.425260 CHARSIZE 2270 PAGE 280 CALL "TIME",Z$290 IF Z$<>"" THEN 330300 PRINT "Indicate Date and Time: ";310 INPUT U$320 CALL "SETTIM",Z$330 PRINT "Insert Program Disk in Drive #0.  ";340 INPUT Z$350 CALL "MOUNT",0,Z$360 CALL "FILE",0,"@TEXT",Z$370 IF Z$="" THEN 330380 CALL "UNIT",0390 OPEN "@TEXT";1,"R",Z$400 READ #1:H$,I$,N$410 CLOSE 1420 APPEND "@DRAFTING/COMPRESS";22600430 PRINT "Insert Working Disk in Drive #0. ";440 INPUT Z$450 CALL "MOUNT",0,U$460 D$=SEG(U$,77,6)470 Z1=VAL(D$)480 IF Z1>50000 THEN 520490 PRINT "This Floppy Disk is nearly full."500 PRINT "Please insert another Working Disk!"510 GO TO 440520 PRINT "Indicate name of desired PDB File: ";530 INPUT B$540 IF LEN(B$)<=13 THEN 560550 B$=SEG(B$,1,13)560 GOSUB 12610570 IF E1<>0 THEN 520580 T$="@"&B$590 T$=T$&"/PDB"600 CALL "UNIT",0610 CALL "FILE",0,T$,Z$620 IF Z$="" THEN 690630 OPEN T$;1,"F",Z$640 READ #1,1:P5650 PRINT "PDB ";B$;" is open for editting!"660 P5=P5+1670 CALL "WAIT",2680 GO TO 770690 CREATE T$,"U";2,410700 OPEN T$;1,"F",D$710 WRITE #1,1:U$720 WRITE #1,2:U$730 WRITE #1,1:0740 PRINT "PDB ";B$;" is created!"750 P5=1760 CALL "WAIT",2770 DATA 0,0,32,25,0,45,20,0,1,1,0,10,100,100780 DATA 100,100,0,0,0,4000,0,4000,1,97,0790 RESTORE 770800 READ D1,I1,O1,H1,A1,A0,D0,R0,S0,L1,J1,A5810 READ G0,G1,N4,M4,G2,M1,W1,W2,W3,W4,T2,O3,Z1820 P$=CHR(124)830 WINDOW W1,W2,W3,W4840 VIEWPORT 30,130,0,100850 T1=(W2-W1)/100*2860 SET DEGREES 870 IF Z$<>"" THEN 10340880 PAGE 890 GOSUB 20780900 GOSUB 20670910 PRINT ">";920 INPUT A$930 B$=SEG(A$,1,3)940 IF B$="INS" THEN 5110950 IF B$="SEL" THEN 2920960 IF B$="LIS" THEN 9100970 IF B$="PAU" THEN 1550980 IF B$="DIS" THEN 9960990 IF B$="PAG" THEN 107301000 IF B$="ZOM" THEN 102601010 IF B$="ERS" THEN 111201020 IF B$="CHG" THEN 16301030 IF B$="TRA" THEN 23101040 IF B$="SAV" THEN 11901050 IF B$="END" THEN 15701060 IF B$="RES" THEN 11501070 IF B$<>"COM" THEN 11101080 GOSUB 229801090 GOSUB 153701100 GO TO 9001110 GOSUB 206701120 PRINT B$;" ?"1130 GO TO 9001140 REM ****** RESTART1150 CLOSE 11160 CLOSE 21170 GO TO 4301180 REM ****** SAVE1190 P1=POS(A$," ",5)1200 B$=SEG(A$,5,P1-5)1210 IF LEN(B$)<=13 THEN 12301220 B$=SEG(B$,1,13)1230 GOSUB 126101240 IF E1<>0 THEN 11101250 D$=B$1260 B$=SEG(A$,P1,LEN(A$)-P1+1)1270 GOSUB 124201280 IF E1<>0 THEN 11101290 D8=VAL(B$)1300 IF D8<>0 AND D8<>1 THEN 11101310 V$="@"&D$1320 V$=V$&"/PDB"1330 IF V$=T$ AND D8=0 THEN 15001340 IF D8=0 THEN 14001350 GOSUB 206701360 PRINT "Insert Disk to store PDB ";D$;" on in Drive #1! ";1370 INPUT Z$1380 CALL "MOUNT",1,U$1390 GO TO 14101400 CALL "MOUNT",0,U$1410 U$=SEG(U$,73,10)1420 I0=VAL(U$)1430 IF I0>P5*500 THEN 14701440 GOSUB 206701450 PRINT "No enough room on Unit #";D8;" to store PDB ";D$1460 GO TO 9001470 CLOSE 11480 CLOSE 21490 COPY T$,0 TO V$,D81500 GOSUB 206701510 PRINT " PDB ";D$;" stored on Drive #";D8;"!"1520 OPEN T$;1,"F",D$1530 GO TO 9001540 REM ****** PAUSE1550 STOP 1560 REM ****** END1570 CLOSE 11580 CLOSE 21590 GOSUB 206701600 PRINT "Session Complete!"1610 END 1620 REM ****** CHANGE1630 B$=SEG(A$,5,3)1640 IF B$="DSH" THEN 16701650 IF B$="HGT" THEN 16901660 GO TO 11101670 A9=11680 GO TO 17101690 A9=21700 REM ****** CHANGE DASH & HGT n1710 P1=POS(A$,":",10)1720 IF P1=0 THEN 17701730 GOSUB 206701740 PRINT "Changing via keyboard input is not available!"1750 GO TO 9001760 REM ****** CHANGE DSH & HGT n - TABLET1770 B$=SEG(A$,9,LEN(A$)-8)1780 GOSUB 124201790 N1=VAL(B$)1800 IF E1<>0 THEN 11101810 IF A9=1 THEN 18401820 IF N1<0 OR N1>1000 THEN 11101830 GO TO 18601840 IF N1-INT(N1) THEN 11101850 IF N1<0 OR N1>5 THEN 11101860 IF I1=0 THEN 19601870 GOSUB 206701880 PRINT "Press CLEAR - Entity ";1890 INPUT Z$1900 INPUT @I1:X1,Y1,Z11910 MOVE X1,Y11920 GOSUB 141101930 IF Z1<>2 THEN 19001940 GO TO 20801950 REM ****** CHANGE DSH & HGT n -POINTER1960 POINTER X1,Y1,Z$1970 IF A9=1 THEN 21901980 V1=21990 GOSUB 131402000 IF Z3=0 THEN 9002010 IF E4<>0 THEN 9002020 READ #1,Z3:C1,L0,X2,Y22030 MOVE X2,Y22040 GOSUB 133602050 GOSUB 206702060 PRINT "Confirm: ";2070 INPUT Z$2080 Z$=SEG(Z$,1,1)2090 IF Z$="N" THEN 9002100 IF Z$<>"Y" THEN 20602110 MOVE X2-Q5/4,Y2-3*Q5/42120 PRINT "#"2130 READ #1,Z3:C1,L0,X1,Y1,A2,H2,J2,C$2140 WRITE #1,Z3:C1,L0,X1,Y1,A2,N1,J2,C$2150 MOVE @O1:X1,Y12160 H2=N12170 GOSUB 146502180 GO TO 9002190 GOSUB 188502200 IF E6<>0 THEN 10402210 GOSUB 183202220 RMOVE -Q5/4,-(3*Q5)/42230 PRINT "#"2240 READ #1,Z3:C1,L0,D2,X1,Y1,X2,Y22250 WRITE #1,Z3:C1,L0,N1,X1,Y1,X2,Y22260 MOVE @O1:X1,Y12270 D2=N12280 GOSUB 141602290 GO TO 9002300 REM ****** TRANSLATE2310 B$=SEG(A$,5,3)2320 IF B$="LIN" THEN 23502330 GO TO 11102340 REM ****** TRANSLATE LIN n2350 P1=POS(A$,":",10)2360 IF P1=0 THEN 24102370 GOSUB 206702380 PRINT "Translation via keyboard input is not available!"2390 GO TO 9002400 REM ****** TRANS LIN n -TABLET2410 B$=SEG(A$,9,LEN(A$)-8)2420 GOSUB 124202430 IF E1<>0 THEN 9002440 N1=VAL(B$)2450 IF N1-INT(N1)<>0 THEN 11102460 IF N1<1 OR N1>100 THEN 11102470 IF I1=0 THEN 27602480 GOSUB 206702490 PRINT "Press CLEAR - Line ";2500 INPUT Z$2510 INPUT @I1:X1,Y1,Z12520 MOVE X1,Y12530 GOSUB 141102540 IF Z1=8 THEN 25702550 IF Z1<>1 THEN 25102560 GO TO 26002570 N3=N42580 M3=M42590 GO TO 28802600 GOSUB 206702610 PRINT "Press CLEAR - Beginning Position ";2620 INPUT Z$2630 INPUT @I1:X2,Y2,Z12640 MOVE X2,Y22650 GOSUB 141102660 IF Z1<>1 THEN 26302670 GOSUB 206702680 PRINT "Press Clear - Ending Position ";2690 INPUT Z$2700 INPUT @I1:X3,Y3,Z12710 MOVE X3,Y32720 GOSUB 141102730 IF Z1<>1 THEN 27002740 GO TO 28302750 REM ****** TRANS LIN n - POINTER2760 POINTER X1,Y1,Z$2770 IF Z$<>"S" THEN 28102780 N3=N42790 M3=M42800 GO TO 28802810 POINTER X2,Y2,Z$2820 POINTER X3,Y3,Z$2830 IF G2=0 THEN 28602840 GOSUB 139702850 GOSUB 140402860 N3=X3-X22870 M3=Y3-Y22880 GOSUB 188502890 IF E6<>0 THEN 11102900 GO TO 191502910 REM ****** SELECT2920 B$=SEG(A$,5,3)2930 IF B$="DSH" THEN 30902940 IF B$="TOL" THEN 31802950 IF B$="ARW" THEN 33002960 IF B$="INP" THEN 33802970 IF B$="OUT" THEN 34702980 IF B$="HGT" THEN 35602990 IF B$="ANG" THEN 36403000 IF B$="ITL" THEN 37203010 IF B$="GRD" THEN 39003020 IF B$="LAY" THEN 38103030 IF B$="WIN" THEN 43003040 IF B$="XHA" THEN 48303050 IF B$="PDB" THEN 49703060 IF B$="TRA" THEN 41603070 GO TO 11103080 REM ****** DSH3090 B$=SEG(A$,9,LEN(A$)-8)3100 GOSUB 124203110 IF E1<>0 THEN 11103120 Q5=VAL(B$)3130 IF Q5-INT(Q5)<>0 THEN 11103140 IF Q5<0 OR Q5>5 THEN 11103150 D1=Q53160 GO TO 9003170 REM ****** TOL3180 B$=SEG(A$,9,LEN(A$)-8)3190 GOSUB 124203200 IF E1<>0 THEN 11103210 Q5=VAL(B$)3220 IF Q5<0 OR Q5>1000 THEN 11103230 IF Q5<>0 THEN 32603240 T2=13250 Q5=(W2-W1)/1003260 T1=Q53270 T2=03280 GO TO 9003290 REM ****** ARW3300 B$=SEG(A$,9,LEN(A$)-8)3310 GOSUB 124203320 IF E1<>0 THEN 11103330 Q5=VAL(B$)3340 IF Q5<0 OR Q5>1000 THEN 11103350 A5=Q53360 GO TO 9003370 REM ****** INP3380 B$=SEG(A$,9,LEN(A$)-8)3390 GOSUB 124203400 IF E1<>0 THEN 11103410 Q5=VAL(B$)3420 IF Q5-INT(Q5)<>0 THEN 11103430 IF Q5<0 OR Q5>64 THEN 11103440 I1=Q53450 GO TO 9003460 REM ****** OUT3470 B$=SEG(A$,9,LEN(A$)-8)3480 GOSUB 124203490 IF E1<>0 THEN 11103500 Q5=VAL(B$)3510 IF Q5-INT(Q5)<>0 THEN 11103520 IF Q5<1 OR Q5>64 THEN 11103530 O1=Q53540 GO TO 9003550 REM ****** HGT3560 B$=SEG(A$,9,LEN(A$)-8)3570 GOSUB 124203580 IF E1<>0 THEN 11103590 Q5=VAL(B$)3600 IF Q5<=0 OR Q5>1000 THEN 11103610 H1=Q53620 GO TO 9003630 REM ****** ANG3640 B$=SEG(A$,9,LEN(A$)-8)3650 GOSUB 124203660 IF E1<>0 THEN 11103670 Q5=VAL(B$)3680 IF Q5<0 OR Q5>360 THEN 11103690 A1=Q53700 GO TO 9003710 REM ****** ITL3720 B$=SEG(A$,9,2)3730 IF B$="ON" THEN 37603740 IF B$="OF" THEN 37803750 GO TO 11103760 J1=13770 GO TO 9003780 J1=03790 GO TO 9003800 REM ****** LAY3810 B$=SEG(A$,9,LEN(A$)-8)3820 GOSUB 124203830 IF E1<>0 THEN 11103840 Q5=VAL(B$)3850 IF Q5-INT(Q5)<>0 THEN 11103860 IF Q5<1 OR Q5>100 THEN 11103870 L1=Q53880 GO TO 9003890 REM ****** GRD3900 B$=SEG(A$,9,2)3910 IF B$="ON" THEN 41103920 IF B$="OF" THEN 41303930 A$=SEG(A$,9,LEN(A$)-8)3940 B$=A$3950 GOSUB 128403960 IF E1<>0 THEN 11103970 Q5=VAL(B$)3980 IF Q5<=0 OR Q5>1000 THEN 11103990 IF P1=0 THEN 40804000 B$=A$4010 GOSUB 124204020 IF E1<>0 THEN 11104030 Q6=VAL(B$)4040 IF Q6<=0 OR Q6>1000 THEN 11104050 G0=Q54060 G1=Q64070 GO TO 9004080 G1=Q54090 G0=Q54100 GO TO 9004110 G2=14120 GO TO 9004130 G2=04140 GO TO 9004150 REM ****** TRANSLATE - X & Y INC4160 A$=SEG(A$,9,LEN(A$)-8)4170 GOSUB 128404180 IF E1<>0 OR E2<>0 THEN 11104190 Q5=VAL(B$)4200 IF ABS(Q5)>1000 THEN 11104210 B$=A$4220 GOSUB 124204230 IF E1<>0 THEN 11104240 Q6=VAL(B$)4250 IF ABS(Q6)>1000 THEN 11104260 N4=Q54270 M4=Q64280 GO TO 9004290 REM ****** WIN - KEYBOARD4300 B$=SEG(A$,8,1)4310 IF B$<>":" THEN 45104320 A$=SEG(A$,9,LEN(A$)-8)4330 GOSUB 128404340 IF E1<>0 OR E2<>0 THEN 11104350 Q5=VAL(B$)4360 GOSUB 128404370 IF E1<>0 OR E2<>0 THEN 11104380 Q7=VAL(B$)4390 GOSUB 128404400 IF E1<>0 OR E2<>0 THEN 11104410 Q6=VAL(B$)4420 B$=A$4430 GOSUB 124204440 IF E1<>0 THEN 11104450 W4=VAL(B$)4460 W1=Q54470 W2=Q64480 W3=Q74490 GO TO 47004500 REM ****** WIN - TABLET4510 IF I1=0 THEN 46804520 GOSUB 206704530 PRINT "Press CLEAR - Lower Left ";4540 INPUT Z$4550 INPUT @I1:W1,W3,Z14560 MOVE W1,W34570 GOSUB 141104580 IF Z1<>1 THEN 45504590 GOSUB 206704600 PRINT "Press CLEAR - Upper Right ";4610 INPUT Z$4620 INPUT @I1:W2,W4,Z14630 MOVE W2,W44640 GOSUB 141104650 IF Z1<>1 THEN 46204660 GO TO 47004670 REM ****** WIN - POINTER4680 POINTER W1,W3,Z$4690 POINTER W2,W4,Z$4700 IF G2=0 THEN 47304710 GOSUB 137604720 GOSUB 138304730 IF W2-W1>W4-W3 THEN 47604740 W2=W1+(W4-W3)4750 GO TO 47704760 W4=W3+(W2-W1)4770 IF T2<>0 THEN 47904780 T1=(W2-W1)/100*24790 WINDOW W1,W2,W3,W44800 GOSUB 153704810 GO TO 9004820 REM ****** XHATCH, ANGLE AND DISPLACEMENT4830 A$=SEG(A$,9,LEN(A$)-8)4840 GOSUB 128404850 IF E1<>0 OR E2<>0 THEN 11104860 Q5=VAL(B$)4870 IF Q5<0 OR Q5>360 THEN 11104880 B$=A$4890 GOSUB 124204900 IF E1<>0 THEN 11104910 Q6=VAL(B$)4920 IF Q6<=0 OR Q6>100 THEN 11104930 A0=Q54940 D0=Q64950 GO TO 9004960 REM ****** FIG - ROTATION & SCALE4970 A$=SEG(A$,9,LEN(A$)-8)4980 GOSUB 128404990 IF E1<>0 OR E2<>0 THEN 11105000 Q5=VAL(B$)5010 IF Q5<0 OR Q5>360 THEN 11105020 B$=A$5030 GOSUB 124205040 IF E1<>0 THEN 11105050 Q6=VAL(B$)5060 IF Q6<=0 OR Q6>100 THEN 11105070 R0=Q55080 S0=Q65090 GO TO 9005100 REM ****** INSERT5110 B$=SEG(A$,5,3)5120 IF B$="LIN" THEN 64205130 IF B$="TXT" THEN 72305140 IF B$="XHA" THEN 82205150 IF B$="PDB" THEN 86705160 IF B$="ARW" THEN 59405170 IF B$="CIR" THEN 52605180 GO TO 11105190 REM ****** INS CIRCLE5200 P1=POS(A$,":",1)5210 IF P1=0 THEN 52605220 GOSUB 206705230 PRINT "Circle input via Keyboard input is not available!"5240 GO TO 9005250 REM ****** INS CIRCLE, TABLET5260 IF LEN(A$)>8 THEN 53205270 GO TO 11105280 PRINT "Specifying a circle by 3 points on its"5300 PRINT "circumference is not available!"5310 GO TO 9005320 B$=SEG(A$,9,LEN(A$)-8)5330 GOSUB 124205340 IF E1<>0 THEN 11105345 IF B$=" " OR B$="  " OR B$="   " THEN 11105350 R1=VAL(B$)5360 IF R1<=0 OR R1=>1000 THEN 11105370 IF I1=0 THEN 58705380 GOSUB 206705390 PRINT "Press CLEAR - Center ";5400 INPUT Z$5410 INPUT @I1:X4,Y4,Z15420 MOVE X4,Y45430 GOSUB 141105440 IF Z1<>1 THEN 54105450 GOSUB 206705460 PRINT "Press CLEAR - Beginning Angle ";5470 INPUT Z$5480 INPUT @I1:X1,Y1,Z15490 MOVE X1,Y15500 GOSUB 141105510 IF Z1<>1 THEN 54805520 GOSUB 206705530 PRINT "Press CLEAR - Ending Angle ";5540 INPUT Z$5550 INPUT @I1:X2,Y2,Z15560 MOVE X2,Y25570 GOSUB 141105580 IF Z1<>1 THEN 55505590 GO TO 56605600 REM ****** INS CIRCLE, POINTER5610 IF LEN(A$)>8 THEN 58705620 POINTER X1,Y1,Z$5630 POINTER X4,Y4,Z$5640 POINTER X2,Y2,Z$5650 GOSUB 205005660 IF G2=0 THEN 57405670 X9=X45680 Y9=Y45690 GOSUB 127205700 X4=X05710 Y4=Y05720 X8=X45730 Y8=Y45740 X9=X1-X85750 Y9=Y1-Y85760 GOSUB 203805770 B1=X05780 X9=X2-X85790 Y9=Y2-Y85800 GOSUB 203805810 B2=X05820 IF LEN(A$)>8 THEN 58405830 GOSUB 200805840 IF ABS(B2-B1)>1 THEN 58605850 B2=B15860 GO TO 203205870 POINTER X4,Y4,Z$5880 X8=X45890 Y8=Y45900 POINTER X1,Y1,Z$5910 POINTER X2,Y2,Z$5920 GO TO 56605930 REM ****** INS ARROW5940 B$=SEG(A$,9,3)5950 P1=POS(A$,":",12)5960 A$=SEG(A$,13,LEN(A$)-12)5970 IF B$="HOR" THEN 62105980 IF B$="VER" THEN 60105990 GO TO 11106000 REM ****** INS ARROW VERTICAL6010 A6=06020 IF P1=0 THEN 61006030 REM ****** INS ARROW VER - KEYBOARD6040 A9=26050 GO TO 64906060 GOSUB 184406070 IF Z3=1 THEN 9006080 GO TO 64906090 REM ****** INS ARROW VER - TABLET6100 IF I1=0 THEN 61606110 A8=26120 GO TO 68006130 GOSUB 184406140 GO TO 61206150 REM ****** INS ARROW VER - POINTER6160 A7=26170 GO TO 70606180 GOSUB 184406190 GO TO 61706200 REM ****** INS ARROW HORIZONTAL6210 A6=16220 IF P1=0 THEN 63006230 REM ****** INS ARROW HOR - KEYBOARD6240 A9=36250 GO TO 64906260 GOSUB 184406270 IF Z3=1 THEN 9006280 GO TO 64906290 REM ****** INS ARROW HOR - TABLET6300 IF I1=0 THEN 63606310 A8=36320 GO TO 68006330 GOSUB 184406340 GO TO 63206350 REM ****** INS ARROW HOR - POINTER6360 A7=36370 GO TO 70606380 GOSUB 184406390 GO TO 63706400 REM ****** INS LIN6410 REM ****** HOR,VER,PRL,PER - INSERT CODE HERE6420 B$=SEG(A$,8,1)6430 A9=16440 A8=16450 A7=16460 IF B$<>":" THEN 67906470 REM ****** LIN - KEYBOARD6480 A$=SEG(A$,9,LEN(A$)-8)6490 GOSUB 128406500 IF E1<>0 OR E2<>0 THEN 11106510 X1=VAL(B$)6520 GOSUB 128406530 IF E1<>0 OR E2<>0 THEN 11106540 Y1=VAL(B$)6550 Z3=06560 GOSUB 128406570 IF E1<>0 THEN 11106580 IF E2=0 THEN 66006590 GO TO 9006600 X2=VAL(B$)6610 GOSUB 128406620 IF E1<>0 THEN 11106630 IF E2=0 THEN 66806640 Z3=16650 B$=A$6660 GOSUB 124206670 IF E1<>0 THEN 11106680 Y2=VAL(B$)6690 IF G2=0 THEN 67206700 GOSUB 139006710 GOSUB 139706720 GO TO A9 OF 6730,6060,62606730 GOSUB 129506740 IF Z3=1 THEN 9006750 X1=X26760 Y1=Y26770 GO TO 65606780 REM ****** LIN - TABLET, POINT6790 IF I1=0 THEN 70606800 GOSUB 206706810 PRINT "Press CLEAR - Beginning Point ";6820 INPUT Z$6830 INPUT @I1:X1,Y1,Z16840 MOVE X1,Y16850 GOSUB 141106860 IF Z1=8 THEN 9006870 IF Z1<>1 THEN 68306880 GOSUB 206706890 PRINT "Press CLEAR - Next Point ";6900 INPUT Z$6910 INPUT @I1:X2,Y2,Z16920 MOVE X2,Y26930 GOSUB 141106940 IF Z1=4 THEN 68006950 IF Z1=8 THEN 9006960 IF Z1<>1 THEN 69106970 IF G2=0 THEN 70006980 GOSUB 139006990 GOSUB 139707000 GO TO A8 OF 7010,6130,63307010 GOSUB 129507020 X1=X27030 Y1=Y27040 GO TO 68807050 REM ***************** LIN - POINTER7060 POINTER X1,Y1,Z$7070 IF A7<>1 AND Z$="S" THEN 9007080 POINTER X2,Y2,Z$7090 IF Z$<>"M" THEN 71307100 X1=X27110 Y1=Y27120 GO TO 70807130 IF Z$="S" THEN 9007140 IF G2=0 THEN 71707150 GOSUB 139007160 GOSUB 139707170 GO TO A7 OF 7180,6180,63807180 GOSUB 129507190 X1=X27200 Y1=Y27210 GO TO 70807220 REM **************** INS TXT **************7230 P1=POS(A$,":",10)7240 IF P1=0 THEN 76607250 REM ***************** INS TXT - KEYBOARD7260 C$=SEG(A$,9,P1-9)7270 IF LEN(C$)<>0 THEN 73007280 B$=C$7290 GO TO 11107300 A$=SEG(A$,P1+1,LEN(A$)-P1)7310 GOSUB 128407320 IF E1<>0 OR E2<>0 THEN 11107330 X1=VAL(B$)7340 P1=POS(A$,",",1)7350 IF P1<>0 THEN 74607360 B$=A$7370 GOSUB 124207380 IF E1<>0 THEN 11107390 Y1=VAL(B$)7400 IF G2=0 THEN 74207410 GOSUB 139007420 A2=A17430 GOSUB 130407440 GO TO 9007450 REM *************** TEXT ANGLE7460 GOSUB 128407470 IF E1<>0 OR E2<>0 THEN 11107480 Y1=VAL(B$)7490 IF G2=0 THEN 75107500 GOSUB 139007510 GOSUB 128407520 IF E1<>0 OR E2<>0 THEN 11107530 X2=VAL(B$)7540 GOSUB 128407550 IF E1<>0 OR E2<>0 THEN 11107560 Y2=VAL(B$)7570 GOSUB 128407580 IF E1<>0 OR E2<>0 THEN 11107590 X3=VAL(B$)7600 B$=A$7610 GOSUB 124207620 IF E1<>0 THEN 11107630 Y3=VAL(B$)7640 GO TO 81007650 REM ***************** INS TEXT - TABLET7660 C$=SEG(A$,9,LEN(A$)-8)7670 IF LEN(C$)<>0 THEN 77007680 B$=C$7690 GO TO 11107700 IF I1=0 THEN 80207710 GOSUB 206707720 PRINT "Press CLEAR - Position ";7730 INPUT Z$7740 INPUT @I1:X1,Y1,Z17750 MOVE X1,Y17760 GOSUB 141107770 IF Z1=8 THEN 77907780 IF Z1<>1 THEN 77407790 IF G2=0 THEN 78107800 GOSUB 139007810 IF Z1<>8 THEN 78407820 A2=A17830 GO TO 80607840 IF G2=0 THEN 78607850 GOSUB 139007860 GOSUB 206707870 PRINT "Press CLEAR - Beginning Angle ";7880 INPUT Z$7890 INPUT @I1:X2,Y2,Z27900 MOVE X2,Y27910 GOSUB 141107920 IF Z1<>1 THEN 78907930 GOSUB 206707940 PRINT "Press CLEAR - Ending Angle ";7950 INPUT Z$7960 INPUT @I1:X3,Y3,Z17970 MOVE X3,Y37980 GOSUB 141107990 IF Z1<>1 THEN 79608000 GO TO 81008010 REM ***************** INS TEXT - POINTER8020 POINTER X1,Y1,Z$8030 IF G2=0 THEN 80508040 GOSUB 139008050 IF Z$<>"S" THEN 80808060 A2=A18070 GO TO 81908080 POINTER X2,Y2,Z$8090 POINTER X3,Y3,Z$8100 IF X3-X2<>0 THEN 81608110 IF Y2<Y3 THEN 81408120 A2=2708130 GO TO 81908140 A2=908150 GO TO 81908160 A2=ATN((Y3-Y2)/(X3-X2))8170 IF X3>X2 THEN 81908180 A2=A2+1808190 GOSUB 130408200 GO TO 9008210 REM ******************** XHATCH8220 P=08230 P1=POS(A$,":",7)8240 IF P1=0 THEN 82908250 GOSUB 206708260 PRINT "X-hatching via keyboard input is not available!"8270 GO TO 9008280 REM ******************** XHATCH - TABLET8290 P6=18300 IF I1=0 THEN 84908310 GOSUB 206708320 PRINT "Press CLEAR - Line ";8330 INPUT Z$8340 INPUT @I1:X1,Y1,Z18350 MOVE X1,Y18360 GOSUB 141108370 IF Z1=8 THEN 86008380 IF Z1<>1 THEN 83408390 GOSUB 188508400 IF E6<>0 THEN 83208410 GOSUB 192708420 IF P6<19 THEN 84608430 GOSUB 206708440 PRINT "10 sides maximum!"8450 GO TO 79708460 P6=P6+28470 GO TO 83108480 REM ******************** XHA - POINTER8490 POINTER X1,Y1,Z$8500 IF Z$="S" THEN 86008510 GOSUB 188508520 IF E6<>0 THEN 84908530 GOSUB 192708540 IF P6<19 THEN 85808550 GOSUB 206708560 PRINT "10 sides maximum!"8570 GO TO 86008580 P6=P6+28590 GO TO 84908600 IF P6>3 THEN 86408610 GOSUB 206708620 PRINT "More sides needed!"8630 GO TO 9008640 N0=P6-18650 GO TO 136708660 REM ******************* INS FIG8670 P1=POS(A$,":",10)8680 IF P1=0 THEN 88608690 REM ******************* INS FIG - KEYBOARD8700 F$=SEG(A$,9,P1-9)8710 U$="@"&F$8720 IF U$<>T$ THEN 87608730 GOSUB 206708740 PRINT "Invalid PDB name!"8750 GO TO 9008760 A$=SEG(A$,P1+1,LEN(A$)-P1)8770 GOSUB 128408780 IF E1<>0 OR E2<>0 THEN 11108790 X3=VAL(B$)8800 B$=A$8810 GOSUB 124208820 IF E1<>0 THEN 11108830 Y3=VAL(B$)8840 GO TO 90408850 REM ************************** INS FIGURE -TABLET8860 F$=SEG(A$,9,LEN(A$)-8)8870 U$="@"&F$8880 U$=U$&"/PDB"8890 IF U$<>T$ THEN 89308900 GOSUB 206708910 PRINT "Invalid PDB name!"8920 GO TO 9008930 IF I1=0 THEN 90308940 GOSUB 206708950 PRINT "Press CLEAR - Position ";8960 INPUT Z$8970 INPUT @I1:X3,Y3,Z18980 MOVE X3,Y38990 GOSUB 141109000 IF Z1<>1 THEN 89709010 GO TO 90409020 REM ************************** INS FIGURE - POINTER9030 POINTER X3,Y3,Z$9040 IF G2=0 THEN 90609050 GOSUB 140409060 GOSUB 166609070 IF Z$="" THEN 9009080 GO TO 182309090 REM ********************* LIST9100 B$=SEG(A$,5,3)9110 IF B$="PAR" THEN 91609120 IF B$="PDB" THEN 95509130 GO TO 11109140 REM **************** LIST PARAMETERS9150 REM **************** LIST PARAMETERS9160 PRINT "
PARAMETERS
"9170 PRINT "TXT:"9180 PRINT " HGT: ";INT(H1*100)/1009190 PRINT " ANG: ";INT(A1*100)/1009200 IF J1=0 THEN 92309210 PRINT " ITL: ON"9220 GO TO 92409230 PRINT " ITL: OFF"9240 PRINT "XHA:"9250 PRINT " ANG: ";INT(A0*100)/1009260 PRINT " DIS: ";INT(D0*100)/1009270 PRINT "FIG:"9280 PRINT " ROT: ";INT(R0*100)/1009290 PRINT " SCA: ";INT(S0*100)/1009300 PRINT "DEV:"9310 PRINT " INP: ";I19320 PRINT " OUT: ";O19330 PRINT "TRA :"9340 PRINT " X INC: ";N49350 PRINT " Y INC: ";M49360 PRINT "LAY:  ";L19370 PRINT "DSH:  ";D19380 IF T2=0 THEN 94109390 PRINT "TOL:  MANUAL"9400 GO TO 94209410 PRINT "TOL:  AUTO"9420 PRINT "TOL:  ";INT(T1*100)/1009430 PRINT "GRD:  ";INT(G0*100)/100;" ";INT(G1*100)/1009440 IF G2=0 THEN 94709450 PRINT "GRD:  ON"9460 GO TO 94809470 PRINT "GRD:  OFF"9480 Z1=INT(W1*100)/1009490 Z2=INT(W2*100)/1009500 PRINT "WIN:  ";Z1;" ";INT(W3*100)/100;" ";Z2;" ";INT(W4*100)/1009510 INPUT Z$9520 GOSUB 153709530 GO TO 9009540 REM ****************** LIST PICTURE DATA BASE9550 READ #1,1:I89560 IF I8=>1 THEN 96009570 GOSUB 206709580 PRINT "Data Base is empty!"9590 GO TO 9009600 PRINT "
PDB
"9610 FOR I9=2 TO I8+19620 READ #1,I9:C19630 IF C1=1 THEN 97609640 IF C1=2 THEN 97909650 IF C1=3 THEN 98209660 IF C1=4 THEN 98909670 IF C1=5 THEN 97309680 IF C1=6 THEN 97009690 GO TO 99109700 READ #1,I9:C1,L0,X1,Y1,R1,B1,B29710 PRINT I9;" *";C1;" ";L0;" ";X1;" ";Y1;" ";R1;" ";B1;" ";B29720 GO TO 99109730 READ #1,I9:C1,L0,X1,Y1,X2,Y2,A6,A49740 PRINT I9;" *";C1;" ";L0;" ";X1;" ";Y1;" ";X2;" ";Y2;" ";A6;" ";A49750 GO TO 99109760 READ #1,I9:C1,L0,D2,X1,Y1,X2,Y29770 PRINT I9;" *";C1;" ";L0;" ";D2;" ";X1;" ";Y1;" ";X2;" ";Y29780 GO TO 99109790 READ #1,I9:C1,L0,X1,Y1,A2,H2,J2,C$9800 PRINT I9;" *";C1;" ";L0;" ";X1;" ";Y1;" ";A2;" ";H2;" ";J2;" ";C$9810 GO TO 99109820 READ #1,I9:C1,L0,N0,A3,D3,P9830 PRINT I9;" *";C1;" ";L0;" ";N0;" ";A3;" ";D3;" ";9840 FOR I7=1 TO N09850 PRINT P(1,I7);" ";P(2,I7);" ";9860 NEXT I79870 PRINT 9880 GO TO 99109890 READ #1,I9:C1,L0,X3,Y3,R3,S3,F$9900 PRINT I9;" *";C1;" ";L0;" ";X3;" ";Y3;" ";R3;" ";S3;" ";F$9910 NEXT I99920 INPUT Z$9930 GOSUB 153709940 GO TO 9009950 REM ***************** DISPLAY9960 B$=SEG(A$,5,3)9970 Z1=09980 IF B$="ALL" THEN 101409990 IF B$="GRD" THEN 1018010000 IF B$="LAY" THEN 1003010010 GO TO 111010020 REM ****************** DISPAY LAYER10030 B$=SEG(A$,9,LEN(A$)-8)10040 GOSUB 1242010050 IF E1<>0 THEN 111010060 L2=VAL(B$)10070 IF L2-INT(L2)<>0 THEN 111010080 IF L2<1 OR L2>1000 THEN 111010090 Z1=110100 GOSUB 1537010110 Z1=010120 GO TO 90010130 REM ******************** DIS ALL10140 Z1=010150 GOSUB 1537010160 GO TO 90010170 REM ******************** DIS GRD10180 FOR I9=INT(W1/G0)*G0 TO INT(W2/G0)*G0 STEP G010190 FOR I8=INT(W3/G1)*G1 TO INT(W4/G1)*G1 STEP G110200 MOVE I9,I810210 DRAW I9,I810220 NEXT I810230 NEXT I910240 GO TO 90010250 REM **************************** ZOOM10260 B$=SEG(A$,5,3)10270 Z1=010280 IF B$="WIN" THEN 430010290 IF B$="DWN" THEN 1041010300 IF B$="UP" OR B$="UP " THEN 1059010310 IF B$="ALL" THEN 1034010320 GO TO 111010330 REM ******************* ZOOM ALL10340 Z1=010350 W1=010360 W2=400010370 W3=010380 W4=400010390 GO TO 1055010400 REM ******************* ZOOM DOWN10410 B$=SEG(A$,9,LEN(A$)-8)10420 GOSUB 1242010430 IF E1=0 THEN 1046010440 Q1=0.5/210450 GO TO 1048010460 Q1=VAL(B$)/100/210470 IF Q1<=0 OR Q1>100 THEN 111010480 Z3=(W2-W1)*Q110490 W1=W1-Z310500 W2=W2+Z310510 W3=W3-Z310520 W4=W3+(W2-W1)10530 IF T2<>0 THEN 1055010540 T1=(W2-W1)/100*210550 WINDOW W1,W2,W3,W410560 GOSUB 1537010570 GO TO 90010580 REM ******************* ZOOM UP10590 B$=SEG(A$,8,LEN(A$)-7)10600 GOSUB 1242010610 IF E1=0 THEN 1064010620 Q1=0.5/210630 GO TO 1066010640 Q1=VAL(B$)/100/210650 IF Q1<=0 OR Q1=>1 THEN 111010660 Z3=(W2-W1)*Q110670 W1=W1+Z310680 W2=W2-Z310690 W3=W3+Z310700 W4=W3+(W2-W1)10710 GO TO 1053010720 REM ********************** PAGE10730 C$=SEG(A$,5,3)10740 IF C$="LFT" OR C$="RGT" OR C$="DWN" THEN 1078010750 IF C$="UP " OR C$="UP" THEN 1078010760 B$=C$10770 GO TO 111010780 B$=SEG(A$,8,LEN(A$)-7)10790 GOSUB 1242010800 IF E1=0 THEN 1083010810 Q1=0.510820 GO TO 1084010830 Q1=VAL(B$)/10010840 B$=C$10850 Z1=010860 IF B$="RGT" THEN 1105010870 IF B$="LFT" THEN 1100010880 IF B$="UP " OR B$="UP" THEN 1095010890 REM ******************* PAGE DOWN10900 Z3=(W4-W3)*Q110910 W3=W3+Z310920 W4=W4+Z310930 WINDOW W1,W2,W3,W410940 GO TO 1108010950 Z3=(W4-W3)*Q110960 W3=W3-Z310970 W4=W4-Z310980 GO TO 1108010990 REM ******************* PAGE LEFT11000 Z3=(W2-W1)*Q111010 W1=W1+Z311020 W2=W2+Z311030 GO TO 1108011040 REM ******************** PAGE RIGHT11050 Z3=(W2-W1)*Q111060 W1=W1-Z311070 W2=W2-Z311080 WINDOW W1,W2,W3,W411090 GOSUB 1537011100 GO TO 90011110 REM ****************** ERS ********************11120 B$=SEG(A$,5,3)11130 IF B$="TXT" THEN 1136011140 IF B$="LIN" THEN 1121011150 IF B$="XHA" THEN 1124011160 IF B$="PDB" THEN 1127011170 IF B$="ARW" THEN 1130011180 IF B$="CIR" THEN 1133011190 GO TO 111011200 REM ********************* ERS LIN11210 A9=111220 GO TO 1185011230 REM ********************* ERS XHA11240 A9=211250 GO TO 1185011260 REM ********************* ERS FIG11270 A9=311280 GO TO 1185011290 REM ********************* ERS ARW11300 A9=411310 GO TO 1185011320 REM ****** ERS CIRCLE11330 A9=511340 GO TO 1185011350 REM *************** ERS TXT - KEYBOARD11360 B$=SEG(A$,8,1)11370 IF B$<>":" THEN 1148011380 A$=SEG(A$,9,LEN(A$)-8)11390 GOSUB 1284011400 IF E1<>0 OR E2<>0 THEN 111011410 X1=VAL(B$)11420 B$=A$11430 GOSUB 1242011440 IF E1<>0 THEN 111011450 Y1=VAL(B$)11460 GO TO 1164011470 REM ******************** ERS TEXT - TABLET11480 IF I1=0 THEN 1160011490 GOSUB 2067011500 PRINT "Press CLEAR - Text ";11510 INPUT Z$11520 INPUT @I1:X1,Y1,Z111530 MOVE X1,Y111540 GOSUB 1411011550 IF Z1=8 THEN 90011560 IF Z1<>1 THEN 1152011570 GOSUB 1164011580 GO TO 1149011590 REM ******************** ERS TEXT - POINTER11600 POINTER X1,Y1,Z$11610 IF Z$="S" THEN 90011620 GOSUB 1164011630 GO TO 1160011640 V1=211650 GOSUB 1314011660 IF Z3=0 THEN 90011670 IF E4<>0 THEN 90011680 READ #1,Z3:C1,L0,X2,Y211690 MOVE X2,Y211700 GOSUB 1336011710 GOSUB 2067011720 PRINT "Confirm: ";11730 INPUT Z$11740 Z$=SEG(Z$,1,1)11750 IF Z$<>"N" THEN 1181011760 V1=Z3+111770 IF V1<=P5 THEN 1165011780 GOSUB 2067011790 PRINT "No Text found within Tolerance!"11800 GO TO 90011810 IF Z$<>"Y" THEN 1171011820 GOSUB 1348011830 RETURN 11840 REM ******************** ERS 11850 B$=SEG(A$,8,1)11860 IF B$<>":" THEN 1199011870 REM *********************** ERS - KEYBOARD11880 A$=SEG(A$,9,LEN(A$)-8)11890 GOSUB 1284011900 IF E1<>0 OR E2<>0 THEN 111011910 X1=VAL(B$)11920 B$=A$11930 GOSUB 1242011940 IF E1<>0 THEN 111011950 Y1=VAL(B$)11960 GOSUB 1212011970 GO TO 1199011980 REM *********************** ERS - TABLET11990 IF I1=0 THEN 1210012000 GOSUB 2067012010 PRINT "Press CLEAR - Entity ";12020 INPUT Z$12030 INPUT @I1:X1,Y1,Z112040 MOVE X1,Y112050 GOSUB 1411012060 IF Z1=8 THEN 90012070 IF Z1<>1 THEN 1203012080 GO TO 1212012090 REM ******************** ERS - POINTER12100 POINTER X1,Y1,Z$12110 IF Z$="S" THEN 90012120 GO TO A9 OF 12140,12190,12240,12300,1236012130 REM ********************** ERS LIN12140 GOSUB 1885012150 IF E6<>0 THEN 90012160 GOSUB 1354012170 GO TO 1199012180 REM *********************** ERS XHA12190 GOSUB 1782012200 IF E4<>0 THEN 90012210 GOSUB 1361012220 GO TO 1199012230 REM ************************ ERS FIG12240 A9=112250 GOSUB 1957012260 IF E6<>0 THEN 90012270 GOSUB 2009012280 GO TO 1199012290 REM ************************* ERS ARW12300 A9=212310 GOSUB 1957012320 IF E6<>0 THEN 90012330 GOSUB 2015012340 GO TO 1199012350 REM ************* ERS CIRCLE12360 A9=312370 GOSUB 1957012380 IF E6<>0 THEN 90012390 GOSUB 2090012400 GO TO 1199012410 REM **************** NUMERIC CHECK ON B$12420 E1=012430 E6=012440 IF LEN(A$)<>0 THEN 1249012450 E4=112460 GOSUB 2067012470 PRINT "Missing value!"12480 GO TO 1257012490 FOR I9=1 TO LEN(B$)12500 Z$=SEG(B$,I9,1)12510 IF Z$=>"0" AND Z$<="9" OR Z$="." OR Z$="-" OR Z$=" " THEN 1254012520 E1=112530 I9=LEN(B$)12540 IF Z$<"0" OR Z$>"9" THEN 1256012550 E6=112560 NEXT I912570 IF E6=1 THEN 1259012580 E4=112590 RETURN 12600 REM ***************** ALPHABETIC CHECK ON B$12610 E1=012620 FOR I9=1 TO LEN(B$)12630 Z$=SEG(B$,I9,1)12640 IF I9=1 AND (Z$<"A" OR Z$>"Z") THEN 1266012650 IF Z$=>"A" AND Z$<="Z" OR (Z$=>"0" AND Z$<="9") THEN 1269012660 E1=112670 PRINT B$;" ?"12680 I9=LEN(B$)12690 NEXT I912700 RETURN 12710 REM ****** X9,Y9 TO X0,Y0 NEAREST GRID POINT *****12720 X0=X9-INT(X9/G0)*G012730 IF X0<G0/2 THEN 1276012740 X0=INT(X9/G0)*G0+G012750 GO TO 1277012760 X0=INT(X9/G0)*G012770 Y0=Y9-INT(Y9/G1)*G112780 IF Y0<G1/2 THEN 1281012790 Y0=INT(Y9/G1)*G1+G112800 GO TO 1282012810 Y0=INT(Y9/G1)*G112820 RETURN 12830 REM ******** DETERMIN "," POSITION IN A$ ****12840 E2=012850 P1=POS(A$,",",1)12860 IF P1<>0 THEN 1289012870 E2=112880 GO TO 1293012890 B$=SEG(A$,1,P1-1)12900 GOSUB 1242012910 IF E1=1 THEN 1293012920 A$=SEG(A$,P1+1,LEN(A$)-P1+1)12930 RETURN 12940 REM ************ DRAW LINE AND STORE INFO IN DATA BASE ***12950 MOVE @O1:X1,Y112960 D2=D112970 P5=P5+112980 WRITE #1,P5:1,L1,D2,X1,Y1,X2,Y212990 WRITE #1,1:P5-113000 GOSUB 1416013010 GOSUB 2058013020 RETURN 13030 REM ************ PRINT TEXT AND STORE INFO IN DATA BASE ***13040 J2=J113050 H2=H113060 P5=P5+113070 WRITE #1,P5:2,L1,X1,Y1,A2,H2,J2,C$13080 WRITE #1,1:P5-113090 MOVE @O1:X1,Y113100 GOSUB 1465013110 GOSUB 2058013120 RETURN 13130 REM *********** DETERMIN CLOSEST TEXT TO POINT ***13140 E4=013150 IF P5>0 THEN 1320013160 GOSUB 2067013170 PRINT "Data Base Empty!"13180 E4=113190 GO TO 1334013200 Z3=013210 FOR I9=V1 TO P513220 READ #1,I9:C1,L0,X2,Y213230 IF L0=0 THEN 1329013240 IF C1<>2 THEN 1329013250 Z1=((Y2-Y1)^2+(X2-X1)^2)^(1/2)13260 IF Z1>T1 THEN 1329013270 Z3=I913280 I9=P513290 NEXT I913300 IF Z3<>0 THEN 1334013310 E4=113320 GOSUB 2067013330 PRINT "No Text found within Tolerance!"13340 RETURN 13350 REM ************** DRAW CONFIRMING SQUARE ****13360 Q5=(W2-W1)/10013370 FOR I9=1 TO 313380 RMOVE -Q5/2,-Q5/213390 RDRAW 0,+Q513400 RDRAW Q5,013410 RDRAW 0,-Q513420 RDRAW -Q5,013430 RMOVE Q5/2,Q5/213440 NEXT I913450 PRINT ""13460 RETURN 13470 REM ******************* ZERO TEXT INFO FROM DATA BASE13480 MOVE X2-Q5/4,Y2-3*Q5/413490 PRINT "#"13500 READ #1,Z3:C1,L0,X1,Y1,A2,H2,J2,C$13510 WRITE #1,Z3:C1,0,X1,Y1,A2,H2,J2,C$13520 RETURN 13530 REM ******************* ZERO LIN INFO FROM DATA BASE13540 GOSUB 1832013550 RMOVE -Q5/4,-(3*Q5)/413560 PRINT "#"13570 READ #1,Z3:C1,L0,D2,X1,Y1,X2,Y213580 WRITE #1,Z3:C1,0,D2,X1,Y1,X2,Y213590 RETURN 13600 REM **************** ZERO XHATCH INFO FROM DATA BASE13610 MOVE P(1,1)-Q5/4,P(2,1)-3*Q5/413620 PRINT "#"13630 READ #1,Z3:C1,L0,N0,A3,D3,P13640 WRITE #1,Z3:C1,0,N0,A3,D3,P13650 RETURN 13660 REM ******************* DRAW XHATCH AND STORE INFO IN DATA BASE13670 D3=D013680 A3=A013690 GOSUB 1587013700 P5=P5+113710 WRITE #1,P5:3,L1,N0,A0,D0,P13720 WRITE #1,1:P5-113730 GOSUB 2058013740 GO TO 90013750 REM ************** W1,W2 TO NEAREST GRID POINT ***13760 X9=W113770 Y9=W313780 GOSUB 1272013790 W1=X013800 W3=Y013810 RETURN 13820 REM ************** W3,W4 TO NEAREST GRID POINT ***13830 X9=W213840 Y9=W413850 GOSUB 1272013860 W2=X013870 W4=Y013880 RETURN 13890 REM ************* X1,Y1 TO NEAREST GRID POINT ***13900 X9=X113910 Y9=Y113920 GOSUB 1272013930 X1=X013940 Y1=Y013950 RETURN 13960 REM ************* X2,Y2 TO NEAREST GRID POINT ***13970 X9=X213980 Y9=Y213990 GOSUB 1272014000 X2=X014010 Y2=Y014020 RETURN 14030 REM *************** X3,Y3 TO NEAREST GRID POINT14040 X9=X314050 Y9=Y314060 GOSUB 1272014070 X3=X014080 Y3=Y014090 RETURN 14100 REM ************* DISPLAY BLINKING TABLET CURSOR ***14110 PRINT @32,18:514120 PRINT @32,24:P$14130 PRINT @32,18:014140 RETURN 14150 REM ****************** DRAW DASHED LINE ****14160 MOVE @O1:X1,Y114170 S5=(W2-W1)/10014180 S6=(W4-W3)/10014190 D5=(X2-X1)/S514200 D6=(Y2-Y1)/S614210 D7=SQR(D5^2+D6^2)14220 IF ABS(D6)<1 AND ABS(D5)<1 THEN 1461014230 U5=D5/D7*S514240 U6=D6/D7*S614250 U7=2*U514260 U8=2*U614270 I0=U5 MAX U614280 IF I0>0 THEN 1430014290 I0=ABS(U5 MIN U6)14300 GO TO D2 OF 14320,14370,14420,14470,1454014310 GO TO 1460014320 FOR I9=0 TO ABS(X2-X1-U5*2) MAX ABS(Y2-Y1-U6*2) STEP 2*I014330 RDRAW @O1:U5,U614340 RMOVE @O1:U5,U614350 NEXT I914360 GO TO 1460014370 FOR I9=0 TO ABS(X2-X1-U5) MAX ABS(Y2-Y1-U6) STEP I014380 RDRAW @O1:0,014390 RMOVE @O1:U5,U614400 NEXT I914410 GO TO 1460014420 FOR I9=0 TO ABS(X2-X1-U5*3) MAX ABS(Y2-Y1-U6*3) STEP 3*I014430 RDRAW @O1:U7,U814440 RMOVE @O1:U5,U614450 NEXT I914460 GO TO 1460014470 FOR I9=0 TO ABS(X2-X1-U5*3) MAX ABS(Y2-Y1-U6*3) STEP 3*I014480 RDRAW @O1:U5,U614490 RMOVE @O1:U5,U614500 RDRAW @O1:0,014510 RMOVE @O1:U5,U614520 NEXT I914530 GO TO 1460014540 FOR I9=0 TO ABS(X2-X1-U5*5) MAX ABS(Y2-Y1-U6*5) STEP 5*I014550 RDRAW @O1:U7,U814560 RMOVE @O1:U5,U614570 RDRAW @O1:U5,U614580 RMOVE @O1:U5,U614590 NEXT I914600 DRAW @O1:X2,Y214610 X1=X214620 Y1=Y214630 RETURN 14640 REM *********************** CHARACTER GENERATOR14650 X6=X114660 Y6=Y114670 X8=X614680 Y8=Y614690 X5=X614700 Y5=Y614710 S8=H2*1.2514720 S9=SIN(A2)14730 H9=COS(A2)14740 FOR L9=1 TO LEN(C$)14750 E$=SEG(C$,L9,1)14760 H8=ASC(E$)14770 P9=214780 N9=H8*2+114790 E$=SEG(H$,N9,1)14800 R$=SEG(H$,N9+1,1)14810 N9=ASC(E$)*16+ASC(R$)14820 D5=H8*4+114830 E$=SEG(I$,D5,1)14840 R$=SEG(I$,D5+1,1)14850 G$=SEG(I$,D5+2,1)14860 W8=D514870 D5=ASC(E$)*256+ASC(R$)*16+ASC(G$)14880 D5=D5*2+114890 E$=SEG(I$,W8+3,1)14900 W8=ASC(E$)14910 FOR M7=D5 TO D5+2*N9-1 STEP 214920 Q$=SEG(N$,M7,1)14930 X7=ASC(Q$)14940 Y$=SEG(N$,M7+1,1)14950 Y7=ASC(Y$)14960 IF X7=15 THEN 1519014970 X7=X7-114980 Y7=Y7-314990 IF H8>16 THEN 1502015000 Y7=Y7-615010 X7=X7-615020 IF J2=0 THEN 1504015030 X7=X7+0.3*Y715040 IF A2=0 THEN 1509015050 X3=-Y7*S9+X7*H915060 Y3=Y7*H9+X7*S915070 X7=X315080 Y7=Y315090 X3=X7*0.06667*S8+X615100 Y3=Y7*0.06667*S8+Y615110 X7=X315120 Y7=Y315130 IF P9=2 THEN 1516015140 DRAW @O1:X7,Y715150 GO TO 1517015160 MOVE @O1:X7,Y715170 P9=115180 GO TO 1528015190 GO TO Y7+1 OF 15210,15270,1524015200 GO TO 1528015210 P9=215220 GO TO 1528015230 REM Y7=215240 S8=S8*215250 GO TO 1528015260 REM DECREASE SCALE FACTOR15270 S8=S8*0.515280 NEXT M715290 IF H8<17 THEN 1533015300 X3=W8*0.06667*S815310 Y6=Y6+X3*S915320 X6=X6+X3*H915330 MOVE @O1:X6,Y615340 NEXT L915350 RETURN 15360 REM **************** REPAINT *************15370 IF O1<>32 THEN 1544015380 IF Z1=1 THEN 1541015390 PAGE 15400 O3=9715410 GOSUB 2078015420 IF P5<=1 THEN 1585015430 GO TO 1547015440 GOSUB 2067015450 PRINT "Ready Output Device!"15460 INPUT Z$15470 FOR I5=2 TO P515480 READ #1,I5:C1,L015490 IF L0=0 THEN 1583015500 IF Z1<>1 THEN 1552015510 IF L0<>L2 THEN 1583015520 IF C1=2 THEN 1564015530 IF C1=1 THEN 1568015540 IF C1=3 THEN 1571015550 IF C1=4 THEN 1574015560 IF C1=5 THEN 1580015570 IF C1=6 THEN 1561015580 GOSUB 2067015590 PRINT "Data Base Error at Record ";I5;"!"15600 GO TO 1583015610 READ #1,I5:C1,L0,X4,Y4,R1,B1,B215620 GOSUB 2022015630 GO TO 1583015640 READ #1,I5:C1,L0,X1,Y1,A2,H2,J2,C$15650 MOVE @O1:X1,Y115660 GOSUB 1465015670 GO TO 1583015680 READ #1,I5:C1,L0,D2,X1,Y1,X2,Y215690 GOSUB 1416015700 GO TO 1583015710 READ #1,I5:C1,L0,N0,A3,D3,P15720 GOSUB 1587015730 GO TO 1583015740 READ #1,I5:C1,L0,X3,Y3,R3,S3,F$15750 GOSUB 1666015760 IF Z$="" THEN 1583015770 GOSUB 1686015780 GO TO 1583015790 GO TO 1583015800 READ #1,I5:C1,L0,X1,Y1,X2,Y2,A6,A415810 GOSUB 1857015820 GO TO 1583015830 NEXT I515840 O1=3215850 RETURN 15860 REM ********************* XHATCH ****************15870 DELETE W7,U015880 DIM W7(2,N0+1),U0(N0)15890 SET RADIANS 15900 Q5=1.0E+30715910 Q6=-1.0E+30715920 S9=SIN(A3*0.01745327)15930 C9=COS(A3*0.01745327)15940 FOR I0=1 TO N015950 W7(1,I0)=P(1,I0)*C9+P(2,I0)*S915960 W7(2,I0)=-P(1,I0)*S9+P(2,I0)*C915970 Q5=Q5 MIN W7(2,I0)15980 Q6=Q6 MAX W7(2,I0)15990 NEXT I016000 W7(1,N0+1)=W7(1,1)16010 W7(2,N0+1)=W7(2,1)16020 Y0=Q5+0.5*D316030 IF Y0>Q6 THEN 1631016040 K0=016050 FOR I0=1 TO N016060 Q7=W7(2,I0) MIN W7(2,I0+1)16070 IF Y0<Q7 THEN 1620016080 W0=W7(2,I0) MAX W7(2,I0+1)16090 IF Y0=>W0 THEN 1620016100 X1=(W7(2,I0)-Y0)*(W7(1,I0)-W7(1,I0+1))/(W7(2,I0)-W7(2,I0+1))16110 X1=W7(1,I0)-X116120 K0=K0+116130 J0=K016140 IF J0=1 THEN 1619016150 IF U0(J0-1)=>X1 THEN 1619016160 U0(J0)=U0(J0-1)16170 J0=J0-116180 GO TO 1614016190 U0(J0)=X116200 NEXT I016210 FOR I0=1 TO K016220 P8(1)=U0(I0)*C9-Y0*S916230 P8(2)=U0(I0)*S9+Y0*C916240 IF 2*INT(0.5*I0)-I0>-0.1 THEN 1627016250 MOVE @O1:P8(1),P8(2)16260 GO TO 1628016270 DRAW @O1:P8(1),P8(2)16280 NEXT I016290 Y0=Y0+D316300 GO TO 1603016310 SET DEGREES 16320 RETURN 16330 REM ********************* DETERMIN CLOSEST LINE ENDPT TO POINT16340 E4=016350 IF P5>0 THEN 1640016360 GOSUB 2067016370 PRINT "Data Base is empty!"16380 E4=216390 GO TO 1664016400 Z2=1.0E+30716410 Z3=016420 FOR I5=I3 TO P516430 READ #1,I5:C1,L016440 IF L0=0 THEN 1659016450 IF C1<>1 THEN 1659016460 READ #1,I5:C1,L0,D2,X2,Y2,X3,Y316470 Z1=((Y2-Y1)^2+(X2-X1)^2)^(1/2)16480 IF Z1>T1 THEN 1653016490 Z3=I516500 I5=P516510 Z4=216520 GO TO 1659016530 Z1=((Y3-Y1)^2+(X3-X1)^2)^(1/2)16540 IF Z1>T1 THEN 1659016550 Z3=I516560 I5=P516570 Z4=316580 GO TO 1659016590 NEXT I516600 IF Z3<>0 THEN 1664016610 GOSUB 2067016620 PRINT "No Line found within Tolerance!"16630 E4=116640 RETURN 16650 REM ******************** FIND AND DISPLAY PDB  16660 GOSUB 2067016670 PRINT "PDB ";F$;" must reside in Drive #0 or #1! ";16680 INPUT Z$16690 REM *** CALL "CUSTAT",Z$16700 REM ***16710 GO TO 1677016720 D9=116730 J$="@"&F$16740 J$=J$&"/PDB"16750 CALL "FILE",1,J$,Z$16760 IF Z$<>"" THEN 1686016770 D9=016780 J$="@"&F$16790 J$=J$&"/PDB"16800 CALL "FILE",0,J$,Z$16810 IF Z$<>"" THEN 1684016820 GOSUB 2067016830 PRINT "PDB ";F$;" does not exist!"16840 RETURN 16850 REM ******************************** DRAW PDB16860 CALL "UNIT",D916870 CLOSE 216880 OPEN J$;2,"R",Z$16890 E4=016900 READ #2,1:P716910 IF P7=>2 THEN 1696016920 E4=116930 GOSUB 2067016940 PRINT "PDB ";F$;" is empty!"16950 GO TO 1780016960 FOR I8=2 TO P7+116970 READ #2,I8:C1,L016980 IF L0=0 THEN 1777016990 IF C1=2 THEN 1733017000 IF C1=1 THEN 1750017010 IF C1=4 THEN 1764017020 IF C1=3 THEN 1766017030 IF C1=5 THEN 1717017040 IF C1=6 THEN 1706017050 GO TO 1777017060 READ #2,I8:C1,L0,X4,Y4,R1,B1,B217070 X9=X417080 Y9=Y417090 GOSUB 1940017100 X4=X0*S3+X317110 Y4=Y0*S3+Y317120 B1=B1+R317130 B2=B2+R317140 R1=R1*S317150 GOSUB 2022017160 GO TO 1777017170 READ #2,I8:C1,L0,X1,Y1,X2,Y2,A6,A417180 X9=X117190 Y9=Y117200 GOSUB 1940017210 X1=X0*S3+X317220 Y1=Y0*S3+Y317230 X9=X217240 Y9=Y217250 GOSUB 1940017260 X2=X0*S3+X317270 Y2=Y0*S3+Y317280 A6=A6*S317290 A4=A4*S317300 N1=117310 GOSUB 1857017320 GO TO 1777017330 READ #2,I8:C1,L0,X2,Y2,A2,H2,J2,C$17340 X9=X217350 Y9=Y217360 GOSUB 1940017370 X2=X0*S3+X317380 Y2=Y0*S3+Y317390 MOVE @O1:X2,Y217400 X1=X217410 Y1=Y217420 A2=A2+R317430 H2=H2*S317440 U1=X317450 V1=Y317460 GOSUB 1465017470 X3=U117480 Y3=V117490 GO TO 1777017500 READ #2,I8:C1,L0,D2,X1,Y1,X2,Y217510 X9=X117520 Y9=Y117530 GOSUB 1940017540 X1=X0*S3+X317550 Y1=Y0*S3+Y317560 X9=X217570 Y9=Y217580 GOSUB 1940017590 X2=X0*S3+X317600 Y2=Y0*S3+Y317610 MOVE @O1:X1,Y117620 GOSUB 1416017630 GO TO 1777017640 REM ******* PLACE NEXT LEVEL PDB HERE17650 GO TO 1777017660 READ #2,I8:C1,L0,N0,A3,D3,P17670 FOR I6=1 TO N017680 X9=P(1,I6)17690 Y9=P(2,I6)17700 GOSUB 1940017710 P(1,I6)=X0*S3+X317720 P(2,I6)=Y0*S3+Y317730 NEXT I617740 A3=A3+R317750 D3=D3*S317760 GOSUB 1587017770 NEXT I817780 CALL "UNIT",017790 CLOSE 217800 RETURN 17810 REM **************** DETERMIN CLOSEST XHATCH TO POINT17820 E4=017830 IF P5>0 THEN 1788017840 GOSUB 2067017850 PRINT "Data Base is empty!"17860 E4=117870 GO TO 1821017880 Z3=017890 V1=217900 FOR I9=V1 TO P517910 READ #1,I9:C1,L017920 IF L0=0 THEN 1801017930 IF C1<>3 THEN 1801017940 READ #1,I9:C1,L0,N0,A3,D3,P17950 X2=P(1,1)17960 Y2=P(2,1)17970 Z1=((Y2-Y1)^2+(X2-X1)^2)^(1/2)17980 IF Z1>T1 THEN 1801017990 Z3=I918000 I9=P518010 NEXT I918020 IF Z3<>0 THEN 1807018030 E4=118040 GOSUB 2067018050 PRINT "No X-hatching found within Tolerance!"18060 GO TO 1821018070 MOVE P(1,1),P(2,1)18080 GOSUB 1336018090 GOSUB 2067018100 PRINT "Confirm: ";18110 INPUT Z$18120 Z$=SEG(Z$,1,1)18130 IF Z$<>"N" THEN 1820018140 V1=Z3+118150 IF V1<=P5 THEN 1790018160 GOSUB 2067018170 PRINT "No X-hatching found within Tolerance!"18180 E4=118190 GO TO 1821018200 IF Z$<>"Y" THEN 1809018210 RETURN 18220 REM *************** DRAW PDB AND STORE INFO IN DATA BASE18230 R3=R018240 S3=S018250 P5=P5+118260 WRITE #1,P5:4,L1,X3,Y3,R3,S3,F$18270 WRITE #1,1:P5-118280 GOSUB 1686018290 GOSUB 2058018300 GO TO 90018310 REM ********** POSITION ON LINE FOR CONFIRMING SQUARE18320 IF X2<X3 THEN 1838018330 IF Y2<Y3 THEN 1836018340 MOVE X3+(X2-X3)/2,Y3+(Y2-Y3)/218350 GO TO 1842018360 MOVE X3+(X2-X3)/2,Y2+(Y3-Y2)/218370 GO TO 1842018380 IF Y2<Y3 THEN 1841018390 MOVE X2+(X3-X2)/2,Y3+(Y2-Y3)/218400 GO TO 1842018410 MOVE X2+(X3-X2)/2,Y2+(Y3-Y2)/218420 RETURN 18430 REM **************** DRAW ARROW AND STORE INFO IN DATA BASE18440 P5=P5+118450 IF A6=1 THEN 1848018460 X2=X118470 GO TO 1849018480 Y2=Y118490 WRITE #1,P5:5,L1,X1,Y1,X2,Y2,A6,A518500 WRITE #1,1:P5-118510 A4=A518520 N1=018530 GOSUB 1857018540 GOSUB 2058018550 RETURN 18560 REM ***************** DRAW ARROW18570 IF A6=1 THEN 1871018580 IF Y1<Y2 THEN 1865018590 MOVE @O1:X1+A4,Y1-A418600 DRAW @O1:X1,Y118610 DRAW @O1:X1-A4,Y1-A418620 MOVE @O1:X1,Y118630 DRAW @O1:X2,Y218640 GO TO 1883018650 MOVE @O1:X1+A4,Y1+A418660 DRAW @O1:X1,Y118670 DRAW @O1:X1-A4,Y1+A418680 MOVE @O1:X1,Y118690 DRAW @O1:X2,Y218700 GO TO 1883018710 IF X2<X1 THEN 1878018720 MOVE @O1:X1+A4,Y1+A418730 DRAW @O1:X1,Y118740 DRAW @O1:X1+A4,Y1-A418750 MOVE @O1:X1,Y118760 DRAW @O1:X2,Y218770 GO TO 1883018780 MOVE @O1:X1-A4,Y1+A418790 DRAW @O1:X1,Y118800 DRAW @O1:X1-A4,Y1-A418810 MOVE @O1:X1,Y118820 DRAW @O1:X2,Y218830 RETURN 18840 REM *************************** FIND AND CONFIRM LINE18850 I3=218860 U1=X118870 V1=Y118880 E6=018890 GOSUB 1634018900 IF E4=0 THEN 1893018910 E6=118920 GO TO 1913018930 IF Z3=0 THEN 1912018940 IF E4<>0 THEN 1912018950 READ #1,Z3:C1,L0,D2,X2,Y2,X3,Y318960 GOSUB 1832018970 GOSUB 1336018980 GOSUB 2067018990 PRINT "Confirm: ";19000 INPUT Z$19010 Z$=SEG(Z$,1,1)19020 IF Z$<>"N" THEN 1910019030 I3=Z3+119040 X1=U119050 Y1=V119060 IF I3<=P5 THEN 1889019070 GOSUB 2067019080 PRINT "No Line found within Tolerance!"19090 GO TO 1912019100 IF Z$<>"Y" THEN 1898019110 GO TO 1913019120 E6=119130 RETURN 19140 REM ************** DRAW TRANSLATED LINES AND STORE IN DATA BASE19150 FOR I6=1 TO N119160 READ #1,Z3:C1,L0,D2,X1,Y1,X2,Y219170 X1=X1+N3*I619180 Y1=Y1+M3*I619190 X2=X2+N3*I619200 Y2=Y2+M3*I619210 MOVE @O1:X1,Y119220 GOSUB 1297019230 NEXT I619240 GOSUB 2058019250 GO TO 90019260 REM ********** STORE LINE ENDPTS IN P FOR XHATCHING19270 READ #1,Z3:C1,L0,D2,X2,Y2,X3,Y319280 IF Z4=2 THEN 1934019290 P(1,P6)=X219300 P(2,P6)=Y219310 P(1,P6+1)=X319320 P(2,P6+1)=Y319330 GO TO 1938019340 P(1,P6)=X319350 P(2,P6)=Y319360 P(1,P6+1)=X219370 P(2,P6+1)=Y219380 RETURN 19390 REM ************ ROTATE COORD FOR FIG19400 V1=(X9^2+Y9^2)^(1/2)19410 IF X9<0 THEN 1952019420 IF X9<>0 THEN 1948019430 IF Y9>0 THEN 1946019440 V2=270+R319450 GO TO 1949019460 V2=90+R319470 GO TO 1949019480 V2=R3+ATN(Y9/X9)19490 X0=COS(V2)*V119500 Y0=SIN(V2)*V119510 GO TO 1955019520 V2=R3+ATN(Y9/X9)19530 X0=-COS(V2)*V119540 Y0=-SIN(V2)*V119550 RETURN 19560 REM ****** DETERMIN CLOSEST FIGURE, CIRCLE, OR ARROW TO POINT19570 E6=019580 IF P5>0 THEN 1963019590 GOSUB 2067019600 PRINT "Data Base is empty!"19610 E6=119620 GO TO 2007019630 Z3=019640 V1=219650 FOR I9=V1 TO P519660 READ #1,I9:C1,L0,X3,Y319670 IF L0=0 THEN 1979019680 IF A9=1 THEN 1974019690 IF A9=3 THEN 1972019700 IF C1<>5 THEN 1979019710 GO TO 1975019720 IF C1<>6 THEN 1979019730 GO TO 1975019740 IF C1<>4 THEN 1979019750 Z1=((Y3-Y1)^2+(X3-X1)^2)^(1/2)19760 IF Z1>T1 THEN 1979019770 Z3=I919780 I9=P519790 NEXT I919800 IF Z3<>0 THEN 1995019810 IF A9=1 THEN 1991019820 IF A9=3 THEN 1987019830 GOSUB 2067019840 PRINT "No Arrow found within Tolerance!"19850 E6=119860 GO TO 2007019870 GOSUB 2067019880 PRINT "No Circle found within Tolerance!"19890 E6=119900 GO TO 2007019910 GOSUB 2067019920 PRINT "No Sub-PDB found within Tolerance!"19930 E6=119940 GO TO 2007019950 MOVE X3,Y319960 GOSUB 1336019970 GOSUB 2067019980 PRINT "Confirm: ";19990 INPUT Z$20000 Z$=SEG(Z$,1,1)20010 IF Z$<>"N" THEN 2006020020 V1=Z3+120030 Z3=020040 IF V1<=P5 THEN 1965020050 GO TO 1981020060 IF Z$<>"Y" THEN 1997020070 RETURN 20080 REM ************** ZERO FIGURE FROM DATA BASE20090 MOVE X3-Q5/4,Y3-3*Q5/420100 PRINT "#"20110 READ #1,Z3:C1,L0,X3,Y3,R3,S3,F$20120 WRITE #1,Z3:C1,0,X3,Y3,R3,S3,F$20130 RETURN 20140 REM ************** ZERO ARROW FROM DATA BASE20150 GOSUB 1832020160 MOVE X3-Q5/4,Y3-3*Q5/420170 PRINT "#"20180 READ #1,Z3:C1,L0,X1,Y1,X2,Y2,A6,A420190 WRITE #1,Z3:C1,0,X1,Y1,X2,Y2,A6,A420200 RETURN 20210 REM ********** DRAW CIRCLE20220 IF B2<0 OR B2<=B1 THEN 2024020230 GO TO 2025020240 B2=B2+36020250 MOVE @O1:X4+COS(B1)*R1,Y4+SIN(B1)*R120260 FOR I9=B1 TO B2 STEP 820270 DRAW @O1:X4+COS(I9)*R1,Y4+SIN(I9)*R120280 NEXT I920290 DRAW @O1:X4+COS(B2)*R1,Y4+SIN(B2)*R120300 RETURN 20310 REM ******** STORE CIRCLE INFO IN DATA BASE20320 P5=P5+120330 WRITE #1,P5:6,L1,X4,Y4,R1,B1,B220340 WRITE #1,1:P5-120350 GOSUB 2022020360 GO TO 90020370 REM ************ FIND ANGLE20380 IF X9<0 THEN 2047020390 IF X9<>0 THEN 2045020400 IF Y9<0 THEN 2043020410 B1=9020420 GO TO 2048020430 X0=27020440 GO TO 2048020450 X0=ATN(Y9/X9)20460 GO TO 2048020470 X0=ATN(Y9/X9)+18020480 RETURN 20490 REM ************** FIND RADIUS20500 Q5=((X2-X1)^2+(Y2-Y1)^2)^(1/2)20510 Q6=((X3-X1)^2+(Y3-Y1)^2)^(1/2)20520 Q7=((X3-X2)^2+(Y3-Y2)^2)^(1/2)20530 Q8=(Q5+Q6+Q7)*(1/2)20540 R1=((Q8-Q5)*(Q8-Q6)*(Q8-Q7)*Q8)^(1/2)20550 R1=Q5*Q6*Q7/(4*R1)20560 RETURN 20570 REM ***** CHECK FREE ROOM LEFT ON DISK20580 CALL "MOUNT",0,U$20590 U$=SEG(U$,73,10)20600 Z1=VAL(U$)20610 IF Z1>1000 THEN 2065020620 GOSUB 2067020630 PRINT "There is no more free space on this floppy disk!"20640 GO TO 157020650 RETURN 20660 REM ***** POSITION FOR TEXT20670 O3=O3-O420680 IF O3>3 THEN 2071020690 O3=9720700 GOSUB 1537020710 WINDOW 0,130,0,10020720 VIEWPORT 0,130,0,10020730 MOVE 0,O320740 WINDOW W1,W2,W3,W420750 VIEWPORT 30,130,0,10020760 RETURN 20770 REM ********* DRAW VIEWPORT FRAME20780 MOVE W1,W320790 DRAW W2,W320800 DRAW W2,W420810 DRAW W1,W420820 DRAW W1,W320830 Q5=(W2-W1)/100/220840 MOVE Q5,Q520850 DRAW -Q5,-Q520860 MOVE -Q5,Q520870 DRAW Q5,-Q520880 RETURN 20890 REM **** ZERO CIRCLE FROM DATA BASE20900 MOVE X3-Q5/4,Y3-3*Q5/420910 MOVE X3-Q5/4,Y3-3*Q5/420920 PRINT "#"20930 READ #1,Z3:C1,L0,X3,Y3,R1,B1,B220940 WRITE #1,Z3:C1,0,X3,Y3,R1,B1,B220950 RETURN 20960 REM *** DELETE REMARK STATEMENTS20970 PAGE 20980 GOSUB 2100020990 GO TO 2117021000 FOR I9=1 TO 1021010 MOVE 0,021020 PRINT @32,20:130,0,130,100,0,100,0,021030 MOVE 2.5,2.521040 PRINT @32,20:127.5,2.5,127.5,97.5,2.5,97.5,2.5,2.521050 MOVE 5,521060 PRINT @32,20:125,5,125,95,5,95,5,521070 NEXT I921080 CHARSIZE 421090 FOR I9=1 TO 1021100 MOVE 57,7021110 U$="4 0 5 X


D R A F T I N G"21120 U$=U$&"


S Y S T E M"21130 PRINT U$21140 NEXT I921150 PRINT ""21160 RETURN 21170 DELETE 321180 DELETE 1921190 DELETE 3921200 DELETE 114021210 DELETE 118021220 DELETE 154021230 DELETE 156021240 DELETE 162021250 DELETE 170021260 DELETE 176021270 DELETE 195021280 DELETE 230021290 DELETE 234021300 DELETE 240021310 DELETE 291021320 DELETE 308021330 DELETE 317021340 DELETE 329021350 DELETE 337021360 DELETE 346021370 DELETE 355021380 DELETE 363021390 DELETE 371021400 DELETE 380021410 DELETE 389021420 DELETE 415021430 GOSUB 2100021440 DELETE 429021450 DELETE 450021460 DELETE 467021470 DELETE 482021480 DELETE 496021490 DELETE 510021500 DELETE 519021510 DELETE 525021520 DELETE 560021530 DELETE 593021540 DELETE 600021550 DELETE 603021560 DELETE 609021570 DELETE 615021580 DELETE 620021590 DELETE 623021600 DELETE 629021610 DELETE 635021620 DELETE 640021630 DELETE 647021640 DELETE 678021650 DELETE 705021660 DELETE 722021670 DELETE 725021680 DELETE 745021690 DELETE 765021700 GOSUB 2100021710 DELETE 801021720 DELETE 821021730 DELETE 828021740 DELETE 848021750 DELETE 866021760 DELETE 869021770 DELETE 885021780 DELETE 902021790 DELETE 909021800 DELETE 954021810 DELETE 995021820 DELETE 1013021830 DELETE 1017021840 DELETE 1025021850 DELETE 1033021860 DELETE 1040021870 DELETE 1058021880 DELETE 1072021890 DELETE 1089021900 DELETE 1099021910 DELETE 1104021920 DELETE 1111021930 DELETE 1120021940 DELETE 1123021950 DELETE 1126021960 DELETE 1129021970 GOSUB 2100021980 DELETE 1135021990 DELETE 1147022000 DELETE 1159022010 DELETE 1184022020 DELETE 1187022030 DELETE 1198022040 DELETE 1209022050 DELETE 1213022060 DELETE 1218022070 DELETE 1223022080 DELETE 1229022090 DELETE 1241022100 DELETE 1260022110 DELETE 1271022120 DELETE 1283022130 DELETE 1294022140 DELETE 1303022150 DELETE 1313022160 DELETE 1335022170 DELETE 1347022180 DELETE 1353022190 DELETE 1360022200 DELETE 1366022210 DELETE 1375022220 DELETE 1382022230 DELETE 1396022240 GOSUB 2100022250 DELETE 1403022260 DELETE 1410022270 DELETE 1415022280 DELETE 1464022290 DELETE 1536022300 DELETE 1586022310 DELETE 1633022320 DELETE 1665022330 DELETE 1685022340 DELETE 1781022350 DELETE 1822022360 DELETE 1831022370 DELETE 1843022380 DELETE 1856022390 DELETE 1884022400 DELETE 1914022410 DELETE 1926022420 DELETE 1939022430 DELETE 1956022440 DELETE 2008022450 DELETE 2014022460 DELETE 2021022470 DELETE 2031022480 DELETE 2037022490 DELETE 2008022500 DELETE 2049022510 DELETE 2057022520 GOSUB 2100022530 DELETE 2066022540 DELETE 2077022550 DELETE 2089022560 GOSUB 2100022570 DELETE 20970,2257022580 N1=MEMORY22590 RETURN 22600 REM