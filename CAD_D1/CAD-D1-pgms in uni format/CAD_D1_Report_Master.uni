100 INIT 110 DIM T1(80),T2(80),T3(80)120 PAGE 130 FOR I1=1 TO 3140 PRINT @32,21:0,0150 PRINT @32,20:130,0,130,100,0,100,0,0160 PRINT @32,21:2.5,2.5170 PRINT @32,20:127.5,2.5,127.5,97.5,2.5,97.5,2.5,2.5180 PRINT @32,21:5,5190 PRINT @32,20:125,5,125,95,5,95,5,5200 NEXT I1210 MOVE 22,70220 PRINT "G. J.  O R P H A N   &   A S S O C I A T E S"230 MOVE 22,65240 PRINT "CONSULTING                         ENGINEERS"250 MOVE 45,50260 PRINT "CABLE LAYOUT PROGRAM"270 MOVE 46,35280 PRINT "*** REPORT TASK ***"290 FOR I1=1 TO 750300 NEXT I1310 PAGE 320 D0=1330 D1=0340 T1=0350 T2=0360 T3=0370 T4=0380 CALL "TIME",Z$390 IF Z$<>"" THEN 430400 PRINT "
Enter the Date and Time (DD-MMM-YY HH:MM:SS): ";410 INPUT Z$420 CALL "SETTIME",Z$430 PRINT "
How many Disk Units are there in your System? ";440 INPUT J1450 IF J1=2 THEN 540460 IF J1=1 THEN 490470 PRINT "Answer must be '1' or '2'!"480 GO TO 430490 PRINT "
Insert the Floppy Disk into the Disk Unit.  Type <CR> ";500 PRINT "to continue. ";510 INPUT Z$520 CALL "mount",D1,Z$530 GO TO 590540 PRINT "
Insert if System Disk in Disk Unit #1 and the Job Disk ";550 PRINT "in Disk          Unit #0.  Type <CR> to continue. ";560 INPUT Z$570 CALL "MOUNT",D1,Z$580 CALL "MOUNT",D0,Z$590 PRINT "
Shall the Report be generated on the Screen(32) or on ";600 PRINT "the Line          Printer(41 or 51)? ";610 INPUT D9620 IF D9=32 OR D9=41 OR D9=51 OR D9=58 THEN 650630 PRINT "Please answer with '32', '41', or '51'!"640 GO TO 590650 PRINT "
Indicate Job or Customer Code: ";660 INPUT Y$670 Z$=SEG(Y$,1,1)680 IF Z$=>"A" AND Z$<="Z" THEN 710690 PRINT "Customer Code must begin with an Alphabetic Character!"700 GO TO 650710 Z$="@"&Y$720 Z$=Z$&"/SHEETS"730 CALL "FILE",D1,Z$,B$740 IF B$<>"" THEN 770750 PRINT "Customer Code ";Y$;" doesn't exist on this Disk!"760 GO TO 650770 OPEN Z$;1,"F",B$780 READ #1,1:Z0790 IF Z0=0 THEN 2860800 PRINT "
The Sheet Numbers associated with Customer Code ";Y$;810 PRINT " are:"820 FOR I1=2 TO Z0+1830 READ #1,I1:B$840 PRINT "  ";B$850 NEXT I1860 PRINT "
Would you like to see the Report for all Sheet Numbers";870 PRINT "(1) or "880 PRINT "for one given Sheet Number(2)? ";890 INPUT B2900 IF B2=1 THEN 2020910 IF B2=2 THEN 940920 PRINT "Please answer '1' or '2'!"930 GO TO 860940 PRINT "
Indicate desired Sheet Number: ";950 INPUT J$960 J1=0970 FOR I1=2 TO Z0+1980 READ #1,I1:B$990 IF B$<>J$ THEN 10201000 J1=11010 I1=Z0+11020 NEXT I11030 IF J1=1 THEN 10601040 PRINT J$;" is not one of the listed Sheet Numbers!"1050 GO TO 9401060 L$="@"&Y$1070 L$=L$&"/S"1080 L$=L$&J$1090 L$=L$&"/PL/"1100 GOSUB 11201110 GO TO 28601120 OPEN "@MASTERLIST";3,"F",B$1130 OPEN "@CABLELIST";4,"F",B$1140 D$=L$&"PEDS"1150 OPEN D$;5,"F",B$1160 D$=L$&"CABLES"1170 OPEN D$;6,"F",B$1180 D$=L$&"SUMPARTS"1190 OPEN D$;7,"F",B$1200 D$=L$&"SUMCABLE"1210 OPEN D$;8,"F",B$1220 READ #3,80:Z91230 READ #5,1:A11240 IF D9<>32 THEN 12701250 PRINT ""1260 INPUT E$1270 PRINT @D9:"CUSTOMER CODE ";Y$;", SHEET NUMBER ";J$;"
"1280 FOR I1=2 TO A1+11290 READ #5,I1:A$1300 Z$="PED"&A$1310 CLOSE 21320 D$=L$&Z$1330 OPEN D$;2,"F",B$1340 READ #2,79:A21350 PRINT @D9:"
Pedestal ";A$;", Meter Reading: ";A21360 PRINT @D9:"  Parts:"1370 FOR I2=1 TO Z91380 READ #2,I2:A21390 IF A2=0 THEN 14201400 READ #3,I2:C$1410 PRINT @D9:"    ";C$;" - ";A21420 NEXT I21430 NEXT I11440 PRINT @D9:"
Totals:"1450 READ #3,80:Z91460 FOR I2=1 TO Z91470 READ #7,I2:A21480 IF A2=0 THEN 15101490 READ #3,I2:C$1500 PRINT @D9:"    ";C$;" - ";A21510 NEXT I21520 CLOSE 21530 READ #7,80:Z91540 READ #6,1:A11550 FOR I1=2 TO A1+11560 READ #6,I1:A$1570 Z$="CABLE"&A$1580 D$=L$&Z$1590 PRINT @D9:"
Cable ";A$1600 CLOSE 11610 OPEN D$;1,"F",B$1620 READ #1,77:N$1630 READ #1,78:M$1640 PRINT @D9:"  Adjoining Pedestals: ";N$;" and ";M$1650 READ #1,79:A21660 PRINT @D9:"  In-Line Trenching: ";A21670 PRINT @D9:"  Cable Types:"1680 READ #4,80:Z91690 FOR I6=1 TO Z91700 READ #1,I6:A11710 IF A1=0 THEN 17401720 READ #4,I6:C$1730 PRINT @D9:"    ";C$;" - ";A11740 NEXT I61750 PRINT @D9:"  Construction Units:"1760 READ #4,80:Z91770 FOR I2=1 TO Z91780 READ #1,I2:A2,A01790 IF A0=0 THEN 18201800 READ #4,I2:C$1810 PRINT @D9:"    ";C$;" - ";A01820 NEXT I21830 NEXT I11840 PRINT @D9:"
Totals:"1850 READ #8,79:A21860 PRINT @D9:"  In-Line Trenching: ";A21870 PRINT @D9:"  Cable Types:"1880 FOR I2=1 TO Z91890 READ #8,I2:A01900 IF A0=0 THEN 19301910 READ #4,I2:C$1920 PRINT @D9:"    ";C$;" - ";A01930 NEXT I21940 PRINT @D9:"  Construction Units:"1950 FOR I2=1 TO Z91960 READ #8,I2:A0,A01970 IF A0=0 THEN 20001980 READ #4,I2:C$1990 PRINT @D9:"    ";C$;" - ";A02000 NEXT I22010 RETURN 2020 FOR I9=2 TO Z0+12030 CLOSE 52040 Z$="@"&Y$2050 Z$=Z$&"/SHEETS"2060 OPEN Z$;5,"F",B$2070 READ #5,I9:J$2080 L$="@"&Y$2090 L$=L$&"/S"2100 L$=L$&J$2110 L$=L$&"/PL/"2120 CLOSE 32130 CLOSE 42140 CLOSE 52150 CLOSE 62160 CLOSE 72170 CLOSE 82180 GOSUB 11202190 NEXT I92200 CLOSE 32210 CLOSE 42220 CLOSE 52230 CLOSE 62240 CLOSE 72250 CLOSE 82260 OPEN "@MASTERLIST";3,"F",B$2270 OPEN "@CABLELIST";4,"F",B$2280 READ #3,80:C12290 READ #4,80:C22300 FOR P1=2 TO Z0+12310 Z$="@"&Y$2320 Z$=Z$&"/SHEETS"2330 OPEN Z$;5,"F",B$2340 READ #5,P1:J$2350 L$="@"&Y$2360 L$=L$&"/S"2370 L$=L$&J$2380 L$=L$&"/PL/"2390 CALL "USERLIB",L$2400 CLOSE 52410 CLOSE 72420 CLOSE 82430 D$=L$&"SUMPARTS"2440 OPEN D$;7,"R",B$2450 D$=L$&"SUMCABLE"2460 OPEN D$;8,"R",B$2470 T1(80)=C12480 FOR I1=1 TO C12490 READ #7,I1:A12500 IF A1=0 THEN 25202510 T1(I1)=T1(I1)+A12520 NEXT I12530 T2(80)=C22540 T3(80)=C22550 FOR I6=1 TO C22560 READ #8,I6:A1,A22570 T2(I6)=T2(I6)+A12580 T3(I6)=T3(I6)+A22590 NEXT I62600 READ #8,79:A12610 T4=T4+A12620 NEXT P12630 IF D9<>32 THEN 26602640 PRINT ""2650 INPUT E$2660 PRINT @D9:"TOTALS FOR CUSTOMER CODE ";Y$2670 PRINT @D9:"
Pedestals:"2680 FOR I1=1 TO C12690 IF T1(I1)=0 THEN 27202700 READ #3,I1:C$2710 PRINT @D9:"  ";C$;" - ";T1(I1)2720 NEXT I12730 PRINT @D9:"
In-Line Trenching: ";T42740 PRINT @D9:"
Cable Types:"2750 FOR I1=1 TO C22760 IF T2(I1)=0 THEN 27902770 READ #4,I1:C$2780 PRINT @D9:"  ";C$;" - ";T2(I1)2790 NEXT I12800 PRINT @D9:"
Construction Operations:"2810 FOR I1=1 TO C22820 IF T3(I1)=0 THEN 28502830 READ #4,I1:C$2840 PRINT @D9:"  ";C$;" - ";T3(I1)2850 NEXT I12860 PRINT ""2870 END 