100 REM    STEREONET PROGRAM PLOTTING ROUTINE110 REM          BY STEVE WILSON120 REM         REVISED 9/23/82130 REM140 REM150 INIT 160 VIEWPORT 0,150,0,100170 SET DEGREES 180 WINDOW -19.05,19.05,-12.7,12.7185 GOSUB 13000187 GOSUB 14000188 IF E6=0 THEN 950190 PRINT "DATA: ENTER FROM KEYBOARD=1 OR DATA FILE(BINARY) =2: ";200 INPUT E1210 GO TO E1 OF 290,220220 PRINT "ENTER FILE NO. ";230 INPUT E235 REM ** FINDS BINARY DATA FILE IF E1=2 ***240 FIND E250 READ @33:N260 GOSUB 4100270 READ @33:X,Y,Z,P280 GO TO 650285 REM ** DATA INPUT FROM KEYBOARD ****290 PRINT "ENTER NUMBER OF DATA POINTS: ";300 INPUT N310 GOSUB 4100312 REM ** TYPES OF SYMBOLS FOR DATA ***315 PRINT USING "LL":320 PRINT " ENTER DATA (DIRECTION, AMOUNT)"321 PRINT USING "LL":322 PRINT USING 330:"POLE TO PLANE SYMBOLS"323 PRINT USING 331:"1=triangle"324 PRINT USING 331:"2=open square"325 PRINT USING 331:"3=open circle"326 PRINT USING "L":327 PRINT USING 330:"LINEATION SYMBOLS"328 PRINT USING 331:"4=dot"329 PRINT USING 331:"5=asterisk"330 IMAGE 5X,22A331 IMAGE 10X,22A332 PRINT USING "LL":340 FOR I=1 TO N350 PRINT "DATA POINT NO. ";I360 INPUT A1,D,P(I)370 REM **** A1 = AZZIMUTH , D = DIP, P(I) TYPE OF POINT ****380 GO TO P(I) OF 450,450,450,400,400,450,450390 REM CALCULATES X,Y,Z FOR LINEATION400 X(I)=10*COS(D)*SIN(A1)410 Y(I)=10*COS(D)*COS(A1)420 Z(I)=10*SIN(D)430 GO TO 480440 REM CALCULATES X,Y,Z FOR POLE TO PLANE450 X(I)=10*COS(90-D)*SIN(A1+180)460 Y(I)=10*COS(90-D)*COS(A1+180)470 Z(I)=10*SIN(90-D)480 NEXT I485 REM ** STORE DATA ON TAPE **490 PRINT "STORE DATA ON TAPE? (YES=1, NO=2):  ";500 INPUT E510 GO TO E OF 520,650520 PRINT "ENTER FILE NO. (IF NOT KNOW ENTER '0' FOR A TLIST) ";530 INPUT E1540 IF E1=0 THEN 610550 FIND E1560 MARK 1,40*N+10*N570 FIND E1580 WRITE @33:N,X,Y,Z,P590 CLOSE 600 GO TO 650610 PAGE 620 TLIST 630 CALL "WAIT",5640 GO TO 520650 FOR I=1 TO N660 Z2=10*SQR(2)*SIN(45-ASN(Z(I)/10)/2)670 REM  **** Z2 IS A DUMMY VARIABLE ****680 REM    CALCULATE THE PLOTTING COORDINATES690 X1(I)=Z2*SIN(ASN(X(I)/(10*COS(ASN(Z(I)/10)))))700 Y1(I)=Z2*COS(ACS(Y(I)/(10*COS(ASN(Z(I)/10)))))710 NEXT I720 PRINT " OUTPUT DEVICE (32= SCREEN , 1= PLOTTER): ";730 INPUT C740 PRINT "WOULD YOU LIKE STEREONET PLOTTED (1=YES, 2=NO):  ";750 INPUT E760 GO TO E OF 770,800770 PAGE 780 GOSUB 4400790 GO TO 810800 PAGE 810 FOR I=1 TO N820 MOVE @C:X1(I),Y1(I)830 GOSUB P(I) OF 3500,7100,7900,3100,9600,11000,12000870 NEXT I880 MOVE -18,-11890 PRINT "WOULD YOU LIKE TO PLOT AGAIN (1=YES, 2=NO)";900 INPUT E910 IF E=1 THEN 920912 PAGE 913 GO TO 100920 PRINT "ENTER DEVICE NO. (1=PLOTTER, 32=SCREEN)";930 INPUT C940 GO TO 740950 END 3000 REM    SUBROUTINE FOR PLOTTING LINEATION SYMBOL NO. 43100 DRAW @C:X1(I),Y1(I)3300 RETURN 3400 REM    SUBROUTINE FOR POLE TO PLANE SYMBOL3500 RMOVE @C:0.1,-0.13600 RDRAW @C:-0.1,0.23700 RDRAW @C:-0.1,-0.23800 RDRAW @C:0.2,03900 RETURN 4000 REM SUBROUTINE THAT DIMENSIONS VARIABLES4100 DIM X(N),Y(N),Z(N),X1(N),Y1(N),P(N)4200 RETURN 4300 REM SUBROUTINE TO PLOT THE STEREONET4400 DIM A(361),B(361)4500 FOR J=1 TO 3614600 D=J-14700 A(J)=10*COS(D)4800 B(J)=10*SIN(D)4900 NEXT J4950 IF E=3 THEN 62755000 MOVE @C:-0.5,05100 DRAW @C:0.5,05200 MOVE @C:0,0.55300 DRAW @C:0,-0.55400 MOVE @C:A(1),B(1)5500 FOR J=2 TO 3615600 DRAW @C:A(J),B(J)5700 NEXT J5800 MOVE @C:0,10.25900 DRAW @C:0,11.26000 MOVE @C:-0.13,11.46100 PRINT @C:"N"6200 MOVE @C:-18,86275 RETURN 7100 REM SUBROUTINE FOR POLE TO PLANE SYMBOL NO 27200 RMOVE @C:0.1,-0.17300 RDRAW @C:0,0.27400 RDRAW @C:-0.2,07500 RDRAW @C:0,-0.27600 RDRAW @C:0.2,07700 RETURN 7800 REM SUBROUTINE FOR POLE TO PLANE SYMBOL NO 37900 IF E=1 THEN 82008000 E=38100 GOSUB 44008200 DIM E8(37),E9(37)8300 E=18400 FOR J=1 TO 361 STEP 108500 E8(E)=0.01*A(J)+X1(I)8600 E9(E)=0.01*B(J)+Y1(I)8700 E=E+18800 NEXT J8900 MOVE @C:E8(1),E9(1)9000 FOR J=2 TO 379100 DRAW @C:E8(J),E9(J)9200 NEXT J9300 E=19400 RETURN 9500 REM SUBROUTINE FOR LINEATION SYMBOL NO 59600 FOR J=1 TO 49700 MOVE @C:X1(I),Y1(I)9800 D=J-19900 ROTATE D*4510000 GOSUB 1040010100 NEXT J10200 ROTATE 010300 RETURN 10400 RMOVE @C:-0.1,010500 RDRAW @C:0.2,010600 RMOVE @C:-0.1,-0.110700 RDRAW @C:0,0.210800 RETURN 11000 REM SUBROUTINE TO DRAW VECTOR MEAN SYMBOL NO.611010 RMOVE @C:0,-0.1511020 RDRAW @C:0,0.311030 RMOVE @C:-0.15,-0.1511040 RDRAW @C:0.3,011050 RETURN 12000 REM SUBROUTINE TO DRAW POLE TO PIE PLANE SYMBOL NO.712010 RMOVE @C:-0.187,-0.2387612020 PRINT @C:"#"12030 D=ASN(Z(I)/10)12040 L=Y(I)/(10*COS(D))12050 IF L<=1 THEN 1207012060 L=112070 A3=ACS(L)12080 IF X(I)=>0 THEN 1211012090 A3=360-A312100 GO TO 1212512110 IF A3<360 THEN 1212512120 A3=A3-36012125 D=90-D12127 REM ** CALCULATES AND PLOTS THE CYCLOGRAPHIC TRACE ***12130 FOR J=181 TO 36112140 X3=10*SIN(J-1)*COS(D)*SIN(A3)+10*COS(J-1)*COS(A3)12150 Y3=10*SIN(J-1)*COS(D)*COS(A3)-10*COS(J-1)*SIN(A3)12160 Z3=-10*SIN(J-1)*SIN(D)12190 Z4=10*SQR(2)*SIN(45-ASN(Z3/10)/2)12200 X4=Z4*SIN(ASN(X3/(10*COS(ASN(Z3/10)))))12210 Y4=Z4*COS(ACS(Y3/(10*COS(ASN(Z3/10)))))12220 IF J>181 THEN 1224012230 MOVE @C:X4,Y412240 DRAW @C:X4,Y412250 NEXT J12260 DELETE J,Z4,X4,Y4,X3,Y3,Z312270 RETURN 13000 PAGE 13010 PRINT "Welcome to the STEREONET program package.  At present"13020 PRINT "this series of programs alows the user to:"13030 PRINT 13040 PRINT "         1)input data, store it on tape, and"13050 PRINT "             plot it on either the screen or"13060 PRINT "             the plotter"13070 PRINT 13080 PRINT "         2)add, delete or change information"13090 PRINT "             currently on tape"13100 PRINT ""13110 PRINT "         3)calculate the vector mean"13120 PRINT ""13130 PRINT "         4)calculate the least squares best fit"13140 PRINT "             pie pole"13150 PRINT " "13160 PRINT "         5)rotate data about any orientation"13170 PRINT 13180 PRINT " These programs were writen by STEVE WILSON AUGUST 1982"13190 PRINT 13200 RETURN 13999 REM ** ALOWS ACCESS TO THE OTHER PROGRAMS14000 PRINT " ENTER THE PROGRAM NUMBER THAT YOU WANT TO RUN"14010 PRINT "      1= STEREONET PLOTTING PROGRAM"14020 PRINT "      2= STEREONET ROTATION PROGRAM"14030 PRINT "      3= STEREONET DATA EDITING PROGRAM"14040 PRINT "      4= STEREONET VECTOR MEAN AND PIE-POLE PROGRAM"14050 PRINT "      0= NOTHING BUT EXITS YOU FROM THIS PROGRAM"14060 PRINT " ENTER PROGRAM NUMBER: ";14070 INPUT E614080 IF E6=1 OR E6=0 THEN 1411014090 FIND E614100 OLD 14110 RETURN 