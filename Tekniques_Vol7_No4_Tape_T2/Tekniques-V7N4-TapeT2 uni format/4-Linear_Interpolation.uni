100 REM  ---------------DRIVER FOR INTERP----------------110 REM INTERP: X (INDEPENDENT BASIS ARRAY) MUST BE MONOTONIC120 REM         Y (DEPENDENT BASIS ARRAY)130 REM         B (INDEPENDENT TARGET ARRAY) MUST BE MONOTONIC140 REM         C (DEPENDENT TARGET ARRAY)150 REM        C1 FILL VALUE (C(I)=C1 WHEN B(I) OUTSIDE OF X)160 REM        N4=ARRAY SIZE FOR X,Y BASIS ARRAYS170 REM        N5=ARRAY SIZE FOR B,C TARGET ARRAYS180 DATA 54,55,1.0E-30190 RESTORE 180200 READ N4,N5,C1210 DELETE X,Y,B,C220 DIM X(N5),Y(N5),B(N4),C(N4)230 FOR I=1 TO N5240 L=N5-I+1250 X(L)=-(N5/2-I)*1.2260 Y(L)=SIN(I)270 NEXT I280 FOR I=1 TO N4290 L=N4-I+1300 B(L)=L310 NEXT I320 GOSUB 370330 GO TO 680340 REM350 REM   ------------------END OF DRIVER FOR INTERP---------------360 REM370 REM   -------------------START OF BASIC INTERP-----------------380 REM    INTERP: ROUTINE PERFORMS A LINEAR INTERPOLATION USING THE390 REM    BASIS ARRAYS X AND Y CONTAINING THE ORIGINAL DATA ONTO400 REM    THE INDEPENDENT VARIABLE TARGET ARRAY B, AND STORES THE410 REM    RESULTS IN THE DEPENDENT VARIABLE TARGET ARRAY C.420 REM    THE INDEPENDENT BASIS ARRAY MUST BE EITHER430 REM    MONOTONICALLY INCREASING OR DECREASING, THE INDEPENDENT440 REM    TARGET ARRAY B MUST ALSO BE MONOTONIC.  450 REM INTERP: X (INDEPENDENT BASIS ARRAY) MUST BE MONOTONIC460 REM         Y (DEPENDENT BASIS ARRAY)470 REM         B (INDEPENDENT TARGET ARRAY) MUST BE MONOTONIC480 REM         C (DEPENDENT TARGET ARRAY)490 REM        C1 FILL VALUE (C(I)=C1 WHEN B(I) OUTSIDE OF RANGE OF X)500 K=X(N5)>X(1)510 IF K>0 THEN 630520 B=-B530 C=C1540 J1=1550 FOR I=1 TO N4560 L0=B(I)570 IF L0<X(K+N5*(1-K)) OR L0>X(N5*K+1-K) THEN 640580 FOR J=J1 TO N5-1590 J1=J600 IF L0<=X((J+1)*K+J*(1-K)) AND L0=>X(J*K+(J+1)*(1-K)) THEN 620610 NEXT J620 J=J-(J>N5-1)630 C(I)=(Y(J+1)-Y(J))/(X(J+1)-X(J))*(L0-X(J))+Y(J)640 NEXT I650 REM   --------------------END OF BASIC INTERP------------------660 REM670 REM   ------------PLOT ORIGINAL AND INTERPOLATED DATA----------680 VIEWPORT 0,130,5,95690 WINDOW -35,35,-1.5,1.5700 MOVE X(1),Y(1)710 DRAW X,Y720 MOVE B(1),C(1)730 DRAW B,C