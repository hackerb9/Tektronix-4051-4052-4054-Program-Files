100 PRINT "ROTATION PROGRAM FOR STEREONETS"110 PRINT " "120 PRINT "ENTER BINARY DATA FILE NUMBER : ";130 INPUT E140 FIND E150 SET DEGREES 155 REM ** READS IN DATA FROM TAPE **156 REM ** NO PROVISION FOR KEYBOARD ENTRY**160 READ @33:N170 DIM X(N),Y(N),Z(N),P(N),X2(N),Y2(N),Z2(N)180 READ @33:X,Y,Z,P190 CLOSE 191 PRINT "SIGN CONVENTION FOR ROTATION PROGRAM"192 PRINT 193 PRINT "  Top Angle - clockwise rotations are positive (+)"194 PRINT 195 PRINT "  Side Angle - (rotations around the north arrow)"196 PRINT "             - clockwise (ie; R to L ) rotations "197 PRINT "             - are positive (+)"198 PRINT 200 PRINT "ENTER TOP ANGLE : ";210 INPUT T1220 PRINT "ENTER SIDE ANGLE : ";230 INPUT S1235 REM ** ROTATES THE DATA **240 FOR I=1 TO N250 X2(I)=(X(I)*COS(T1)-Y(I)*SIN(T1))*COS(S1)-Z(I)*SIN(S1)260 Y2(I)=X(I)*SIN(T1)+Y(I)*COS(T1)270 Z2(I)=(X(I)*COS(T1)-Y(I)*SIN(T1))*SIN(S1)+Z(I)*COS(S1)271 IF Z2(I)=>0 THEN 280272 X2(I)=-X2(I)273 Y2(I)=-Y2(I)274 Z2(I)=-Z2(I)275 REM ** LINES 271-274 MAKE SURE THAT Z IS POSITIVE **280 NEXT I290 FOR I=1 TO N295 E=X2(I)300 X2(I)=X2(I)*COS(-T1)-Y2(I)*SIN(-T1)310 Y2(I)=E*SIN(-T1)+Y2(I)*COS(-T1)320 NEXT I330 PRINT "ENTER OUTPUT FILE : ";340 INPUT E1341 PRINT "IS THIS FILE NEW OR OLD (1=NEW, 2=OLD):  ";342 INPUT E2343 IF E2=2 THEN 365350 FIND E1360 MARK 1,40*N+10*N365 KILL E1370 FIND E1380 WRITE @33:N,X2,Y2,Z2,P385 GOSUB 1000387 IF E6=2 THEN 100390 END 999 REM ** ALOWS ACCESS TO OTHER PROGRAMS IN THIS PACKAGE **1000 PRINT " ENTER THE PROGRAM NUMBER THAT YOU WANT TO RUN"1010 PRINT "      1= STEREONET PLOTTING PROGRAM"1020 PRINT "      2= STEREONET ROTATION PROGRAM"1030 PRINT "      3= STEREONET DATA EDITING PROGRAM"1040 PRINT "      4= STEREONET VECTOR MEAN AND PIE-POLE PROGRAM"1050 PRINT "      0= NOTHING BUT EXITS YOU FROM THIS PROGRAM"1060 PRINT " ENTER PROGRAM NUMBER: ";1070 INPUT E61080 IF E6=0 OR E6=2 THEN 11101090 FIND E61100 OLD 1110 RETURN 