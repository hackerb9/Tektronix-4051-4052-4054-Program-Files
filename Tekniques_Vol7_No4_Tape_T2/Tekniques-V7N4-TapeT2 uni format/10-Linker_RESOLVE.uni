100 REM RESOLVE BY JAMES A. BAINS,JR., PH.D110 PRINT "TO INCLUDE A NON-RENUMBERABLE ASCII FILE,"120 PRINT "ENTER FILE I.D.: ";130 INPUT D$140 PRINT "ENTER 'L' TO PURGE 'REMLBL' AND 'REMREF' STATEMENTS,"150 PRINT "ENTER 'A' TO PURGE ALL 'REM' STATEMENTS: ";160 INPUT C$170 IF C$="A" THEN 210180 IF C$="L" THEN 230190 C$=""200 GO TO 250210 C$="REM"220 GO TO 250230 C$="REMLBL"240 REM PASS 1250 KILL "@SCRATCHLIB/LABELTABLE"260 CREATE "@SCRATCHLIB/LABELTABLE";1,0270 OPEN "@SCRATCHLIB/LABELTABLE";2,"F",A$280 ON EOF (2) THEN 1650290 ON EOF (1) THEN 1580300 IF D$="" THEN 1670310 Q1=0320 OPEN D$;1,"R",A$330 Q=0340 INPUT #1:A$350 IF Q=1 THEN 710360 F=POS(A$,"REMLBL",1)370 IF F<2 OR F>7 THEN 340380 Z$=SEG(A$,F+6,1)390 F=F+1400 IF Z$=" " THEN 380410 I=LEN(A$)420 Z$=SEG(A$,I,1)430 I=I-1440 IF I>0 AND Z$=" " THEN 420450 Z$=SEG(A$,F+5,I-F-3)460 CALL "REWIND",2470 READ #2:G$,A$480 IF Q=1 THEN 520490 IF G$<>Z$ THEN 470500 PRINT "DUPLICATE LABEL ";Z$510 END 520 Q=0530 INPUT #1:A$540 IF Q=1 THEN 1770550 F=POS(A$,"REMLBL",1)560 IF F<2 OR F>7 THEN 590570 WRITE #2:Z$,"X"580 GO TO 380590 F=POS(A$,"REMREF",1)600 IF F>1 AND F<8 THEN 530610 IF A$="" THEN 530620 I=1630 I=I+1640 B$=SEG(A$,I,1)650 B0=ASC(B$)660 IF B0>47 AND B0<58 THEN 630670 B$=SEG(A$,1,I-1)680 WRITE #2:Z$,B$690 GO TO 330700 REM PASS 2710 CLOSE 1720 PRINT "ENTER FILE I.D. FOR LINKED FILE: ";730 INPUT Y$740 Z$=SEG(Y$,1,1)750 IF Z$<>"#" AND Z$<>"?" AND Z$<>"*" THEN 780760 DIRECTORY 0770 GO TO 720780 SAVE Y$,"A";100,100790 OPEN Y$;3,"F",A$800 ON EOF (2) THEN 1750810 IF D$="" THEN 1690820 Q1=0830 OPEN D$;1,"R",A$840 GO TO 880850 F=POS(A$,C$,1)860 IF F>1 AND F<8 THEN 880870 PRINT #3:A$880 Q=0890 INPUT #1:A$900 IF Q=1 THEN 1800910 IF A$="" THEN 890920 F=POS(A$,"REMREF",1)930 IF F<2 OR F>7 THEN 850940 IF C$<>"" THEN 960950 PRINT #3:A$960 B$=SEG(A$,F+6,80)970 P=POS(B$,",",1)980 IF P=0 THEN 1010990 H$=SEG(B$,P+1,80)1000 B$=SEG(B$,1,P-1)1010 F=01020 F=F+11030 G$=SEG(B$,F,1)1040 IF G$=" " THEN 10201050 I=LEN(B$)1060 G$=SEG(B$,I,1)1070 I=I-11080 IF I>0 AND G$=" " THEN 10601090 B$=SEG(B$,F,I-F+2)1100 IF Q=2 THEN 12901110 INPUT #1:A$1120 IF Q=1 THEN 17101130 IF A$="" THEN 11101140 F=POS(A$,"REMREF",1)1150 IF F>1 AND F<8 THEN 17201160 F=POS(A$,"REMLBL",1)1170 IF F>1 AND F<8 THEN 17201180 L=LEN(A$)1190 I=L+11200 I=I-11210 G$=SEG(A$,I,1)1220 B0=ASC(G$)1230 IF B0>47 AND B0<58 THEN 12001240 IF I=L THEN 17201250 IF G$="," OR G$=" " THEN 12001260 E$=SEG(A$,I+1,L)1270 A$=SEG(A$,1,I)1280 A$=A$&" "1290 F=POS(E$,",",1)1300 G$=SEG(E$,1,F-1)1310 E$=SEG(E$,F+1,80)1320 IF F<>0 THEN 13501330 G$=E$1340 E$=""1350 IF B$="" THEN 15401360 I=01370 I=I+11380 G$=SEG(B$,I,1)1390 IF G$="" THEN 15601400 B0=ASC(G$)1410 IF B0>47 AND B0<58 THEN 13701420 CALL "REWIND",21430 READ #2:G$,Z$1440 IF G$<>B$ THEN 14301450 IF Z$<>"X" THEN 14801460 READ #2:G$,Z$1470 IF Z$="X" THEN 14601480 A$=A$&Z$1490 IF P=0 THEN 8501500 A$=A$&","1510 Q=21520 B$=H$1530 GO TO 9701540 IF G$="" THEN 17201550 B$=G$1560 Z$=B$1570 GO TO 14801580 CLOSE 11590 IF Q1=1 THEN 16501600 Q1=11610 OPEN "@SCRATCHLIB/LINKFILE";1,"R",A$1620 Q=01630 INPUT #1:A$1640 RETURN 1650 Q=11660 RETURN 1670 GOSUB 16001680 GO TO 3501690 GOSUB 16001700 GO TO 9001710 A$="END OF FILE"1720 PRINT "SYNTAX ERROR IN USE OF LABEL REFERENCE ";B$1730 PRINT "BEFORE ";A$1740 END 1750 PRINT "UNRESOLVED LABEL REFERENCE ";B$1760 END 1770 PRINT "SYNTAX ERROR IN USE OF LABEL DEFINITION ";Z$1780 PRINT "BEFORE END OF FILE"1790 END 1800 PRINT #3:1810 CLOSE 1820 DELETE 110,18201830 IF D$="" THEN 18501840 DELETE ALL 1850 APPEND Y$,"A";1001860 RENUMBER R,10,1001870 INIT 1880 DELETE 1830,1880