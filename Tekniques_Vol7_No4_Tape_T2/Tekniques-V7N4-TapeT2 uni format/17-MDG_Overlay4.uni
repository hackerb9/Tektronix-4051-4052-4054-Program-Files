1225 REM3000 REM3280 FOR K=1 TO N13290 IF Z=32 THEN 33303295 IF B$="N" THEN 33303300 PRINT "
 CHANGE PEN COLOR IF DESIRED, THEN PRESS CR";3310 PRINT @Z:"";3320 INPUT X$3330 IF N4(K)=1 OR N4(K)=6 THEN 33503340 GOSUB N4(K)-1 OF 100,145,200,2603350 X5=03360 Y5=03370 M4=13430 FOR I=1 TO N3450 IF Y(I,K)<0 THEN 40503451 IF B2(K)=2 THEN 34543453 IF K>1 THEN 34603454 B5(I)=203460 R=20+70*Y(I,K)/V3470 C=S3+S2*(I-1)3490 IF D4(K)=7 THEN 40403500 IF B2(K)=1 OR B2(K)=2 THEN 36403510 IF I=1 THEN 35403520 IF Y(I-1,K)<0 OR (R<B5(I) AND H7=1) THEN 35403530 GO TO 35703540 PRINT @Z,21:C,R3550 C1=C3560 R1=R3570 IF D4(K)=0 THEN 36203580 GOSUB 60003590 C1=C3600 R1=R3610 GO TO 40303620 PRINT @Z,20:C,R3630 GO TO 40303640 IF N9=0 THEN 36903660 W2=(W1*2/N9-0.5)/23670 C2=C-W1+V1+N8*V1*23680 GO TO 37103690 C2=C3700 W2=W13710 IF R<B5(I) AND H7=1 THEN 40503740 PRINT @Z,21:C2-W2,B5(I)3750 PRINT @Z,20:C2-W2,R,C2+W2,R,C2+W2,B5(I),C2-W2,B5(I)3790 IF D(K)<0 THEN 39203800 IF D(K)=0 THEN 40303810 D1=W2/(D(K)/2)3830 PRINT @Z,21:C2-W2+D1,B5(I)3840 FOR J=D1 TO 2*W2 STEP 2*D13850 PRINT @Z,20:C2-W2+J,B5(I),C2-W2+J,R3870 IF C2-W2+J+D1>C2+W2 THEN 40303880 PRINT @Z,20:C2-W2+J+D1,R,C2-W2+J+D1,B5(I)3900 NEXT J3910 GO TO 40303920 D1=18/-D(K)3940 PRINT @Z,21:C2-W2,B5(I)+D13950 FOR J=D1 TO R STEP 2*D13960 IF B5(I)+J>R THEN 40203970 PRINT @Z,20:C2-W2,B5(I)+J,C2+W2,B5(I)+J3990 IF B5(I)+D1+J>R THEN 40204000 PRINT @Z,20:C2+W2,B5(I)+D1+J,C2-W2,B5(I)+D1+J4020 NEXT J4030 REM B5 IS PROPAGATING HORIZON4040 B5(I)=R4050 NEXT I4060 IF K>5 THEN 40904070 IF B2(K+1)<>2 THEN 40904080 N8=N8+14090 GOSUB 80004100 NEXT K4250 PRINT @Z:"";4330 END 6000 O4=R-R16020 H4=C-C16030 Z1=SQR(ABS(H4*H4+O4*O4))6040 IF Z1=0 THEN 62706050 X4=C16060 Y4=R16070 IF D4(K)=7 THEN 62706080 I4=(Z4(D4(K),M4)-SQR(X5*X5+Y5*Y5))/Z16090 X4=X4+H4*I46100 Y4=Y4+O4*I46110 X5=06120 Y5=06130 IF X4<=C THEN 61806140 X5=ABS(C1-C)6150 Y5=ABS(R1-R)6160 X4=C6170 Y4=R6180 PRINT @Z,21:C1,R16190 IF M4=2 OR M4=4 THEN 62106200 PRINT @Z,20:X4,Y46210 M4=(M4+1)*(M4<>4)+(M4=4)6220 C1=X46230 R1=Y46240 IF X4<C THEN 60806250 IF X5=0 AND Y5=0 THEN 62706260 M4=(M4-1)*(M4<>1)+4*(M4=1)6270 RETURN 8000 WINDOW 0,130,0,1008010 VIEWPORT 0,130,0,1008020 H5=H28030 Q1=3.5*H5-((4-K)*H5*(K<4)+(7-K)*H5*(K>3))8040 Q2=19*(K<4)+110*(K>3)8050 C$=SEG(D$,K*16-15,16)8060 IF C$="                " THEN 87108070 FOR T=16 TO 1 STEP -18080 X$=SEG(C$,T,1)8090 IF X$<>" " THEN 81108100 NEXT T8110 C$=SEG(C$,1,T)8120 IF K<4 THEN 82408130 FOR U=T TO 1 STEP -18140 X$=SEG(C$,U,1)8150 IF X$<>" " THEN 81808160 NEXT U8170 GO TO 87108180 PRINT @Z,21:Q2,Q18190 FOR T=1 TO U8200 PRINT @Z:"";8210 NEXT T8220 PRINT @Z:C$;8230 GO TO 82608240 PRINT @Z,21:Q2+1.25,Q18250 PRINT @Z:C$;8260 Q2=Q2+(K>3)*2+(K<4)*-198270 IF D4(K)=7 THEN 87108280 IF B2(K)<1 THEN 85908290 PRINT @Z,21:Q2,Q18300 PRINT @Z,20:Q2,Q1+H2,Q2+18,Q1+H2,Q2+18,Q1,Q2,Q18340 IF D(K)=0 THEN 87108350 IF D(K)<1 THEN 84708360 PRINT @Z,21:Q2+D1,Q18380 FOR T=D1 TO 18 STEP 2*D18390 IF Q2+T>Q2+18 THEN 87108400 PRINT @Z,20:Q2+T,Q1,Q2+T,Q1+H28420 IF Q2+T+D1>Q2+18 THEN 87108430 PRINT @Z,20:Q2+T+D1,Q1+H2,Q2+T+D1,Q18450 NEXT T8460 GO TO 87108470 PRINT @Z,21:Q2,Q1+D18490 FOR T=D1 TO Q1+H2 STEP 2*D18500 IF Q1+T>Q1+H2 THEN 85608510 PRINT @Z,20:Q2,Q1+T,Q2+18,Q1+T8530 IF Q1+T+D1>Q1+H2 THEN 85608540 PRINT @Z,20:Q2+18,Q1+T+D1,Q2,Q1+T+D18560 NEXT T8580 GO TO 87108590 MOVE @Z:Q2,Q1+0.5*H28600 C=Q2+188610 R=Q1+H2/28620 C1=Q28630 R1=R8640 IF D4(K)=0 THEN 87008650 M4=18660 X5=08670 Y5=08680 GOSUB 60008690 GO TO 87108700 PRINT @Z,20:C,R8710 WINDOW 20,120,20,908720 VIEWPORT 20,120,20,908730 RETURN 