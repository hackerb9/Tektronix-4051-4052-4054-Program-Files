1000 REM  ******************RESIDENT OVERLAY*******************1010 REM  *********SPLINE SMOOTHING******** 1020 DELETE Q1030 IF P9<10 THEN 1001040 IF P9<26 THEN 10701050 PRINT "
DRAW A GRAPH BEFORE REQUESTING AN AXIS"1060 END 1070 IF P9>19 THEN 1001080 PRINT "CUBIC SPLINE FIT FOR ";N;" DATA POINTS."1090 REM  *********************************************************1100 REM  VARIABLES:1110 REM    **INPUT**1120 REM        N - THE NUMBER OF DATA POINTS.1130 REM        X,Y-LINEAR ARRAYS CONTAINING THE N (Xi,Yi) DATA PAIRS.1140 REM            THE Xi MUST BE IN STRICTLY INCREASING ORDER.1150 REM        Y0- LINEAR ARRAY OF LENGTH N CONTAINING THE ERROR1160 REM            WEIGTHS FOR EACH Y VALUE.  REASONABLE VALUES ARE1170 REM            STANDARD DEVIATIONS FOR THE Y VALUES.  IF NO SUCH1180 REM            VALUES ARE AVAILABLE THEN SET Y0 = 1.1190 REM    **OUTPUT**1200 REM        C(N,4)-AN ARRAY WITH THE COEFS. OF THE SPLINE FIT.1210 REM1220 DELETE C,Q1230 DIM C(N,4),Q(N,7)1240 Q=01250 P(2)=01260 IF P(12)=1 THEN 13001270 PRINT "
ENTER S (S = 0  FORCES INTERPOLATION) = ";1280 INPUT P11290 P(2)=ABS(P1)1300 P3=N-11310 P7=X(2)-X(1)1320 P5=(Y(2)-Y(1))/P71330 FOR P1=2 TO P31340 P2=P1+11350 P6=P71360 P7=X(P2)-X(P1)1370 P4=P51380 P5=(Y(P2)-Y(P1))/P71390 C(P1,1)=P5-P41400 Q(P1,4)=2*(P6+P7)/31410 Q(P1,5)=P7/31420 Q(P1,3)=Y0(P1-1)/P61430 Q(P1,1)=Y0(P2)/P71440 Q(P1,2)=-Y0(P1)/P6-Y0(P1)/P71450 NEXT P11460 Q(1,1)=01470 Q(N,2)=01480 Q(N,3)=01490 FOR P1=2 TO P31500 P2=P1+11510 C(P1,2)=Q(P1,1)^2+Q(P1,2)^2+Q(P1,3)^21520 C(P1,3)=Q(P1,1)*Q(P2,2)+Q(P1,2)*Q(P2,3)1530 IF P1=P3 THEN 15501540 C(P1,4)=Q(P1,1)*Q(P2+1,3)1550 NEXT P11560 C(P3,4)=01570 Q1=01580 Q2=-P(2)1590 P4=01600 FOR P1=2 TO P31610 P2=P1-21620 IF P2=0 THEN 16501630 Q(P2,3)=P6*Q(P2,1)1640 P4=P6*Q(P2,3)1650 Q3=P1-11660 Q(Q3,2)=P5*Q(Q3,1)1670 Q(P1,1)=1/(Q1*C(P1,2)+Q(P1,4)-P5*Q(Q3,2)-P4)1680 Q(P1,6)=C(P1,1)-Q(Q3,2)*Q(Q3,6)1690 IF P2=0 THEN 17101700 Q(P1,6)=Q(P1,6)-Q(P2,3)*Q(P2,6)1710 P5=Q1*C(P1,3)+Q(P1,5)-P7*Q(Q3,2)1720 P6=P71730 P7=C(P1,4)*Q11740 NEXT P11750 Q(1,6)=01760 Q(N,6)=01770 Q(P3,6)=Q(P3,1)*Q(P3,6)-Q(P3,2)*Q(N,6)1780 IF N<4 THEN 18301790 FOR P1=P3-1 TO 2 STEP -11800 Q(P1,6)=Q(P1,1)*Q(P1,6)-Q(P1,2)*Q(P1+1,6)1810 Q(P1,6)=Q(P1,6)-Q(P1,3)*Q(P1+2,6)1820 NEXT P11830 P4=01840 P7=01850 FOR P1=1 TO P31860 P2=P1+11870 P6=P71880 P7=(Q(P2,6)-Q(P1,6))/(X(P2)-X(P1))1890 Q(P1,7)=(P7-P6)*Y0(P1)^21900 P4=P4+Q(P1,7)*(P7-P6)1910 NEXT P11920 Q(N,7)=-P7*Y0(N)^21930 P4=P4-Q(N,7)*P71940 P6=Q21950 Q2=P4*Q1*Q11960 IF Q2=>P(2) THEN 21601970 IF Q2<=P6 THEN 21601980 P5=01990 P7=(Q(2,7)-Q(1,7))/(X(2)-X(1))2000 FOR P1=2 TO P32010 P6=P72020 P2=P1+12030 P7=(Q(P2,7)-Q(P1,7))/(X(P2)-X(P1))2040 P2=P1-12050 P6=P7-P6-Q(P2,2)*Q(P2,1)2060 P2=P2-12070 IF P2=0 THEN 20902080 P6=P6-Q(P2,3)*Q(P2,1)2090 P5=P5+P6*Q(P1,1)*P62100 Q(P1,1)=P62110 NEXT P12120 P7=P4-Q1*P52130 IF P7<=0 THEN 21602140 Q1=Q1+(P(2)-Q2)/((Q1+SQR(ABS(P(2)/P4)))*P7)2150 GO TO 15902160 FOR P1=1 TO N2170 C(P1,1)=Y(P1)-Q1*Q(P1,7)2180 C(P1,3)=Q(P1,6)2190 NEXT P12200 FOR P1=1 TO P32210 P2=P1+12220 P7=X(P2)-X(P1)2230 C(P1,4)=(C(P2,3)-C(P1,3))/(3*P7)2240 C(P1,2)=(C(P2,1)-C(P1,1))/P7-(P7*C(P1,4)+C(P1,3))*P72250 NEXT P12260 C(N,2)=02270 C(N,4)=02280 P(13)=P92290 IF P(2)=0 THEN 24302300 P2=02310 P3=02320 FOR P1=1 TO N2330 P4=ABS(C(P1,1)-Y(P1))2340 P2=P2+P4*P42350 IF P3=>P4 THEN 23702360 P3=P42370 NEXT P12380 PRINT 2390 PRINT "MAX DEV = ";P32400 PRINT "
STD DEV = ";SQR(P2/(N-1))2410 IF P(12)=1 THEN 24302420 PRINT "
PRESS ""SOLVE"" {KEY #6} WHEN YOU WANT A NEW FIT."2430 DELETE Q2440 REM  ***********************************************************2450 IF P9<>19 THEN 24702460 END 2470 IF P9>19 THEN 1002480 P9=P9+102490 GO TO 1002500 REM  *****END OVL2*****2510 REM  ***************************************************** 2520 REM