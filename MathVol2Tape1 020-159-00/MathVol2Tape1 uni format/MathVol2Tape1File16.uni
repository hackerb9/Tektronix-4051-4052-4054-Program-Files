1000 REM  *************RESIDENT OVERLAY**************************** 1010 REM  *****CHEBYCHEV SMOOTHING***** 1020 DELETE Q1030 IF P9<10 THEN 1001040 IF P9<26 THEN 10701050 PRINT "DRAW A GRAPH BEFORE REQUESTING AN AXIS"1060 END 1070 IF P9>19 THEN 1001080 PAGE 1090 PRINT "CHEBYCHEV FIT FOR ";N;" DATA POINTS"1100 IF P(12)=1 THEN 11601110 PRINT 1120 PRINT "ENTER DEGREE OF POLYNOMIAL = ";1130 INPUT P51140 P5=INT(ABS(P5))1150 IF P5<N-1 THEN 13301160 P5=N-21170 REM  *******************************************************1180 REM  VARIABLES:1190 REM    **INPUT**1200 REM      N - THE NUMBER OF DATA POINTS.1210 REM      X,Y-LINEAR ARRAY CONTAINING THE N (Xi,Yi) DATA PAIRS.1220 REM          THE Xi MUST BE IN STRICTLY INCREASING ORDER.1230 REM      P5- DEGREE OF FIT DESIRED.1240 REM    **OUTPUT**1250 REM      C - LINEAR ARRAY OF LENGTH P5+1 CONTAINING THE COEFS.1260 REM          OF THE CHEBYCHEV TYPE SMOOTHING POLYNOMIAL.1270 REM          F(X) = C(1) + C(2)*X + ... + C(P5+1)*X^P51280 REM      P(18) = P5 + 1 = DEGREE + 11290 REM      P8- THE MAX. DEVIATION BETWEEN THE POLYNOMIAL PRODUCED1300 REM          AND A DATA POINT.1310 REM      Q3- INDEX OF THE DATA POINT WHERE THE MAX. DEVIATION1320 REM          OCCURS.1330 P6=P5+11340 P(18)=P61350 P7=P6+11360 DELETE Q,C1370 DIM Q(P7,3),C(P7)1380 REM  *****START OF CACM ALG. 318***** 1390 P(17)=01400 Q(1,1)=11410 Q(P7,1)=N1420 Q8=INT((N-1)/P6)1430 Q7=Q8+11440 IF P6<2 THEN 15001450 FOR P1=2 TO P61460 Q(P1,1)=Q71470 Q7=Q7+Q81480 NEXT P11490 REM  START OF ITERATION LOOP1500 Q7=-11510 FOR P1=1 TO P71520 Q4=Q(P1,1)1530 Q(P1,2)=X(Q4)1540 C(P1)=Y(Q4)1550 Q7=-Q71560 Q(P1,3)=Q71570 NEXT P11580 REM DIVIDED DIFFERENCES1590 FOR P2=1 TO P61600 Q6=P71610 Q1=C(Q6)1620 Q2=Q(Q6,3)1630 FOR P1=P6 TO P2 STEP -11640 Q3=Q(Q6,2)-Q(P1-P2+1,2)1650 Q4=C(P1)1660 Q5=Q(P1,3)1670 C(Q6)=(Q1-Q4)/Q31680 Q(Q6,3)=(Q2-Q5)/Q31690 Q6=P11700 Q1=Q41710 Q2=Q51720 NEXT P11730 NEXT P21740 Q7=-C(P7)/Q(P7,3)1750 FOR P1=1 TO P71760 C(P1)=C(P1)+Q(P1,3)*Q71770 NEXT P11780 REM  COMPUTE POLYNOMIAL COEFS. 1790 IF P5<1 THEN 19201800 FOR P2=P5 TO 1 STEP -11810 Q5=Q(P2,2)1820 P1=P21830 Q4=C(P1)1840 FOR Q6=P2+1 TO P61850 Q1=C(Q6)1860 C(P1)=Q4-Q5*Q11870 Q4=Q11880 P1=Q61890 NEXT Q61900 NEXT P21910 REM  STOP IF DEVIATION IS NOT INCREASING MONOTONICALLY.1920 P8=ABS(Q7)1930 IF P8=0 THEN 19601940 IF P8<=P(17) THEN 25201950 REM  FIND LARGEST ERROR1960 P(17)=P81970 C(P7)=P81980 Q3=Q(1,1)1990 Q1=Q72000 P2=12010 Q6=Q(P2,1)2020 FOR P1=1 TO N2030 IF P1=Q6 THEN 21602040 Q4=X(P1)2050 Q5=02060 FOR P3=P6 TO 1 STEP -12070 Q5=Q5*Q4+C(P3)2080 NEXT P32090 Q5=Q5-Y(P1)2100 Q2=ABS(Q5)2110 IF Q2<=P8 THEN 21902120 P8=Q22130 Q1=Q52140 Q3=P12150 GO TO 21902160 IF P2>P6 THEN 21902170 P2=P2+12180 Q6=Q(P2,1)2190 NEXT P12200 REM  EXCHANGE REF. POINTS, IF NECESSARY. 2210 IF Q3=Q(1,1) THEN 25702220 FOR P1=1 TO P72230 IF Q3<Q(P1,1) THEN 22602240 NEXT P12250 P1=P72260 P(16)=Q72270 IF P1<>2*INT(P1/2) THEN 22902280 P(16)=-Q72290 IF Q1*P(16)<0 THEN 23202300 Q(P1,1)=Q32310 GO TO 15002320 IF Q3=>Q(1,1) THEN 24002330 Q1=P72340 FOR P2=P6 TO 1 STEP -12350 Q(Q1,1)=Q(P2,1)2360 Q1=P22370 NEXT P22380 Q(1,1)=Q32390 GO TO 15002400 IF Q3<=Q(P7,1) THEN 24802410 P2=12420 FOR Q1=2 TO P72430 Q(P2,1)=Q(Q1,1)2440 P2=Q12450 NEXT Q12460 Q(P7,1)=Q32470 GO TO 15002480 Q(P1-1,1)=Q32490 GO TO 15002500 REM  *****END OF CACM ALG. 318*****2510 REM2520 PRINT 2530 PRINT "ERROR:  ROUNDOFF ERRORS ARE OCCURING -"2540 PRINT "        TRY AGAIN WITH A DEGREE SMALLER THAN ";P52550 GO TO 11102560 REM  FIT FINISHED NORMALLY 2570 DIM C(P6)2580 PRINT 2590 PRINT "MAX. DEVIATION, ";P8;", OCCURS AT X = ";X(Q3)2600 PRINT "
PRESS ""SOLVE"" {KEY #6} WHEN YOU WANT A NEW FIT."2610 REM  *********************************************************2620 P(13)=P92630 Q2=02640 Q1=X(1)2650 FOR P1=P6 TO 1 STEP -12660 Q2=Q2*Q1+C(P1)/P12670 NEXT P12680 P(20)=Q2*Q12690 DELETE Q2700 IF P9<>19 THEN 27202710 END 2720 IF P9>19 THEN 1002730 P9=P9+102740 GO TO 1002750 REM  *****END OVL2**************** 2760 REM  ******************************************************* 2770 REM