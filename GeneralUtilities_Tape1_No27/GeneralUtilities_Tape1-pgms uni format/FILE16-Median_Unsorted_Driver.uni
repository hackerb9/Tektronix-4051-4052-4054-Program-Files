100 REM        ******START OF MEDIAN (UNSORTED) DRIVER ROUTINE******110 DELETE D120 PRINT "	** MEDIAN (UNSORTED) **

"130 PRINT "THE MEDIAN ALGORITHM ITSELF IS IN A SUBROUTINE STARTING AT";140 PRINT " LINE #1000.	LINES #100-300 ARE AN EXAMPLE OF HOW TO ";150 PRINT "USE THE SUBROUTINE:

"160 PRINT "HOW LARGE A RANDOM ARRAY WOULD YOU LIKE FOR A TEST = ";170 INPUT N180 DIM D(N)190 FOR I=1 TO N200 D(I)=INT(10*N*RND(1)+1)210 NEXT I220 PRINT "
	MEDIAN OF THE NUMBERS",D230 GOSUB 1000240 PRINT "
	IS EQUAL TO  ";C3250 END 260 REM         ******END OF MEDIAN (UNSORTED) DRIVER ROUTINE******270 REM280 REM *-----------------------------------------------------------*290 REM1000 REM            *******START OF MEDIAN ROUTINE (UNSORTED DATA)*****1010 REM VARIABLES:1020 REM              **INPUT**1030 REM      D  - LINEAR ARRAY WHOSE MEDIAN IS TO BE FOUND1040 REM      N  - THE NUMBER OF ELEMENTS IN D1050 REM              **OUTPUT**1060 REM      C3 - THE MEDIAN OF THE ARRAY D1070 DIM C(10),C2(10)1080 F1=11090 C(1)=N1100 F2=01110 C1=01120 C9=91130 C5=0.5*N1140 C6=01150 GOSUB 15701160 C6=11170 IF C0<=10 THEN 13401180 IF C1=C9 THEN 14301190 C=01200 FOR F7=1 TO N1210 IF D(F7)<C1 OR D(F7)>C9 THEN 12401220 F3=INT(9*(D(F7)-C1)/(C9-C1))+11230 C(F3)=C(F3)+11240 NEXT F71250 F1=01260 F1=F1+11270 IF F2+C(F1)=>C5 THEN 13001280 F2=F2+C(F1)1290 GO TO 12601300 F8=C11310 F9=C91320 GOSUB 15701330 GO TO 11701340 IF C0=1 THEN 14301350 FOR F3=1 TO C0-11360 FOR F4=F3 TO 1 STEP -11370 IF C2(F4)<=C2(F4+1) THEN 14201380 F5=C2(F4)1390 C2(F4)=C2(F4+1)1400 C2(F4+1)=F51410 NEXT F41420 NEXT F31430 IF C5=INT(C5) THEN 14601440 C3=C2(C5-F2)1450 RETURN 1460 IF C5-F2+1>C0 THEN 14901470 C3=0.5*(C2(C5-F2)+C2(C5-F2+1))1480 RETURN 1490 C4=C2(C5-F2)1500 F1=F1+11510 IF C(F1)=0 THEN 15001520 C1=F81530 C9=F91540 GOSUB 15701550 C3=0.5*(C4+C1)1560 RETURN 1570 F6=01580 F7=11590 C0=C(F1)1600 FOR F3=1 TO N1610 IF C6=0 THEN 17601620 IF INT(9*(D(F3)-C1)/(C9-C1))+1<>F1 THEN 16801630 C2(F7-10*INT((F7-1)*0.1+5.0E-13))=D(F3)1640 F7=F7+11650 IF F6=0 THEN 17201660 F4=F4 MIN D(F3)1670 F5=F5 MAX D(F3)1680 NEXT F31690 C1=F41700 C9=F51710 RETURN 1720 F4=D(F3)1730 F5=F41740 F6=11750 GO TO 16801760 F1=INT(D(F3))+11770 GO TO 1620