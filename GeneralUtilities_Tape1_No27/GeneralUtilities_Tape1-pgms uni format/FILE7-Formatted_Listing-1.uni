1000 REM *1010 REM *  "FORMATTED" LISTING PROGRAM #11020 REM *           DAN TAYLOR, GCS SOFT. ENGR., DEC 19751030 REM *1040 PRINT """FORMATTED"" LISTING PROGRAM -- ";1050 PRINT "FOR A PRINTER WITH A ""FORM FEED""."1060 PRINT "	(EG. ""TEK 4641"")"1070 INIT 1080 REM *1090 PRINT "
INITIALIZATION DEPENDENT UPON YOUR PRINTER:
"1100 LIST 1110,12701110 DATA 41,12,0,601120 READ S3,S4,S5,S61130 PRINT @S3,15:01140 REM *            S3 = GPIB PRIMARY ADDRESS OF THE PRINTER.1150 REM *            S4 = SECONDARY ADDRESS FOR THE PRINTER.1160 REM *            S5 = NUMBER OF SECONDS TO PAUSE AT THE BOTTOM1170 REM *                 OF EACH PAGE BEFORE PRINTING F$.1180 REM *            S6 = NUMBER OF LINES TO PRINT PER PAGE.1190 REM *            F$ = CHARACTER STRING WHICH WILL CAUSE YOUR1200 REM *                 PRINTER TO "FORM FEED" TO THE NEXT PAGE.1210 REM *            S$ = STRING WHICH WILL CAUSE YOUR PRINTER1220 REM *                 TO "CARRIAGE RETURN & LINE FEED" 1 LINE.1230 DIM F$(2),S$(2)1240 F$=CHR(12)1250 F$=" "&F$1260 S$=CHR(13)1270 S$=" "&S$1280 REM *1290 PRINT "INSERT YOUR PROGRAM TAPE WITH THE FILES TO BE LISTED."1300 PRINT "
START WITH TAPE FILE NUMBER = ";1310 INPUT S81320 PRINT "  END WITH TAPE FILE NUMBER = ";1330 INPUT S91340 PRINT "
HOW MANY SPACES DO YOU WANT EACH ""FOR--NEXT"" LOOP ";1350 PRINT "INDENTED = ";1360 INPUT S01370 S0=INT(ABS(S0))1380 DATA 0,1,2,3,4,32,64,33,91390 READ W0,W1,W2,W3,W4,T2,T6,T8,T91400 DIM B$(W2),I$(130),L$(210),R$(W1),T$(S0 MAX W1),Z$(3)1410 DIM M$(75),X$(5000),Y$(T9),W$(T9)1420 PRINT "
DO YOU WANT BRANCH POINTS INDICATED: ";1430 INPUT R$1440 T5=W01450 IF R$="Y" THEN 14801460 IF R$<>"N" THEN 14201470 T5=W11480 PRINT "
DO YOU WANT SEQUENCES OF ""REM"" STATEMENTS SEPARATED"1490 PRINT "FROM THE REST OF THE CODE BY A BLANK LINE          : ";1500 INPUT R$1510 T7=W01520 IF R$="Y" THEN 15501530 IF R$<>"N" THEN 14801540 T7=W11550 T$=""1560 IF S0=W0 THEN 16001570 FOR J=W1 TO S01580 T$=T$&" "1590 NEXT J1600 B$=CHR(8)1610 B$=B$&"_"1620 W$=""1630 X$=""1640 Y$=""1650 FOR J=W1 TO T91660 Y$=Y$&" "1670 NEXT J1680 J3=S6-W21690 T9=T9-W21700 PAGE 1710 GOSUB 32201720 FOR J9=S8 TO S91730 PRINT "FILE # ";J9;""1740 IF T5 THEN 22001750 REM                      ***** PASS 1 -- BUILD TABLE *****1760 X$=""1770 ON EOF (0) THEN 22001780 FIND J91790 IF TYP(0)<>2 THEN 31801800 INPUT @T8:L$1810 REM           ***** FIND KEYWORD *****1820 S1=POS(L$," ",W2)+W11830 S2=POS(L$," ",S1)1840 IF NOT(S2) THEN 18001850 M$=SEG(L$,S1,S2-S1)1860 J=POS("GOIFONGOSUB",M$,W1)1870 GO TO J OF 1890,1800,1920,1800,1920,1800,18901880 GO TO 18001890 S1=POS(L$,"OF",S2)1900 IF S1 THEN 20301910 REM           ***** IF,ON OR SIMPLE GOTO/GOSUB *****1920 S1=S21930 S2=POS(L$," ",S1+W1)1940 IF S2 THEN 19201950 M$=SEG(L$,S1,LEN(L$)+W1-S1)1960 M$=" "&M$1970 M$=M$&" "1980 IF J<W4 THEN 20001990 M$=REP("-",W1,W1)2000 X$=REP(M$,W1+LEN(X$),W0)2010 GO TO 18002020 REM           ***** GOTO/GOSUB OF ... *****2030 S1=S1+W32040 S2=POS(L$,",",S1)2050 IF S2 THEN 21102060 REM           ***** PROCESS LAST NUMBER *****2070 M$=SEG(L$,S1,W1+LEN(L$)-S1)2080 M$="  "&M$2090 GO TO 19702100 REM           ***** PROCESS NEXT NUMBER *****2110 M$=SEG(L$,S1,S2-S1)2120 M$="  "&M$2130 M$=M$&" "2140 S1=S2+W12150 IF J<W4 THEN 21702160 M$=REP("-",W1,W1)2170 X$=REP(M$,W1+LEN(X$),W0)2180 GO TO 20402190 REM                 ***** PASS 2 - PRINT THE LISTING *****2200 I$=""2210 S1=W12220 S2=W22230 ON EOF (0) THEN 30302240 FIND J92250 PRINT @S3,S4:"                                                 ";2260 PRINT @S3,S4:" FILE # ";J9;S$;2270 PRINT @S3,S4:S$;2280 INPUT @T8:L$2290 IF L$="" THEN 22802300 IF POS(L$,"REM",W1)=W0 AND POS(L$,"""",W1)=W0 THEN 23802310 FOR I=LEN(L$) TO W1 STEP -W12320 Z$=SEG(L$,I,W1)2330 IF Z$=>" " THEN 23702340 Z$=CHR(ASC(Z$)+T6)2350 Z$=Z$&B$2360 L$=REP(Z$,I,W1)2370 NEXT I2380 I=POS(L$," ",W2)+W12390 IF T5 THEN 27802400 J1=W02410 J2=W02420 W$=Y$2430 M$=SEG(L$,W1,I-W1)2440 M$=" "&M$2450 J=W12460 J=POS(X$,M$,J)2470 IF NOT(J) THEN 25602480 REM            ***** M$ FOUND IN X$ *****2490 J1=W1+J12500 IF J2 THEN 25302510 Z$=SEG(X$,J-W1,W1)2520 J2=Z$<>" "2530 X$=REP("",J-W1,W1+LEN(M$))2540 GO TO 24602550 REM            ***** ALL LINES IN X$ PROCESSED *****2560 IF NOT(J1) THEN 27802570 REM            ***** SET UP W$ *****2580 M$=STR(J1)2590 M$=REP("",W1,W1)2600 Z$=CHR(43.25+J2+J2)2610 W$=Z$&Z$2620 W$=W$&Z$2630 W$=W$&M$2640 FOR J=W4+LEN(M$) TO T92650 W$=W$&Z$2660 NEXT J2670 W$=W$&"  "2680 REM              ***** SUBR. BRANCH POINT? *****2690 IF NOT(J2) THEN 27802700 IF S2<J3 THEN 27402710 GOSUB 32202720 S2=W12730 GO TO 27602740 S2=S2+W22750 PRINT @S3,S4:S$;2760 PRINT @S3,S4:"--------------------------------------------------";2770 PRINT @S3,S4:"----------------------------------------------";S$;2780 IF T7 THEN 28702790 J=POS(L$,"REM",I)=I2800 IF J<>S1 THEN 28502810 PRINT @S3,S4:S$;2820 S2=W1+S22830 IF S2<S6 THEN 28502840 GOSUB 32202850 S1=W1-J2860 IF J THEN 29202870 J=POS(L$,"NEXT",I)=I2880 IF NOT(J) THEN 29202890 IF I$="" THEN 29202900 I$=REP("",W1,S0)2910 REM                      ***** INSERT BLANKS FOR INDENTING? *****2920 IF NOT(LEN(I$)) THEN 29402930 L$=REP(I$,I,W0)2940 PRINT @S3,S4:W$;L$;S$;2950 S2=W1+S22960 IF S2<S6 THEN 29802970 GOSUB 32202980 IF J THEN 22802990 IF POS(L$,"FOR",I)<>I+LEN(I$) THEN 22803000 I$=REP(T$,W1,W0)3010 GO TO 22803020 REM                      ***** FILE #J9 IS DONE *****3030 IF NOT(LEN(X$)) THEN 31603040 IF S2<S6-6 THEN 30603050 GOSUB 32203060 S2=W13070 PRINT @S3,S4:S$;" THE FOLLOWING LINE NUMBERS ARE BRANCHED TO BUT";3080 PRINT @S3,S4:" DO NOT EXIST IN THIS TAPE FILE ( # ";J9;" )";S$;3090 PRINT @S3,S4:" A ""-"" BEFORE THE LINE NUMBER INDICATES IT IS B";3100 PRINT @S3,S4:"RANCHED TO AS A SUBROUTINE (VIA A ""GOSUB"" OR ";3110 PRINT @S3,S4:"""ON"")";S$;S$;3120 L$=SEG(X$,1,120)3130 PRINT @S3,S4:L$;S$;3140 X$=REP("",1,120 MIN LEN(X$))3150 IF X$<>"" THEN 31203160 IF S2=W0 THEN 31803170 GOSUB 32203180 NEXT J93190 PRINT "
	DONE"3200 END 3210 REM                      ***** PAUSE AND FORM FEED *****3220 FOR T4=W1 TO S5*2253230 NEXT T43240 PRINT @S3,S4:F$;3250 S2=W03260 RETURN 