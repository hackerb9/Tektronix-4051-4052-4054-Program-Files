1000 REM  ****************RESIDENT OVERLAY**************************1010 GO TO P9 OF 1340,1870,1590,1980,17201020 GO TO 21401030 REM1040 REM  **********************************************************1050 REM  REFN: BURTON S. GARBOW, ARGONNE NATIONAL LABORATORY,1060 REM        ARGONNE, ILLINOIS, MAY 1969.  ANL F265S EIGENP1070 REM  REFN: ALGORITHM 343, COMMUNICATIONS OF THE ACM, 1080 REM        DECEMBER 1968, J. GRAD AND M.A. BREBNER.1090 REM  VARIABLES:  N AND A ARE USED ALONG WITH ANY VARIABLE1100 REM        NAME STARTING WITH E,P,Q, OR R. 1110 REM  PARAMETERS1120 REM    ***INPUT*** 1130 REM    A - THE MATRIX WHOSE EIGENVALUES (AND EIGENVECTORS, 1140 REM        IF DESIRED) ARE FOUND.  IT IS DESTROYED BY THE1150 REM        ROUTINE.1160 REM    N - THE # OF ROW (=#COLUMNS) OF A.1170 REM    ***OUTPUT***1180 REM    E0,E1 - LINEAR ARRAYS OF LENGTH N IN WHICH THE REAL(E0) 1190 REM        AND IMAGINARY(E1) PARTS OF THE EIGENVALUES OF 1200 REM        A ARE STORED. 1210 REM    E2,E3 - N BY N ARRAYS IN WHICH THE REAL(E2) AND 1220 REM        IMAGINARY(E3)  PARTS OF THE NORMALIZED EIGENVECTORS 1230 REM        OF A ARE STORED.  THE J'TH EIGENVECTOR IS IN THE1240 REM        J'TH COLUMNS OF E2 AND E3.1250 REM            A REAL EIGENVECTOR IS NORMALIZED SO THAT THE SUM1260 REM        OF THE SQUARES OF THE COMPONENTS IS EQUAL TO ONE. 1270 REM        A COMPLEX EIGENVECTOR IS NORMALIZED SO THAT THE 1280 REM        LARGEST COMPONENT (IN ABSOLUTE VALUE)  HAS REAL 1290 REM        PART EQUAL TO ONE AND IMAGINARY PART ZERO.1300 REM  **********************************************************1310 REM1320 REM  ******************************************************* 1330 REM  *********** DATA ENTRY ROUTINE ***********1340 PAGE 1350 SET NOKEY 1360 PRINT 1370 PRINT "EIGENANALYSIS OF GENERAL REAL MATRIX"1380 PRINT "
  ENTER # OF ROWS (=COLUMNS) OF MATRIX = ";1390 INPUT N1400 N=INT(N)1410 PRINT "
ENTER THE ENTIRE MATRIX BEFORE USING ANY OTHER KEYS."1420 DELETE A1430 DIM A(N,N)1440 FOR P1=1 TO N1450 PRINT 1460 PRINT "ROW ";P11470 FOR P2=1 TO N1480 PRINT "A(";P1;",";P2;")  =  ";1490 INPUT A(P1,P2)1500 NEXT P21510 NEXT P11520 SET KEY 1530 PRINT "
ENTRY FINISHED"1540 RETURN 1550 REM  ********************************************************* 1560 REM1570 REM  ********************************************************* 1580 REM  *********** CORRECT MATRIX ROUTINE ************ 1590 PRINT "CORRECT THE MATRIX:  ENTER THE ROW AND COLUMN #"1600 PRINT "               OF THE ELEMENT TO BE CORRECTED"1610 PRINT 1620 PRINT "ROW, COLUMN = ";1630 INPUT P1,P21640 PRINT "PRESENT VALUE   = ";A(P1,P2)1650 PRINT "ENTER NEW VALUE = ";1660 INPUT A(P1,P2)1670 GO TO 16101680 REM  **********************************************************1690 REM1700 REM  **********************************************************1710 REM  ********** PRINT MATRIX ROUTINE **************1720 PAGE 1730 PRINT "*A* MATRIX, PRINTED OUT BY ROWS"1740 FOR P1=1 TO N1750 PRINT 1760 PRINT "ROW ";P11770 FOR P2=1 TO N1780 PRINT A(P1,P2),"";1790 NEXT P21800 PRINT 1810 NEXT P11820 PRINT 1830 RETURN 1840 REM ***********************************************************1850 REM1860 REM  ********** FROM TAPE ********** 1870 P3=331880 P$="FROM"1890 GOSUB 20501900 READ @P3:N1910 DELETE A1920 DIM A(N,N)1930 READ @P3:A1940 PRINT "
PUT PROGRAM TAPE BACK IN."1950 RETURN 1960 REM  1970 REM  ********** TO TAPE ********** 1980 P3=331990 P$="TO"2000 GOSUB 20502010 WRITE @P3:N2020 WRITE @P3:A2030 GO TO 19402040 REM  ******UTILITY FOR TAPE I/O******2050 PAGE 2060 PRINT P$;" TAPE"2070 PRINT 2080 PRINT "INSERT DATA TAPE AND ENTER THE TAPE FILE NUMBER = ";2090 INPUT P22100 FIND P22110 RETURN 2120 REM  **********************************************************2130 REM  *************SCALE A BEFORE FINDING EIGENVALUES***********2140 DELETE E0,E1,E3,P2150 DIM E0(N),E1(N),E3(N,N),P(N,3),Q$(1)2160 IF N>1 THEN 22702170 DIM E2(1,1),Q(1,5)2180 E0(1)=A(1,1)2190 E1(1)=02200 E2(1,1)=12210 E3(1,1)=02220 P(1,1)=22230 P1=12240 P9=412250 GO TO 1002260 REM **********2270 PRINT "DO YOU WANT TO FIND THE EIGENVECTORS ALSO: ";2280 INPUT Q$2290 GOSUB 23302300 GO TO 1002310 REM  ******************************************************* 2320 REM  ********* SCALE A **********2330 FOR P1=1 TO N2340 FOR P2=1 TO N2350 E3(P1,P2)=A(P1,P2)2360 NEXT P22370 P(P1,2)=12380 NEXT P12390 Q1=0.752400 Q2=1.332410 P3=02420 P4=02430 FOR P1=1 TO N2440 Q7=02450 Q8=02460 FOR P2=1 TO N2470 IF P1=P2 THEN 25002480 Q7=Q7+ABS(A(P2,P1))2490 Q8=Q8+ABS(A(P1,P2))2500 NEXT P22510 IF Q7*Q8=0 THEN 25502520 Q3=Q7/Q82530 IF Q3<Q1 THEN 25702540 IF Q3>Q2 THEN 25702550 P4=P4+12560 GO TO 26402570 Q9=SQR(Q3)2580 FOR P2=1 TO N2590 IF P1=P2 THEN 26202600 A(P1,P2)=A(P1,P2)*Q92610 A(P2,P1)=A(P2,P1)/Q92620 NEXT P22630 P(P1,2)=P(P1,2)*Q92640 NEXT P12650 P3=P3+12660 IF P3>30 THEN 28202670 IF P4<N THEN 24202680 Q4=02690 FOR P1=1 TO N2700 FOR P2=1 TO N2710 Q3=A(P1,P2)2720 Q4=Q4+Q3*Q32730 NEXT P22740 NEXT P12750 Q4=SQR(Q4)2760 FOR P1=1 TO N2770 FOR P2=1 TO N2780 A(P1,P2)=A(P1,P2)/Q42790 NEXT P22800 NEXT P12810 RETURN 2820 FOR P1=1 TO N2830 P(P1,2)=12840 FOR P2=1 TO N2850 A(P1,P2)=E3(P1,P2)2860 NEXT P22870 NEXT P12880 Q4=12890 RETURN 2900 REM  ********* END OF SCALING ***********2910 REM  **********************************************************2920 REM