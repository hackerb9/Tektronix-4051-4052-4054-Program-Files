1000 REM *************************1010 IF INT(P9/10)<>2 THEN 5101020 REM ************************* 1030 REM FINDS EIGENVALUES AND EIGENVECTORS OF A SYMMETRIC 1040 REM   TRIDIAGONAL MATRIX BY THE IMPLICIT QL METHOD1050 REM 1060 REM INPUT:1070 REM   N  - ORDER OF THE MATRIX1080 REM   E  - CONTAINS DIAGONAL ELEMENTS OF TRIDIAGONAL MATRIX 1090 REM   Q1 - CONTAINS SUBDIAGONAL ELEMENTS OF TRIDI-1100 REM          AGONAL MATRIX IN ITS LAST N-1 PLACES 1110 REM   A  - TRANSFORMATION MATRIX WHICH REDUCED1120 REM          SYMMETRIC MATRIX TO TRIDIAGONAL FORM 1130 REM 1140 REM OUTPUT: 1150 REM   E  - CONTAINS EIGENVALUES IN ASCENDING ORDER. 1160 REM          IF ERROR EXIT OCCURS, EIGENVALUES1170 REM          ARE CORRECT BUT UNORDERED FOR Q7-1 1180 REM   A  - CONTAINS ORTHONORMAL EIGENVECTORS OF REAL1190 REM          SYMMETRIC MATRIX. IF ERROR EXIT OCCURS, A1200 REM          CONTAINS EIGENVECTORS WITH EIGENVALUES IN E. 1210 REM   Q7 - ZERO FOR NORMAL RETURN OR J IF THE JTH EIGEN-1220 REM          VALUE HAS NOT BEEN DETERMINED AFTER 30 ITERATIONS1230 REM 1240 Q7=01250 Q6=1.0E-141260 IF N=1 THEN 21001270 FOR P1=2 TO N1280 Q1(P1-1)=Q1(P1)1290 NEXT P11300 Q1(N)=01310 FOR P4=1 TO N1320 P2=01330 REM LOOK FOR SMALL SUB DIAGONAL ELEMENT 1340 FOR P5=P4 TO N1350 IF P5=N THEN 13801360 IF ABS(Q1(P5))<=Q6*(ABS(E(P5))+ABS(E(P5+1))) THEN 13801370 NEXT P51380 P=E(P4)1390 IF P5=P4 THEN 18501400 IF P2=30 THEN 20701410 P2=P2+11420 REM FORM SHIFT1430 Q9=(E(P4+1)-P)/(2*Q1(P4))1440 Q4=SQR(Q9*Q9+1)1450 Q8=ABS(Q4)1460 IF Q9=>0 THEN 14801470 Q8=-Q81480 Q9=E(P5)-P+Q1(P4)/(Q9+Q8)1490 Q5=11500 Q=11510 P=01520 P7=P5-P41530 FOR P6=1 TO P71540 P1=P5-P61550 P8=Q5*Q1(P1)1560 P9=Q*Q1(P1)1570 IF ABS(P8)<ABS(Q9) THEN 16401580 Q=Q9/P81590 Q4=SQR(Q*Q+1)1600 Q1(P1+1)=P8*Q41610 Q5=1/Q41620 Q=Q*Q51630 GO TO 16901640 Q5=P8/Q91650 Q4=SQR(Q5*Q5+1)1660 Q1(P1+1)=Q9*Q41670 Q=1/Q41680 Q5=Q5*Q1690 Q9=E(P1+1)-P1700 Q4=(E(P1)-Q9)*Q5+2*Q*P91710 P=Q5*Q41720 E(P1+1)=Q9+P1730 Q9=Q*Q4-P91740 REM FORM VECTOR 1750 FOR P3=1 TO N1760 P8=A(P3,P1+1)1770 A(P3,P1+1)=Q5*A(P3,P1)+Q*P81780 A(P3,P1)=Q*A(P3,P1)-Q5*P81790 NEXT P31800 NEXT P61810 E(P4)=E(P4)-P1820 Q1(P4)=Q91830 Q1(P5)=01840 GO TO 13401850 NEXT P41860 REM ORDER EIGENVALUES AND EIGENVECTORS1870 FOR P6=2 TO N1880 P1=P6-11890 P3=P11900 P=E(P1)1910 FOR P2=P6 TO N1920 IF E(P2)=>P THEN 19501930 P3=P21940 P=E(P2)1950 NEXT P21960 IF P3=P1 THEN 20401970 E(P3)=E(P1)1980 E(P1)=P1990 FOR P2=1 TO N2000 P=A(P2,P1)2010 A(P2,P1)=A(P2,P3)2020 A(P2,P3)=P2030 NEXT P22040 NEXT P62050 GO TO 21002060 REM SET ERROR - NO CONVERGENCE TO EIGENVALUE AFTER 30 ITERATIONS2070 Q7=P42080 PRINT "ERROR - NO CONVERGENCE AFTER 30"2090 PRINT "ITERATIONS FOR EIGENVALUE # ";Q7;"
"2100 PRINT "EIGENVALUES
"2110 FOR P1=1 TO N2120 PRINT E(P1)2130 NEXT P12140 IF Q3=9 THEN 22002150 PRINT "
DO YOU WANT THE EIGENVECTORS, NOW: ";2160 INPUT P$2170 IF P$="Y" THEN 22002180 IF P$<>"N" THEN 21502190 RETURN 2200 PRINT "

EIGENVALUE","EIGENVECTOR
"2210 FOR P1=1 TO N2220 PRINT "
";E(P1)2230 FOR P2=1 TO N2240 PRINT " ",A(P2,P1)2250 NEXT P22260 NEXT P12270 DELETE E,Q12280 RETURN 