4000 REM **** FILE 15 - MI5010 Error Code Test ****10/27/824005 F$="MI5010 Error Code Test"4010 FOR L1=1 TO L4015 PRINT @D0:"<<";F$;">>  Loop ";L1;" of ";L;"     Unit ";P(N4)4020 DELETE I,J,K,K1,K2,K34025 ON SRQ THEN 58004030 PRINT @D0:"   Mainframe Test"4100 REM4105 REM                                               *** VERIFY ID ***4110 REM4115 A$="ID TEK/MI5010,V"4120 GOSUB 27004200 REM4205 REM                            *** VERIFY SETTINGS AFTER 'INIT' ***4210 REM4215 A$="INIT;SET?"4220 GOSUB 5004225 GOSUB 6004230 I$="OPC OFF;USER OFF;RQS ON;"4235 B$=SEG(B$,7,LEN(B$))4240 IF B$=I$ THEN 43004245 GOSUB 64004300 REM4305 REM                                           ***** Error 401 *****4310 REM4315 A$="POWERON"4320 S1=654325 S2=4014330 GOSUB 5004335 WAIT 4340 IF E=S2 AND S9=S1 THEN 44004345 GOSUB 57004400 REM4405 REM           *** Error Codes 101..107, 203..205, 220, 402, 605 ***4410 REM4415 RESTORE 60154420 READ I14425 FOR I2=1 TO I14430 READ A$,S1,S24435 GOSUB 56004440 NEXT I24450 READ X$4455 READ A$,S1,S24460 A$=X$&A$4465 GOSUB 56004500 REM4505 REM                                          *** Error Code 206 ***4510 REM4515 A$="SEL 1;DT OFF;SEL 2;DT OFF;SEL 3;DT OFF;"4520 GOSUB 5004525 S1=984530 S2=2064535 WBYTE @32+P(N4),8:4540 REM             ^ G.E.T.4545 FOR I=1 TO 504550 REM  Allow sufficient time to field SRQ4555 NEXT I4560 IF E=S2 AND (S9=S1 OR S9-16=S1) THEN 46004565 GOSUB 57004600 REM4605 REM                                          *** Error Code 402 ***4610 REM4615 A$="OPC ON;BUF ON;WAI .5;BUF OFF;EXEC 1;"4620 S1=664625 S2=4024630 GOSUB 56004635 A$="INIT;"4640 GOSUB 5004700 REM4705 REM                                          *** Error Code 403 ***4710 REM4715 A$="USER ON;"4720 S1=674725 S2=4034730 GOSUB 5004735 PRINT 4740 PRINT "Please press Front Panel ID Button."4745 WAIT 4750 PRINT "Thank You."4755 IF E=S2 AND (S9=S1 OR S9-16=S1) THEN 47654760 GOSUB 57004765 A$="INIT;"4770 GOSUB 5004800 REM4805 REM                        *** Monitor for card-dependant tests ***4810 REM4815 FOR I=1 TO 34820 ON SRQ THEN 50004825 Q1=04830 S$=STR(I)4835 A$="SEL"&S$4840 GOSUB 5004845 FOR I9=1 TO 254850 REM Allow enough time to generate SRQ if slot is empty4855 NEXT I94860 IF Q1=1 THEN 49154865 A$="NAME?;"4870 GOSUB 5004875 GOSUB 6004880 C$=SEG(B$,6,3)4885 X7=POS("   DIO RSC DEV",C$,1)/44890 IF X7>0 THEN 49104895 IF Q1=0 AND C$=";" THEN 49154900 PRINT "      Not programmed to test ";C$;" cards."4905 GO TO 49154910 GOSUB 51004915 NEXT I4920 NEXT L14925 RETURN 5000 REM5005 REM                                     *** Local SRQ Handler 1 ***5010 REM5015 POLL A,B;P(N4)5025 PRINT @P(N4):"ERR?;"5030 INPUT @P(N4):B$5035 IF B<>98 AND B$<>"ERR 220;" THEN 29005040 Q1=15045 RETURN 5100 REM5105 REM                                             *** Card Tests ****5110 REM5115 PRINT "   ";C$;" Test - Slot ";I5120 ON SRQ THEN 58005125 GO TO X7 OF 5130,5140,51505130 RESTORE 61155135 GO TO 52005140 RESTORE 62155145 GO TO 52005150 RESTORE 63155200 REM5205 REM                                                  *** NAME?; ***5210 REM5215 READ I$5220 A$="NAME?;"5225 GOSUB 5005230 GOSUB 6005235 B$=SEG(B$,1,18)5240 IF B$=I$ THEN 53005245 GOSUB 64005300 REM5305 REM                                                  *** FSET?; ***5310 REM5315 I$=""5320 READ I15325 FOR I2=1 TO I15330 READ X$5335 I$=I$&X$5340 NEXT I25345 A$="FSET?;"5350 GOSUB 5005355 GOSUB 6005360 IF B$=I$ THEN 54005362 E$="Incorrect settings returned "5365 GOSUB 25005400 REM5405 REM                       *** Verify all applicable Error Codes ***5410 REM5415 READ I15420 FOR I2=1 TO I15425 READ A$,S1,S25430 GOSUB 56005435 NEXT I25500 REM5505 REM                             *** Return to Card Test Monitor ***5510 REM5515 RETURN 5600 REM5605 REM                                           *** PUT/WAIT/TEST ***5610 REM5615 E=05620 GOSUB 5005625 IF E=0 THEN 56255630 IF E=S2 AND (S9=S1 OR S9-16=S1) THEN 56405635 GOSUB 57005640 RETURN 5700 REM5705 REM                                                  *** SET E$ ***5710 REM5715 E$="Incorrect Error Code or Status Byte returned after "5720 E$=E$&A$5725 B$="Status"5730 S$=STR(S9)5735 B$=B$&S$5740 B$=B$&", Error Code"5745 S$=STR(E)5750 B$=B$&S$5755 I$="Status"5760 S$=STR(S1)5765 I$=I$&S$5770 I$=I$&", Error Code"5775 S$=STR(S2)5780 I$=I$&S$5785 GOSUB 25005790 RETURN 5800 REM5805 REM                                     *** Local SRQ Handler 2 ***5810 REM5815 S$=" "5820 FOR I1=1 TO N15825 IF T(I1)=0 THEN 58455827 POLL D,S9;P(I1)5832 PRINT @P(I1):"ERR?;"5834 INPUT @P(I1):E5835 IF D<>0 AND P(I1)<>P(N4) THEN 29555840 IF D<>0 AND P(I1)=P(N4) THEN 58555845 NEXT I15850 GO TO 58755855 IF F1<>1 THEN 58755860 PRINT @D0:"Got    Status:";S9;", Error Code:";E5875 RETURN 6000 REM6005 REM            *** Main Box Commands, Status Bytes, Error Codes ***6010 REM6015 DATA 116020 DATA "BFR ON;",97,101,"EXEC,1;",97,102,"SEL DEV",97,1056025 DATA "EXEC ON;",97,105,"TIME;",97,1066030 DATA "INIT SET?",97,1076040 DATA "BUF ON;WAI .25;BUF OFF;EXEC 1;BUF ON;",98,2046045 DATA "ADDR 65536;",98,205,"SEL 0;",98,2206050 DATA "OPC ON;BUF ON;WAI .25;BUF OFF;EXEC 1;",66,4026055 DATA "OPC OFF;BUF ON;WAI UNT;EXEC 1;",102,6056060 DATA "SET?;FSET?;SET?;FSET?;SET?;FSET?;SET?;"6065 DATA "FSET?;SET?;FSET?;SET?;FSET?;SET?;",98,2036100 REM6105 REM                            *** Data for 50M30 card (DIOM30) ***6110 REM6115 DATA "NAME DIOM30,V79.1,"6120 DATA 16125 DATA "DT OFF;CHA 1;DAT 0;ARM OFF;CHA 2;ARM OFF;"6130 DATA 66135 DATA "CHA1;",97,101,"CHA,1;",97,102,"ARM 2;",97,103,"ARM;",97,1066140 DATA "DAT 255,DAT?;",97,1076145 DATA "DAT 65536;",98,2056200 REM6205 REM                            *** Data for 50M40 card (RSCM40) ***6210 REM6215 DATA "NAME RSCM40,V79.1,"6220 DATA 26225 DATA "DT OFF;OPE 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16;CLO 0;"6230 DATA "ARM OFF;SCAN 0;"6235 DATA 76237 REM  THERE POSSIBLY MIGHT BE ONE MORE HEADER IF ERR 104 IS6238 REM  IMPLIMENTED.  THIS WOULD MAKE 8 ITEMS TO READ AND TEST.6240 DATA "NET;",97,101,"CLO,1;",97,102,"ARM 2;",97,1036245 DATA "SCAN ON;",97,105,"SCAN;",97,1066250 DATA "SCAN 1,2,3.SCAN?;",97,1076255 DATA "CLO 17;",98,2056300 REM6305 REM                            *** Data for 50M70 card (DEVM70) ***6310 REM6315 DATA "NAME DEVM70,V79.1,"6320 DATA 56325 DATA "DT OFF;"6330 DATA "CHA 1;DAT 255;DIR 0;"6335 DATA "CHA 2;DAT 0;DIR 255;ARM OFF;SLO NEG;"6340 DATA "CHA 3;DAT 255;DIR 0;ARM OFF;SLO NEG;"6345 DATA "CHA 4;DAT 0;DIR 255;ARM OFF;SLO NEG;"6350 DATA 76355 DATA "CHA1;",97,101,"CHA,1;",97,102,"CHA 2;ARM 2;",97,1036360 DATA "ARM;",97,106,"DAT 255,DAT?;",97,1076365 DATA "CHA 1;ARM ON;",98,204,"DAT 256;",98,2056400 REM6410 REM                               ***BAD RESPONCE SETUP OF E$ ***6420 REM6430 E$="Incorrect responce to "6440 E$=E$&A$6450 GOSUB 25006460 RETURN 6470 END 