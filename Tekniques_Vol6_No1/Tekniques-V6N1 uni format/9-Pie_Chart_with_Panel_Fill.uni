1 GOSUB 1002 GO TO 2104 GO TO 53008 GO TO 459016 GO TO 548020 GO TO 610024 Z=3225 GO TO 201028 Z=129 GO TO 201040 PAGE 41 GOSUB 10042 GO TO 25044 GOSUB 662045 GO TO 21048 GOSUB 690049 GO TO 21060 GOSUB 100100 INIT 110 SET KEY 120 C$="Tektronix 4050 Pie Chart"130 R$="****"140 Z=32150 DIM V$(1),S$(10),T$(11)160 C=11170 D$=" "180 L$=" "190 Q$=CHR(13)200 RETURN 210 GOSUB 6100220 PRINT "J_   Press <RETURN> to create a pie chart";230 INPUT B$240 PAGE 250 PRINT "J_  How many PIE segments:  ";260 INPUT N270 Q=N280 C=11290 DIM A$(C*Q),D(Q),C3(Q+1),S1(Q),E(Q)300 A$=""310 S=0320 S$=""330 T$=""340 S1=-45350 V$="B"360 E=0400 REM ....................DATA INPUT SECTION410 FOR I=1 TO N420 PAGE 430 PRINT "Segment #";I440 PRINT USING """J_Enter text : "",11""_"",11"""",S":450 B$="               "460 INPUT K$470 B$=REP(K$,1,C)480 B$=B$&"                                  "490 B$=SEG(B$,1,C)500 A$=A$&B$510 PRINT "J_Enter value : ";520 INPUT B530 IF B<=0 THEN 510540 D(I)=B550 S=S+D(I)560 PRINT "J_Explode this segment? (Y/N_): ";570 INPUT B$580 IF B$="" OR B$="N" THEN 600590 E(I)=1600 PRINT "J_Shade this segment? (Y/N_): ";610 INPUT B$620 IF B$="" OR B$="N" THEN 770630 PRINT "J_  H   Horizontal"640 PRINT "  V   Vertical"650 PRINT "  D   Diagonal"660 PRINT "  N   None"670 PRINT "J_Enter type of shading : ";680 INPUT B$690 S1(I)=-45*(B$="N")+-45*(B$="")+(B$="H")*0+(B$="D")*45+(B$="V")*90700 IF S1(I)<0 THEN 770710 PRINT "J_Enter number of shading lines: ";720 INPUT B$730 B$=B$&" 0"740 O3=VAL(B$)750 IF O3<=0 OR O3>25 THEN 710760 S1(I)=S1(I)+O3770 NEXT I780 GOSUB 810790 GOSUB 6100800 END 810 PAGE 820 PRINT "J_Do you want segment values printed as:"830 PRINT "     (P) PERCENTAGE of total "840 PRINT "     (A) ACTUAL values as entered"850 PRINT "     (B) both PERCENTAGE and ACTUAL values"860 PRINT "J_Enter choice (default=";V$;") :   ";870 INPUT K$880 IF K$="" THEN 900890 V$=K$900 IF V$<>"A" AND V$<>"P" AND V$<>"B" THEN 820910 PRINT "J_Enter symbol ($,etc) to PRECEDE values (default=";S$;"): ";920 INPUT K$930 IF K$="" THEN 950940 S$=K$950 PRI "J_Enter symbol (%,Lb,etc) to TRAIL values (default=";T$;"): ";960 INPUT K$970 IF K$="" THEN 990980 T$=K$990 PRINT "J_Use existing graph labels? (Y_/N) ";1000 INPUT B$1010 IF B$="" OR B$="Y" THEN 12201020 PRINT "J_J_J_(default=";C$;")";Q$1030 PRINT "Enter Title: ";1040 INPUT B$1050 IF B$="" THEN 10701060 C$=B$1070 PRINT "J_J_J_(default=";R$;")";Q$1080 PRINT "Enter Subtitle: ";1090 INPUT B$1100 IF B$="" THEN 11201110 R$=B$1120 PRINT "J_J_J_(default=";D$;")";Q$1130 PRINT "Enter Lower Label #1: ";1140 INPUT B$1150 IF B$="" THEN 11701160 D$=B$1170 PRINT "J_J_J_(default=";L$;")";Q$1180 PRINT "Enter Lower Label #2: ";1190 INPUT B$1200 IF B$="" THEN 12201210 L$=B$1220 RETURN 2000 REM ......SUBROUTINE TO DRAW PIE CHART2010 C3=02020 PAGE 2030 X$="N"2040 IF Z=32 THEN 20702050 PRINT "Do you want to change pen colors on the plotter (Y_/N): ";2060 INPUT X$2070 WINDOW -1.4,1.4,-1.4,1.42080 VIEWPORT 35,95,20,802090 SET DEGREES 2100 FOR I=2 TO N+12110 C3(I)=C3(I-1)+D(I-1)/S*3602120 NEXT I2130 REM ......DRAW A SEGMENT2140 FOR I=1 TO N2150 IF X$<>"Y" AND X$<>"" THEN 21802160 PRINT "Change pen color for segment #";I;" ,then press <RETURN>.";2170 INPUT B$2180 MOVE @Z:0,02190 IF N>1 THEN 22102200 MOVE COS(J),SIN(J)2210 GO TO E(I)+1 OF 2220,25002220 IF S1(I)<0 THEN 22702230 DIM P(2,185)2240 N0=12250 P(1,1)=652260 P(2,1)=502270 FOR J=C3(I) TO C3(I+1) STEP 22280 DRAW @Z:COS(J),SIN(J)2290 IF S1(I)<0 THEN 23302300 N0=N0+12310 P(1,N0)=(COS(J)+1.4)*46.42857142862320 P(2,N0)=(SIN(J)+1.4)*35.71428571432330 IF J+2<=C3(I+1) OR J=C3(I+1) THEN 24002340 DRAW @Z:COS(C3(I+1)),SIN(C3(I+1))2350 IF S1(I)<0 THEN 24002360 N0=N0+12370 P(1,N0)=(COS(C3(I+1))+1.4)*46.42857142862380 P(2,N0)=(SIN(C3(I+1))+1.4)*35.71428571432390 J=J+22400 NEXT J2410 IF N>1 THEN 24302420 GO TO 24402430 DRAW @Z:0,02440 A9=(C3(I)+C3(I+1))/22450 MOVE @Z:COS(A9),SIN(A9)2460 GOSUB 25802470 IF S1(I)<0 THEN 25102480 GOSUB 37002490 GO TO 25102500 GOSUB 33702510 NEXT I2520 IF X$<>"Y" AND X$<>"" THEN 25502530 PRINT "Change pen color for titles, then press <RETURN>.";2540 INPUT B$2550 GOSUB 42202560 END 2570 REM ......LABEL SEGMENTS2580 X8=COS(A9)*1.42590 Y0=SIN(A9)*1.42600 DRAW @Z:X8,Y02610 B8=(X8<0)*1+(X8=>0)*2+(Y0<0)*1+(Y0=>0)*32620 WINDOW 0,130,0,1002630 VIEWPORT 0,130,0,1002640 GIN @Z:X8,Y02650 IF I<>1 THEN 26802660 Y6=Y0+102670 B9=B8-12680 GOSUB B8-1 OF 2730,2860,2730,28602690 Y6=Y02700 B9=B82710 RETURN 2720 REM ......2ND + 3RD QUADRANTS2730 Y0=Y0+-3.857*(B8=2)+3.857*(B8=4)2740 IF ABS(Y6-Y0)=>5 OR B8<>B9 THEN 27702750 Y0=Y0-3.8572760 GO TO 27402770 D7=INT(X8/1.805)2780 GOSUB 30802790 B5=LEN(Y$) MAX LEN(Z$)2800 X8=INT((D7-B5)*1.805)2810 GOSUB 29902820 WINDOW -1.4,1.4,-1.4,1.42830 VIEWPORT 35,95,20,802840 RETURN 2850 REM ......1ST + 4TH QUADRANTS2860 X8=X8+1.8052870 Y0=Y0+-3.857*(B8=3)+3.857*(B8=5)2880 IF ABS(Y6-Y0)=>5 OR B8<>B9 THEN 29102890 Y0=Y0+3.8572900 GO TO 28802910 D7=INT((130-X8)/1.805)2920 GOSUB 30802930 B5=LEN(Y$) MAX LEN(Z$)2940 GOSUB 29902950 WINDOW -1.4,1.4,-1.4,1.42960 VIEWPORT 35,95,20,802970 RETURN 2980 REM .......PRINT LABEL,%,ACTUAL2990 IF LEN(Z$)=0 AND B8=4 OR (LEN(Z$)=0 AND B8=5) THEN 30503000 MOVE @Z:X8,Y03010 PRINT @Z:Y$;3020 MOVE @Z:X8,Y0-3.8573030 PRINT @Z:Z$;3040 RETURN 3050 MOVE @Z:X8,Y0-3.8573060 PRINT @Z:Y$;3070 RETURN 3080 Y$=""3090 B$=SEG(A$,(I-1)*11+1,11)3100 IF B$="           " THEN 31903110 B5=03120 FOR K=11 TO 1 STEP -13130 Y$=SEG(B$,K,1)3140 IF Y$=" " THEN 31703150 B5=K3160 K=13170 NEXT K3180 Y$=SEG(B$,1,B5)3190 B$=""3200 IF V$="A" THEN 32703210 B5=INT(D(I)/S*10000+0.5)/1003220 B$=STR(B5)3230 B$=B$&"%"3240 IF LEN(B$)+LEN(Y$)<=D7 THEN 32603250 Y$="***********"3260 Y$=Y$&B$3270 Z$=""3280 IF V$="P" THEN 33503290 B$=STR(D(I))3300 B$=REP("",1,1)3310 Z$=S$&B$3320 Z$=Z$&T$3330 IF LEN(Z$)<=D7 THEN 33503340 Z$="***********"3350 RETURN 3360 REM ....................DRAW AN EXPLODED SEGMENT3370 A9=(C3(I)+C3(I+1))/23380 X=0.2*COS(A9)3390 Y=0.2*SIN(A9)3400 MOVE @Z:X,Y3410 N0=03420 IF S1(I)<0 THEN 34703430 DIM P(2,185)3440 N0=N0+13450 P(1,N0)=(X+1.4)*46.42857142863460 P(2,N0)=(Y+1.4)*35.71428571433470 DRAW @Z:COS(C3(I))+X,SIN(C3(I))+Y3480 FOR K=C3(I) TO C3(I+1) STEP 23490 DRAW @Z:COS(K)+X,SIN(K)+Y3500 IF S1(I)<0 THEN 35403510 N0=N0+13520 P(1,N0)=(COS(K)+X+1.4)*46.42857142863530 P(2,N0)=(SIN(K)+Y+1.4)*35.71428571433540 IF K+2<=C3(I+1) OR K=C3(I+1) THEN 36103550 DRAW @Z:COS(C3(I+1))+X,SIN(C3(I+1))+Y3560 IF S1(I)<0 THEN 36103570 N0=N0+13580 P(1,N0)=(COS(C3(I+1))+X+1.4)*46.42857142863590 P(2,N0)=(SIN(C3(I+1))+Y+1.4)*35.71428571433600 K=K+23610 NEXT K3620 DRAW @Z:X,Y3630 MOVE @Z:COS(A9)*1.2,SIN(A9)*1.23640 GOSUB 25803650 IF S1(I)<0 THEN 36703660 GOSUB 37003670 MOVE @Z:0,03680 RETURN 3690 REM ....................SHADING3700 WINDOW 0,130,0,1003710 A=INT(S1(I)/45)*453720 SET RADIANS 3730 D0=S1(I)-A3740 DELETE W7,X0,P13750 DIM W7(2,N0+1),X0(N0),P1(2)3760 S0=1.0E+3073770 L0=-1.0E+3073780 S9=SIN(A*0.01745327)3790 C9=COS(A*0.01745327)3800 FOR I0=1 TO N03810 W7(1,I0)=P(1,I0)*C9+P(2,I0)*S93820 W7(2,I0)=-P(1,I0)*S9+P(2,I0)*C93830 S0=S0 MIN W7(2,I0)3840 L0=L0 MAX W7(2,I0)3850 NEXT I03860 W7(1,N0+1)=W7(1,1)3870 W7(2,N0+1)=W7(2,1)3880 Y0=S0+0.5*D03890 IF Y0>L0 THEN 41703900 K0=03910 FOR I0=1 TO N03920 W1=W7(2,I0) MIN W7(2,I0+1)3930 IF Y0<W1 THEN 40603940 W0=W7(2,I0) MAX W7(2,I0+1)3950 IF Y0=>W0 THEN 40603960 X1=(W7(2,I0)-Y0)*(W7(1,I0)-W7(1,I0+1))/(W7(2,I0)-W7(2,I0+1))3970 X1=W7(1,I0)-X13980 K0=K0+13990 J0=K04000 IF J0=1 THEN 40504010 IF X0(J0-1)=>X1 THEN 40504020 X0(J0)=X0(J0-1)4030 J0=J0-14040 GO TO 40004050 X0(J0)=X14060 NEXT I04070 FOR I0=1 TO K04080 P1(1)=X0(I0)*C9-Y0*S94090 P1(2)=X0(I0)*S9+Y0*C94100 IF 2*INT(0.5*I0)-I0>-0.1 THEN 41304110 MOVE @Z:P1(1),P1(2)4120 GO TO 41404130 DRAW @Z:P1(1),P1(2)4140 NEXT I04150 Y0=Y0+D04160 GO TO 38904170 DELETE P,W7,X0,P14180 WINDOW -1.4,1.4,-1.4,1.44190 SET DEGREES 4200 RETURN 4210 REM ......PRINT TITLES AND LOWER LABELS4220 P$="n"4230 IF Z=32 THEN 42704240 PRINT "Different character sizes or positioning (Y/N_) ";4250 INPUT P$4260 GO TO P$="Y" OF 43004270 L=LEN(C$)4280 PRINT @Z,21:65-L*1.87/2,974290 GO TO 43204300 W$=C$4310 GOSUB 62404320 PRINT @Z:C$4330 GO TO P$="Y" OF 43704340 L=LEN(R$)4350 PRINT @Z,21:65-L*1.87/2,924360 GO TO 43904370 W$=R$4380 GOSUB 62404390 PRINT @Z:R$4400 GO TO P$="Y" OF 44404410 L=LEN(D$)4420 PRINT @Z,21:65-L*1.87/2,44430 GO TO 44604440 W$=D$4450 GOSUB 62404460 PRINT @Z:D$4470 GO TO P$="Y" OF 45104480 L=LEN(L$)4490 PRINT @Z,21:65-L*1.87/2,14500 GO TO 45504510 W$=L$4520 GIN @Z:X9,Y14530 MOVE @Z:X0,Y14540 GOSUB 62404550 PRINT @Z:L$;4560 RETURN 4570 REM ....................CHANGE TEXT4580 REM4590 PAGE 4600 PRINT "Change Text"4610 PRINT "___________J_J_J_"4620 PRINT " (A) Pie Title: `";C$;"'"4630 PRINT " (B) Subtitle: `";R$;"'"4640 PRINT " (C) Lower Label #1: `";D$;"'"4650 PRINT " (D) Lower Label #2: `";L$;"'"4660 PRINT " (E) Symbol to preceed values: `";S$;"'"4670 PRINT " (F) Symbol to trail values: `";T$;"'"4680 PRINT " (G) Pie Segment Labels:J_"4690 FOR I=1 TO N4700 B$=SEG(A$,(I-1)*11+1,11)4710 PRINT "/";B$;4720 NEXT I4730 PRINT "/"4740 PRINT "J_ Enter choice (RETURN for no change) : ";4750 INPUT X$4760 IF X$="" THEN 61004770 GO TO ASC(X$)-64 OF 4790,4820,4850,4880,4910,4940,49704780 GO TO 52304790 PRINT "J_ Replace ";C$;" with ";4800 INPUT C$4810 GO TO 52304820 PRINT "J_ Replace ";R$;" with ";4830 INPUT R$4840 GO TO 52304850 PRINT "J_ Replace ";D$;" with ";4860 INPUT D$4870 GO TO 52304880 PRINT "J_ Replace ";L$;" with ";4890 INPUT L$4900 GO TO 52304910 PRINT "J_ Replace ";S$;" with ";4920 INPUT S$4930 GO TO 52304940 PRINT "J_ Replace ";T$;" with ";4950 INPUT T$4960 GO TO 52304970 PRINT "Pie Segment Labels: J_"4980 I=14990 I1=15000 B$=SEG(A$,(I-1)*C+1,C)5010 IF I1=4 THEN 50505020 PRINT USING 5030:I,"=",B$5030 IMAGE 3D,1A,15A,1X,S5040 GO TO 50805050 I1=45060 PRINT I$;"=";B$5070 PRINT 5080 I=I+15090 IF I<N+1 THEN 50005100 PRINT 5110 PRINT "Horizontal position #      ('RETURN' for no change)"5120 INPUT B$5130 IF B$="" THEN 52305140 I=VAL(B$)5150 IF I>N OR I<1 THEN 52305160 B$=SEG(A$,(I-1)*C+1,C)5170 PRINT "Replace ";B$;" with ";5180 INPUT B$5190 B$=B$&"               "5200 B$=SEG(B$,1,C)5210 A$=REP(B$,(I-1)*C+1,C)5220 GO TO 49705230 PRINT "J_ Do you want to make another label change (Y/N_) ";5240 INPUT B$5250 IF B$="Y" THEN 45905260 GOSUB 61005270 END 5280 REM ....................CHANGE DATA VALUES5290 REM5300 PAGE 5310 PRINT "Change Data Values"5320 PRINT USING "18""_"",""J_J_J_""":5330 FOR I=1 TO N5340 B$=SEG(A$,(I-1)*C+1,C)5350 PRINT "/Segment# ";I;"/    ";B$;"= ";D(I)5360 NEXT I5370 PRINT "J_Which Cell # (or 0 to stop) ";5380 INPUT I5390 IF I>0 AND I<=N THEN 54205400 GOSUB 61005410 END 5420 S=S-D(I)5430 PRINT "Old value was ";D(I);"     New value is ";5440 INPUT D(I)5450 S=S+D(I)5460 GO TO 53005470 REM *** CHANGE PIE PARAMETERS ***5480 PAGE 5490 PRINT "Change Pie Chart Parameters"5500 PRINT USING "27""_"",""J_J_J_""":5510 FOR I=1 TO N5520 B$=SEG(A$,(I-1)*C+1,C)5530 PRINT "      Segment #";I;" ";B$5540 NEXT I5550 PRINT "J_Which segment requires a parameter change?  ";5560 PRINT " (RETURN for none) : ";5570 INPUT B$5580 IF B$="" THEN 60605590 I=VAL(B$)5600 PAGE 5610 PRINT "Explode this segment? ";5620 GO TO E(I)+1 OF 5630,56705630 PRINT "(Y/N_)  ";5640 INPUT B$5650 IF B$="" OR B$="N" THEN 57105660 GO TO 57005670 PRINT "(Y_/N)  ";5680 INPUT B$5690 IF B$="" OR B$="Y" THEN 57105700 E(I)=ABS(E(I)-1)5710 PRINT "J_Shade this segment? ";5720 IF S1(I)<0 THEN 57805730 PRINT "(Y_/N): ";5740 INPUT B$5750 IF B$="" OR B$="Y" THEN 58105760 S1(I)=-455770 GO TO 60605780 PRINT "(Y/N_): ";5790 INPUT B$5800 IF B$="" OR B$="N" THEN 60605810 PRINT "J_  H  Horizontal"5820 PRINT "  V  Vertical"5830 PRINT "  D  Diagonal"5840 PRINT "  N  None"5850 PRINT "J_Type of shading for segment (default=";5860 B$="NHDV"5870 B$=SEG(B$,INT(S1(I)/45)+2,1)5880 PRINT B$;") : ";5890 INPUT B$5900 IF B$="" AND S1(I)<0 THEN 60605910 IF B$="" THEN 59505920 S1(I)=-455930 S1(I)=-45*(B$="N")+0*(B$="H")+45*(B$="D")+90*(B$="V")5940 IF S1(I)<0 THEN 60605950 PRINT "J_Number of shading lines? (default=";5960 O3=S1(I)-INT(S1(I)/45)*455970 PRINT O3;") ";5980 O4=O35990 INPUT B$6000 IF B$="" AND O3<>0 THEN 60606010 B$=B$&" 0"6020 O3=VAL(B$)6030 IF O3<=0 THEN 59506040 S1(I)=S1(I)-O46050 S1(I)=S1(I)+O36060 GOSUB 8106070 GOSUB 61006080 END 6090 REM ......MENU6100 PAGE 6110 PRINT "J_    Press User Definable Key"6120 PRINT "J_    1    To Change Data Values"6130 PRINT "    2    To Change Text"6140 PRINT "    4    To Change Pie Chart Parameters"6150 PRINT "    5    To List Menu"6160 PRINT "    6    To Redraw on Screen"6170 PRINT "    7    To Redraw on Plotter"6180 PRINT "   10    To Create a Pie Chart"6190 PRINT "   11    To Save Pie"6200 PRINT "   12    To Load Pie"6210 PRINT "   15    Init"6220 PRINT "J_   (NOTE: All defaults are underlined or specified)"6230 RETURN 6240 PRINT "J_Centered or Positioned Titles (P or C)? ";6250 INPUT F$6260 IF F$<>"P" AND F$<>"C" THEN 62406270 PRINT @1,17:1.87,2.976280 PRINT "Character Size (default=1.87 x 2.97): "6290 PRINT "Input X value: ";6300 INPUT E$6310 IF E$="" THEN 64006320 IF ASC(E$)<49 OR ASC(E$)>57 THEN 62906330 X=VAL(E$)6340 PRINT "Input Y value: ";6350 INPUT E$6360 IF E$="" THEN 64006370 IF ASC(E$)<49 OR ASC(E$)>57 THEN 63406380 Y=VAL(E$)6390 PRINT @Z,17:X,Y6400 PRINT "Position Pen and press RETURN: ";6410 INPUT M$6420 GIN @Z:X0,Y16430 GO TO F$="P" OF 64906440 MOVE @Z:0,Y16450 FOR V=1 TO LEN(W$)/26460 PRINT @Z:" ";6470 NEXT V6480 GO TO 65206490 FOR V=1 TO LEN(W$)6500 PRINT @Z:" ";6510 NEXT V6520 INPUT @Z,24:X2,Y26530 IF X2<140 THEN 65606540 PRINT "Won't fit."6550 GO TO 62906560 GO TO F$="P" OF 65906570 GIN @Z:X2,Y26580 X0=0-(X2-0)6590 MOVE @Z:X0,Y16600 RETURN 6610 REM Save Pie6620 PRINT "Which file for storage: ";6630 INPUT F6640 FIND F6650 PRINT @33:N;S6660 FOR I=1 TO N6670 PRINT @33:D(I);6680 NEXT I6690 PRINT @33:6700 FOR I=1 TO N6710 PRINT @33:S1(I);6720 NEXT I6730 PRINT @33:6740 FOR I=1 TO N6750 PRINT @33:E(I);6760 NEXT I6770 PRINT @33:6780 PRINT @33:A$6790 PRINT @33:S$6800 PRINT @33:T$6810 PRINT @33:V$6820 PRINT @33:C$6830 PRINT @33:R$6840 PRINT @33:D$6850 PRINT @33:L$6860 CLOSE 6870 RETURN 6880 REM Load Pie6890 DELETE D,S1,E,C3,A$6900 PRINT "Which file contains the data :";6910 INPUT F6920 FIND F6930 INPUT @33:N,S6940 DIM D(N),S1(N),E(N),C3(N+1)6950 DIM A$(11*N)6960 INPUT @33:D,S1,E6970 INPUT @33:A$,S$,T$,V$,C$,R$,D$,L$6980 RETURN 