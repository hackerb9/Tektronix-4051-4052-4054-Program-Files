1 REM ** Program PROGVARLI **2 SET KEY 3 GO TO 1004 N=F6+15 RETURN 100 PRINT "	***  Program  PROGVARLI ***J_"110 INIT 120 H$="Programlist of tape nr."130 PRINT "Number of tape: ";140 INPUT F8150 PRINT "List from file to file :: ";160 INPUT F5,F6170 PRINT "date: ";180 INPUT Z$190 REM statem. variables       input    FUZ200 DIM A$(171),W$(5000),W(312),L$(150),S$(300)210 REM  IF      DIM     DEL     GOS      GO TO    FOR-NEXT220 DIM M$(2000),N$(600),O$(400),Q$(1800),R$(3000),T$(2000)230 REM        REM  subroutines240 DIM E$(1),F$(600),G$(600),X$(200),X(100)250 E$=CHR(13)260 A$="LETPRIWRIIF REAWBYRBYFINMARKILMOVDRARMORDRAXIGINVIEWINSCAROT"270 A$=A$&"POIMATINPDEFPOLFORNEXDELFUZDIMGOSGO RETREMIMACALDATPAGEND"280 A$=A$&"OLDSAVSECTLIAPPON OFFHOMRESRUNSTOWAICLOCOPSETLISRENINI"290 REM output @g: (printer)300 G=41310 FOR N=F5 TO F6320 N1=N330 W=0340 X=0350 F$="REM in line:J_J_"360 G$="Subroutine from line to lineJ_J_"370 DATA 10,0,0,0,1380 RESTORE 370390 READ F9,N2,L1,L2,X1400 W$=""410 M$=""420 N$=""430 O$=""440 Q$=""450 R$=""460 S$=""470 T$=""480 X$=""490 I$=" "500 ON EOF (0) THEN 1590510 FIND N1520 PRINT @33,0:0,0,1530 FIND N1540 INPUT @33:L$550 PRINT @33,0:0,0,0560 FIND N1570 D$=SEG(L$,9,1)580 IF D$<>"A" THEN 1640590 D$=SEG(L$,17,1)600 IF D$<>"P" THEN 1640610 GOSUB 3120620 PRINT @G:"Meaning of symbols in position 1:J_J_*  PRINT"630 PRINT @G:"+  data-inputJ_=  DIMENSIONJ_!  DELETEJ_#  GOSUBJ_J_"640 I1=I1+9650 INPUT @33:L$660 IF LEN(L$)<2 THEN 650670 L1=L1+LEN(L$)+1680 L2=L2+1690 L=VAL(L$)700 A=9710 FOR I=1 TO A-2-INT(LGT(L)+1.0E-10)720 L$=" "&L$730 NEXT I740 D$=SEG(L$,A+1,3)750 L$=REP(I$,A,0)760 C=(POS(A$,D$,1)+2)/3770 IF C<>31 THEN 790780 L$=REP("#",1,1)790 IF C<>2 THEN 810800 L$=REP("*",1,1)810 IF C<>28 THEN 830820 L$=REP("!",1,1)830 IF C<>30 THEN 850840 L$=REP("=",1,1)850 IF C<>23 AND C<>5 THEN 870860 L$=REP("+",1,1)870 I1=I1+1880 F9=L890 GOSUB I1>64 OF 3120900 IF C<8 OR (C>30 AND C<38) THEN 930910 PRINT @G:L$920 GO TO 1020930 FOR I=1 TO LEN(L$)940 D$=SEG(L$,I,1)950 IF D$=>" " THEN 990960 B=ASC(D$)970 D$=CHR(B+64)980 D$=D$&"_"990 PRINT @G:D$;1000 NEXT I1010 GOSUB 31701020 IF C<>32 AND C<>33 AND C<>39 THEN 10601030 GOSUB 31601040 IF C<>39 THEN 10601050 GOSUB 31601060 L$=REP("",A,LEN(I$))1070 IF C<>26 THEN 10901080 I$=I$&"  "1090 IF C<>27 THEN 11101100 I$=REP("",1,2)1110 F=01120 L$=L$&E$1130 IF C<>4 THEN 11501140 GOSUB 24601150 IF C<26 OR C>32 THEN 11701160 GOSUB C-25 OF 2480,2480,2500,2520,2540,2560,25801170 D$=SEG(L$,A-6,6)1180 GO TO (C=34)+2*(C=33)+3*(C=31)+4*(C>34) OF 2600,2660,2680,6501190 REM ["] searching1200 B1=POS(L$,"""",A)1210 B2=POS(L$,"""",B1+1)1220 IF B2=0 THEN 12501230 L$=REP("",B1,B2-B1+1)1240 GO TO 12001250 L$=REP("!",LEN(L$),1)1260 B$=SEG(L$,A,1)1270 IF B$="!" THEN 15401280 L$=REP("",1,A-1)1290 A=11300 A=A+11310 B$=SEG(L$,A,1)1320 B=ASC(B$)1330 IF B=36 OR B>47 AND B<58 THEN 13001340 IF B<32 OR B>64 THEN 13001350 IF A<3 OR A>4 THEN 12601360 B$=SEG(L$,2,1)1370 B1=ASC(B$)1380 IF B1<65 OR B1>90 THEN 12601390 B2=471400 C$=" "1410 IF A=3 THEN 14801420 C$=SEG(L$,3,1)1430 B2=ASC(C$)1440 IF C$="$" THEN 14701450 IF B2<48 OR B2>57 THEN 12601460 GO TO 14801470 B2=581480 W$=W$&B$1490 W$=W$&C$1500 F=11510 H=(B1-65)*12+B2-461520 W(H)=W(H)+11530 GO TO 12601540 IF F=0 THEN 6501550 W$=W$&"#"1560 L$=STR(L)1570 W$=W$&L$1580 GO TO 6501590 GOSUB 22101600 GOSUB 16801610 GOSUB 27701620 PRINT @G:"J_J_J_J_number of lines: ";L21630 PRINT @G:"stringlength   : ";L11640 NEXT N1650 PRINT @G:""1660 FIND 01670 END 1680 REM list of variables with linenr.1690 GOSUB 31201700 PRINT @G:"    variables in line:J_J_"1710 I1=I1+31720 FOR I=65 TO 901730 H=(I-65)*12+11740 IF W(H)<0.5 THEN 17801750 D$=CHR(I)1760 D$=D$&" "1770 GOSUB 19601780 FOR J=0 TO 91790 H=(I-65)*12+J+21800 IF W(H)<0.5 THEN 18601810 D$=CHR(I)1820 L$=STR(J)1830 L$=SEG(L$,2,1)1840 D$=D$&L$1850 GOSUB 19601860 NEXT J1870 NEXT I1880 FOR I=65 TO 901890 H=(I-64)*121900 IF W(H)<0.5 THEN 19401910 D$=CHR(I)1920 D$=D$&"$"1930 GOSUB 19601940 NEXT I1950 RETURN 1960 REM subroutine output1970 PRINT @G:"J_    ";D$;"  :   ";1980 I1=I1+11990 H=W(H)2000 A=12010 L=12020 B=POS(W$,D$,A)2030 B1=POS(W$,"#",B+2)2040 L$=SEG(W$,B1+1,5)2050 B2=VAL(L$)2060 PRINT @G: USING "6d,s":B22070 H=H-12080 A=B+22090 L=L+12100 IF L<11 THEN 21602110 PRINT @G:2120 I1=I1+12130 GOSUB I1>64 OF 31202140 PRINT @G:"            ";2150 L=12160 IF H>0.5 THEN 20202170 PRINT @G:2180 I1=I1+12190 GOSUB I1>60 OF 31202200 RETURN 2210 REM list of variables2220 GOSUB 31202230 PRINT @G:"    list of variablesJ_    =================J_"2240 I1=I1+42250 L=12260 FOR I=1 TO 3122270 IF W(I)<0.5 THEN 24402280 A=INT((I-1)/12)2290 B=I-12*A+462300 D$=CHR(A+65)2310 B$=" "2320 IF B=47 THEN 23602330 B$="$"2340 IF B=58 THEN 23602350 B$=CHR(B)2360 D$=D$&B$2370 PRINT @G: USING "4x2a26xs":D$2380 L=L+12390 IF L<3 THEN 24402400 PRINT @G:"J_"2410 I1=I1+22420 GOSUB I1>63 OF 31202430 L=12440 NEXT I2450 RETURN 2460 M$=REP(L$,LEN(M$)+1,0)2470 RETURN 2480 T$=REP(L$,LEN(T$)+1,0)2490 RETURN 2500 O$=REP(L$,LEN(O$)+1,0)2510 RETURN 2520 S$=REP(L$,LEN(S$)+1,0)2530 RETURN 2540 N$=REP(L$,LEN(N$)+1,0)2550 RETURN 2560 Q$=REP(L$,LEN(Q$)+1,0)2570 RETURN 2580 R$=REP(L$,LEN(R$)+1,0)2590 RETURN 2600 F$=F$&D$2610 N2=N2+12620 IF N2<12 THEN 6502630 F$=F$&E$2640 N2=02650 GO TO 6502660 X$=X$&D$2670 GO TO 6502680 B1=POS(L$,"OF",8)+3 MAX 152690 D$=SEG(L$,B1,70)2700 B2=POS(D$,",",1)2710 B1=VAL(D$)2720 X(X1)=B12730 X1=X1+12740 IF B2=0 THEN 11902750 D$=SEG(D$,B2+1,70)2760 GO TO 27002770 REM Statements2780 FOR J=1 TO X1-22790 B1=X(J)2800 FOR I=J+1 TO X1-12810 IF X(I)>B1 THEN 28502820 X(J)=X(I)2830 X(I)=B12840 B1=X(J)2850 NEXT I2860 NEXT J2870 X$=X$&"999999999999"2880 B2=02890 FOR J=1 TO X1-12900 B1=X(J)2910 IF B1=B2 THEN 30702920 B2=B12930 D$=STR(B1)2940 D$="       "&D$2950 D$=SEG(D$,LEN(D$)-5,6)2960 G$=G$&D$2970 IF B1>L THEN 30002980 D$=STR(L)2990 GO TO 30403000 D$=SEG(X$,1,6)3010 L=VAL(D$)3020 X$=SEG(X$,7,LEN(X$))3030 IF L<B1 THEN 30003040 D$="  - "&D$3050 D$=D$&E$3060 G$=REP(D$,LEN(G$)+1,0)3070 NEXT J3080 PRINT @G:"J_tape  ";F8;"   file    ";N13090 PRINT @G:"J_",F$,"J_J_J_",G$,"J_J_",N$,"J_J_",O$,"J_J_",Q$,"J_J_",R$3100 PRINT @G:"J_J_",M$,"J_J_",T$,"J_J_",S$3110 RETURN 3120 PRINT @G: USING "p/4xfa5d3x""file ""3d3xs":H$,F8,N13130 PRINT @G:"    ";Z$;"J_J_"3140 I1=03150 RETURN 3160 I1=I1+13170 PRINT @G:3180 RETURN 