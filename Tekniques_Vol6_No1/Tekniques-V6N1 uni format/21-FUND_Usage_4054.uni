1 INIT 2 REM FILE 2 FUND USAGE PLOT II3 SET KEY 4 GO TO 1008 REM INPUT DATA9 GO TO 30012 REM SET LIMITS13 GO TO 60016 REM PLOT DATA17 GO TO 300020 REM PLOT CODE21 GO TO 700024 REM NEXT ACCT25 F4=526 RETURN 28 REM DATA TYPE29 F4=130 RETURN 32 F4=233 RETURN 36 F4=337 RETURN 40 F4=441 RETURN 44 REM STORE DATA45 GO TO 50046 RETURN 48 REM ZERO DATA49 GO TO 70056 REM PRINT DATA57 GO TO 600060 REM NEW ACCT.61 GO TO 800064 REM PRINT TITLES65 GO TO 10000100 REM START UP101 REM THIS CODE WAS DEVELOPED BY W. J. ORVIS AT THE 102 REM LAWRENCE LIVERMORE LAB TO STORE AND DISPLAY103 REM ACCOUNTING DATA , WITH 4 SUB-ACCOUNTS104 REM OVER SEVERAL YEARS. THE CODE SAVES THE DATA105 REM BY ACCOUNT AND YEAR IN THE ORDER THAT THEY WERE106 REM INPUT STARTING IN FILE 12. FILES 10 AND 11107 REM CONTAIN THE ACCOUNT NUMBERS AND NAMES.108 REM LIVERMORE, CALIFORNIA JUNE 1980110 Q2=32120 Q1=32122 Q3=32130 DIM D(54),Z$(100),T$(100),S$(100),Y$(100),X$(100)135 D=0140 PRINT @Q2:"	********** FUND USAGE PROGRAM **********"150 PRINT @Q2:"INPUT THE YEAR : ";160 INPUT F5170 GOSUB 2000180 IF F6=1 THEN 230190 FIND F1195 REM F1=FILE NUMBER200 READ @33:D210 PRINT @Q2:"DATA FOR ";F5;" INPUT"220 END 230 PRINT @Q2:"NEW DATA FILE # ";F1;" ASSIGNED"240 END 300 REM INPUT DATA305 PRINT @Q2:"	********** ADD DATA **********"310 GOSUB 1000330 PRINT @Q2:"USE KEYS 6-10 TO SPECIFY THE ACCOUNT AFTER INPUTTING THE"340 PRINT @Q2:" NUMBER"360 PRINT @Q2:"INPUT THE DATA:"370 F4=0375 INPUT X380 IF F4<>0 THEN 410390 PRINT @Q2:"PLEASE USE THE KEYS"400 GO TO 370410 IF F4=5 THEN 450420 D((F4-1)*13+F2)=D((F4-1)*13+F2)+X422 GO TO F4 OF 425,427,430,435425 PRINT @Q2:"	SUBTOTAL = ";D((F4-1)*13+F2);"  CONSULTANTS"426 GO TO 440427 PRINT @Q2:"	SUBTOTAL = ";D((F4-1)*13+F2);"  BILLS      "428 GO TO 440430 PRINT @Q2:"	SUBTOTAL = ";D((F4-1)*13+F2);"  LIENS      "431 GO TO 440435 PRINT @Q2:"	SUBTOTAL = ";D((F4-1)*13+F2);"  INTERNAL   "440 GO TO 370450 PRINT @Q2:"	DONE	DONT FORGET TO STORE THIS DATA FILE"452 F4=0460 END 500 REM STORE DATA510 FIND F1520 WRITE D530 IF F6=0 THEN 594540 FIND 5550 S1=TYP(0)560 IF S1=1 OR S1=0 THEN 585565 READ @33:X$570 READ @33:X$575 READ @33:X$580 GO TO 550585 WRITE A$586 X$=STR(F5)588 WRITE X$590 X$=STR(F1)592 WRITE X$594 END 600 REM SET LIMITS610 F4=0615 PRINT @Q2:"	********** SET LIMITS **********"640 PRINT @Q2: USING 650:A$," FOUND WITH A SPENDING LIMIT OF",D(53)642 PRINT @Q2: USING 652:" AND A PLOT LIMIT OF ",D(54)650 IMAGE    10A,33A,$C9D.2D652 IMAGE 21X,22A,$C9D.2D660 PRINT @Q2:"INPUT THE NEW SPENDING LIMIT:";670 INPUT D(53)672 PRINT @Q2:"INPUT THE NEW PLOT LIMIT: ";674 INPUT D(54)675 IF D(53)<D(54) THEN 680676 PRINT @Q2:"BEWARE: THE PLOT LIMIT IS LESS THEN THE SPENDING LIMIT"677 PRINT @Q2:D(54),D(53)680 END 700 REM ZERO DATA710 PRINT @Q2:"	********** ZERO DATA **********"720 PRINT @Q2:"J_J_ ARE YOU SURE YOU WANT TO ZERO THIS ACCOUNT"730 PRINT @Q2:A$;"  ";T$,"";S$;"		(Y OR N): ";732 INPUT X$734 IF X$="N" THEN 760736 IF X$="Y" THEN 750738 GO TO 720750 D=0760 END 1000 REM FIND MONTH M$ AND F21005 Z$=" START OCTOBER NOVEMBER DECEMBER JANUARY "1010 Z$=Z$&"FEBRUARY MARCH APRIL MAY JUNE JULY AUGUST SEPTEMBER "1030 PRINT @Q2:"INPUT THE MONTH (OR START): ";1040 INPUT X$1050 S1=POS(Z$,X$,1)1060 IF S1<>0 THEN 10901070 PRINT @Q2:X$," NOT FOUND"1080 GO TO 10301090 S3=21100 S4=01110 S2=POS(Z$," ",S3)1120 S4=S4+11130 IF S2>S1 THEN 11601140 S3=S2+11150 GO TO 11101160 F2=S41170 M$=SEG(Z$,S1,S2-S1)1180 RETURN 2000 REM FIND THE ACCOUNT A$, F3 AND THE ACCOUNT TITLE2030 PRINT @Q2:"INPUT THE ACCOUNT NUMBER: ";2040 INPUT X$2050 FIND 42060 S1=TYP(0)2070 IF S1=1 OR S1=0 THEN 21302080 READ @33:A$2090 READ @33:T$2100 READ @33:S$2110 IF A$=X$ THEN 21502120 GO TO 20602130 PRINT @Q2:"NO SUCH ACCOUNT, START A NEW ACCOUNT"2140 END 2150 FIND 52160 F1=52170 S1=TYP(0)2180 IF S1=1 OR S1=0 THEN 22802190 READ @33:X$2200 READ @33:Y$2210 READ @33:Z$2220 S2=VAL(Y$)2230 F1=VAL(Z$)2240 IF X$=A$ AND S2=F5 THEN 22602250 GO TO 21702260 F6=02270 RETURN 2280 F1=F1+12290 F6=12300 RETURN 3000 REM PLOT DATA3010 PRINT @Q2:"	********** PLOT DATA **********"3030 PRINT @Q2:"INPUT THE LAST MONTH TO BE PLOTTED"3040 GOSUB 10003260 PRINT @Q2:"J_	32-CRT	1-PLOTTERINPUT THE PLOT MEDIUM: ";3270 INPUT Q13280 IF Q1=32 OR Q1=1 THEN 33103290 PRINT @Q2:"TRY AGAIN: ";3300 GO TO 32703310 VIEWPORT 0,130,0,1003340 L2=D(54)3350 L1=-0.05*L23360 S1=103361 L3=INT(L2/S1+0.5)3362 S1=S1*103363 IF L3>10 THEN 33613364 L3=L3*S1/1003370 WINDOW -2,12,0,1003380 PAGE 3390 CHARSIZE 43395 IF Q1=32 THEN 34003397 PRINT @Q1,17:1.79,2.823400 MOVE @Q1:-2,98.13410 PRINT @Q1:"STATUS REPORT ON ";T$3411 PRINT @Q1:S$3412 MOVE @Q1:4,953414 PRINT @Q1:"ACCOUNT NO. ";A$;"-XX   ";F53420 MOVE @Q1:5,13430 PRINT @Q1:"MONTH";3440 MOVE @Q1:0.82,43450 Z$="O    N    D    J    F    M    A    M    J    J    A    S"3452 PRINT @Q1:Z$;3460 MOVE @Q1:-0.6,703470 PRINT @Q1:"J_EJ_XJ_PJ_EJ_NJ_DJ_IJ_TJ_UJ_RJ_EJ_S";3475 CHARSIZE 23476 IF Q1=32 THEN 34803478 PRINT @Q1,17:1.074,1.6923480 MOVE @Q1:-1.5,93.33490 PRINT @Q1: USING "$C9D.2D":L23500 MOVE @Q1:-0.5,103510 PRINT @Q1:"$ 0.00"3520 VIEWPORT 13,130,5,943550 WINDOW -1,12,L1,L23560 AXIS @Q1:1,L33570 MOVE @Q1:0,D(53)3580 DASH 2043590 DRAW @Q1:12,D(53)3600 DASH 03610 MOVE @Q1:0.2,1.01*D(53)3620 PRINT @Q1: USING "$C9D.2D":D(53)3630 FOR I=1 TO 53635 Y=03640 FOR J=1 TO F23650 X=J-13655 IF I<>5 THEN 36603656 Y=Y+D((1-1)*13+J)+D((2-1)*13+J)+D((3-1)*13+J)3657 Y=Y+D((4-1)*13+J)3658 GO TO 36703660 IF I<>3 THEN 36683662 Y=D((3-1)*13+J)3664 GO TO 36703668 Y=D((I-1)*13+J)+Y3670 IF J<>1 THEN 36903680 MOVE @Q1:X,Y3690 DRAW @Q1:X,Y3700 GOSUB I OF 4000,4200,4400,4600,48003702 IF I<>5 THEN 37103704 Y=Y-D((3-1)*13+J)3710 NEXT J3720 NEXT I3730 PRINT @Q1,21:150,1003740 CHARSIZE 43750 END 4000 REM SYMBOLS SQUARE4010 L5=L2/804015 L6=0.25/24020 RMOVE @Q1:L6/2,L5/24030 RDRAW @Q1:-L6,04040 RDRAW @Q1:0,-L54050 RDRAW @Q1:L6,04060 RDRAW @Q1:0,L54070 RMOVE @Q1:-L6/2,-L5/24080 RETURN 4200 REM SYMBOL TRIANGLE4210 L5=L2/804215 L6=0.25/24220 RMOVE @Q1:0,L5/24230 RDRAW @Q1:-L6/2,-L54240 RDRAW @Q1:L6,04250 RDRAW @Q1:-L6/2,L54260 RMOVE @Q1:0,-L5/24270 RETURN 4400 REM SYMBOL PLUS4410 L5=L2/804415 L6=0.25/24420 RMOVE @Q1:0,L5/24430 RDRAW @Q1:0,-L54440 RMOVE @Q1:-L6/2,L5/24450 RDRAW @Q1:L6,04460 RMOVE @Q1:-L6/2,04470 RETURN 4600 REM SYMBOL X4610 L5=L2/804615 L6=0.25/24620 RMOVE @Q1:L6/2,L5/24630 RDRAW @Q1:-L6,-L54640 RMOVE @Q1:0,L54650 RDRAW @Q1:L6,-L54660 RMOVE @Q1:-L6/2,L5/24670 RETURN 4800 REM SYMBOL STAR4810 L5=L2/804815 L6=0.25/24820 RMOVE @Q1:L6/2,L5/24830 RDRAW @Q1:-L6,-L54840 RMOVE @Q1:0,L54850 RDRAW @Q1:L6,-L54860 RMOVE @Q1:0,L5/24870 RDRAW @Q1:-L6,04880 RMOVE @Q1:L6/2,-L5/24890 RDRAW @Q1:0,L54900 RMOVE @Q1:0,-L5/24910 RETURN 6000 REM PRINT DATA6005 CHARSIZE 26010 PRINT @Q2:"	********** PRINT DATA **********"6020 PRINT @Q2:"J_J_32-CRT41-LINE PRINTER	INPUT NUMBER: ";6030 INPUT Q36040 IF Q3=41 OR Q3=32 THEN 60906050 PRINT @Q2:"TRY IT AGAIN SAM"6060 GO TO 60206090 PRINT @Q3:"J_J_STATUS REPORT ON ";T$6095 PRINT @Q3:S$6100 PRINT @Q3:"J_J_                        ACCOUNT NO. ";A$;"-XX   ";F56110 Z$="CONSULTANTS   SUBCONTRACTS   SUBCONTRACTS   INTERNAL     TOTAL"6120 PRINT @Q3:"J_J_              ";Z$6130 Z$="              BILLED         LIENS "6140 PRINT @Q3:"              ";Z$6150 Z$="=============================================================="6151 Z$=Z$&"============="6152 PRINT @Q3:"        ";Z$6160 S6=06170 S7=06180 S8=06190 S9=06200 S0=06210 FOR I=1 TO 136220 GO TO I OF 6240,6260,6280,6300,6320,6340,6360,6380,6400,64206230 GO TO I-10 OF 6440,6460,64806240 X$="START"6250 GO TO 64906260 X$="OCT"6270 GO TO 64906280 X$="NOV"6290 GO TO 64906300 X$="DEC"6310 GO TO 64906320 X$="JAN"6330 GO TO 64906340 X$="FEB"6350 GO TO 64906360 X$="MAR"6370 GO TO 64906380 X$="APR"6390 GO TO 64906400 X$="MAY"6410 GO TO 64906420 X$="JUN"6430 GO TO 64906440 X$="JULY"6450 GO TO 64906460 X$="AUG"6470 GO TO 64906480 X$="SEP"6490 S1=D((1-1)*13+I)6500 S2=D((2-1)*13+I)6510 S3=D((3-1)*13+I)6520 S4=D((4-1)*13+I)6530 S5=S1+S2+S3+S46540 S6=S6+S16550 S7=S7+S26570 S9=S9+S46590 PRINT @Q3: USING 6600:X$,"  |",S1,S2,S3,S4,S56600 IMAGE 5A,3A,5(C11D.2D,1X)6610 NEXT I6620 Z$="--------------------------------------------------------------"6621 Z$=Z$&"-------------"6622 PRINT @Q3:"        ";Z$6630 PRINT @Q3: USING 6635:"TOTALS"," ",S6,S7,S96635 IMAGE 6A,2A,2($C10D.2D,1X),15X,$C10D.2D6640 PRINT @Q3: USING "15A,$C9D.2D":"J_J_ACCOUNT LIMIT",D(53)6650 CHARSIZE 46660 END 7000 REM PLOT CODE7010 IF Q1=1 THEN 74007020 L5=L2/807030 L6=0.25/27035 L7=L57040 MOVE @Q1:5.5,(L2-L1)/27050 ROPEN 17060 GOSUB 40007070 RMOVE 0,-L77080 PRINT " -----CONSULTANTS"7090 RMOVE 0,-1*L57100 GOSUB 42007110 RMOVE 0,-L77120 PRINT " -----SUBCONTRACTS BILLED"7130 RMOVE 0,-1*L57140 GOSUB 44007150 RMOVE 0,-L77160 PRINT " -----SUBCONTRACT LIENS"7170 RMOVE 0,-1*L57180 GOSUB 46007185 RMOVE 0,-L77190 PRINT " -----INTERNAL"7200 RMOVE 0,-1*L57210 GOSUB 48007215 RMOVE 0,-L77220 PRINT " -----TOTALS"7230 RCLOSE 7240 CURSOR 17250 POINTER X,Y,Z$7260 STPOINT 1,X,Y7270 FIX 17280 VISIBILITY 1,07290 END 7400 REM FOR PLOTTER7410 PRINT @Q2:"MOVE THE PLOTTER PEN TO THE LOWER LEFT CORNER OF THE"7420 PRINT @Q2:"BLOCK THAT IS TO HOLD THE CODES AND PRESS RETURN: ";7430 INPUT Z$7432 GIN @1:X,Y7434 MOVE @Q1:X,Y7440 L5=L2/807450 L6=0.25/27451 L7=L5*0.57460 RMOVE @Q1:0,10*L57470 GOSUB 40007472 RMOVE @Q1:0,-L77480 PRINT @Q1:" -----CONSULTANTS"7485 RMOVE @Q1:0,-L5*1.27490 GOSUB 42007495 RMOVE @Q1:0,-L77500 PRINT @Q1:" -----SUBCONTRACTS BILLED"7505 RMOVE @Q1:0,-L5*1.27510 GOSUB 44007515 RMOVE @Q1:0,-L77520 PRINT @Q1:" -----SUBCONTRACT LIENS"7525 RMOVE @Q1:0,-L5*1.27530 GOSUB 46007535 RMOVE @Q1:0,-L77540 PRINT @Q1:" -----INTERNAL"7545 RMOVE @Q1:0,-L5*1.27550 GOSUB 48007555 RMOVE @Q1:0,-L77560 PRINT @Q1:" -----TOTALS"7570 MOVE @Q1:12,L27580 END 8000 REM NEW ACCOUNTS8010 PRINT @Q2:"J_	NEW ACCOUNTSJ_J_"8020 PRINT @Q2:"1-NEW ACCOUNT2-CORRECT ACCOUNT	INPUT NUMBER: ";8030 INPUT S18040 GO TO S1 OF 8050,83008050 GOSUB 80708060 GO TO 81408070 PRINT @Q2:"INPUT THE ACCOUNT NUMBER: ";8080 INPUT A$8090 PRINT @Q2:"INPUT THE TITLE BETWEEN THE MARKS"8100 PRINT @Q2: USING "55X,1A       ":"|"8101 PRINT @Q2: USING "30X,3A       ":"|"8110 INPUT T$8120 INPUT S$8130 RETURN 8140 FIND 48150 S1=TYP(0)8160 IF S1=1 OR S1=0 THEN 82408170 READ @33:X$8180 IF X$<>A$ THEN 82108190 PRINT @Q2:"ACCOUNT ";A$;" ALREADY EXISTS"8200 GO TO 80208210 READ @33:X$8220 READ @33:X$8230 GO TO 81508240 WRITE @33:A$8250 WRITE @33:T$8260 WRITE @33:S$8270 END 8300 REM CORRECT8310 PRINT @Q2:"INPUT THE ACCOUNT NUMBER: ";8320 INPUT A$8330 S2=08340 FIND 48350 S1=TYP(0)8360 IF S1=1 THEN 84308370 READ @33:X$8380 READ @33:T$8390 READ @33:S$8400 S2=S2+18410 IF X$=A$ THEN 84508420 GO TO 83508430 PRINT @Q2:"NO SUCH FILE"8440 END 8450 DELETE Y$8460 DIM Y$(1000)8470 PRINT @Q2:"ACCOUNT NUMBER  ";A$8480 PRINT @Q2:T$8490 PRINT @Q2:S$8500 PRINT @Q2:"CORRECT VALUES"8510 GOSUB 80708520 Y$=A$&"|"8530 Y$=Y$&T$8540 Y$=Y$&"|"8550 Y$=Y$&S$8560 Y$=Y$&"|"8570 S1=TYP(0)8580 IF S1=1 THEN 86408590 READ @33:Z$8600 READ @33:T$8610 READ @33:S$8620 Y$=Y$&Z$8622 Y$=Y$&"|"8630 GO TO 85308640 FIND 108650 IF S2=1 THEN 87108660 FOR I=1 TO S2-18670 READ @33:Z$8680 READ @33:Z$8690 READ @33:Z$8700 NEXT I8710 S4=08720 S3=POS(Y$,"|",S4+1)8730 T$=SEG(Y$,S4+1,S3-S4-1)8740 WRITE T$8750 S4=S38760 IF S4=LEN(Y$) THEN 87808770 GO TO 87208780 DELETE Y$8790 DIM Y$(100)8800 END 10000 PRINT @Q2:"	PRINT TITLESJ_J_"10010 FIND 410015 S1=TYP(0)10018 IF S1=1 OR S1=0 THEN 1005010020 READ @33:X$10030 PRINT X$10040 GO TO 1001510050 END 