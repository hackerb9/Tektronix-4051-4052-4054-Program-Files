100 REM          AIR DEFENSE GAME: DATA ANALYSIS110 REM120 REM   R. L. Hershman, F. L. Greitzer, & R. T. Kelly130 REM            Command and Support Systems140 REM    Navy Personnel Research & Development Center150 REM                    Code 302160 REM               San Diego, CA 92152170 REM180 INIT 190 PRINT "ENTER FILE NO.: ";200 INPUT F$210 FIND VAL(F$)220 READ @33:S$,D,N230 DIM A1(N),A5(N),A8(N),Q(N,5),C1(3),C2(3),W(99),Y(3,4)240 READ @33:A1,A5,A8,L250 DIM L$(L+1)260 READ @33:L$,C1,C2,K9,L9,L8,L7,R1,U270 REM..........Display Data Summary280 T$="FILE #"&F$290 PRINT "	AIR DEFENSE GAME SUMMARY:";T$;"";S$300 Q$=SEG("LOW         INTERMEDIATEHIGH        ",12*(D-1)+1,12)310 PRINT "J_J_N= ";N;"  ";Q$;"SPEED	KILLS	HITSJ_"320 FOR I=1 TO 3330 Q$=SEG("FAST  MEDIUMSLOW  ",6*(I-1)+1,6)340 PRINT USING "8A13D18D":Q$,C2(I),C1(I)350 NEXT I360 PRINT "J_TOTAL KILLS = ";SUM(C2);"    TOTAL HITS = ";SUM(C1)370 PRINT USING """J_J_AVE. DISTANCE FOR KILLS = ""2D.2D":K9380 PRINT "J_LAUNCHES = ";L9+L7;"SPLASHES = ";L8;"INFLITES = ";L7390 PRINT "R= ";R1 MAX 0400 INPUT Q$410 DIM R(U,6),F(3),F4(3),F5(3),F6(3),F7(6),H(SUM(C1) MAX 1)420 READ F,F4,F5,F6,F7430 DATA 2,5,12,9,15,28,5,3,1.6,45,44,44,1,2,4,5,10,20440 N0=N/3450 Q=0460 J=1470 R=0480 K4=U490 W=0500 Y=0510 REM..........W=look-up table for targets by track no520 REM..........Q(I,1)=Entry U, Q(I,2)=Optimal U for launch530 REM..........Q(I,3)=U of player's killing launch540 REM..........Q(I,4)=# of inflight launches, Q(I,5)=# of splashes550 REM..........H=updates on which hit(s) occurred560 FOR I1=1 TO 3570 FOR I=N0*(I1-1)+1 TO N0*I1580 W(A8(I))=I590 IF A5(I)<2000 THEN 620600 Q(I,1)=A5(I)-2000610 GO TO 650620 Q(I,1)=A5(I)-1000630 H(J)=Q(I,1)+F4(I1)640 J=J+1650 Q(I,2)=Q(I,1)+F(I1)660 K4=K4 MIN Q(I,2)670 NEXT I680 NEXT I1690 REM..........Get launch info from L$:T1=Update..T2=Track No.700 REM..........Find splashes and inflite launches710 FOR I=1 TO L/6720 X$=SEG(L$,6*I-5,3)730 T1=VAL(X$)-100740 X$=SEG(L$,6*I-2,3)750 T2=VAL(X$)760 IF T2>699 THEN 870770 X=T2-600780 IF T1=>Q(W(X),2) THEN 850790 REM..........A splash, so engaged800 Q(W(X),5)=Q(W(X),5)+1810 FOR J=T1 TO T1+3820 R(J,2)=R(J,2)+1830 NEXT J840 GO TO 890850 Q(W(X),3)=T1860 GO TO 890870 X=T2-700880 Q(W(X),4)=Q(W(X),4)+1890 NEXT I900 REM..........Print data by target910 FOR I=1 TO 3920 PRINT "";T$;"           ";930 PRINT "ANG    TN      E     L*      L     LAG   IN    SP    O"940 FOR J=N0*(I-1)+1 TO I*N0950 Q6=Q(J,3)-Q(J,2) MAX 0960 Y(I,1)=Y(I,1)+Q(J,5)970 Y(I,2)=Y(I,2)+Q6980 Y(I,3)=Y(I,3)+Q6^2990 Y(I,4)=Y(I,4)+Q(J,4)1000 A$=SEG("FMS",I,1)1010 C$=SEG("HK",Q(J,3) MIN 2,1)1020 PRINT USING 1040:J,A$,A1(J),A8(J),Q(J,1),Q(J,2),Q(J,3)1030 PRINT USING 1050:Q(J,3)-Q(J,2),Q(J,4),Q(J,5),C$1040 IMAGE 2D4X1A4X3D4X2D4X3D4X3D4X3D4XS1050 IMAGE 3D4X2D4X2D4X1A1060 NEXT J1070 INPUT Q$1080 NEXT I1090 PRINT "	MEAN LAG     SD LAG       N       IN       SP"1100 FOR I=1 TO 31110 C$=SEG("FASTMED SLOW",4*(I-1)+1,4)1120 PRINT C$;" TARGETS   ";1130 PRINT USING "2D.2D7XS":Y(I,2)/C2(I)1140 PRINT USING "2D.2D7XS":SQR((Y(I,3)-Y(I,2)^2/C2(I))/C2(I))1150 PRINT USING "2D7X2D7X2D":C2(I),Y(I,4),Y(I,1)1160 NEXT I1170 X=Y(1,2)+Y(2,2)+Y(3,2)1180 S=Y(1,3)+Y(2,3)+Y(3,3)1190 PRINT USING """ALL  TARGETS   ""2D.2D7XS":X/SUM(C2)1200 PRINT USING "2D.2D7XS":SQR((S-X^2/SUM(C2))/SUM(C2))1210 PRINT USING "2D7X2DS":SUM(C2),Y(1,4)+Y(2,4)+Y(3,4)1220 PRINT USING "7X2D":Y(1,1)+Y(2,1)+Y(3,1)1230 INPUT Q$1240 REM..........Aanlysis by update...R(J,1)=Active1250 REM..........R(J,2)=Engaged...R(J,3)=Kills...R(J,4)=Hits1260 REM..........R(J,5)=Unengaged...R(J,6)=Missed opps.1270 FOR I1=1 TO 31280 FOR I=N0*(I1-1)+1 TO N0*I11290 K5=Q(I,3)-11300 IF Q(I,3)=0 THEN 15501310 REM..........Process the kill1320 X1=F6(I1)-F5(I1)*(Q(I,3)-Q(I,1))1330 X2=51340 K=Q(I,3)-11350 IF X1<=X2 THEN 14101360 X1=X1-F5(I1)1370 X2=X2+51380 K=K+11390 GO TO 13501400 REM..........target is active1410 FOR J=Q(I,1) TO K1420 R(J,1)=R(J,1)+11430 NEXT J1440 FOR J=K+1 TO U1450 R(J,3)=R(J,3)+11460 NEXT J1470 REM..........target is engaged1480 IF K+1=Q(I,3) THEN 15201490 FOR J=Q(I,3) TO K1500 R(J,2)=R(J,2)+11510 NEXT J1520 IF Q(I,3)=Q(I,2) THEN 16901530 GO TO 16201540 REM..........Process the hit1550 FOR J=Q(I,1) TO Q(I,1)+F4(I1)-11560 R(J,1)=R(J,1)+11570 NEXT J1580 FOR J=Q(I,1)+F4(I1) TO U1590 R(J,4)=R(J,4)+11600 NEXT J1610 K5=Q(I,1)+F4(I1)-11620 J1=11630 REM..........Unengaged targets and missed opps.1640 FOR J=Q(I,2) TO K51650 R(J,6)=R(J,6)+J11660 R(J,5)=R(J,5)+11670 J1=J1+11680 NEXT J1690 NEXT I1700 NEXT I11710 PRINT "";T$;"  U   ACT  ENG   K    H  REM   UT    MO"1720 M=01730 U1=U-(R(U-1,3)+R(U-1,4)=N)1740 FOR I=1 TO U11750 R5=N-R(I,1)-R(I,3)-R(I,4)1760 PRINT USING 1770:I,R(I,1),R(I,2),R(I,3),R(I,4),R5,R(I,5),R(I,6)1770 IMAGE 3D3X2D3X2D3X2D3X2D3X2D3X2D3X3D1780 M=M MAX R(I,6)1790 NEXT I1800 INPUT Q$1810 REM..........Make the graph...axes,ticks, and values1820 PAGE 1830 MOVE 10,101840 DRAW 110,101850 MOVE 10,101860 DRAW 10,1001870 X1=100/U11880 X2=85/M1890 FOR I=1 TO U11900 MOVE I*X1+10,101910 RDRAW 0,-21920 IF I/5<>INT(I/5) THEN 19401930 PRINT USING """J_""2D":I1940 NEXT I1950 FOR J=1 TO 61960 IF INT(M/15) MAX 1<F7(J) THEN 19801970 NEXT J1980 FOR I=0 TO M STEP F7(J-1)1990 MOVE 10,I*X2+152000 RDRAW -2,02010 IF I/(5*F7(J-1))<>INT(I/(5*F7(J-1))) THEN 20402020 RMOVE 0,-12030 PRINT USING """""3D":I2040 NEXT I2050 MOVE 0,702060 PRINT "PERFORMANCE";2070 MOVE 10,02080 PRINT T$;"	          UPDATE";2090 MOVE K4*X1+9.5,112100 PRINT "^"2110 IF SUM(C1)=0 THEN 21702120 FOR I=1 TO SUM(C1)2130 MOVE H(I)*X1+9.5,112140 PRINT "*";2150 NEXT I2160 REM..........Plot unengaged targets and missed opportunities2170 MOVE X1+9,R(1,6)*X2+152180 FOR I=2 TO U12190 DRAW I*X1+9,R(I,6)*X2+152200 NEXT I2210 FOR I=1 TO U12220 MOVE I*X1+9,R(I,5)*X2+142230 PRINT "+";2240 NEXT I2250 END 