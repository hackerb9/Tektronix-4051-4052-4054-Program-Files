100 INIT 101 REM  ********************************************************102 REM  *                                                      *103 REM  *               PROGRAM WRITTEN MAY 1980               *104 REM  *                          BY                          *105 REM  *                   RICHARD M ENGEMAN                  *106 REM  *                         FOR                          *107 REM  *             DENVER WILDLIFE RESEARCH CENTER          *108 REM  *             U.S. FISH AND WILDLIFE SERVICE           *109 REM  *                                                      *110 REM  ********************************************************111 PAGE 120 PRINT "THIS PROGRAM CALCULATES AN ANALYSIS OF VARIANCE"130 PRINT "FOR A TWO FACTOR EXPERIMENT WITH"140 PRINT "REPEATED MEASURES ON ONE FACTOR"150 PRINT "(SEE WINER P514-539,P599-603)"160 PRINT 170 PRINT "THIS ANALYSIS ASSUMES COMPOUND SYMMETRY"180 PRINT "IN THE COVARIANCE MATRIX"190 PRINT 210 PRINT "THE DATA STRUCTURE IS AS FOLLOWS"220 PRINT 230 PRINT 240 PRINT "                 TREATMENT B"250 PRINT "|---|-------|-------------------|"260 PRINT "|   |SUBJECT|   1      2.....Q  |"270 PRINT "|---|-------|-------------------|"280 PRINT "| | |  |    |  x111   x112..x11Q|"290 PRINT "|T| |  2    |  x121   x122..x12Q|"300 PRINT "|R|1|  .    |   .      .     .  |"310 PRINT "|E| |  .    |   .      .     .  |"320 PRINT "|A| | N(1)  |   .      .     .  |"330 PRINT "|T|-|-------|-------------------|"340 PRINT "|M|.|  .    |   .      .     .  |"350 PRINT "|E|.|  .    |   .      .     .  |"360 PRINT "|N|-|-------|-------------------|"370 PRINT "|T| |  1    |  xP11   xP12  xP1Q|"380 PRINT "| |P|  .    |   .      .     .  |"390 PRINT "|A| |  .    |   .      .     .  |"400 PRINT "| | | N(P)  |   .      .     .  |"405 PRINT "|---|-------|-------------------|"410 PRINT 420 PRINT "THIS PROGRAM CAN NOT HANDLE MISSING DATA WITHIN A SUBJECT"430 PRINT 460 PRINT "ARE YOU READY TO INPUT DATA?  Y OR N ";470 INPUT U$475 PAGE 480 IF U$="N" THEN 460485 REM LINES 490 TO 600 INPUT AOV STRUCTURE AND TEST IF IS486 REM A 2-WAY REPEATED MEASURES DESIGN490 PRINT "ENTER # LEVELS TREATMENT A ";500 INPUT P501 IF P=1 THEN 503502 GO TO 510503 PRINT "J_*** YOUR DATA IS FROM A 1-WAY REPEATED MEASURES DESIGN ***"504 PRINT "J_START OVER WITH DIFFERENT DATA SET UP"505 END 510 PRINT "ENTER # LEVELS TREATMENT B ";520 INPUT Q525 D8=0526 IF Q=1 THEN 528527 GO TO 530528 PRINT "J_*** YOUR DATA IS FROM A 1-WAY ANALYSIS OF VARIANCE ***"529 GO TO 504530 DELETE N531 DIM N(P)535 O$="E"540 N1=0545 PRINT 546 PRINT 550 FOR I=1 TO P560 PRINT "ENTER # SUBJECTS IN LEVEL ";I;" OF TREATMENT A ";570 INPUT N(I)580 N1=N1+N(I)590 NEXT I592 FOR I=1 TO P593 IF N(I)<>1 THEN 600594 NEXT I595 PRINT "J_YOUR DATA IS FROM A 2-WAY AOV OR RANDOMIZED BLOCKS DESIGN"596 PRINT "        WITH NO INTERACTION"597 GO TO 504600 DELETE X,T,W,V,P1,B9601 DIM X(N1,Q),T(P,Q),W(P),V(Q),P1(N1),B9(P,Q)605 REM DATA INPUT610 PAGE 620 PRINT "ENTER EACH SUBJECT`S DATA ROW-WISE."630 PRINT "PUSH RETURN AFTER EACH DATA POINT."635 Z=1640 C=0650 FOR I=1 TO P660 L=1670 FOR J=L TO N(I)680 C=C+1690 FOR K=1 TO Q700 PRINT "ENTER x ";I;J;K;"  "710 INPUT X(C,K)711 Z=Z+1712 IF Z=17 THEN 716714 GO TO 720716 Z=0718 PAGE 720 NEXT K730 NEXT J740 NEXT I750 GO TO 3240760 PAGE 770 PRINT @D:"THIS IS THE RAW DATA"780 PRINT @D:790 PRINT @D:X;800 PRINT "WHEN YOU PRESS RETURN THE SCREEN WILL PAGE AND"820 PRINT "THE PROGRAM WILL CONTINUE ";830 INPUT U$880 GO TO 3240910 REM DATA CORRECTION920 PRINT "WHAT LEVEL OF A? ";930 INPUT I940 PRINT "WHAT SUBJECT IN LEVEL ";I;" "950 INPUT J960 PRINT "WHAT LEVEL OF B? ";970 INPUT K980 PRINT "ENTER CORRECT DATA POINT ";990 INPUT S995 D8=01000 IF I=1 THEN 10701010 L=01020 I=I-11030 FOR M=1 TO I1040 L=L+N(M)1050 NEXT M1060 L=L+J1065 GO TO 10801070 L=J1080 X(L,K)=S1090 PRINT "CORRECT ANOTHER DATA POINT? Y OR N ";1100 INPUT U$1110 IF U$="Y" THEN 9101120 GO TO 32401125 REM SENDS TO SUMMARY TABLE CALCULATIONS1140 PAGE 1145 GOSUB 13301148 GO TO 32401149 REM TESTS FOR EQUAL # OF SUBJECTS IN THE LEVELS OF A1150 FOR I=2 TO P1160 IF N(I-1)<>N(I) THEN 11801170 NEXT I1175 GO TO 12401180 PAGE 1185 O$="U"1190 PRINT "THERE ARE AN UNEQUAL NUMBER OF SUBJECTS "1195 PRINT "IN THE LEVELS OF TREATMENT A"1200 PRINT 1210 PRINT "DO YOU WANT LEAST SQUARES OR UN-WEIGHTED MEANS?"1220 PRINT "L OR U "1230 INPUT U$1240 GOSUB 17501250 IF U$="U" THEN 12701260 GO TO 12751270 GOSUB 19701275 GOSUB 23101277 IF O$<>"U" THEN 32401278 PRINT 1280 PRINT "DO YOU WANT ANOTHER TABLE USING THE OTHER METHOD?  Y OR N"1290 PRI "(THIS ONLY APPLIES IF THERE ARE UNEQUAL NUMBERS OF SUBJECTS)"1300 INPUT U$1310 IF U$="Y" THEN 12101315 GO TO 32401320 END 1325 REM SUMMARY TABLE OF DATA1330 L1=01340 A1=01350 L=01360 FOR K=1 TO P1370 L=L+N(K)1380 L1=L1+1/N(K)1390 FOR J=1 TO Q1400 S=01410 M=L-N(K)1420 FOR I=1 TO N(K)1430 M1=M+I1440 S=S+X(M1,J)1450 A1=A1+X(M1,J)^21460 NEXT I1470 T(K,J)=S1480 NEXT J1490 NEXT K1495 S2=A11500 H1=P/L11510 FOR I=1 TO P1520 W(I)=01530 FOR J=1 TO Q1540 W(I)=W(I)+T(I,J)1550 NEXT J1560 NEXT I1570 FOR J=1 TO Q1580 V(J)=01590 FOR I=1 TO P1600 V(J)=V(J)+T(I,J)1610 NEXT I1620 NEXT J1630 PRINT @D:"SUMMARY TABLE OF DATA (CELL TOTALS)"1640 PRINT @D:1650 PRINT @D:T1654 PRINT "WHEN YOU PRESS RETURN THE SCREEN WILL PAGE AND"1655 PRINT "THE PROGRAM WILL CONTINUE ";1656 INPUT U$1659 PAGE 1660 S6=01670 FOR I=1 TO N11680 P1(I)=01690 FOR J=1 TO Q1700 P1(I)=P1(I)+X(I,J)1710 NEXT J1720 S6=S6+P1(I)^21730 NEXT I1740 S6=S6/Q1744 GO TO 25901745 RETURN 1748 REM CALCULATES SUMS OF SQARES1750 S3=01760 G=01770 FOR I=1 TO P1780 G=G+W(I)1790 S3=S3+W(I)^2/(N(I)*Q)1800 NEXT I1810 S1=G^2/(N1*Q)1820 S4=01830 FOR J=1 TO Q1840 S4=S4+V(J)^2/N11850 NEXT J1860 S5=01870 FOR I=1 TO P1880 FOR J=1 TO Q1890 S5=S5+T(I,J)^2/N(I)1900 NEXT J1910 NEXT I1920 Q1=S3-S11930 Q2=S6-S31940 Q3=S4-S11950 Q4=S5-S3-S4+S11960 Q5=S2-S5-S6+S31965 RETURN 1969 REM CALCULATES SUMS OF SQUARES FOR UNWEIGHTED MEANS METHOD1970 DIM W1(P),V1(Q)1980 FOR I=1 TO P1990 W1(I)=W(I)/N(I)2000 FOR J=1 TO Q2010 T(I,J)=T(I,J)/N(I)2020 NEXT J2030 NEXT I2040 FOR J=1 TO Q2050 V1(J)=02060 FOR I=1 TO P2070 V1(J)=V1(J)+T(I,J)2080 NEXT I2090 NEXT J2100 U3=02110 G1=02120 FOR I=1 TO P2130 G1=G1+W1(I)2140 U3=U3+W1(I)^2/Q2150 NEXT I2160 U1=G1^2/(P*Q)2170 U4=02180 FOR J=1 TO Q2190 U4=U4+V1(J)^2/P2200 NEXT J2210 U5=02220 FOR I=1 TO P2230 FOR J=1 TO Q2240 U5=U5+T(I,J)^22250 NEXT J2260 NEXT I2270 Q1=H1*(U3-U1)2280 Q3=H1*(U4-U1)2290 Q4=H1*(U5-U3-U4+U1)2300 RETURN 2305 REM CALCULATES DF & MS2310 D1=P-12320 D2=N1-P2330 D3=Q-12340 D4=(P-1)*(Q-1)2350 D5=(N1-P)*(Q-1)2360 M1=Q1/D12370 M2=Q2/D22380 M3=Q3/D32390 M4=Q4/D42400 M5=Q5/D52410 F1=M1/M22420 F2=M3/M52430 F3=M4/M52440 PAGE 2450 PRINT @D:2460 PRINT @D:"                  AOV TABLE"2470 PRINT @D:2480 PRINT @D:"   SOURCE        DF        SS          MS          F"2490 PRINT @D:"--------------------------------------------------------"2500 PRINT @D:"BETWEEN SUBJECT"2510 PRINT @D: USING "3X,1A,11X,4D.,8D.3D,8D.3D,8D.3D":"A",D1,Q1,M1,F12520 PRINT @D: USING "15A,4D.,8D.3D,8D.3D":"SUBJ IN GROUPS",D2,Q2,M22530 PRINT @D:2535 PRINT @D:"WITHIN SUBJECT"2540 PRINT @D: USING "3X,1A,11X,4D.,8D.3D,8D.3D,8D.3D":"B",D3,Q3,M3,F22550 PRINT @D: USING "3X,3A,9X,4D.,8D.3D,8D.3D,8D.3D":"A*B",D4,Q4,M4,F32560 PRINT @D: USING "15A,4D.,8D.3D,8D.3D":"B*SUBJ IN GRPS",D5,Q5,M52570 PRI @D:"---------------------------------------------------------"2575 PRINT 2576 PRINT "WHEN YOU PRESS RETURN THE PROGRAM WILL CONTINUE"2577 INPUT U$2580 RETURN 2590 REM CALCULATING MEANS2600 PRINT @D:2610 PRINT @D:"THE MEAN FOR EACH SUBJECT IS LISTED BELOW"2620 PRINT @D:2630 M9=02640 FOR I=1 TO P2645 PRINT @D:"GROUP ";I2647 PRINT @D:"SUBJECT              MEAN"2650 M9=M9+N(I)2660 FOR J=1 TO N(I)2670 M8=M9+J-N(I)2680 M7=02690 FOR K=1 TO Q2700 M7=M7+X(M8,K)2710 NEXT K2720 M7=M7/Q2730 PRINT @D:J,M72740 NEXT J2750 NEXT I2755 PRINT 2760 PRINT "WHEN YOU PRESS RETURN THE OTHER MEANS WILL PRINT OUT"2780 INPUT U$2810 PAGE 2820 PRINT @D:2830 PRINT @D:2840 PRINT @D:"THE MEAN RESPONSE FOR EACH LEVEL OF TREATMENT A"2850 PRINT @D:"LEVEL              MEAN"2860 FOR I=1 TO P2870 M9=02880 FOR J=1 TO Q2890 M9=M9+T(I,J)2900 NEXT J2910 M9=M9/(Q*N(I))2920 PRINT @D:I,M92930 NEXT I2940 REM2950 PRINT @D:2960 PRINT @D:2970 PRINT @D:"THE MEAN RESPONSE FOR EACH LEVEL OF TREATMENT B"2980 PRINT @D:"LEVEL              MEAN"2990 FOR J=1 TO Q3000 M9=03010 FOR I=1 TO P3020 M9=M9+T(I,J)3030 NEXT I3040 M9=M9/L3050 PRINT @D:J,M93060 NEXT J3070 FOR I=1 TO P3080 FOR J=1 TO Q3090 B9(I,J)=T(I,J)/N(I)3100 NEXT J3110 NEXT I3120 PRINT @D:3130 PRINT @D:3140 PRINT @D:"THE MEAN RESPONSE IN THE A*B CELLS"3150 PRINT @D:3160 PRINT @D:B93170 PRINT 3180 PRINT "PRESS RETURN AND THE PROGRAM WILL CONTINUE ";3190 INPUT U$3220 PAGE 3230 GO TO 17453235 REM CHOOSING TASK TO BE PERFORMED3240 PAGE 3250 PRINT "ENTER # FOR WHAT YOU WANT TO DO"3260 PRINT 3270 PRINT "1=PRINT RAW DATA"3280 PRINT "2=ALTER DATA POINT"3290 PRINT "3=PRINT SUMMARY TABLE OF CELL TOTALS AND MEANS TABLES"3300 PRINT "4=PRINT AOV TABLE"3310 PRINT "5=INPUT A NEW DATA SET"3320 PRINT "6=STOP"3330 INPUT D93335 IF D9>6 THEN 32403340 PRINT 3350 IF D9=2 OR D9=>5 THEN 34303360 PRINT "ENTER DEVICE WHERE OUTPUT IS TO BE PRINTED"3370 PRINT "P=PRINTER"3380 PRINT "S=SCREEN"3390 INPUT U$3400 IF U$<>"P" AND U$<>"S" THEN 33603410 D=323420 IF U$="P" THEN 34403430 GO TO 34503440 D=513450 IF D9=3 THEN 34703460 GO TO 34803470 D8=13480 IF D9=4 AND D8=0 THEN 35003490 GO TO 35103500 D9=33502 D8=13504 PAGE 3506 PRINT "MEANS TABLES MUST BE CALCULATED BEFORE THE AOV TABLE"3507 PRINT 3508 GO TO D9 OF 760,920,1145,1150,460,13203510 GO TO D9 OF 760,920,1140,1150,460,1320