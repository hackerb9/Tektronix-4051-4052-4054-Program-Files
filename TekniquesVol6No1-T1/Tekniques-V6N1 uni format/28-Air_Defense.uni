2 RUN 1703 REM----------function key servicing4 T$=T$&"1"6 GOSUB A OF 2690,507 RETURN 8 T$=T$&"2"10 GOSUB A OF 2690,5011 RETURN 12 T$=T$&"3"14 GOSUB A OF 2690,5015 RETURN 16 T$=T$&"4"18 GOSUB A OF 2690,5019 RETURN 20 T$=T$&"5"21 GOSUB A OF 2690,5022 RETURN 24 T$=T$&"6"26 GOSUB A OF 2690,5027 RETURN 28 T$=T$&"7"30 GOSUB A OF 2690,5031 RETURN 32 T$=T$&"8"34 GOSUB A OF 2690,5035 RETURN 36 T$=T$&"9"38 GOSUB A OF 2690,5039 RETURN 40 T$=T$&"0"41 GOSUB A OF 2690,5042 RETURN 49 REM----------inappropriate keypress50 T$=""60 RETURN 100 REM                     AIR DEFENSE GAME110 REM120 REM          R. L. Hershman, F. L. Greitzer, & R. T. Kelly130 REM           Command and Support Systems, Code 302140 REM           Navy Personnel Research & Development Center150 REM                   San Diego, CA 92152160 REM170 REM----------find next data file180 PRINT @33,0:0,0,1190 F1=3200 FIND F1210 INPUT @33:A$220 A$=SEG(A$,9,1)230 IF A$="L" THEN 260240 F1=F1+1250 GO TO 200260 PRINT @33,0:0,0,0270 SET DEGREES 280 SET NOKEY 290 A=2300 Z=RND(-1)310 REM----------print instructions320 PRINT "	AIR DEFENSE GAME INSTRUCTIONS    YOUR SHIP IS U";330 PRINT "NDER ATTACK BY INCOMING MISSILES WITHVARYING SPEEDS AND";340 PRINT " LAUNCH TIMES.  YOUR TASK IS TO MONITORTHE RADAR DISPLAY";350 PRINT " AND DESTROY THEM.  THE PRIORITIESOF THE ENGAGEMENT ARE:"360 PRINT "   (1) AVOID BEING HIT.   (2) AVOID SPLASHING YOUR OWN ";370 PRINT "MISSILES BY LAUNCHING TOO       EARLY...YOUR WEAPONS ";380 PRINT "RANGE IS 20 MILES, WHICH       IS THE INNER CIRCLE OF THE";390 PRINT " RADAR DISPLAY.   (3) DESTROY INCOMING MISSILES AS SOON ";400 PRINT "AS POSSIBLE       AFTER THEY ENTER YOUR WEAPONS RANGE."410 PRINT "   (4) AVOID LAUNCHING A MISSILE IF YOU ALREADY HAVE ONE"420 PRINT "       IN FLIGHT ON THE SAME TARGET.    YOUR SKILL RATI";430 PRINT "NG (0-100) WILL INCLUDE A 12-POINTPENALTY FOR EACH HIT ";440 PRINT "SUSTAINED AND A 2-POINT PENALTY FOREACH INFLIGHT LAUNCH. ";450 PRINT " THE MAXIMUM KILL RANGE IS 20 MILES.FIVE POINTS ARE DEDUC";460 PRINT "TED FOR EACH MILE THAT YOUR AVERAGEKILL RANGE IS UNDER 20."470 PRINT "J_    TO LAUNCH A MISSILE, USE THE TEN WHITE KEYS AT THE";480 PRINT " UPPERLEFT OF THE KEYBOARD.  ENTER THE TWO-DIGIT ";490 PRINT "TRACK NUMBEROF THE TARGET...A READOUT WILL THEN INFORM ";500 PRINT "YOU OF A SUCCESSFULLAUNCH--OR AN ERROR.  ";510 PRINT "AN ERROR OCCURS IF YOU KEY A NUMBERINCORRECTLY";520 PRINT " OR IF YOU LAUNCH A MISSILE UNNECESSARILY."530 PRINT "J_ GOOD LUCK....THE FATE OF YOUR SHIP LIES IN YOUR HANDS!"540 PRINT "J_        Press RETURN to continue...";550 INPUT A$560 REM----------cleanup memory and get player I.D.570 PRINT "J_J_ENTER YOUR NAME:   ";580 INPUT S$590 Z1=0600 T7=54610 M$="L##"620 N$="E##"630 DELETE P3,S3,F3,G3,K3,L3,X9,K5,T$,A6,A7,A8,A9,H9,L$,A1,A5,A4,W,T2640 SET NOKEY 650 A=2660 T$=""670 REM----------select tempo and target density680 W$="LOW      "690 X$="INTERMEDIATE   "700 Y$="HIGH       "710 Q$="Practice"720 PRINT "J_J_SELECT TEMPO:   1=";W$;"   2=";X$;"   3=";Y$730 PRINT "   4=";Q$;"       ";740 INPUT D750 IF D<1 OR D>4 THEN 740760 IF D<>4 THEN 810770 N0=2780 K=2790 W7=443800 GO TO 890810 PRINT "J_J_J_SELECT TARGET DENSITY (1, 2, 3, OR 4): ";820 INPUT N0830 IF N0<1 OR N0>4 THEN 820840 N0=N0*6850 K=N0/D860 REM----------set W7 counter to equate update times870 A$=SEG("083095100025022018010006002004001000",3*N0/2+3*D-11,3)880 W7=VAL(A$)890 N=3*N0900 W8=N=72 AND D=3910 PRINT "J_J_J_J_We'll begin in a few seconds..."920 DIM A5(N),R1(N)930 REM----------randomization for entry times940 CALL "FLASH"950 R1=INT(RND(1)+0.5)960 FOR I=1 TO K970 GO TO D OF 1040,1010,980,1040980 A5(I+2*K)=5*I+R1(I+2*K)990 A5(I+2*K+N0)=4*I+3+R1(I+2*K+N0)1000 A5(I+2*K+2*N0)=I+R1(I+2*K+2*N0)1010 A5(I+K)=5*I+4+R1(I+K)1020 A5(I+K+N0)=4*I+1+R1(I+K+N0)1030 A5(I+K+2*N0)=I+R1(I+K+2*N0)1040 A5(I)=5*I+R1(I)1050 A5(I+N0)=4*I-1+R1(I+N0)1060 A5(I+2*N0)=2*I-1+R1(I+2*N0)1070 NEXT I1080 REM----------assign track nos, speeds, angles, and hit times1090 DIM P3(90),S3(90),H9(N),L$(1200),A1(90),A8(90),A9(90),X9(90),W(N)1100 S3=01110 CALL "MFLASH"1120 A1=FNX(4)1130 A8=FNX(1)+91140 W=FNX(1)1150 REM1160 FOR K=1 TO 901170 B=A1(K)1180 C=A8(K)1190 CALL "MFLASH"1200 J=INT(RND(1)*90)+11210 J1=INT(RND(1)*90)+11220 REM1230 A1(K)=A1(J)1240 A1(J)=B1250 A8(K)=A8(J1)1260 A8(J1)=C1270 NEXT K1280 DIM A1(N),A8(N),A4(N)1290 FOR I=1 TO N1300 A9(I)=A1(I)/41310 IF I<=N0 THEN 13901320 IF I<=2*N0 THEN 13601330 A4(I)=28+A5(I)1340 S3(A9(I))=1.61350 GO TO 14101360 A4(I)=16+A5(I)1370 S3(A9(I))=31380 GO TO 14101390 A4(I)=10+A5(I)1400 S3(A9(I))=51410 NEXT I1420 REM----------draw circles1430 PAGE 1440 DIM X(101),Y(101),T2(N)1450 Z0=461460 GOSUB 15001470 Z0=201480 GOSUB 15001490 GO TO 15701500 CALL "MFLASH"1510 X=SIN(FNX(3.6))*Z0+T71520 Y=COS(FNX(3.6))*Z0+501530 X(1)=-X(1)1540 REM1550 CALL "DFLASH",X,Y1560 RETURN 1570 MOVE T7-0.5,48.51580 PRINT @32,18:51590 PRINT "+";M$;"J_";N$1600 DELETE X,Y,R11610 REM----------initialize1620 DIM F3(90),G3(90),K3(180),L3(180),T$(20),A6(N),A7(N),K5(N)1630 U=11640 K1=01650 K9=01660 L7=01670 L8=01680 L9=01690 A6=01700 A7=01710 P3=441720 FOR I=1 TO N01730 P3(A9(I))=451740 NEXT I1750 H0=01760 X9=01770 H9=11780 L1=11790 SET KEY 1800 A=11810 REM----------start new epoch1820 K4=01830 H=11840 CALL "FLASH"1850 A6=ABS(A6)*H91860 H9=11870 REM----------determine target status1880 FOR I0=1 TO N1890 GO TO 2*(A5(I0)>U)+W8 OF 1900,2330,19801900 IF U=A4(I0) THEN 34201910 X9(A9(I0))=11920 IF P3(A9(I0))<44 THEN 19601930 K4=K4+11940 K5(K4)=I01950 GO TO 19801960 GO TO A6(I0)+1 OF 1980,23701970 A6(I0)=11980 NEXT I01990 REM----------make radar sweep2000 CALL "MFLASH"2010 F3=(2*X9-1)*(SIN(FNX(4))*P3+T7)2020 G3=COS(FNX(4))*P3+502030 REM2040 FOR I=1 TO 902050 CALL "MFLASH"2060 J1=2*I-12070 K3(J1)=F3(I)2080 K3(J1+1)=F3(I)2090 L3(J1)=G3(I)2100 L3(J1+1)=G3(I)2110 REM2120 NEXT I2130 CALL "XFLASH"2140 K3=-ABS(K3)2150 H=-12160 CALL "DFLASH",K3,L32170 IF K4=0 THEN 22802180 REM----------display target nos.2190 FOR J2=1 TO K42200 CALL "MFLASH"2210 X7=SIN(A1(K5(J2)))*48.5+T7+0.52220 Y7=COS(A1(K5(J2)))*48.5+492230 REM2240 MOVE X7,Y72250 PRINT "";A8(K5(J2));2260 NEXT J22270 REM----------compute next position2280 CALL "FLASH"2290 P3=P3-X9*S32300 P3=0 MAX P32310 U=U+12320 GO TO 18202330 FOR W6=1 TO W72340 NEXT W62350 GO TO 19802360 REM----------plot player's missile track2370 A7(I0)=A7(I0)+52380 IF A7(I0)>20 THEN 25002390 IF P3(A9(I0))+S3(A9(I0))-A7(I0)<=0.1 THEN 25502400 CALL "MFLASH"2410 X1=SIN(A1(I0))*A7(I0)+T72420 Y1=COS(A1(I0))*A7(I0)+502430 X2=SIN(A1(I0))*(A7(I0)-1)+T72440 Y2=COS(A1(I0))*(A7(I0)-1)+502450 REM2460 MOVE X1,Y12470 DRAW X2,Y22480 GO TO 19802490 REM----------missile splashed2500 L8=L8+12510 A7(I0)=02520 A6(I0)=02530 GO TO 19802540 REM----------destroyed a target2550 PRINT "";2560 MOVE T7,502570 ROTATE 90-A1(I0)2580 RDRAW 45,02590 X9(A9(I0))=02600 K9=K9+P3(A9(I0))+S3(A9(I0))2610 A5(I0)=A5(I0)+20002620 A6(I0)=02630 K1=K1+12640 IF K1+H0<>N THEN 19802650 I0=N2660 NEXT I02670 GO TO 35602680 REM----------assemble target no. for launch2690 GO TO LEN(T$)+1 OF 2700,3320,27302700 T$=SEG(T$,1,2)2710 GIN X6,Y62720 GO TO 32402730 T0=VAL(T$)2740 GIN X6,Y62750 REM----------lookup target #2760 T2=T0=A82770 T2=T2*W2780 J=SUM(T2)2790 IF J=0 THEN 32102800 IF ABS(A6(J))=1 THEN 31802810 IF X9(A9(J))=0 THEN 32102820 CALL "MFLASH"2830 X3=SIN(A1(J))*5+T72840 Y3=COS(A1(J))*5+502850 X4=SIN(A1(J))*4+T72860 Y4=COS(A1(J))*4+502870 REM2880 REM----------launch the missile2890 MOVE X3,Y32900 DRAW X4,Y42910 A6(J)=-12920 H9(J)=H2930 A7(J)=52940 L9=L9+12950 I$=STR(600+A8(J))2960 GOSUB 33402970 REM----------good launch...inform player2980 FOR S=1 TO 62990 MOVE 1.792+Z1*5.376,86.9123000 PRINT T$;3010 FOR S1=1 TO 83020 NEXT S13030 NEXT S3040 IF P3(A9(J))+S3(A9(J))>5 THEN 33003050 REM----------destroyed target3060 PRINT "";3070 MOVE T7,503080 ROTATE 90-A1(J)3090 RDRAW 45,03100 X9(A9(J))=03110 A6(J)=03120 K9=K9+0 MAX P3(A9(J))+S3(A9(J))3130 A5(J)=A5(J)+20003140 K1=K1+13150 IF K1+H0<>N THEN 33003160 GO TO 35603170 REM----------error:in-flight launch3180 L7=L7+13190 I$=STR(700+A8(J))3200 GOSUB 33403210 REM----------error...inform player3220 GOSUB 32403230 RETURN 3240 FOR S=1 TO 63250 MOVE 1.792+Z1*5.376,78.4643260 PRINT T$;3270 FOR S1=1 TO 83280 NEXT S13290 NEXT S3300 MOVE X6,Y63310 T$=""3320 RETURN 3330 REM.....load L$ with launch information3340 H$=STR(U+99.5-H/2)3350 H$=SEG(H$,2,3)3360 I$=SEG(I$,2,3)3370 H$=H$&I$3380 L$=REP(H$,L1,0)3390 L1=L1+63400 RETURN 3410 REM----------target hit player's ship3420 H0=H0+13430 A5(I0)=A5(I0)+10003440 X9(A9(I0))=03450 PRINT "";3460 CALL "MFLASH"3470 X8=SIN(A1(I0))*48.5+T7+0.53480 Y8=COS(A1(I0))*48.5+493490 REM3500 MOVE X8,Y83510 PRINT "##";3520 IF K1+H0<>N THEN 19803530 I0=N3540 NEXT I03550 REM-----------end of game3560 MOVE 0,43570 PRINT "End of game..."3580 A=23590 FOR I=1 TO 7003600 J=J3610 NEXT I3620 SET NOKEY 3630 REM----------summarize performance3640 DIM C1(3),C2(3),V$(15)3650 C1=03660 C2=03670 FOR K=1 TO 33680 FOR I=(K-1)*N0+1 TO K*N03690 IF A5(I)<2000 THEN 37203700 C2(K)=C2(K)+13710 GO TO 37303720 C1(K)=C1(K)+13730 NEXT I3740 NEXT K3750 IF K1=0 THEN 37703760 K9=K9/K13770 PRINT "	AIR DEFENSE SUMMARY";S$;"NO. OF TARGETS = ";N;3780 GO TO D OF 3790,3810,3830,38403790 Q$=W$3800 GO TO 38403810 Q$=X$3820 GO TO 38403830 Q$=Y$3840 PRINT @32,18:03850 PRINT "     TEMPO: ";Q$;"SPEED        # KILLS          # HITS "3860 V$="FAST"3870 PRINT USING 3920:V$,C2(1),C1(1)3880 V$="MEDIUM"3890 PRINT USING 3920:V$,C2(2),C1(2)3900 V$="SLOW"3910 PRINT USING 3920:V$,C2(3),C1(3)3920 IMAGE  8A,10D,16D3930 PRINT "J_TOTAL KILLS = ";SUM(C2);"     TOTAL HITS = ";SUM(C1)3940 PRINT USING """J_AVERAGE RANGE FOR KILLS = ""2D.2D":K93950 PRINT "		(MAX. = 20)"3960 R$="NO. OF MISSILES "3970 PRINT R$;"LAUNCHED = ";L9+L7;R$;"SPLASHED = ";L83980 PRINT "NO. OF INFLIGHT LAUNCHES = ";L73990 R=INT(100*K9/20-12*SUM(C1)-2*L7)4000 PRINT "J_J_SKILL RATING = ";R MAX 0;"   (MAX. = 100)"4010 IF Q$="PRACTICE" THEN 41204020 REM----------store data on tape4030 PRINT "Data is being stored on tape..."4040 L=LEN(L$)4050 FIND F14060 MARK 1,30*N+300+L4070 FIND F14080 U=U+0.5-H/24090 WRITE @33:S$,D,N,A1,A5,A8,L,L$,C1,C2,K9,L9,L8,L7,R,U4100 CLOSE 4110 F1=F1+14120 PRINT "J_DO YOU WANT TO PLAY AGAIN (Y/N)? ";4130 INPUT A$4140 IF A$="Y" THEN 41804150 IF A$<>"N" THEN 41304160 PRINT "J_THANK YOU"4170 END 4180 REM----------Set display parameters for next game4190 PAGE 4200 A=24210 T$=""4220 SET NOKEY 4230 M$="   "&M$4240 N$="   "&N$4250 Z1=Z1+14260 T7=T7+5.3764270 GO TO (Z1=5)+1 OF 630,590