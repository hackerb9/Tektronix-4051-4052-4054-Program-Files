37000 REM*R Create_List_Of_File_Names(::)37005 PAGE 37010 N4=037020 IF C2=1 THEN 3706037030 PRINT "	       ** WARNING **"37040 PRINT "J_If you attempt to list or convert a SECRET file, the";37050 PRINT " program willterminate."37060 KILL "@C49074909/FILELIST"37070 CREATE "@C49074909/FILELIST","A";400,037080 OPEN "@C49074909/FILELIST";3,"F",T$37090 S1=237100 P9=137110 IF NOT(P9) THEN 3717037120 PRINT "J_Do you want all files on the 4907 disk to be processed?";37130 PRINT " (Yes or No;   default No): ";37140 P0=037150 GOSUB 800037160 GO TO 3711037170 IF P1=0 THEN 3722037180 P$="@#"37190 P0=037200 GOSUB 3800037210 GO TO 3761037220 P9=137230 IF NOT(P9) THEN 3732037240 PRINT "J_You may either specify the files to be processed, or the";37250 PRINT " name ofeach file on the disk will be printed and you";37260 PRINT " will be asked todecide whether it should be processed.";37270 PRINT " Do you want to specify thefiles? (Yes or No; default";37280 PRINT " No): ";37290 P0=037300 GOSUB 800037310 GO TO 3723037320 IF P1=1 THEN 3737037325 PRINT 37330 P$="@#"37340 P0=137350 GOSUB 3800037360 GO TO 3761037370 PRINT "J_Please enter, one per line, the name of each file to be";37380 PRINT " processed.When you are done, press RETURN without";37390 PRINT " entering a file name."37395 K9=-137400 I8=037410 D8=037420 IF D8 THEN 3761037430 I8=I8+(K9<N4)37440 PRINT USING "3d,fa,s":I8,".  "37445 K9=N437450 GOSUB 1000037460 IF NOT(P9) THEN 3750037470 PRINT "J_This is not a legal 4907 filename. Please correct it";37480 PRINT " andpress RETURN: ";37482 GOSUB 1000037484 PRINT 37490 GO TO 3746037500 IF P$="" THEN 3754037510 P0=037520 GOSUB 3800037530 GO TO 3760537540 P9=137550 IF NOT(P9) THEN 3760037560 PRINT "J_Done? (Yes or No; default Yes): ";37570 P0=137580 GOSUB 800037590 GO TO 3755037600 D8=P137602 IF D8 THEN 3760537604 PRINT 37605 GO TO 3742037610 SET NOKEY 37612 PRINT #3:" "37614 PRINT #3:" "37616 CLOSE 337618 SET KEY 37620 IF N4>0 THEN 3765037630 PRINT "No files were selected.Done."37632 CLOSE 37634 KILL "@c49074909#"37640 DELETE ALL 37650 RETURN 38000 REM*R Build_File_List(P$,P0::)38005 S8=P038010 CLOSE 238015 N9=N438020 OPEN P$,"G";2,"R",T$38030 IF T$="" THEN 3824238032 N$=SEG(T$,189,59)38034 N$=SEG(N$,1,LEN(N$)-1)38036 IF POS(N$,"C49074909/",1)=1 THEN 3823038038 IF C2<>2 THEN 3804938040 S$="@"&N$38041 CALL "file",F1,S$,T$38042 S$=SEG(T$,6,1)38043 IF POS("HAB",S$,1)+2*(POS(T$,"  0",151)<>151)<3 THEN 3804938044 GO TO 3822038049 IF NOT(S8) THEN 3811038050 P9=138060 IF NOT(P9) THEN 3811038070 PRINT "Process file @";N$;"?   (Yes or No; default No): ";38080 P0=038090 GOSUB 800038100 GO TO 3806038110 IF S8 AND (NOT(S8) OR P1=0) THEN 3822038120 IF C2=2 THEN 3816038130 P$=N$38140 GOSUB 3900038150 GO TO 3818038160 Q$=" "38170 P9=038180 IF P9 THEN 3822038190 N4=N4+138200 PRINT #3:"@";N$38210 PRINT #3:Q$38220 SET KEY 38230 CALL "next",2,T$38240 GO TO 3803038242 IF N4>N9 OR S8 OR (C2<>2 AND P9) THEN 3825038244 PRINT "J_Warning: No acceptable matches were found ";38246 PRINT "for this file name.J_"38250 CLOSE 238260 RETURN 39000 REM*R Create_4909_Dummy_File(P$::Q$,P9)39010 N$=P$39020 D$=N$39030 S$="@"&N$39040 CALL "file",F1,S$,T$39050 T$=SEG(T$,145,9)39060 IF VAL(T$)>0 THEN 3909039070 E$="TYPE: DIRECT"39080 GO TO 3910039090 E$="TYPE: NINDEX"39100 F8=139110 F9=039120 IF NOT(F8) OR F9 THEN 3978039130 P$="CLOSE LFN:1"39140 GOSUB 50039150 SET NOKEY 39160 P$="OPEN  LFN:1 NEW "&E$39170 P$=REP(D$,6,0)39180 GOSUB 50039183 GOSUB 4000039186 IF P8 THEN 3916039190 IF E1<>E0(7) THEN 3954039200 SET KEY 39210 P9=139220 IF NOT(P9) THEN 3929039230 PRINT "J_File ";D$;" exists on the 4909 and conflicts with the";39235 PRINT "destination name for";39240 PRINT " 4907 file @";N$;". Do you wishto overwrite the existing";39250 PRINT " 4909 file with the 4907 file?(Yes or No; default No): ";39260 P0=039270 GOSUB 800039280 GO TO 3922039290 R8=P139295 W8=139300 IF R8=0 THEN 3943039310 P$="DELETE "&D$39315 P$=P$&" NINQ"39320 GOSUB 50039323 GOSUB 4000039326 IF P8 THEN 3931039340 W8=E1<>E0(5)39350 IF W8 THEN 3938039360 PRINT "J_You do not have write access to 4909 file ";D$;"."39370 GO TO 3943039380 SET NOKEY 39390 P$="OPEN  LFN:1 NEW "&E$39400 P$=REP(D$,6,0)39410 GOSUB 50039413 GOSUB 4000039416 IF P8 THEN 3939039420 F8=039430 IF R8=1 AND W8 THEN 3953039440 P9=139450 IF NOT(P9) THEN 3953039460 PRINT "J_Would you like to stop processing this file and";39470 PRINT " skip to the nextfile to be processed? (Yes or";39480 PRINT " No; default No): ";39490 P0=039500 GOSUB 800039510 F9=P139520 GO TO 3945039530 GO TO 3958039540 IF E1=0 THEN 3957039550 GOSUB 100039560 STOP 39570 F8=039580 IF F9 OR NOT(F8) THEN 3977039590 PRINT "J_4907 file ";N$;" must be given a 4909  name different"39600 PRINT "from ";D$;". What name do you wish to callthis file? ";39610 GOSUB 1100039620 D$=P$39630 IF NOT(P9) AND D$<>"" THEN 3977039640 IF NOT(B2) THEN 3974039650 PRINT "J_The first character of a 4909 file name is alphabetic";39660 PRINT " and isfollowed by a series of alphanumeric characters.";39670 PRINT " Library names(followed by ""/"") and extensions";39680 PRINT " (preceded by ""."") are allowed, butthe 4907 symbols";39690 PRINT " ""@"" and ""$"" are not used. Library and file"39700 PRINT "passwords are also not allowed. Examples of 4909";39710 PRINT " file names are    NEWNAME    F4909.PROG"39720 PRINT "    LIBRARY1/LIBRARY2/FILE7.EXT"39730 B2=039740 PRINT "J_";D$;" is not a legal 4909 file name. Please correct";39750 PRINT " it and pressRETURN: ";39760 GO TO 3961039770 GO TO 3912039780 IF F8 OR F9 THEN 3989039790 S$="@"&N$39800 CALL "file",F1,S$,T$39810 P$="WATTRIBUTE LFN:1 HATTRIBUTE: ""{4050  }  """39820 S$=SEG(T$,6,1)39850 T$=SEG(E$,7,1)39860 T$=SEG("DNP",(T$="D")+2*(T$="N")+2*(S$="H"),1)39870 P$=REP(T$,40,1)39872 S$=SEG("ABB",POS("ABH",S$,1),1)39874 P$=REP(S$,39,1)39880 GOSUB 10039890 P$="CLOSE LFN:1"39900 GOSUB 50039910 P9=F939920 Q$=D$39930 RETURN 40000 REM*R Write_Protect_Check(::P8) [Local to Create_4909_Dummy_File] 40010 P8=E1=E0(6)40020 IF NOT(P8) THEN 4006040030 PRINT "J_The disk is write-protected. Please remove the write-";40040 PRINT "protect andpress RETURN: ";40050 INPUT S$40060 RETURN 41000 REM*R Get_Printer_Address(::)41005 PAGE 41010 L=041020 IF L<>0 THEN 4115041030 PRINT "J_Do you want to list the file names";41040 IF C2<>1 THEN 4108041050 PRINT " to the screen or to a printer?"41070 GO TO 4109041080 PRINT " and program statements to thescreen or to a printer? ";41090 PRINT "(Screen or Printer; default Screen): ";41100 GOSUB 1200041110 L=32*(POS("SCREEN",P$,1)=1)41120 IF L>0 THEN 4114041130 L=51*(POS("PRINTER",P$,1)=1)41140 GO TO 4102041150 P9=141160 IF L<>32 THEN 4128041170 IF NOT(P9) THEN 4123041180 PRINT "J_Do you want hardcopies automatically made? (Yes or No;";41190 PRINT " default Yes): ";41200 P0=141210 GOSUB 800041220 GO TO 4117041230 IF P1=0 THEN 4126041240 PRINT @32,26:341250 GO TO 4127041260 PRINT @32,26:041270 GO TO 4136041280 IF NOT(P9) THEN 4136041290 PRINT "J_What is the printer address? (Default is 51): ";41300 P0=141310 P1=8041320 P2=5141330 GOSUB 700041340 L=P341350 GO TO 4128041360 RETURN 42000 REM*R Calculate_Processing_Time(::)42010 GO TO C2 OF 42020,42050,4208042020 S$="transfer"42030 K7=N4*1.3+142040 GO TO 4210042050 S$="list"42060 K7=N4*2+242070 GO TO 4210042080 S$="transfer, list, and conversion"42090 K7=N4*3+242100 PRINT "Beginning the ";S$;" operations.J_"42110 K7=INT(K7+2.5*K7*(RND(0)<0.5)+0.5)42112 S$=" file"42114 IF N4=1 THEN 4212042116 S$=" files"42120 PRINT "The ";N4;S$;" selected should be processed in ";42125 PRINT "approximately ";K7;" minutes."42130 RETURN 