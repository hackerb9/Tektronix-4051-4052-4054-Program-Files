1 GO TO 1008 GOSUB 70009 END 16 Z9=117 IF Z9=1 THEN 1718 RETURN 20 Z9=021 RETURN 32 GO TO 800036 END 40 GO TO 1000100 REM 4051 FLOWCHARTER. (C:03/042 A:04/042) File 2/042110 REM Author: Han Klinkspoor, SA, Datatek, April 1976120 REM  Rewrite: Leland C. (Chuck) Sheppard, July 1977130 INIT 140 REM S=# of Branch References150 S=400160 REM N=length of max stmt #170 N=4180 DIM A$(171+1),C$(100+1),D$(S*N+1),E$(S*N+1),F$(40+1),Z$(52+1)190 DIM F(20),I$(2+1),M$(2+1),L$(72+1),B$(3+1)200 DIM H$(N+2),G$(N+2),J$(S*2+1),K$(S*2+1),N$(N+2),Y$(2+1),V$(2+1)210 D$=""220 E$=""230 J$=""240 FOR I=1 TO S*2/10250 J$=J$&"          "260 NEXT I270 K$=J$280 GOSUB 8000290 PRINT USING "20(100(""""))ps":300 ON EOF (0) THEN 1000310 REM A$=Basic Command Names320 G=0330 A$="PRIINPWRIREAWBYRBYFINAPPSAVOLDSECTLIMARKILPAGHOMMOVDRARMORDR"340 A$=A$&"AXIGINVIEWINSCAROTPOIINISETDIMFUZDEFON POLOFFDATRESRUNENDRET"350 A$=A$&"STOWAICLOCOPFORNEXIF GO GOSCALLISDELRENREMIMALETMAT"360 PRINT "Specify File # to be flowcharted:"370 INPUT F3380 PAGE 390 REM [Pass 1: build branch table]400 FIND F3410 INPUT @33:L$420 IF LEN(L$)=0 THEN 410430 A=POS(L$," ",1)+1440 H$="    "450 G$=SEG(L$,1,A-2)460 H$=REP(G$,1+N-LEN(G$),LEN(G$))470 C$=SEG(L$,A,3)480 V=1490 C=POS(A$,C$,V)500 IF C=0 THEN 550510 IF (C+2)/3=INT((C+2)/3) THEN 540520 V=C+1530 GO TO 490540 C=(C+2)/3550 IF C<47 OR C>49 AND C<>33 THEN 410560 P=POS(L$," OF",A)+POS(L$,"TH",A)570 P=(A+5)*(P=0)+(P+4)*(P<>0)580 C$=SEG(L$,P,70)590 G=G+1600 IF G<=S THEN 640610 PRINT "# of branches >";S;", Program Mod Needed (Lines Below).
"620 LIST 140,200630 END 640 IF C<>49 THEN 660650 J$=REP("-",G*2-1,1)660 D$=D$&H$670 P0=VAL(C$)680 G$="    "690 N$=STR(P0)700 N$=SEG(N$,2,LEN(N$)-1)710 G$=REP(N$,1+N-LEN(N$),LEN(N$))720 E$=E$&G$730 IF C<>33 THEN 750740 K$=REP("-",G*2-1,1)750 A=POS(C$,",",1)760 IF A=0 THEN 410770 C$=REP("",1,A)780 GO TO 5901000 REM [EOF reached]1010 SET KEY 1020 F=-11030 F$=""1040 FOR I=1 TO 41050 F$=F$&"          "1060 NEXT I1070 T=11080 PRINT "Flowchart between Line Numbers: "1090 INPUT L1,L21100 REM [Pass 2: Chart]1110 ON EOF (0) THEN 90001120 C$="B E G I N"1130 O2=01140 H=531150 C=H1160 X=651170 Y=1001180 W=X1190 M=01200 L=01210 FIND F31220 PAGE 1230 MOVE X,Y1240 GO TO 15801250 INPUT @33:L$1260 IF LEN(L$)=0 THEN 12501270 GOSUB 60001280 L=VAL(L$)1290 IF L<L1 THEN 12501300 IF L>L2 THEN 90001310 H$="    "1320 G$=STR(L)1330 G$=SEG(G$,2,LEN(G$)-1)1340 H$=REP(G$,1+N-LEN(G$),LEN(G$))1350 REM Stmt # right aligned1360 IF O2<>0 THEN 13801370 O2=L1380 IF L>80 OR L/4<>INT(L/4) THEN 14401390 GOSUB 30001400 RMOVE 0,-21410 PRINT "**** Key #";L/4;" ****";1420 MOVE X,U-4-4*(C<>48)1430 GIN X,Y1440 GOSUB 20001450 P=POS(L$," ",1)+11460 C$=SEG(L$,P,3)1463 V=11470 C=POS(A$,C$,V)1473 IF C=0 THEN 14781475 IF (C+2)/3=INT((C+2)/3) THEN 14781476 V=C+11477 GO TO 14701478 C=(C+2)/31480 IF C<>1 OR POS(L$,"@",P)=0 THEN 15101490 C$=SEG(L$,POS(L$,"@",P)+1,3)1495 C$=REP("0",1,0)1500 C=1+(VAL(C$)=32)*20.51505 C$=REP("",1,1)1510 IF C=H AND (H<45 OR H>50) AND H<>39 AND H<>40 THEN 15301520 GOSUB 30001530 C$=SEG(L$,P,LEN(L$)-P+1)1540 C$=REP("",1,ASC(C$)=32)1550 I$=SEG(C$,LEN(C$),1)1560 C$=REP("",LEN(C$),I$=" ")1570 H=C1580 IF C<>47 THEN 16201590 P=POS(C$,"TH",3)1600 C$=SEG(C$,4,P-5)1610 GOSUB 60001620 RMOVE 0,-2.8-2.5*(C=47)1630 GIN X,U1640 M=01650 IF C<>48 OR POS(C$,"OF",1)<>0 THEN 17301660 MOVE X,U+6.21670 W=641680 U=U+1.31690 M=11700 GOSUB 40001710 GIN A,Y1720 GO TO 19101730 L0=LEN(C$)*0.8961740 REM Look for Ctrl Characters if Print or $tring1750 IF C=54 THEN 17901760 IF C=1 OR POS(C$,"$=",1)<>0 OR POS(C$,"POS(",1)<>0 THEN 17801770 IF C<>55 THEN 17901780 GOSUB 50001790 MOVE X-L0,U1800 PRINT C$;1810 IF C=46 THEN 18601820 IF C<>45 THEN 18701830 P=POS(C$,"=",5)1840 V$=SEG(C$,P-2,2)1850 GO TO 18701860 V$=SEG(C$,LEN(C$)-1,2)1870 W=W MAX 70 MAX L0+65.61880 IF C<47 OR C>49 AND C<>33 THEN 19201890 GOSUB 40001900 IF U=>98 THEN 19201910 U=U-3*(C=47 OR C=48)1920 MOVE X,U1930 P2=L1940 GO TO 12502000 REM [Incoming Branch Check]2010 IF G=0 THEN 23002020 O=12030 I=POS(E$,H$,O)2040 IF I=0 THEN 22902050 IF (I+N-1)/N=INT((I+N-1)/N) THEN 20802060 O=I+12070 GO TO 20302080 I=(I+N-1)/N2090 Y$=CHR(T)2100 K$=REP(Y$,I*2,1)2110 GOSUB 30002120 GOSUB 60002130 MOVE X-60,Y2140 PRINT USING "6d,"">"",s":I2150 I$=SEG(J$,I*2-1,1)2155 M$=SEG(K$,I*2-1,1)2160 IF I$<>"-" THEN 22002170 PRINT "SUBR CALL";2180 GO TO 22202200 IF M$<>"-" THEN 22202210 PRINT "INTERRUPT";2220 RMOVE 12+16*(I$="-" OR M$="-"),1.32230 DRAW X,Y+1.32240 RDRAW 0,-42250 GIN X,Y2260 U=Y2270 I=I*N2280 GO TO 20602290 GOSUB 60002300 RETURN 3000 REM [Draw Boxes]3010 IF M THEN 35303020 U=U-0.53030 MOVE X,U3040 A=(Y-U)/2+U3050 B=2*X-W3060 IF H<27 OR H=47 OR H=49 OR H=50 OR H>54 THEN 32503070 REM Misc Box3080 PRINT @32,20:W,U,W+1,A,W,Y,B,Y,B-1,A,B,U,X,U3090 IF H<>45 AND H<>46 THEN 34803100 MOVE W+1,A3110 IF H=46 THEN 31903120 REM "For" Statement3130 J=POS(F$,"  ",1)3140 IF J=0 THEN 34703150 F$=REP(V$,J,2)3160 PRINT @32,20:130-J,A3170 F((J+1)/2)=A3180 GO TO 34703190 REM "Next" Statement3200 B=POS(F$,V$,1)3210 PRINT @32,20:130-B,A,130-B,F(B/2)3220 F$=REP("  ",B,2)3230 F((B+1)/2)=-13240 GO TO 34703250 IF H>6 OR H<1 THEN 32903260 REM Box for I/O Operations3270 PRINT @32,20:W,U,W+2,Y,B,Y,B-2,U,X,U3280 GO TO 34803290 IF H=>1 AND H<15 OR (H>27 AND H<49) OR H>50 THEN 33903300 REM Calculation Box3310 PRINT @32,20:W+1,U,W+1,Y,B-1,Y,B-1,U,X,U3320 IF H<15 OR H>28 AND H<>49 AND H<>50 THEN 34803330 REM Graphic/Subroutine Call Box3340 W=W+(H=49 OR H=50)3350 B=B-(H=49 OR H=50)3360 PRINT @32,20:X,U-0.5,W+0.5,U-0.5,W+0.5,Y+0.5,B-0.5,Y+0.53370 PRINT @32,20:B-0.5,U-0.5,X,U-0.5,X,U3380 GO TO 34803390 IF H<>47 THEN 34703400 REM Decision Box Drawing3410 IF U>15 OR Y-U>8.5 THEN 34403420 U=U-33430 MOVE X,U3440 PRINT @32,20:W-4,U,W+4,Z,W-4,Y,X,Y,B+4,Y,B-4,Z,B+4,U,X,U3450 MOVE W+4,Z+23460 PRINT "YES";3470 MOVE X,U3480 REM Box Done3490 GIN X,Y3500 Y=Y-43510 DRAW @32,20+(H>37 AND H<43):X,Y3520 W=653530 M=13540 RETURN 4000 REM [Outgoing Branch Check]4010 IF G=0 THEN 43004020 IF H=33 THEN 41004030 Z=U+1.54040 MOVE W+(H<>48 AND H<>49)*3+1,Z4050 IF W<100 THEN 40804060 RDRAW 1,04070 GO TO 40904080 DRAW 110,Z4090 RMOVE -0.8,-1.284100 O=14110 I=POS(D$,H$,O)4120 IF I=0 THEN 43004130 IF (I+N-1)/N=INT((I+N-1)/N) THEN 41604140 O=I+14150 GO TO 41104160 I=(I+N-1)/N4170 Y$=CHR(T)4180 J$=REP(Y$,I*2,1)4190 IF H<>33 THEN 42104200 PRINT "      INT SERVICE--";4210 GIN P,U4220 PRINT ">";I;4230 IF U>10+5*(H=47) THEN 42704240 P2=L4250 GOSUB 60004260 MOVE P,1004270 RMOVE 0,-2.64280 I=I*N4290 GO TO 41404300 RETURN 5000 REM [Convert Control Characters]5010 FOR I=1 TO 85020 Q=15030 B$=SEG("	
",I,1)5040 D=POS(C$,B$,Q)5050 IF D=0 THEN 51205060 A=ASC(B$)5070 B$=CHR(A+64)5080 B$=B$&"_"5090 C$=REP(B$,D,1)5100 Q=D+35110 GO TO 50305120 NEXT I5210 RETURN 6000 REM [Page Full]6010 IF U>10+5*(H=47) THEN 62006020 GOSUB 30006030 FOR J=1 TO 206040 IF F(J)<0 THEN 60806050 PRINT @32,21:131-2*J,F(J)6060 PRINT @32,20:131-2*J,06070 F(J)=1006080 NEXT J6090 MOVE 0,06100 PRINT T;" (";O2;"-";P2;")";6110 T=T+16120 COPY 6130 PRINT USING "20(100(""""))ps":6140 O2=L*(P2<>L)6150 U=986160 W=X6170 MOVE X,U+26180 DRAW X,U+0.56190 GIN X,Y6200 RETURN 7000 REM [Print Branch Table]7010 C$="3d,x,4a,2x,2d,x,4a,2x,2d,2x,9a,4x,s"7020 PAGE 7030 IF G=0 THEN 73207040 FOR I=1 TO G/66+17050 A=(I-1)*667060 PAGE 7070 PRINT USING "2(""BR# FROM PAGE  TO PAGE"",14x),72(""="")":7080 FOR K=A+1 TO A+33 MIN A+(G-A+1)/27090 B=33 MIN INT(0.5*(G-A))+(INT(G/2)<>G/2)7100 FOR J=K TO K+B STEP B7110 IF J>G THEN 72707120 L$=""7130 I$=SEG(J$,J*2-1,1)7140 IF I$<>"-" THEN 71707150 L$="SUBR.CALL"7160 GO TO 72007170 M$=SEG(K$,J*2-1,1)7180 IF M$<>"-" THEN 72007190 L$="INTERRUPT"7200 G$=SEG(D$,J*N-N+1,N)7210 H$=SEG(E$,J*N-N+1,N)7220 I$=SEG(J$,J*2,1)7230 P1=ASC(I$)7240 M$=SEG(K$,J*2,1)7250 P3=ASC(M$)7260 PRINT USING C$:J,G$,P1,H$,P3,L$7270 NEXT J7280 NEXT K7290 IF I+1>G/66+1 AND G-A<66 THEN 73107300 COPY 7310 NEXT I7320 PRINT 7330 PRINT USING "20(100(""""))s":7340 PRINT "# Branches: ";G7350 COPY 7360 RETURN 8000 REM [Display Symbols]8010 DATA 0,"CALCULATION.",3,"INPUT/OUTPUT OPERATION.",20,"GRAPHICS."8020 DATA 30,"MISC.",47,"CONDITIONAL BRANCH.",49,"SUBROUTINE CALL.",-18030 RESTORE 80108040 PRINT USING """
	F L O W C H A R T   S Y M B O L S""":8050 Y=858060 X=258070 W=358080 M=08090 READ H8100 U=Y-88110 Z=U+4*(H=47)8120 IF H=-1 THEN 82108130 READ L$8140 GOSUB 30008150 IF H<>47 THEN 81808160 MOVE 39,Z8170 RDRAW 6,08180 MOVE 60,Y+88190 PRINT L$;8200 GO TO 80608210 HOME 8220 RETURN 9000 REM [End of Program]9010 GOSUB 30009020 MOVE 0,09030 PRINT T;" (";O2;"-";P2;")";9040 PRINT USING "20(100(""""))s":9050 COPY 9060 PRINT USING "10(100(""""))s":9070 IF L2<9999 THEN 90909080 GOSUB 70009090 END 