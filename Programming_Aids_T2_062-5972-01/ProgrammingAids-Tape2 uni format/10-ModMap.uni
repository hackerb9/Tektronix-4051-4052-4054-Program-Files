1550 Y0=1001560 I0=41570 GO TO 9901580 I0=31590 GO TO 5501600 REM *** for Program tapes with Directory program on file 1 ***1610 IF U0<>33 THEN 16501620 FIND 01630 PRINT "
please insert PROGRAM ta1 REM ******************************************************************2 REM *** Program Module Map *************** 51/00-8027/0 **************3 REM ******************************************************************5 REM ******************************************************************6 REM *** S. K. Sanford / January 1978 *********************************7 REM ******************************************************************100 INIT 110 REM *** U0 = Input Data Device ***120 U0=33130 REM *** F0 = Input Data File Number ***140 F0=1150 PRINT "	*** MODULE MAP ***


"160 PRINT ">ENTER MAIN PROGRAM NAME: ";170 INPUT A$180 DIM C$(12),D$(6),E$(6),F$(6),G$(1200),H$(300),R$(1)190 PRINT ">IS THERE A BLOCK DATA SUBPROGRAM? (Y/N): ";200 INPUT R$210 B0=2220 IF R$="N" THEN 250230 IF R$<>"Y" THEN 190240 B0=1250 PRINT @32,26:0260 PRINT ">AUTOCOPY? (Y/N): ";270 INPUT R$280 IF R$="N" THEN 310290 IF R$<>"Y" THEN 260300 PRINT @32,26:3310 G$=""320 H$=""330 B$="      "340 J$=""350 K$=""360 L$=""370 P0=97380 P1=97390 P2=97400 I0=3410 D0=1420 D1=0430 Z9=0440 I$=A$&B$450 G$=SEG(I$,1,6)460 GO TO B0 OF 470,490470 H$="BLK DA"480 G$=G$&H$490 IF U0<>33 THEN 530500 FIND 0510 PRINT "
please insert DATA tape - press RETURN when ready: ";520 INPUT R$530 ON EOF (0) THEN 1680540 ON SRQ THEN 1680550 FIND @U0:F0560 IF D0>LEN(G$) THEN 1600570 D$=SEG(G$,D0,6)580 D0=D0+6590 D1=D1+1600 GO TO 630610 PRINT "	         *** MODULE MAP ***	    CHART #";D1;620 RETURN 630 INPUT @U0:C$640 IF Z9=0 THEN 660650 IF Z9=12 THEN 830660 E$=SEG(C$,1,6)670 IF E$<>D$ THEN 630680 F$=SEG(C$,7,LEN(C$)-6)690 I$=F$&B$700 I$=SEG(I$,1,6)710 G0=0720 G0=POS(G$,I$,G0+1)730 IF G0=0 THEN 760740 IF INT((G0-1)/6)<>(G0-1)/6 THEN 720750 GO TO 770760 G$=G$&I$770 H$=H$&I$780 INPUT @U0:C$790 IF Z9=0 THEN 810800 IF Z9=12 THEN 830810 E$=SEG(C$,1,6)820 IF E$=D$ THEN 680830 GOSUB 610840 Z9=0850 MOVE 58,80860 PRINT D$;870 GOSUB 890880 GO TO 970890 RMOVE 0,0900 RMOVE -6,0910 RDRAW 0,6920 RDRAW 24,0930 RDRAW 0,-9940 RDRAW -24,0950 RDRAW 0,3960 RETURN 970 RMOVE 12,-3980 GIN X0,Y0990 FOR K=1 TO 11000 FOR I=1 TO I01010 J0=INT(LEN(H$)/6)1020 IF J0<4 THEN 10401030 J0=41040 FOR J=1 TO 41050 IF H$="" THEN 13701060 E$=SEG(H$,1,6)1070 H$=REP("",1,6)1080 MOVE 140/(J0+1)*J-12,(I0+1-I)*201090 PRINT E$;1100 GOSUB 8901110 GOSUB 11301120 GO TO 13501130 G0=01140 G0=POS(G$,E$,G0+1)1150 IF G0=0 THEN 12901160 IF INT(G0-1)/6<>(G0-1)/6 THEN 11401170 G1=INT((G0-1)/6)+11180 GIN X1,Y11190 RMOVE 12,-31200 RDRAW 0,-31210 RDRAW 3,01220 RDRAW -1,11230 RMOVE 0,-21240 RDRAW 1,11250 RMOVE 2,-11260 PRINT G1;1270 RMOVE 0,01280 MOVE X1,Y11290 RMOVE 12,61300 RDRAW 0,61310 GIN X1,Y11320 RDRAW X0-X1,01330 DRAW X0,Y01340 RETURN 1350 NEXT J1360 NEXT I1370 IF LEN(H$)=0 THEN 14001380 MOVE X0,Y01390 DRAW X0,101400 MOVE 65,01410 IF P1<123 THEN 14501420 L$=CHR(P2)1430 P2=P2+11440 P1=971450 IF P0<123 THEN 14901460 K$=CHR(P1)1470 P1=P1+11480 P0=971490 J$=CHR(P0)1500 P0=P0+11510 J$=K$&J$1520 J$=L$&J$1530 PRINT "(";J$;")"1540 IF LEN(H$)=0 THEN 15801550 Y0=1001560 I0=41570 GO TO 9901580 I0=31590 GO TO 5501600 REM *** for Program tapes with Directory program on file 1 ***1610 IF U0<>33 THEN 16501620 FIND 01630 PRINT "
please insert PROGRAM tape - press return when ready: ";1640 INPUT R$1650 FIND 11660 OLD 1670 END 1680 IF U0=33 THEN 17101690 INPUT @U0,30:Z91700 IF Z9<>12 THEN 17301710 Z9=121720 RETURN 1730 PRINT "
tape unit error - code ";Z91740 STOP 