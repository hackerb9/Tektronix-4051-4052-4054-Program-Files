6570 T3(17)=FNZ(T3(15))6580 IF T3(16)=0 THEN 66006590 T3(17)=T3(17) MAX FNZ(T3(16))6600 IF ABS(T3(17))+(T3(17)<0)<2 THEN 66206610 T3(10)=10^T3(17)6620 RETURN 6630 T5=T3(20)6640 T3(290 REM 51/00-9503/0 LINEAR AXIS LABELING ROUTINE100 DEF FNF(Q)=LOG(ABS(Q+1.0E-3))*SIN(Q)/10110 DEF FNG(Q)=LOG(ABS(Q+1.0E-3))*COS(Q)/10120 T1=10130 T2=12140 W1=-0.25150 W2=0.25160 W3=-0.5170 W4=0.3180 V1=0190 V2=80200 V3=0210 V4=80220 PAGE 230 GOSUB 5000240 MOVE FNF(4*PI),FNG(4*PI)250 FOR I=0 TO 8*PI STEP 0.1260 DRAW FNF(4*PI-I),FNG(4*PI-I)270 NEXT I280 HOME 290 END 5000 REM PARAMETERS: V1-LOW X VIEWPORT  V2-HIGH X VIEWPORT5010 REM             V2-LOW Y VIEWPORT  V4-HIGH Y VIEWPORT5020 REM             W1-LOW X WINDOW    W2-HIGH X WINDOW5030 REM             W3-LOW Y WINDOW    W4-HIGH Y WINDOW5040 REM             T1-NUMBER OF TICS ON X AXIS (MINIMUM)5050 REM             T2-NUMBER OF TICS ON Y AXIS (MINIMUM)5060 REM THIS ROUTINE WILL ADJUST V1,V2,V3,V4,1,W2,W3,W4 AND PASS THEM5070 REM BACK. IT ALSO EXECUTES THE VIEWPORT AND WINDOW COMMANDS5080 REM IMMEDIATELY BEFORE RETURNING.5090 REM INTERNAL VARIABLES USED: T3,T4,T5,X$,Y$,FNZ,FNY5100 REM TO DELETE GRID OF POINTS INSIDE GRAPH, DELETE 6150,63105110 REM THIS ROUTINE PLAYS WITH FUZZ! SO SET IT BACK WHEN IT RETURNS5120 FUZZ 10,1.0E-95130 DEF FNY(Q)=INT(Q*(1+SGN(Q)*1.0E-10))5140 DIM T3(31)5150 DEF FNZ(Q)=FNY(LGT(ABS(Q)+(Q=0)))5160 IF V2<126 THEN 51805170 V2=1265180 T3(12)=W2-W15190 T3(13)=T15200 T3(15)=W15210 T3(16)=W25220 GOSUB 63405230 W2=T3(16)5240 T3(5)=T3(10)5250 W1=T3(15)5260 T3(1)=T3(14)5270 REM CALL FOR Y5280 T3(12)=W4-W35290 T3(13)=T25300 T3(15)=W35310 T3(16)=W45320 GOSUB 63405330 T3(7)=T3(10)5340 W4=T3(16)5350 W3=T3(15)5360 T3(2)=T3(14)5370 DELETE X$,X,Y$,Y5380 DIM X$(16),Y$(4)5390 VIEWPORT 0,130,0,1005400 WINDOW 0,130,0,1005410 MOVE V1+8.9,V3+8.375420 PRINT @32,20:V2,V3+8.37,V1+8.9,V3+8.37,V1+8.9,V4-35430 IF T3(7)=1 THEN 54605440 MOVE V1+7,V4-2.85450 PRINT "E";FNZ(T3(7));5460 IF T3(5)=1 THEN 54905470 MOVE V1+7,V35480 PRINT "E";FNZ(T3(5));5490 VIEWPORT V1+8.92,V2,0,1005500 WINDOW W1,W2,0,1005510 FOR T5=W1 TO W2 STEP T3(1)5520 MOVE T5,V3+8.375530 DRAW T5,V3+95540 NEXT T55550 VIEWPORT 0,130,V3+8.37,V4-35560 WINDOW 0,130,W3,W45570 FOR T5=W3 TO W4 STEP T3(2)5580 MOVE V1+8.92,T55590 DRAW V1+9.3,T55600 NEXT T55610 REM TICS X AND Y5620 REM NOW THE LABELS5630 VIEWPORT V1+8.92,V2,0,1005640 WINDOW W1,W2,0,1005650 T3(20)=(W2/T3(5)-W1/T3(5))*11/(V2-V1-8.92)5660 T3(20)=T3(20)/(T3(1)/T3(5))5670 IF T3(20)=INT(T3(20)) THEN 57105680 T3(20)=INT(T3(20)+1)5690 T3(23)=T3(1)5700 GOSUB 66305710 T3(26)=FNY(W1/T3(20))*T3(20)5720 T3(27)=FNY(W2/T3(20))*T3(20)5730 T3(28)=T3(20)5740 IF T3(26)=>W1 THEN 57605750 T3(26)=T3(26)+T3(20)5760 IF T3(27)<=W2 THEN 57705770 FOR T5=T3(26) TO T3(27) STEP T3(28)5780 MOVE T5,V3+8.375790 DRAW T5,V3+7.55800 T3(21)=T5/T3(5)5810 X$=STR(T3(21)*(T3(21)<>0)*(1+10^(FNZ(T3(21))-6)))5820 Y$=SEG(X$,2,4)5830 MOVE T5-0.89*(W2-W1)/(V2-V1-8.95)*LEN(Y$),V3+45840 PRINT Y$;5850 NEXT T55860 VIEWPORT 0,130,V3+8.37,V4-35870 WINDOW 0,130,W3,W45880 T3(20)=(W4/T3(7)-W3/T3(7))*11/(V4-V3-11.37)5890 T3(20)=T3(20)/(T3(2)/T3(7))5900 IF T3(20)=INT(T3(20)) THEN 59305910 T3(20)=INT(T3(20)+1)5920 T3(23)=T3(2)5930 GOSUB 66305940 T3(29)=FNY(W3/T3(20))*T3(20)5950 T3(30)=FNY(W4/T3(20))*T3(20)5960 T3(31)=T3(20)5970 IF T3(29)=>W3 THEN 59905980 T3(29)=T3(29)+T3(20)5990 IF T3(30)<=W4 THEN 60106000 T3(30)=T3(30)-T3(20)6010 FOR T5=T3(29) TO T3(30) STEP T3(31)6020 T5=T5*(ABS(T5)>T3(2)/3)6030 MOVE V1+8.92,T56040 DRAW V1+7.75,T56050 MOVE V1+1,T56060 X$=STR(T5/T3(7))6070 Y$=SEG(X$,2,4)6080 PRINT Y$;6090 NEXT T56100 V1=V1+8.926110 V3=V3+8.376120 V4=V4-36130 VIEWPORT V1,V2,V3,V46140 WINDOW W1,W2,W3,W46150 FOR T5=T3(29) TO T3(30) STEP T3(31)6160 FOR T4=T3(26) TO T3(27) STEP T3(28)6170 MOVE T4,T56180 DRAW T4,T56190 NEXT T46200 NEXT T56210 IF SGN(W3)*SGN(W4)<>-1 THEN 62706220 IF SGN(W3)*SGN(W4)<>-1 THEN 62706230 FOR T5=W1 TO W2 STEP T3(1)6240 MOVE T5,06250 DRAW T5,06260 NEXT T56270 IF SGN(W1)*SGN(W2)<>-1 THEN 63206280 FOR T5=W3 TO W4 STEP T3(2)6290 MOVE 0,T56300 DRAW 0,T56310 NEXT T56320 DELETE T3,T4,T5,X$,Y$6330 RETURN 6340 REM SUBROUTINE TO MODIFY PASSED PARAMETERS SO AS TO MAKE6350 REM THEM CLEAN; AND COMP556UTE FACTOR FOR LABELING6360 T3(14)=T3(12)/T3(13)6370 T3(24)=FNZ(T3(14))6380 T3(25)=T3(14)/10^T3(24)6390 IF T3(25)=>2 THEN 64206400 T3(25)=16410 GO TO 64906420 IF T3(25)=>2.5 THEN 64506430 T3(25)=26440 GO TO 64906450 IF T3(25)=>5 THEN 64806460 T3(25)=2.56470 GO TO 64906480 T3(25)=56490 T3(14)=T3(25)*10^T3(24)6500 T3(15)=T3(14)*FNY(T3(15)/T3(14))6510 T3(17)=T3(14)*INT(T3(16)/T3(14))6520 IF T3(16)=T3(17) THEN 65406530 T3(16)=T3(14)*(INT(T3(16)/T3(14))+1)6540 T3(10)=16550 T3(17)=06560 IF T3(15)=0 THEN 65806570 T3(17)=FNZ(T3(15))6580 IF T3(16)=0 THEN 66006590 T3(17)=T3(17) MAX FNZ(T3(16))6600 IF ABS(T3(17))+(T3(17)<0)<2 THEN 66206610 T3(10)=10^T3(17)6620 RETURN 6630 T5=T3(20)6640 T3(21)=T5*T3(23)6650 T3(22)=T3(21)/10^FNZ(T3(21)+1.0E-10*SGN(T3(21)))6660 IF T5<>T3(20) THEN 66706670 IF T3(22)=1 THEN 67306680 IF T3(22)=2 THEN 67306690 IF T3(22)=2.5 THEN 67306700 IF T3(22)=5 THEN 67306710 T5=T5+16720 GO TO 66406730 T3(20)=T3(21)6740 RETURN 