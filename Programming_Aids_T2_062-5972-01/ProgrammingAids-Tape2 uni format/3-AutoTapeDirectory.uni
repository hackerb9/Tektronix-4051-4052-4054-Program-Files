100 REM *---*{AUTOMATIC TAPE DIRECTORY/17JAN78}*---*110 REM *   51/00-8022/0120 REM *   AUTHOR: E. A. BLEIWEISS / UNM-CERF130 REM *140 REM *   PROCEDURE FOR FIRST USE:150 REM *   (1)FIND 0; (2)MARK 2,5000; (3)FIND 1;160 REM *   (4)SAVE; (5)F1=1; (6)RUN 280180 REM *190 REM *   NOTE: Make sure the first statement in each200 REM *   program contains the title {IN BRACES}, what-210 REM *   ever is between the braces (to a maximum of220 REM *   48 characters) will be printed out as the230 REM *   contents, all else will be ignored.240 REM *250 INIT 260 F1=0270 DIM A$(56),E$(30),H$(42),Q$(1),T$(16500)280 E$="INVALID ENTRY, TRY AGAIN "290 IF F1 THEN 900300 FIND 2310 READ @33:D$,F320 DIM T(F,3)330 READ @33:T,T$340 REM *   PUT THE TAPE TITLE IN THE NEXT LINE350 PRINT "***TEKTRONIX PROGRAM SUBMITTAL***"360 REM *   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^370 PRINT USING "L,4(FA,4X)":"FILE";"SIZE";"TYPE";"CONTENTS"380 PRINT USING "3(4""-"",4X),8""-""":390 IMAGE X,FD,9T,FD,17T,FA400 PRINT USING 390:1;5120;"ASCII   AUTOMATIC TAPE DIRECTORY/17JAN78"410 PRINT USING 390:2;5120;"BINARY  DIRECTORY DATA"420 P=1430 FOR I=1 TO 1440 FOR F=1 TO 350450 GO TO INT(T(F,2)/10) OF 460,480,500,520460 A$="ASCII   "470 GO TO 540480 A$="BINARY  "490 GO TO 540500 A$="NEW"510 GO TO 560520 A$="LAST"530 GO TO 560540 B$=SEG(T$,P,T(F,3))550 A$=A$&B$560 PRINT USING 390:F+2;T(F,1);A$570 IF T(F,2)=40 THEN 600580 P=P+T(F,3)590 NEXT F600 NEXT I610 PRINT USING "L,2(FA),L":"CURRENT AS OF: ";D$620 IF F1 THEN 680630 PRINT "DO YOU WANT AN UPDATE: ";640 INPUT Q$650 GO TO POS("NY",Q$,1) OF 680,900660 PRINT E$;670 GO TO 640680 PRINT "DO YOU WANT TO RUN A PROGRAM: ";690 INPUT Q$700 GO TO POS("NY",Q$,1) OF 730,750710 PRINT E$;720 GO TO 690730 PRINT "PROGRAM TERMINATED."740 END 750 PRINT "WHICH FILE: ";760 INPUT F770 F=INT(F)780 IF F THEN 810790 PRINT E$;800 GO TO 760810 GO TO F OF 100,840820 F=F-2830 IF INT(T(F,2)/10)=1 OR T(F,2)=21 THEN 860840 PRINT "INVALID ENTRY, THIS IS NOT A PROGRAM FILE, TRY AGAIN: ";850 GO TO 760860 FIND F+2870 GO TO INT(T(F,2)/10) OF 880,890880 OLD 890 CALL "BOLD"900 PRINT "MAKE SURE THE TAPE SAFTEY IS OFF,"910 PRINT "THEN ENTER THE PRESENT DATE: ";920 INPUT D$930 DELETE T940 DIM T(350,3)950 T=0960 T$=""970 FOR I=1 TO 1980 FOR F=1 TO 350990 PRINT @33,0:0,0,11000 FIND F+21010 INPUT @33:H$1020 PRINT @33,0:0,0,01030 A$=SEG(H$,35,5)1040 T(F,1)=VAL(A$)*2561050 A$=SEG(H$,9,1)1060 IF A$<>"A" THEN 10901070 T(F,2)=101080 GO TO 11801090 IF A$<>"B" THEN 11201100 T(F,2)=201110 GO TO 11801120 IF A$<>"N" THEN 11501130 T(F,2)=301140 GO TO 15201150 T(F,2)=401160 DIM T(F,3)1170 GO TO 15401180 A$=SEG(H$,17,7)1190 IF A$="PROGRAM" OR T(F,2)=10 THEN 12201200 T(F,2)=T(F,2)+21210 GO TO 15001220 T(F,2)=T(F,2)+11230 B$=SEG(H$,27,7)1240 IF B$<>"SECRET" THEN 12701250 A$=B$&A$1260 GO TO 15001270 FIND F+21280 GO TO INT(T(F,2)/10) OF 1290,13101290 INPUT @33:B$1300 GO TO 13201310 READ @33:B$1320 P0=11330 P1=POS(B$,"{",P0)1340 IF P1=0 OR P1=72 THEN 15001350 C$=SEG(B$,P1,1)1360 IF ASC(C$)=123 THEN 13901370 P0=P0+11380 GO TO 13301390 P0=P1+11400 P2=POS(B$,"}",P0)1410 IF NOT(P2) THEN 14801420 C$=SEG(B$,P2,1)1430 IF ASC(C$)=125 THEN 14601440 P0=P2+11450 GO TO 14001460 P3=P2-P1-11470 IF P3>0 AND P3<=48 THEN 14901480 P3=481490 A$=SEG(B$,P1+1,P3)1500 T$=T$&A$1510 T(F,3)=LEN(A$)1520 NEXT F1530 F=3501540 NEXT I1550 FIND 21560 WRITE @33:D$,F,T,T$1570 F1=11580 GO TO 3501590 END 1600 REM *---*END AUTOMATIC TAPE FILE DIRECTORY*---*