2100 REM ----- PREPARE FOR NEXT CHARACTER2110 J=J02120 J0=J12130 A$=B$2140 B$=C$2150 NEXT J12160 GO TO 154000 B$=SEG(L$,J0,1)1910 J1=J01920 REM -----SAVE VARIABLE NAME?1930 IF POS(N$,V$,1) THE900 REM 51/00-8003/0 SORT & LIST PROGRAM VARIABLES1000 INIT 1010 DIM A$(1),B$(1),C$(1),K$(3),L$(74),N$(572),T$(1),V$(2),W$(2)1020 REM ----- GET FILE NUMBER -----1030 PRINT "SORT AND LIST PROGRAM VARIABLES"1040 PRINT "
NOTE: YOUR PROGRAM MAY BE ON SEVERAL TAPE FILES."1050 PRINT "
Begin with File Number = ";1060 INPUT F11070 IF INT(F1)<>F1 OR F1<=0 THEN 10501080 PRINT "  
End with File Number = ";1090 INPUT F21100 IF INT(F2)<>F2 OR F2<=0 THEN 10801110 REM ----- INITIALIZE -----1120 N=11130 N$=""1140 SET NOCASE 1150 PRINT "
"1160 FOR F=F1 TO F21170 PRINT "
FILE # ";F1180 FIND F1190 ON EOF (0) THEN 12101200 GO TO 15401210 NEXT F1220 N=N-11230 N$=REP("",1,2)1240 REM ----- PRINT NUMERIC VARIABLE NAMES -----1250 IF N=0 THEN 15201260 PRINT "VARIABLES:
"1270 N$=REP("  ",LEN(N$)+1,0)1280 L$=" $0123456789"1290 V$=SEG(N$,1,2)1300 B$=SEG(V$,1,1)1310 C$=SEG(V$,2,1)1320 J1=11330 FOR J=65 TO 901340 A$=CHR(J)1350 IF A$<>B$ THEN 14801360 FOR J0=1 TO 121370 T$=SEG(L$,J0,1)1380 IF T$<>C$ THEN 14601390 PRINT V$;"    ";1400 J1=J1+21410 V$=SEG(N$,J1,2)1420 B$=SEG(V$,1,1)1430 C$=SEG(V$,2,1)1440 IF B$<>A$ THEN 14801450 GO TO 14701460 PRINT "      ";1470 NEXT J01480 PRINT 1490 NEXT J1500 PRINT 1510 PRINT 1520 END 1530 REM ----- SUBROUTINE TO FETCH VARIABLE NAMES FROM INPUT LINE -----1540 INPUT @33:L$1550 J=POS(L$," ",2)1560 J0=J+11570 K$=SEG(L$,J0,3)1580 IF K$="REM" OR K$="IMA" THEN 15401590 L$=L$&"  "1600 A$=SEG(L$,J,1)1610 B$=SEG(L$,J0,1)1620 FOR J1=J0+1 TO LEN(L$)-11630 REM ----- IGNORE CHARACTERS BETWEEN QUOTES1640 IF B$<>"""" THEN 17201650 J=POS(L$,"""",J1)1660 J0=J+11670 J1=J0+11680 A$=SEG(L$,J,1)1690 B$=SEG(L$,J0,1)1700 GO TO 16401710 REM ----- CHECK PREVIOUS(A$) AND SUCCEEDING(C$) CHARACTER1720 C$=SEG(L$,J1,1)1730 IF B$<"A" OR B$>"Z" THEN 21101740 IF C$>"@" AND C$<"[" THEN 20401750 IF A$>"@" AND A$<"[" THEN 21101760 IF A$>"/" AND A$<":" THEN 21101770 REM ----- ONE OR TWO CHARACTER NAME--SKIP ONE OR TWO CHARS.1780 IF C$="$" OR (C$>"/" AND C$<":") THEN 18601790 V$=B$&" "1800 A$=C$1810 J=J11820 J1=J1+11830 J0=J11840 B$=SEG(L$,J0,1)1850 GO TO 19301860 V$=B$&C$1870 J=J1+11880 A$=SEG(L$,J,1)1890 J0=J+11900 B$=SEG(L$,J0,1)1910 J1=J01920 REM -----SAVE VARIABLE NAME?1930 IF POS(N$,V$,1) THEN 21501940 FOR J2=1 TO LEN(N$)-1 STEP 21950 W$=SEG(N$,J2,2)1960 IF W$<V$ THEN 19901970 N$=REP(V$,J2,0)1980 GO TO 20101990 NEXT J22000 N$=REP(V$,LEN(N$)+1,0)2010 N=N+12020 GO TO 21502030 REM ----- SKIP NEXT CHARACTER2040 A$=C$2050 J=J12060 J1=J1+12070 J0=J12080 B$=SEG(L$,J0,1)2090 GO TO 21502100 REM ----- PREPARE FOR NEXT CHARACTER2110 J=J02120 J0=J12130 A$=B$2140 B$=C$2150 NEXT J12160 GO TO 1540