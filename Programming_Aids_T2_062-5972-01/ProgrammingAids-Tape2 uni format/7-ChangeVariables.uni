1480 V=21490 FOR J=48 TO 571500 S$=CHR(J)1510 V$=REP(S$,2,J>48)1520 GOSUB 8001530 NEXT J1540 W$=""1550 V$=REP("$",2,1)1560 GOSUB 8001570 NEXT I1580 PRINT 1590 RETURN 1680 REM change varia1 REM *** 51/00-8028/0                    ***2 REM *** CHANGE & LIST PROGRAM VARIABLES ***3 REM *** S. SCHICKTANZ                   ***4 GO TO 9024 GO TO 110028 GO TO 140032 GO TO 170036 GO TO 100040 GO TO 40090 GOSUB 110091 PRINT "V-list variablesP-  ""  programC-change variables"92 GOSUB 70093 PAGE 94 GOSUB POS("VPCON",S$,1) OF 1400,1000,1700,400,110095 IF F=0 THEN 9096 PRINT "
O-output new programN-new start"97 GO TO 9198 REM user definable key 1: start, 6: input, 7: list variables99 REM 8: change variables, 9: list program, 10: output190 REM input program from file F into P$200 S$=CHR(13)210 P$=""220 M=1230 INPUT @33:K$240 ON EOF (0) THEN 290250 P$=REP(K$,LEN(P$)+1,0)260 P$=REP(S$,LEN(P$)+1,0)270 INPUT @33:K$280 IF M THEN 250290 M=0300 RETURN 390 REM output of program into original file400 FIND F410 PRINT @33:P$420 CLOSE 430 PRINT " finished
"440 F=0450 RETURN 480 REM input variable names & test if valid490 REM name comes in W$, used variables: W$, S$, K, X, Y500 W$=""510 GOSUB 700520 IF S$="" THEN 600530 IF ASC(S$)>64 AND ASC(S$)<91 THEN 560540 PRINT "invalid name! : ";550 GO TO 500560 W$=S$570 GOSUB 700580 IF POS("$0123456789",S$,1)=0 THEN 540590 W$=W$&S$600 PRINT "";610 RETURN 690 REM input character without RETURN700 GIN X,Y710 POINTER K,K,S$720 MOVE X,Y730 PRINT S$;740 RETURN 770 REM search & substitute variable name in P$780 REM var. searched for: V$, subst.: W$790 REM used variables: K, P, V, M, V$, W$, H$, P$, S$800 P=1810 P=POS(P$,V$,P)820 IF P THEN 840830 RETURN 840 S$=SEG(P$,P-1,1)850 IF POS(H$,S$,1)=0 THEN 900860 S$=SEG(P$,P+V,1)870 IF POS(H$,S$,1)=0 THEN 900880 IF M THEN 920890 P$=REP(W$,P,V)900 P=P+V910 GO TO 810920 PRINT W$;V$;", ";930 W$=""940 RETURN 990 REM listing of program in the format of the BASIC-interpreter1000 FOR I=1 TO LEN(P$)1010 V$=SEG(P$,I,1)1020 IF ASC(V$)>31 OR ASC(V$)=13 THEN 10501030 V$=CHR(ASC(V$)+64)1040 PRINT "_";1050 PRINT V$;1060 NEXT I1070 RETURN 1100 REM initialisation1110 INIT 1120 DIM S$(1),H$(17),V$(3),W$(2)1130 S$=CHR(13)1140 H$=" (+-*/^,;:<=>@)&"&S$1150 REM delete remarks1160 DELETE 1901170 DELETE 3901180 DELETE 480,4901190 DELETE 6901200 DELETE 770,7901210 DELETE 9901220 DELETE 13901230 DELETE 16801240 P=MEMORY-2001250 DIM P$(P)1260 DELETE 1110,12601270 P=MEMORY1280 PRINT "File Nr. ";1290 INPUT F1300 FIND F1310 GO TO F>0 OF 2001320 END 1390 REM list variables1400 M=11410 PRINT "LIST OF VARIABLES:
"1420 FOR I=65 TO 901430 V=11440 W$=""1450 V$=CHR(I)1460 IF POS(P$,V$,1)=0 THEN 15701470 GOSUB 8001480 V=21490 FOR J=48 TO 571500 S$=CHR(J)1510 V$=REP(S$,2,J>48)1520 GOSUB 8001530 NEXT J1540 W$=""1550 V$=REP("$",2,1)1560 GOSUB 8001570 NEXT I1580 PRINT 1590 RETURN 1680 REM change variables1690 PRINT ": wrong type!";1700 PRINT "Variable to be changed:  ";1710 GOSUB 5001720 IF W$="" THEN 18101730 V$=W$1740 PRINT "; New name: ";1750 GOSUB 5001760 IF POS(V$,"$",2)+POS(W$,"$",2)=2 THEN 16901770 V=LEN(V$)1780 M=01790 GOSUB 800