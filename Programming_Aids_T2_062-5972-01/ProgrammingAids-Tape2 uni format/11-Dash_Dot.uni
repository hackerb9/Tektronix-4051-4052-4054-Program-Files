9580 INPUT W1,W2,W3,W49590 PRINT "LINE TYPE:
1  SOLID
2  DOT
3  DASH
4  DASH-DOT"9600 PRINT "
YO4 REM ENTER DATA AND DRAW5 GO TO 90008 REM RE-DRAW WITH A DIFFERENT LINE TYPE9 GO TO 959090 REM92 REM **NICK FKIARAS**94 REM   IDP MARKETING96 REM   51/00-9501/0100 REM ROUTINE TO DRAW DASH, DOT, DASH-DOT LINES OF LENGTH H(2) &110 REM MOVES H(1) BETWEEN X1,Y1 & X2,Y2120 X1=(V2-V1)*(X1-W1)/(W2-W1)+V1130 X2=(V2-V1)*(X2-W1)/(W2-W1)+V1140 Y1=(V4-V3)*(Y1-W3)/(W4-W3)+V3150 Y2=(V4-V3)*(Y2-W3)/(W4-W3)+V3155 IF X1=X2 AND Y1=Y2 THEN 670160 WINDOW V1,V2,V3,V4165 MOVE @Q:X1,Y1180 F1=0190 K=1200 K1=0210 IF F2<>2 THEN 230220 DRAW @Q:X1,Y1230 B=Y1240 IF C<>0 THEN 260250 L=(3+K)/2260 R=SQR((X2-X1)^2+(Y2-Y1)^2)270 D(1)=(X2-X1)*H(1)/R280 D(2)=(X2-X1)*H(2)/R290 E(1)=(Y2-Y1)*H(1)/R300 E(2)=(Y2-Y1)*H(2)/R310 IF F2<>2 THEN 340320 D(1)=D(2)330 E(1)=E(2)340 A=X1350 IF C=0 OR C>SQR(D(L)^2+E(L)^2) THEN 390360 A=A+C*(X2-X1)/R370 B=B+C*(Y2-Y1)/R380 C=0385 GO TO 410390 A=A+D(L)400 B=B+E(L)410 F3=(X2>X1)*(A<X2) OR (X2<X1)*(A>X2) OR (Y2>Y1)*(B<Y2)420 IF (F3 OR (Y2<Y1)*(B>Y2))=1 THEN 479430 C=SQR((X2-A)^2+(Y2-B-E(L))^2)440 F1=1450 A=X2460 B=Y2479 IF K>0 THEN 560480 MOVE @Q:A,B490 IF F2=2 THEN 580500 IF F2<>4 THEN 610510 IF K1=2 THEN 540520 DRAW @Q:A,B530 K=K*-1540 K1=1+K550 GO TO 610560 IF F2<>2 THEN 600570 MOVE @Q:A,B580 DRAW @Q:A,B590 GO TO 610600 DRAW @Q:A,B610 K=K*-1620 L=(3+K)/2630 IF F1=0 THEN 390640 F1=0650 IF K<0 AND F2<>2 THEN 665660 C=0665 WINDOW W1,W2,W3,W4670 RETURN 9000 REM DATA PLOT9010 REM9020 REM VARIABLES9030 REM  X1,Y1 AND X2,Y2-COORDINATES OF THE TWO POINTS DEFINING A9040 REM                  LINE SEGMENT9050 REM9060 REM  F2-LOGIC: =1 FOR SOLID LINE TYPE9070 REM            =2 FOR DOT LINE TYPE9080 REM            =3 FOR DASH LINE TYPE9090 REM            =4 FOR DASH-DOT LINE TYPE9100 REM9110 REM  V1,V2,V3,V4-VIEWPORT PARAMETERS9120 REM9130 REM  W1,W2,W3,W4-WINDOW PARAMETERS9140 REM9150 REM  Q-GPIB ADDRESS OF PLOTTING DEVICE (=32 FOR SCREEN)9160 REM9170 REM  K-LOGIC: >0 FOR DRAW9180 REM           <0 FOR MOVE9190 REM9200 REM  K1-LOGIC (USED IN DASH-DOT): =2 WHEN A DOT IS PRINTED9210 REM                               =0 FOR SECOND DRAW9220 REM9230 REM  L-LOGIC: =1 USE VECTOR LENGTH FOR DRAW9240 REM           =2 USE DARK VECTOR LENGTH9250 REM9260 REM  H-LENGTHS FOR DASHES AND INTERMEDIARY MOVES IN GDU's9270 REM    H(1)=LENTGH OF INTERMEDIARY MOVE9280 REM    H(2)=LENGTH OF DASH9290 REM9300 REM  D-X INCREMENTS IN GDU's:9310 REM    D(1)=X INCREMENT FOR MOVES9320 REM    D(2)=X INCREMENT FOR DRAWS9330 REM9340 REM  E-Y INREMENTS IN GDU's:9350 REM    E(1)=Y INCREMENT FOR MOVES9360 REM    E(2)=Y INCREMENT FOR DRAWS9370 REM9380 REM  F1-LOGIC: =0 IF ENTIRE LINE SEGMENT HAS NOT BEEN PLOTTED9390 REM            =1 IF ENTIRE LINE SEGMENT HAS BEEN PLOTTED9400 REM9410 REM  C=LENGTH OF DASH LEFT OVER AFTER THE ENTIRE LINE SEGMENT9420 REM    HAS BEEN PLOTTED9430 REM9440 REM  A,B,R,F3-INTERMEDIATE VALUES9450 REM9460 REM      *** EXAMPLE ***9470 REM  ENTER DATA9480 INIT 9490 DIM X(10),Y(10),H(2),D(2),E(2)9500 PRINT "	DATA ENTRY

"9510 FOR I=1 TO 109520 PRINT "X(";I;"),Y(";I;"): ";9530 INPUT X(I),Y(I)9540 NEXT I9550 PRINT "VIEWPORT: ";9560 INPUT V1,V2,V3,V49570 PRINT "
WINDOW: ";9580 INPUT W1,W2,W3,W49590 PRINT "LINE TYPE:
1  SOLID
2  DOT
3  DASH
4  DASH-DOT"9600 PRINT "
YOUR CHOICE: ";9610 INPUT F29620 PRINT "
DEVICE CODE:
1  PLOTTER
32 4051 DISPLAY

YOUR CHOICE:";9630 INPUT Q9640 WINDOW W1,W2,W3,W49650 VIEWPORT V1,V2,V3,V49660 C=09662 H(1)=39664 H(2)=69670 PAGE 9680 MOVE @Q:X(1),Y(1)9690 FOR I=2 TO 109700 X1=X(I-1)9710 X2=X(I)9720 Y1=Y(I-1)9730 Y2=Y(I)9740 IF F2=1 THEN 97709750 GOSUB 1009760 GO TO 97809770 DRAW X2,Y29780 NEXT I9790 END 