9000 REM THIS ROUTINE INITIALIZES THE TABLES USE BY THE9002 REM CHARACTER GENERATOR. IT SHOULD BE EXECUTED (ONCE) BEFORE9004 REM THE CHARACTER GENERATOR IS USED. (i.e. GOSUB 9000)9006 DIM N$(257),D$(513),M$(2279),E$(1),F$(1),G$(1)9008 REM SET GRAPHIC DEVICE (DEFAULT IS SCREEN)9010 U9=329011 PRINT "FILE # OF DATA? ";9012 INPUT Z9013 PAGE 9014 FIND Z9016 READ @33:N$,D$,M$9018 REM SET CODE FOR NO ITALICS9020 I9=09022 RETURN 9100 REM ***CHARACTER GENERATOR ROUTINE*** 51/00-8012/09102 REM VARIABLES USED -9104 REM   S - SCALE OF THE CHARACTERS IN GRAPHIC DISPLAY UNITS (GDUs)9106 REM   C$ - ASCII CHARACTER STRING TO BE PLOTTED9108 REM   A     - ANGLE (IN DEGREES) OF COUNTERCLOCKWISE ROTATION9109 REM   Z - DATA FILE #9110 REM LOCAL VARIABLES USED -9112 REM   X4,Y4    - TAB REFERENCE 9114 REM   X5,Y5    - GENERAL REFERENCE POINT ALSO UNDERLINE REFERENCE9116 REM   X6,Y6    - CURRENT LOCATION9118 REM   X7,Y7    - CHARACTER MOVES9120 REM   X8,Y8    - STARTING CHARACTER STRING LOCATION USED FOR CR9122 REM   X9,Y9    - WORK VARIABLES9124 REM   S9,C9    - SIN(A) AND COS(A)9126 REM   E$,F$,G$ - WORK STRINGS9128 REM   N$       - TABLE OF MOVES PER CHARACTER9130 REM   D$       - TABLE OF INDEX INTO M$ AND WIDTH9132 REM   M$       - CHARACTER MOVES9134 REM   I9       - ITALICS CODE (1=ON  0=OFF)9136 REM   L9,M9    - INDEX VARIABLES9138 REM   P9       - DRAW CODE (1=MOVE 2=DRAW)9140 REM   S8       - CORRECTED SCALE FACTOR9142 REM   U9       - UNIT NUMBER OF GRAPHIC DEVICE (DEFAULT IS 32)9144 REM   C8       - ASCII DECIMAL EQUIVALENT OF LETTER OF C$9146 REM   W8       - CHARACTER WIDTH (IN GDUs) USED FOR BACKSPACE9148 REM   N9,D9    - MISC. VARIABLES9150 REM GET BEGINNING LOCATION9152 INPUT @U9,24:X6,Y69154 REM SAVE STARTING LOCATION9156 X8=X69158 Y8=Y69160 REM SET REFERENCE POINT9162 X5=X69164 Y5=Y69200 REM ENTRY POINT FOR BYPASSING THE GIN COMMAND9202 REM THE CHARACTERS WILL BE DRAWN AT THE END OF THE LAST STRING9204 REM CORRECT SCALE FACTOR FOR GDUs9206 S8=S*1.259208 SET DEGREES 9210 REM ALL ANGLES IN DEGREES9212 S9=SIN(A)9214 C9=COS(A)9216 FOR L9=1 TO LEN(C$)9218 REM GET A CHARACTER9220 E$=SEG(C$,L9,1)9222 C8=ASC(E$)9224 REM CHECK FOR CONTROL CHARACTER9226 IF C8<>124 THEN 93669228 L9=L9+19230 E$=SEG(C$,L9,1)9232 C8=ASC(E$)9234 REM CHECK FOR ANOTHER CONTROL CHARACTER, IF YES DRAW ONE9236 IF C8=124 THEN 93669238 REM CHECK FOR 5 THROUGH 99240 IF C8<53 OR C8>57 THEN 92469242 GO TO C8-52 OF 9252,9262,9272,9282,92929244 REM CHECK FOR A THROUGH G9246 IF C8<65 OR C8>72 THEN 95209248 GO TO C8-64 OF 9300,9308,9316,9324,9332,9340,9356,93629250 REM ENTER SUPERSCRIPT MODE (CODE 5)9252 Y6=Y6+S8*0.3333*C99254 X6=X6-S8*0.3333*S99256 S8=S8*0.69258 GO TO 95189260 REM LEAVE SUPERSCRIPT MODE (CODE 6)9262 S8=S8*1.66679264 Y6=Y6-S8*0.3333*C99266 X6=X6+S8*0.3333*S99268 GO TO 95189270 REM ENTER SUBSCRIPT MODE (CODE 7)9272 Y6=Y6-S8*0.2667*C99274 X6=X6+S8*0.2667*S99276 S8=S8*0.69278 GO TO 95189280 REM LEAVE SUBSCRIPT MODE (CODE 8)9282 S8=S8*1.66679284 Y6=Y6+S8*0.2667*C99286 X6=X6-S8*0.2667*S99288 GO TO 95189290 REM ESTABLISH REFERENCE POINT (CODE 9)9292 X5=X69294 Y5=Y69296 GO TO 95209298 REM RETURN TO REFERENCE POINT (CODE A)9300 X6=X59302 Y6=Y59304 GO TO 95189306 REM ESTABLISH TAB REFERENCE (CODE B)9308 X4=X6-X89310 Y4=Y6-Y89312 GO TO 95209314 REM TAB OPERATOR (CODE C)9316 X6=X4+X89318 Y6=Y4+Y89320 GO TO 95189322 REM UNDERLINE (CODE D)9324 PRINT @U9,21:X6+0.2667*S8*S9,Y6-0.2667*S8*C99326 PRINT @U9,20:X5+0.2667*S8*S9,Y5-0.2667*S8*C99328 GO TO 95189330 REM BACKSPACE (CODE E)9332 X6=X6-X9*C99334 Y6=Y6-X9*S99336 GO TO 95189338 REM CARRIAGE RETURN (CODE F)9340 X9=X8+1.5*S8*S99342 Y9=Y8-1.5*S8*C99344 X6=X99346 Y6=Y99348 X8=X99350 Y8=Y99352 GO TO 95189354 REM ITALICS MODE (CODE G)9356 I9=19358 GO TO 95209360 REM NO ITALICS (CODE H)9362 I9=09364 GO TO 95209366 P9=29368 N9=C8*2+19370 E$=SEG(N$,N9,1)9372 F$=SEG(N$,N9+1,1)9374 N9=ASC(E$)*16+ASC(F$)9376 D9=C8*4+19378 E$=SEG(D$,D9,1)9380 F$=SEG(D$,D9+1,1)9382 G$=SEG(D$,D9+2,1)9384 W8=D99386 D9=ASC(E$)*256+ASC(F$)*16+ASC(G$)9388 D9=D9*2+19390 E$=SEG(D$,W8+3,1)9392 W8=ASC(E$)9394 FOR M9=D9 TO D9+2*N9-1 STEP 29396 X$=SEG(M$,M9,1)9398 X7=ASC(X$)9400 Y$=SEG(M$,M9+1,1)9402 Y7=ASC(Y$)9404 REM CHECK FOR SPECIAL CODE9406 IF X7=15 THEN 94749408 REM OFFSET FOR NONCENTERED SYMBOLS9410 X7=X7-19412 Y7=Y7-39414 REM CHECK FOR CENTERED SYMBOLS9416 IF C8>16 THEN 94269418 REM OFFSET FOR CENTERED SYMBOLS9420 Y7=Y7-69422 X7=X7-69424 REM ITALICIZE IT9426 IF I9=0 THEN 94329428 X7=X7+0.3*Y79430 REM ROTATE IT9432 IF A=0 THEN 94449434 X9=-Y7*S9+X7*C99436 Y9=Y7*C9+X7*S99438 X7=X99440 Y7=Y99442 REM SCALE IT9444 X9=X7*0.06667*S8+X69446 Y9=Y7*0.06667*S8+Y69448 X7=X99450 Y7=Y99452 REM CHECK FOR A MOVE9454 IF P9=2 THEN 94649456 REM DRAW IT9458 PRINT @U9,20:X7,Y79460 GO TO 94689462 REM MOVE TO IT9464 PRINT @U9,21:X7,Y79466 REM RESET DRAW CODE9468 P9=19470 GO TO 95009472 REM SPEC CODE X7=159474 GO TO Y7+1 OF 9482,9498,94909476 GO TO 95009478 REM MOVE CODE9480 REM Y7=09482 P9=29484 GO TO 95009486 REM Y7=29488 REM INCREASE SCALE FACTOR9490 S8=S8*29492 GO TO 95009494 REM Y7=19496 REM DECREASE SCALE FACTOR9498 S8=S8*0.59500 NEXT M99502 REM CHECK FOR CENTERED SYMBOL (RETURN TO CENTER OF SYMBOL)9504 IF C8<17 THEN 95189506 REM CALCULATE WIDTH OF CHARACTER9508 X9=W8*0.06667*S89510 REM CALCULATE NEXT LOCATION 9512 Y6=Y6+X9*S99514 X6=X6+X9*C99516 REM MOVE TO IT9518 PRINT @U9,21:X6,Y69520 NEXT L99522 RETURN 