1000 REM  ******RESIDENT OVERLAY******1010 P9=P9-101020 Q6=2-ABS(P9-2)1030 P$="FUNCTION"1040 GO TO P9 OF 1100,1070,10901050 P9=P9+101060 GO TO 1001070 P$="DERIVATIVE"1080 GO TO 11001090 P$="INTEGRAL"1100 PRINT "	";P$1110 P8=11120 GOSUB 15201130 WINDOW 0,130,0,1001140 MOVE @Q9:0,01150 DRAW @Q9:130,01160 DRAW @Q9:130,1001170 DRAW @Q9:0,1001180 DRAW @Q9:0,01190 MOVE @Q9:65,1001200 PRINT @Q9:"

";P$1210 IF Q1<>Q2 THEN 12401220 Q1=Q1-11230 Q2=Q2+11240 P(3)=X(1)*1.2-0.2*X(N)1250 P(4)=X(N)*1.1-0.1*X(1)1260 P(5)=Q1*1.2-0.2*Q21270 P(6)=Q2*1.1-0.1*Q11280 REM  ****ADJUST WINDOW**** 1290 GOSUB 24201300 REM  ****PLOT FUNCTION * AT DATA XI****1310 P2=0.34/72*(P(3)-P(4))1320 P3=0.4/34*(P(5)-P(6))1330 Q8=11340 FOR P1=1 TO N1350 P6=X(P1)1360 IF P9<>1 THEN 13901370 P7=Y(P1)1380 GO TO 14201390 IF P1=1 THEN 14101400 P0=X(P1)-X(P1-1)1410 GOSUB 17901420 MOVE @Q9:P6+P2,P7+P31430 PRINT @Q9:"*";1440 NEXT P11450 P0=(X(N)-X(1))/Q01460 REM  ****DRAW THE FUNCTION**** 1470 P8=01480 GOSUB 15201490 PRINT @Q9,23:""1500 END 1510 REM  **************************1520 P6=X(1)1530 Q8=11540 GOSUB 17901550 IF P8=0 THEN 17101560 Q1=P71570 Q2=P71580 FOR P1=1 TO Q01590 P6=P6+P01600 GOSUB 17901610 Q1=Q1 MIN P71620 Q2=Q2 MAX P71630 NEXT P11640 PRINT "
X MIN = ";X(1),"     Y MIN = ";Q11650 PRINT "
X MAX = ";X(N),"     Y MAX = ";Q21660 PRINT "
PRESS ""RETURN"" FOR THE GRAPH. ";1670 INPUT Q$1680 PRINT @Q9:""1690 RETURN 1700 REM  ******************* 1710 MOVE @Q9:P6,P71720 FOR P1=1 TO Q01730 P6=P6+P01740 GOSUB 17901750 DRAW @Q9:P6,P71760 NEXT P11770 RETURN 1780 REM  ******EVALUATE PROPER FUNCTION******1790 IF Q8>2 THEN 18201800 Q8=31810 GO TO 18801820 IF P6<=X(Q8) THEN 22101830 IF Q8=N-1 THEN 22101840 Q8=Q8+11850 IF P6<=X(Q8) THEN 18801860 IF Q8<N-1 THEN 18401870 REM  CALCULATE NEW COEFFICIENTS1880 Q(1)=01890 Q(3)=01900 Q(4)=01910 Q3=Q8-31920 FOR P4=1 TO 41930 Q3=Q3+11940 Q4=Q8-31950 Q(8)=Y(Q3)1960 Q(7)=01970 Q(5)=-Y(Q3)1980 FOR P5=1 TO 41990 Q4=Q4+12000 IF P4=P5 THEN 20502010 Q5=X(Q3)-X(Q4)2020 Q(5)=Q(5)*X(Q4)/Q52030 Q(7)=Q(7)+X(Q4)2040 Q(8)=Q(8)/Q52050 NEXT P52060 Q(1)=Q(1)+Q(5)2070 Q(3)=Q(3)-Q(7)*Q(8)2080 Q(4)=Q(4)+Q(8)2090 NEXT P42100 Q4=Q82110 IF X(Q4)<>0 THEN 21302120 Q4=Q8-12130 Q(2)=(Y(Q4)-Q(1))/X(Q4)-(Q(4)*X(Q4)+Q(3))*X(Q4)2140 GO TO P9 OF 2210,2150,21802150 Q(4)=3*Q(4)2160 Q(3)=2*Q(3)2170 GO TO 22102180 Q(4)=0.25*Q(4)2190 Q(3)=Q(3)/32200 Q(2)=0.5*Q(2)2210 GOSUB 23502220 IF P9>2 THEN 22502230 P7=Q52240 RETURN 2250 IF P6<>X(1) THEN 22802260 P7=02270 RETURN 2280 P7=P7+P6*Q52290 P6=P6-P02300 GOSUB 23502310 P7=P7-P6*Q52320 P6=P6+P02330 RETURN 2340 REM  ******************* 2350 Q5=02360 FOR Q4=4 TO Q6 STEP -12370 Q5=Q5*P6+Q(Q4)2380 NEXT Q42390 RETURN 2400 REM  ******END OF EVALUATE PROPER FUNCTION******2410 REM  ****ADJUST WINDOW**** 2420 P5=32430 GOSUB 24902440 P5=52450 GOSUB 24902460 WINDOW P(3),P(4),P(5),P(6)2470 RETURN 2480 REM  ******ADJUST WINDOW FOR NEAT TICS******2490 P1=(P(P5+1)-P(P5))/(P5+1)2500 P2=10^INT(LGT(P1))2510 P1=P1/P22520 IF P1<1.414213562 THEN 26002530 IF P1=>3.16227766 THEN 25602540 P2=2*P22550 GO TO 26002560 IF P1=>7.071067812 THEN 25902570 P2=5*P22580 GO TO 26002590 P2=10*P22600 P1=INT(P(P5)/P2)2610 P3=P2*(P1+2)2620 IF P3<P(P5) THEN 26502630 P3=P3-P22640 GO TO 26202650 P(P5)=P32660 P5=P5+12670 P1=INT(P(P5)/P2)2680 P3=P2*(P1-2)2690 IF P(P5)<P3 THEN 27202700 P3=P3+P22710 GO TO 26902720 P(P5)=P32730 P(P5+3)=P22740 RETURN 