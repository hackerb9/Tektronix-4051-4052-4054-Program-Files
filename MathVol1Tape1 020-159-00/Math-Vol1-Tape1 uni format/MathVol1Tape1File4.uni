1 REM NUMBER BASE CONVERSION PROGRAM3 END 12 Q4=113 GO TO 11052 Q4=253 GO TO 37090 REM ******************************************100 REM ROUTINE DRIVES BASE CONVERSION110 PAGE 120 PRINT "WHAT BASE ARE YOU CONVERTING FROM:   ";130 INPUT Q3140 Q3=INT(Q3+0.5)150 Q3=ABS(Q3)160 IF Q3<2 OR Q3>36 THEN 1780170 PRINT "WHAT BASE ARE YOU CONVERTING TO:     ";180 INPUT P0190 P0=INT(P0+0.5)200 P0=ABS(P0)210 IF P0<2 OR P0>36 THEN 1800220 PRINT "HOW MANY DIGITS DO YOU WANT TO"230 PRINT "THE RIGHT OF THE ""DECIMAL"" POINT:    ";240 INPUT P1250 P1=INT(P1+0.5)260 P1=ABS(P1)270 PRINT 280 PRINT "ENTER THE NUMBER: ";290 INPUT A$295 IF A$="" THEN 270300 GOSUB 860310 GOSUB 1410320 PRINT A$;" BASE ";Q3;" = ";B$;" BASE ";P0330 PRINT 340 GO TO 270350 REM ******************************************360 REM ROUTINE DRIVES BASE MATH370 PAGE 380 PRINT "WHAT BASE ARE THE NUMBERS IN:          ";390 INPUT Q3400 Q3=INT(Q3+0.5)410 Q3=ABS(Q3)420 IF Q3<2 OR Q3>36 THEN 1820430 PRINT "HOW MANY DIGITS DO YOU WANT TO"440 PRINT "THE RIGHT OF THE ""DECIMAL"" POINT:      ";450 INPUT P1460 P1=INT(P1+0.5)470 P1=ABS(P1)480 PRINT 490 PRINT "
ENTER THE ARITHMETIC EXPRESSION TO BE EVALUATED: ";500 INPUT A$510 P6=LEN(A$)520 Q8=0530 Q8=Q8+1540 IF Q8<=P6 THEN 570550 PRINT "NO OPERATOR"560 GO TO 1770570 Q$=SEG(A$,Q8,1)580 Q7=POS("+-*/^",Q$,1)590 IF Q7=0 THEN 530600 Q$=A$610 A$=SEG(Q$,1,Q8-1)620 GOSUB 860630 Q1=P6640 A$=SEG(Q$,Q8+1,LEN(Q$)-Q8)650 GOSUB 860660 Q2=P6670 GO TO Q7 OF 680,700,720,740,760680 P6=Q1+Q2690 GO TO 790700 P6=Q1-Q2710 GO TO 790720 P6=Q1*Q2730 GO TO 790740 P6=Q1/Q2750 GO TO 790760 P6=Q1^Q2770 REM AT THIS POINT P6 CONTAINS THE DECIMAL EQUIVALENT OF THE780 REM EVALUATED ARITHMETIC EXPRESSION.790 A$=Q$800 P0=Q3810 GOSUB 1410820 PRINT A$;" = ";B$;" BASE ";Q3830 GO TO 480840 REM ROUTINE CONVERTS A$ INTO DECIMAL EQUIVALENT,850 REM STORED IN P6.860 SET KEY 870 P9=1/Q3880 P3=1890 P5=0900 P6=0910 P7=0920 FOR P2=1 TO LEN(A$)930 P$=SEG(A$,P2,1)940 IF P$=" " THEN 960950 GO TO 970960 IF P3=1 THEN 1170970 IF P$=" " THEN 1190980 P3=0990 IF P$<>"." THEN 10301000 IF P5=1 THEN 13301010 P5=11020 GO TO 11701030 P4=ASC(P$)1040 IF P4=45 THEN 12501050 IF P4<48 THEN 12701060 IF P4>57 AND P4<65 THEN 12701070 IF P4<65 THEN 12901080 IF P4>90 AND P4<97 THEN 12701090 IF P4<91 THEN 13101100 P4=P4-871110 IF P4=>Q3 THEN 13501120 IF P5=1 THEN 11501130 P6=P6*Q3+P41140 GO TO 11701150 P7=P7+P4*P91160 P9=P9/Q31170 NEXT P21180 GO TO 12301190 FOR Q0=P2 TO LEN(A$)1200 P$=SEG(A$,Q0,1)1210 IF P$<>" " THEN 13701220 NEXT Q01230 P6=P6+P71240 RETURN 1250 PRINT " NO MINUS ALLOWED."1260 GO TO 17701270 PRINT "INVALID NUMBER"1280 GO TO 17701290 P4=P4-481300 GO TO 11101310 P4=P4-551320 GO TO 11101330 PRINT "ERROR: 2 OR MORE PERIODS IN ";A$1340 GO TO 17701350 PRINT "ERROR: ";P$;" IN ";A$;" IS TOO LARGE FOR BASE Q3 =";Q31360 GO TO 17701370 PRINT "ERROR: INTERIOR BLANKS IN ";A$1380 GO TO 17701390 REM ROUTINE CONVERTS DECIMAL NUMBER, P6 INTO1400 REM A STRING VARIABLE, B$.1410 P5=INT(P6+P0^(-P1-1)*P0/2)1420 P7=P6-P5+P0^(-P1-1)*P0/21430 B$=""1440 C$=""1450 P8=INT(P5/P0)1460 P9=P5-P0*P81470 P5=P81480 P9=INT(P9+0.5)1490 IF P9>36 THEN 15101500 GO TO 15201510 P9=P9+871520 IF P9<10 THEN 15501530 P9=P9+551540 GO TO 15601550 P9=P9+481560 P$=CHR(P9)1570 B$=P$&B$1580 IF P5>0 THEN 14501590 IF P1=>1 THEN 16101600 RETURN 1610 B$=B$&"."1620 FOR Q0=1 TO P11630 P5=P7*P01640 P9=INT(P5)1650 P7=P5-P91660 IF P9=36 THEN 16801670 GO TO 16901680 P9=P9+871690 IF P9<10 THEN 17201700 P9=P9+551710 GO TO 17301720 P9=P9+481730 P$=CHR(P9)1740 B$=B$&P$1750 NEXT Q01760 RETURN 1770 GO TO Q4 OF 270,4801780 PRINT "INVALID NUMBER."1790 GO TO 1201800 PRINT "INVALID NUMBER."1810 GO TO 1701820 PRINT "INVALID NUMBER."1830 GO TO 380