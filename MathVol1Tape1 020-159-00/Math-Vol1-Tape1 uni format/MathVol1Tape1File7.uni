100 REM  ******SAMPLE DRIVER FOR BESSEL FUNCTIONS*********110 PRINT "      Jn(X)             Yn(X)             In(x)";120 PRINT "             Kn(X)"130 PRINT "
  X,N = ";140 INPUT X,N150 GOSUB 1000160 PRINT B1,B2,B3,B4170 PRINT 180 GO TO 130500 REM  *************** BESSEL FUNCTIONS ***************510 REM    THIS SUBROUTINE COMPUTES VALUES OF THE BESSEL FUNCTIONS OF520 REM    THE FIRST AND SECOND KIND -- Jn AND Kn.   AT THE SAME TIME530 REM    IT ALSO COMPUTES THE MODIFIED BESSEL FUNCTIONS OF THE FIRST540 REM    AND SECOND KIND -- In AND Kn.  "n" MUST BE A NONNEGATIVE550 REM    INTEGER.  IT USES A POWER SERIES EXPANSION FOR X<=n+6 AND560 REM    ASYMPTOTIC EXPANSIONS FOR X>n+6570 REM 580 REM  PARAMETERS:590 REM    X-(INPUT)  PARAMETER FOR X 600 REM    N-(INPUT) INTEGER ORDER OF BESSEL FUNCTION 610 REM    B1-(OUTPUT) BESSEL JN(X) 620 REM    B2-(OUTPUT) BESSEL YN(X) 630 REM    B3-(OUTPUT) MODIFIED BESSEL IN(X)640 REM    B4-(OUTPUT) MODIFIED BESSEL KN(X)650 REM 660 REM  REFN:  "NUMERICAL METHODS IN FORTRAN", JOHN M. MCCORMICK670 REM      AND MARIO SALVADORI.  PRENTICE-HALL, ENGLEWOOD CLIFFS, 680 REM      N.J.  1964 690 REM 1000 DIM P(30)1010 P(24)=N1020 IF X-P(24)-6=>0 THEN 17201030 P1=0.5*X1040 P2=P1*P11050 P3=01060 P4=P31070 P5=11080 P6=-11090 IF P4=0 THEN 11501100 IF P4>0 THEN 11201110 GO TO 20701120 P5=P5*P1/P41130 P4=P4-11140 GO TO 10901150 B1=P51160 B3=P51170 P7=11180 P8=P7*(P7+P3)1190 P5=P5*P2/P81200 IF B1+P5-B1=0 THEN 12601210 B1=B1+P5*P61220 B3=B3+P51230 P6=-P61240 P7=P7+11250 GO TO 11801260 IF P3-1<0 THEN 13601270 IF P3-1=0 THEN 15401280 IF X-P(24)-3<=0 THEN 20501290 GO TO 17201300 P3=11310 P(21)=B11320 P(10)=B31330 P(11)=B21340 P(12)=B41350 GO TO 10601360 B2=2/PI*(0.57721566+LOG(P1))*B11370 B4=-(0.57721566+LOG(P1))*B31380 P5=P21390 P6=11400 P(13)=11410 P7=21420 P(14)=P71430 IF B2+P5*P(13)-B2=0 THEN 15101440 B4=B4+P5*P(13)1450 B2=B2+2/PI*P6*P5*P(13)1460 P5=P5*P2/(P(14)*P(14))1470 P(13)=P(13)+1/P(14)1480 P6=-P61490 P7=P7+11500 GO TO 14201510 IF N>0 THEN 13001520 IF N=0 THEN 12801530 GO TO 20701540 B2=(B1*P(11)-2/(PI*X))/P(21)1550 B4=(1/X-B3*P(12))/P(10)1560 P(15)=11570 IF N-1=0 THEN 12801580 IF N-1<0 THEN 20701590 P(16)=B21600 P(17)=B41610 B2=2*P(15)/X*P(16)-P(11)1620 B4=2*P(15)/X*P(17)+P(12)1630 P(15)=P(15)+11640 IF N-2=0 THEN 17001650 IF N-2<0 THEN 20701660 P(11)=P(16)1670 P(12)=P(17)1680 N=N-11690 GO TO 15901700 P3=P(15)1710 GO TO 10601720 P(18)=4*N*N1730 P(19)=8*X1740 P(20)=SQR(2/(PI*X))1750 P(21)=1/SQR(2*PI*X)1760 P(22)=SQR(PI/(2*X))1770 P4=N1780 P(23)=X-(2*P4+1)/4*PI1790 P5=(P(18)-1)/P(19)1800 P6=11810 P(25)=11820 P(26)=11830 P(27)=P51840 B4=1+P51850 P(28)=1-P51860 FOR P9=2 TO INT(X+1+SQR(X*X+P4*P4))1870 P(29)=P91880 P5=(P(18)-(2*P(29)-1)^2)/P(19)*P5/P(29)1890 B4=B4+P51900 P(28)=P(28)+P5*P61910 IF P6=0 THEN 20701920 IF P6<0 THEN 19601930 P(26)=P(26)-P5*P6*P(25)1940 P(25)=-P(25)1950 GO TO 19801960 P(27)=P(27)-P5*P6*P(25)1970 IF P(27)+P5-P(27)=0 THEN 20001980 P6=-P61990 NEXT P92000 B4=EXP(-X)*P(22)*B42010 IF X<P(24)+6 THEN 20502020 B1=P(20)*(P(26)*COS(P(23))-P(27)*SIN(P(23)))2030 B2=P(20)*(P(26)*SIN(P(23))+P(27)*COS(P(23)))2040 B3=EXP(X)*P(21)*P(28)2050 N=P(24)2060 RETURN 2070 END 