100 REM FILE 4:DATA EDIT FROM TAPE110 REM Part #062-3409-00120 REM 4O5O SERIES GPIB SUPPORT SOFTWARE FOR 4662130 INIT140 E1=0150 M6=(50+1000*INT(MEMORY/8192))/2160 DIM D(M6,2),I(25),F$(1),G$(8),X$(90),D1(4),A$(30)170 PRINT "	DATA EDIT FROM TAPEEDITING FUNCTIONS:1. LIST DATA"180 PRINT "2. CHANGE DATA POINTS3. INSERT DATA POINTS"190 PRINT "4. DELETE DATA POINTSEnter desired function number ";200 GOSUB 250210 IF O3=0 THEN 130220 O2=INT(VAL(G$))230 GOSUB O2 OF 460,670,670,670240 GO TO 130250 INPUT G$260 IF LEN(G$)<1 THEN 310270 FOR O3=1 TO LEN(G$)280 F$=SEG(G$,O3,1)290 IF 47<ASC(F$) AND ASC(F$)<58 THEN 320300 NEXT O3310 O3=0320 RETURN330 O5=4340 IF TYP(0)=4 THEN 590350 O5=0360 READ @33:X,Y370 RETURN380 PRINT "
Insert STORAGE TAPE and enter object file number ";390 GOSUB 250400 IF O3=0 THEN 380410 F1=VAL(G$)420 FIND F1430 ON EOF (0) THEN 1430440 READ @33:X$,O4,D1450 RETURN460 GOSUB 380470 O0=1480 O1=0490 GOSUB 330500 IF O1>0 AND O1<30 THEN 550510 IF O0=1 THEN 540520 PRINT "	Press RETURN to continue ";530 INPUT G$540 GOSUB 600550 PRINT USING "4D,8X,2(C9D.3D,5X)":O0,X,Y560 O0=O0+1570 O1=O1+1580 IF O5<4 THEN 490590 GO TO 1360600 F$=CHR(127)610 P=POS(X$,F$,1)620 A$=SEG(X$,1,P-1)630 PRINT USING "P""FILE ""3D10XFA":F1,A$640 PRINT "INDEX ","X VALUE","Y VALUE"650 O1=0660 RETURN670 GOSUB 380680 PRINT "Enter target file number ";690 GOSUB 250700 IF O3=0 THEN 680710 F2=VAL(G$)720 IF F1=F2 THEN 130730 FIND F2740 ON EOF (0) THEN 1410750 WRITE @33:X$,O4,D1760 O0=1770 O1=1780 A$=SEG("CHANGED INSERTEDDELETED ",(O2-2)*8+1,8)790 PRINT "Enter indicies of points to be ";A$;":"800 PRINT "Type ""END"" to terminate input."810 FOR M1=1 TO 25820 PRINT M1;": ";830 GOSUB 250840 IF O3=0 THEN 870850 I(M1)=VAL(G$)860 NEXT M1870 IF G$="END" OR G$="E" THEN 900880 IF M1=26 THEN 900890 GO TO 820900 M1=M1-1910 FOR M2=1 TO M1920 M3=I(M2)930 FOR M4=M2 TO M1940 IF M3<I(M4) THEN 980950 M3=I(M4)960 I(M4)=I(M2)970 I(M2)=M3980 NEXT M4990 NEXT M21000 M2=01010 M4=01020 GOSUB 4201030 FOR M3=1 TO O11040 FOR M0=1 TO M61050 IF TYP(0)=4 THEN 17301060 READ @33:D(M0,1),D(M0,2)1070 NEXT M01080 NEXT M31090 M0=M0-11100 M3=M01110 O1=O1+11120 FIND F21130 ON EOF (0) THEN 14101140 READ @33:X$,O4,D11150 IF M4=0 THEN 11901160 FOR M0=1 TO M41170 READ @33:X,Y1180 NEXT M01190 FOR M0=1 TO M31200 IF M2=M1 THEN 12901210 IF O0<I(M2+1) THEN 12901220 IF O0>I(M2+1) THEN 12701230 X=D(M0,1)1240 Y=D(M0,2)1250 M2=M2+11260 GO TO O2-1 OF 1450,1570,16901270 M2=M2+11280 GO TO 12001290 WRITE @33:D(M0,1),D(M0,2)1300 M4=M4+11310 O0=O0+11320 NEXT M01330 IF E1=0 THEN 10201340 WRITE @33:"END"1350 PRINT "FILE ";F2;" CLOSED"1360 PRINT "Do you wish to continue EDIT ";1370 INPUT G$1380 IF G$="YES" OR G$="Y" THEN 1001390 PRINT "DATA EDIT ended--Load SUPPORT TAPE and press ""AUTOLOAD"""1400 END1410 PRINT "Target file too small! Remark & rerun."1420 END1430 PRINT "Object file INVALID! Remark & restore."1440 END1450 PRINT "Point ";O01460 PRINT "X value is ";X;" change to ";1470 GOSUB 2501480 IF O3=0 THEN 15001490 X=VAL(G$)1500 PRINT "Y value is ";Y;" change to ";1510 GOSUB 2501520 IF O3=0 THEN 15401530 Y=VAL(G$)1540 D(M0,1)=X1550 D(M0,2)=Y1560 GO TO 12901570 PRINT "Point insertion at ";O01580 PRINT "Enter X value ";1590 GOSUB 2501600 IF O3=0 THEN 15801610 X=VAL(G$)1620 PRINT "Enter Y value ";1630 GOSUB 2501640 IF O3=0 THEN 16201650 Y=VAL(G$)1660 WRITE @33:X,Y1670 M4=M4+11680 GO TO 12001690 REM1700 PRINT "Point ";O01710 PRINT "X value ";X," Y value ";Y," DELETED"1720 GO TO 13101730 E1=11740 GO TO 1090