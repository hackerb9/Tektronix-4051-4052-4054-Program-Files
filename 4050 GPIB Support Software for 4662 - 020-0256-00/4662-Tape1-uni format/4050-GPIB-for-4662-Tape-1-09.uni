100 REM FILE 9:SEMI-LOG DATA PLOT110 REM Part #062-3409-00120 REM 4O5O SERIES GPIB SUPPORT SOFTWARE FOR 4662130 INIT140 PAGE150 PRINT "	SEMI-LOG DATA PLOT"160 DIM X$(90),A$(30),F$(1),D1(4),G(9)170 T=32180 A1=0190 PRINT "
Insert STORAGE TAPE and enter file number ";200 INPUT A$210 F=INT(VAL(A$))220 FIND F230 READ @33:X$,O4,D1240 GOSUB 320250 HOME260 PRINT "1..AXES/NO AXES  2..PLOTTER/SCREEN  3..CHANGE MIN/MAX  ";270 PRINT "4..END"280 PRINT "Select option desired ";290 INPUT P300 GO TO P OF 1770,1810,1830,1870310 GO TO 250320 PAGE330 L=130+20*(T=1)340 IF A1 THEN 540350 P=0360 GOSUB 690370 IF LEN(A$)<1 THEN 400380 PRINT @T,21:(L-25)/2+25-LEN(A$),91*L/150390 PRINT @T:A$;400 GOSUB 690410 IF LEN(A$)<1 THEN 440420 PRINT @T,21:(L-25)/2+25-LEN(A$),3430 PRINT @T:A$;440 GOSUB 690450 IF LEN(A$)<1 THEN 540460 PRINT @T,21:0,L/150*50+LEN(A$)/2*3470 INPUT @T,24:X9,Y9480 FOR I=1 TO LEN(A$)490 PRINT @T,21:X9,Y9500 B$=SEG(A$,I,1)510 PRINT @T:B$;520 Y9=Y9-3530 NEXT I540 VIEWPORT 20,L-9,10,90*L/150550 IF D1(1)=D1(3) OR D1(2)=D1(4) THEN 750560 GOSUB 900570 IF T=32 OR A1 THEN 600580 PRINT "






Change pen color and press RETURN";590 INPUT A$600 IF TYP(0)=4 THEN 740610 READ @33:X,Y620 IF Y<1 THEN 1860630 IF X<D1(1) OR X>D1(3) OR Y<D1(2) OR Y>D1(4) THEN 600640 MOVE @T:X,LGT(Y)650 INPUT @T,24:A,B660 C=0.5670 PRINT @T,20:A+C,B+C,A-C,B-C,A,B,A-C,B+C,A+C,B-C,A,B680 GO TO 600690 REM700 Q=P+1710 F$=CHR(127)720 P=POS(X$,F$,Q)730 A$=SEG(X$,Q,P-Q)740 RETURN750 RESTORE 760760 DATA 1.0E+99,1.0E+99,1.0E-99,1.0E-99770 READ D1780 IF TYP(0)=4 THEN 850790 READ @33:X,Y800 D1(1)=D1(1) MIN X810 D1(2)=D1(2) MIN Y820 D1(3)=D1(3) MAX X830 D1(4)=D1(4) MAX Y840 GO TO 780850 D1(3)=D1(1)+(D1(3)-D1(1) MAX 1)860 D1(4)=D1(2)+(D1(4)-D1(2) MAX 1)870 FIND F880 READ @33:X$,O4,I9,I9,I9,I9890 GO TO 560900 G(1)=D1(1)910 G(2)=D1(3)920 S=1930 GOSUB 1510940 IF D1(2)<1 OR D1(4)<1 THEN 1860950 G(5)=INT(LGT(D1(2)))960 G(6)=INT(LGT(D1(4)))970 IF G(6)=LGT(D1(4)) THEN 990980 G(6)=G(6)+1990 G(9)=11000 G(7)=11010 WINDOW G(1),G(2),G(5),G(6)1020 S=81030 X9=(G(2)-G(1))/1301040 GOSUB 12001050 S=41060 X9=01070 GOSUB 12001080 IF A1 THEN 11901090 AXIS @T:G(3),G(7),G(1),G(5)1100 X=90*L/1501110 Y=(X-10)/(G(6)-G(5))1120 PRINT @T,21:20,101130 FOR X1=10 TO X-Y STEP Y1140 FOR Y1=1 TO 101150 X=X1+LGT(Y1)*Y1160 PRINT @T,20:20,X,19,X,20,X1170 NEXT Y11180 NEXT X11190 RETURN1200 Y2=G(S-1)1210 G(4)=G(1)1220 G(8)=G(5)1230 Y=(G(6)-G(5))/1381240 Y1=ABS(G(S-3)+Y2) MAX ABS(G(S-2)-Y2)1250 Y1=INT(LGT(Y1)+1.0E-8)1260 X2=10^-Y11270 X1=G(S-2)1280 GO TO 13001290 G(S)=G(S)+Y21300 IF G(S)>X1 THEN 11901310 IF A1 THEN 14701320 MOVE @T:G(4)+X9,G(8)+Y1330 INPUT @T,24:A,B1340 A$=STR(G(S)*(S=4)+10^G(S)*(S<>4))1350 A$=REP("",1,1)1360 C=LEN(A$) MIN 71370 PRINT @T,21:A-2-C*1.7+(C+2)*(S=4),B-1.5-3*(S=4)1380 IF LEN(A$)>7 THEN 14101390 PRINT @T:A$;1400 GO TO 12901410 IF POS(A$,"E",1) THEN 14401420 C=POS(A$,".",1)1430 IF C THEN 14801440 A$=STR(1)1450 A$=A$&"E,S"1460 PRINT @T: USING A$:A1470 GO TO 12901480 IF C>7 THEN 14401490 A$=SEG(A$,1,7-(C=7))1500 GO TO 13901510 X1=(G(S+1)-G(S))/51520 X2=10^INT(LGT(X1))1530 X1=X1/X21540 IF X1<SQR(2) THEN 16201550 IF X1=>SQR(10) THEN 15801560 X2=X2+X21570 GO TO 16201580 IF X1=>7.071067812 THEN 16101590 X2=5*X21600 GO TO 16201610 X2=10*X21620 X1=INT(G(S)/X2)1630 X=X2*(X1+2)1640 IF X<G(S) THEN 16701650 X=X-X21660 GO TO 16401670 G(S)=X1680 S=S+11690 X1=INT(G(S)/X2)1700 X=X2*(X1-2)1710 IF G(S)<X THEN 17401720 X=X+X21730 GO TO 17101740 G(S)=X1750 G(S+1)=X21760 RETURN1770 A1=NOT(A1)1780 FIND F1790 READ @33:X$,O4,I9,I9,I9,I91800 GO TO 2401810 T=(T=32)+(T=1)*321820 GO TO 17801830 PRINT "Enter X MIN, Y MIN, X MAX, Y MAX ";1840 INPUT D11850 GO TO 17801860 PRINT "Data values must be >= 1"1870 PRINT "DATA PLOT ended--Load SUPPORT TAPE and";1880 PRINT " press ""AUTOLOAD"""