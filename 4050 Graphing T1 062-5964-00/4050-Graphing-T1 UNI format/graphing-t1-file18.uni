1 GO TO 824 GO TO 500581 REM * *** SET UP DEFAULT VALUES82 INIT83 DIM C(3),V(3),T(3)84 X4=10085 X6=286 X7=187 X8=288 Y4=10089 Y6=290 Y7=191 Y8=292 Z4=5093 Z6=094 Z7=095 Z8=096 S5=097 GOSUB 500598 END99 GO TO 981000 REM 51/00-9506/0 THREE DIMENSIONAL DATA PLOT PROGRAM5000 REM * *** MODE SELECTION5005 PRINT "TYPE IN DESIRED MODE: 1:  3D HISTOGRAM"5010 PRINT " 2:  3D POINT PLOT"5015 PRINT " 3:  RANGED CELL GRAPH 4:  SIGNED CELL GRAPH"5020 PRINT " 5:  BAR HISTOGRAM 6:  POINT PLOT 7:  DATA ENTRY"5025 PRINT " 8:  DATA CORRECTION 9:  SELECTION OF PART OF ARRAY"5030 PRINT "10:  COMPARISON OF TWO ROWS OR COLUMNS"5035 PRINT "11:  CHANGE OF PERSPECTIVE      "5036 PRINT "


      (NOTE: DATA MUST BE ENTERED BEFORE ANY PLOTTING"5037 PRINT "       MAY BE DONE)~^~	    ";5040 INPUT S25045 S3=05050 X5=(X8+X7)*0.55055 X6=X8-X7+15060 Y5=(Y8+Y7)*0.55065 Y6=Y8-Y7+15070 S5=(S2<7 OR S2=8)*S55075 IF S2<7 THEN 50855080 GOSUB 60505085 IF S2>6 THEN 50955090 GOSUB 65405095 GO TO S2 OF 5235,5265,5345,5345,5400,5495,5640,5775,5850,5915,61305100 REM * *** PLOT ROUTINE MAINLINE5105 REM *** INITIALIZE PARMETERS5110 IF S5=PI THEN 51255115 GOSUB 62555120 GO TO 51305125 GOSUB 62955130 PAGE5135 IF S2>4 THEN 51555140 REM *** LABEL5145 GOSUB 66605150 REM *** PLOT GRID5155 GOSUB 68205160 REM *** PLOT CELLS5165 FOR X1=X7 TO X85170 FOR Y1=Y7 TO Y85175 X9=X15180 Y9=Y15185 Z1=A(X1,Y1)5190 Z9=Z15195 GOSUB S2 OF 5250,5285,5360,5375,5420,55205200 GOSUB 69455205 NEXT Y15210 NEXT X15215 IF S2<3 THEN 52255220 S5=05225 RETURN5230 REM * *** 3D HISTOGRAM  S2=15235 S1=45240 S4=15245 GO TO 51105250 S0=Z9/(-Z2 MAX Z3)5255 RETURN5260 REM * *** 3D POINT PLOT  S2=25265 S0=05270 S1=15275 S4=05280 GO TO 51105285 IF X1=X8 THEN 53355290 IF Y9>Y7 THEN 53055295 GOSUB 70555300 GO TO 53105305 GOSUB 70705310 X9=X9+15315 Z9=A(X9,Y9)5320 GOSUB 70705325 X9=X9-15330 Z9=A(X9,Y9)5335 RETURN5340 REM * *** RANGED CELL PLOT  S2=35345 S1=45350 S4=05355 GO TO 51255360 S0=(Z9-Z2)/(Z3-Z2)5365 RETURN5370 REM * *** SIGNED CELL GRAPH  S2=45375 S0=((Z9>0)*0.3+0.7)*ABS(Z9)/(-Z2 MAX Z3)5380 S1=3+(Z9>0)5385 S3=(X6>Y6)*0.5*PI5390 RETURN5395 REM * *** BAR HISTOGRAM  S2=55400 S1=25405 S4=15410 S3=(X6>Y6)*0.5*PI5415 GO TO 51255420 IF X9>X7 AND Y9>Y7 THEN 54805425 Z9=05430 GOSUB 70555435 IF ABS(Z2)<ABS(Z3) THEN 54455440 PRINT "
";5445 IF X6<=Y6 THEN 54655450 IF Y9>Y7 THEN 54755455 PRINT "X=";X9;5460 GO TO 54755465 IF X9>X7 THEN 54755470 PRINT "Y=";Y9;5475 Z9=A(X9,Y9)5480 S0=0.125+0.75*((Y9-Y7+1)/Y6+(X6<=Y6)*((X9-X7+1)/X6-(Y9-Y7+1)/Y6))5485 RETURN5490 REM * *** POINT PLOT  S2=65495 S0=05500 S1=15505 IF Y6=>X6 THEN 51255510 S3=15515 GO TO 51255520 IF Y6<X6 THEN 55605525 IF Y9>Y7 THEN 55555530 GOSUB 70555535 IF Z9<0 THEN 55455540 PRINT "
";5545 PRINT "X=";X1;5550 MOVE X,Y5555 RETURN5560 IF X9>X7 THEN 55855565 GOSUB 70555570 IF Z9<0 THEN 55805575 PRINT "
";5580 PRINT "Y=";Y1;5585 IF X1<X8 THEN 56055590 S1=25595 Y1=Y85600 RETURN5605 X9=X1+15610 Z9=A(X9,Y9)5615 GOSUB 70555620 Z9=A(X1,Y1)5625 X9=X15630 RETURN5635 REM * *** DATA ENTRY  S2=75640 PRINT "TYPE IN DIMENSIONS        ROWS (X)"5645 PRINT "        COLUMNS (Y)~^~     ";5650 INPUT X85655 PRINT "     ";5660 INPUT Y85665 DELETE A5670 DIM A(X8,Y8)5675 S3=35680 FOR S9=1 TO X85685 FOR S8=1 TO Y85690 S3=S3+15695 IF S8=1 AND S3<30 THEN 57205700 IF S8=1 AND S3>29 THEN 57105705 IF S3<34 THEN 57305710 PAGE5715 S3=05720 PRINT "     ROW # (X=) ";S9;""5725 S3=S3+45730 PRINT "          COLUMN # (Y=) ";S8;"   DATA = ";5735 INPUT A(S9,S8)5740 NEXT S85745 NEXT S95750 X7=15755 Y7=15760 S5=05765 GO TO 50055770 REM * *** DATA CORRECTION  S2=85775 PRINT "HOW MANY CORRECTIONS DO YOU WISH TO MAKE? ";5780 INPUT Z5785 FOR Z1=1 TO Z5790 PRINT "     ROW (X)= ";5795 INPUT X5800 PRINT "	COLUMN (Y)= ";5805 INPUT Y5810 IF X>0 AND Y>0 THEN 58255815 Z1=Z5820 GO TO 58355825 PRINT "          DATA WAS ";A(X,Y);"  NEW DATA =";5830 INPUT A(X,Y)5835 NEXT Z15840 GO TO 50055845 REM * *** SELECTION OF PART OF ARRAY  S2=95850 PRINT "SELECT THE LIMITS OF THE DISPLAYED ARRAY"5855 PRINT "     THE ROWS (X) RAN FROM ";X7;" TO ";X85860 PRINT "     NOW THE ROWS (X) WILL RUN FROM    TO		";5865 INPUT X75870 PRINT "		     ";5875 INPUT X85880 PRINT "     THE COLUMNS (Y) RAN FROM ";Y7;" TO ";Y85885 PRINT "     NOW THE COLUMNS (Y) WILL RUN FROM    TO		  ";5890 INPUT Y75895 PRINT "		        ";5900 INPUT Y85905 GO TO 50055910 REM * *** COMPARISON OF TWO ROWS OR COLUMNS  S2=105915 PRINT "TYPE IN DESIRED MODE: 1: COMPARISON OF TWO ROWS (X)"5920 PRINT " 2: COMPARISON OF TWO COLUMNS (Y)~^~	   ";5925 INPUT Z85930 PRINT "     TYPE IN THE ROWS OR COLUMNS TO BE COMPARED: ";5935 INPUT Z75940 PRINT "		               AND ";5945 INPUT Z65950 IF Z8=2 THEN 60005955 X7=Z6 MIN Z75960 X8=X7+15965 IF ABS(Z7-Z6)=1 THEN 50055970 FOR S9=Y7 TO Y85975 S8=A(X8,S9)5980 A(X8,S9)=A(Z6 MAX Z7,S9)5985 A(Z6 MAX Z7,S9)=S85990 NEXT S95995 GO TO 50056000 Y7=Z6 MIN Z76005 Y8=Y7+16010 IF ABS(Z7-Z6)=1 THEN 50056015 FOR S9=X7 TO X86020 S8=A(S9,Y8)6025 A(S9,Y8)=A(S9,Z6 MAX Z7)6030 A(S9,Z6 MAX Z7)=S86035 NEXT S96040 GO TO 50056045 REM *** RESTORE ARRAY6050 IF Z8=0 OR ABS(Z7-Z6)=1 THEN 61206055 IF Z8=2 THEN 60906060 FOR S9=Y7 TO Y86065 S8=A(Z6 MAX Z7,S9)6070 A(Z6 MAX Z7,S9)=A((Z6 MIN Z7)+1,S9)6075 A((Z6 MIN Z7)+1,S9)=S86080 NEXT S96085 GO TO 61156090 FOR S9=X7 TO X86095 S8=A(S9,Z6 MAX Z7)6100 A(S9,Z6 MAX Z7)=A(S9,(Z6 MIN Z7)+1)6105 A(S9,(Z6 MIN Z7)+1)=S86110 NEXT S96115 Z8=06120 RETURN6125 REM * *** CHANGE OF PERSPECTIVE  S2=116130 PRINT "TYPE IN DESIRED MODE: 1:  ROTATE GRAPH CLOCKWISE"6135 PRINT " 2:  ROTATE GRAPH COUNTERCLOCKWISE 3:  CHOOSE VIEWPOINT"6140 PRINT " 4:  AUTOSCALE~^~	   ";6145 S5=PI6150 INPUT S96155 GO TO S9 OF 6160,6180,6195,62406160 S9=X4-X0+Y06165 X4=-Y4+Y0+X06170 Y4=S96175 GO TO 50056180 S9=-X4+X0+Y06185 X4=Y4-Y0+X06190 GO TO 61706195 PRINT " GRAPH RANGES FROM: X:  ";X7;" TO  ";X8;" Y: ";6200 PRINT Y7;" TO  ";Y8;" PREVIOUS VIEWPOINT:	NEW VIEWPOINT:"6205 PRINT " X:  ";X4;" Y:  ";Y4;" Z:  ";Z4;"		";6210 INPUT X46215 PRINT "		";6220 INPUT Y46225 PRINT "		";6230 INPUT Z46235 GO TO 50056240 S5=06245 GO TO 50056250 REM * *** INITIALIZATION OF 3D PLOT PERSPECTIVE6255 IF S7<>X5 THEN 62706260 S7=S7+0.56265 REM *** DETERMINE VIEWPOINT6270 X=10*(X6^2+Y6^2)^0.56275 X4=(2*(X5>S7)-1)*X*ABS(COS(ATN((Y5-S6)/(X5-S7))))+X56280 Y4=(2*(Y5>S6)-1)*X*ABS(SIN(ATN((Y5-S6)/(X5-S7))))+Y56285 Z4=(Z3+Z2)/2+10*(Z3-Z2)6290 REM *** CENTER OF PLOT AND SCALE6295 X0=X56300 Y0=Y56305 Z0=(Z3+Z2)/26310 S=((X4-X0)^2+(Y4-Y0)^2+(Z4-Z0)^2)^0.56315 REM *** INITIALIZE CONVERSION6320 GOSUB 71306325 REM *** FIND MIN AND MAX X,Y COORDINATES OF MAPPING6330 X9=X56335 Y9=Y56340 Z9=(Z3+Z2)/26345 GOSUB 70856350 X1=X6355 X2=X6360 Y1=Y6365 Y2=Y6370 IF S2>2 THEN 64606375 REM *** FOR 3D PLOTS6380 FOR S9=X7 TO X86385 FOR S8=Y7 TO Y86390 S7=ABS((S8-Y0)/(S9-X0+1.0E-30))<Y5/X56395 S6=ABS((S8-Y0)/(S9-X0+1.0E-30))>Y5/X56400 FOR X9=S9-0.5+(S7 AND S9>X0) TO S9+0.5-(S7 AND S9<X0)6405 FOR Y9=S8-0.5+(S6 AND S8>Y0) TO S8+0.5-(S6 AND S8<Y0)6410 S=(S9>X7 AND S9<X8 OR (S8>Y7 AND S8<Y8))*A(S9,S8)6415 FOR Z1=S TO A(S9,S8) STEP A(S9,S8)+(A(S9,S8)=0)6420 GOSUB 66206425 NEXT Z16430 NEXT Y96435 NEXT X96440 NEXT S86445 NEXT S96450 GO TO 65106455 REM *** FOR FLAT PLOTS6460 S9=(Z3>0)*Z36465 S8=(Z2<0)*Z26470 FOR Z1=S8 TO S9 STEP S9-S86475 FOR Y9=Y7-0.5 TO Y8+0.5 STEP Y66480 FOR X9=X7-0.5 TO X8+0.5 STEP X66485 GOSUB 66206490 NEXT X96495 NEXT Y96500 NEXT Z16505 REM *** SET UP WINDOW6510 IF (X2-X1)/(Y2-Y1)>1.3 THEN 65256515 WINDOW (X2+X1)/2-0.65*(Y2-Y1),(X2+X1)/2+0.65*(Y2-Y1),Y1,Y26520 RETURN6525 WINDOW X1,X2,(Y2+Y1)/2-(X2-X1)/2.6,(Y2+Y1)/2+(X2-X1)/2.66530 RETURN6535 REM *** FIND MIN AND MAX Z VALUES6540 Z2=1.0E+3066545 Z3=-Z26550 FOR S9=X8 TO X7 STEP -16555 FOR S8=Y8 TO Y7 STEP -16560 Z2=Z2 MIN A(S9,S8)6565 IF A(S9,S8)<Z3 THEN 65856570 Z3=A(S9,S8)6575 S6=S86580 S7=S96585 NEXT S86590 NEXT S96595 IF Z2<Z3 THEN 66106600 Z2=Z2-1.0E-106605 Z3=Z3+1.0E-106610 RETURN6615 REM *** FIND MIN AND MAX6620 Z9=Z16625 GOSUB 70856630 X1=X1 MIN X6635 X2=X2 MAX X6640 Y1=Y1 MIN Y6645 Y2=Y2 MAX Y6650 RETURN6655 REM * *** LABEL6660 Z9=06665 IF X6=1 THEN 67306670 REM *** DRAW THE X6675 X9=X8+0.26680 Y9=Y7-0.46685 GOSUB 70556690 X9=X8-0.26695 Y9=Y7+0.46700 GOSUB 70706705 Y9=Y7-0.46710 GOSUB 70556715 X9=X8+0.26720 Y9=Y7+0.46725 GOSUB 70706730 IF Y6=1 THEN 68106735 REM *** DRAW THE Y6740 X9=X7-0.46745 Y9=Y8-0.26750 GOSUB 70556755 X9=X76760 Y9=Y86765 GOSUB 70706770 X9=X7-0.46775 Y9=Y8+0.26780 GOSUB 70706785 X9=X76790 Y9=Y86795 GOSUB 70706800 X9=X7+0.46805 GOSUB 70706810 RETURN6815 REM * *** GRID PLOT6820 Z9=06825 IF S2>4 THEN 69056830 REM *** ALONG X COORDINATE6835 FOR X9=X7-0.5 TO X8+0.56840 Y9=Y7-0.56845 GOSUB 70556850 Y9=Y8+0.56855 GOSUB 70706860 NEXT X96865 REM *** ALONG Y COORDINATE6870 FOR Y9=Y7-0.5 TO Y8+0.56875 X9=X7-0.56880 GOSUB 70556885 X9=X8+0.56890 GOSUB 70706895 NEXT Y96900 RETURN6905 X9=X7-0.56910 Y9=Y7-0.56915 GOSUB 70556920 X9=X8+0.56925 Y9=Y8+0.56930 GOSUB 70706935 RETURN6940 REM * *** POLYGON TABLE6945 IF S1=1 AND (Y1>Y7 OR S3=PI OR S2=6) THEN 69306950 IF S0=0 AND S1<>1 THEN 70456955 X9=COS(S3+PI/S1)*S0/2+X16960 Y9=SIN(S3+PI/S1)*S0/2+Y16965 GOSUB 70556970 IF S1=1 THEN 70456975 FOR S8=3*PI/S1+S3 TO 2*PI+2*PI/S1+S3 STEP 2*PI/S16980 IF S4=0 OR Z1=0 THEN 70056985 Z9=06990 GOSUB 70556995 Z9=Z17000 GOSUB 70707005 X9=COS(S8)*S0/2+X17010 Y9=SIN(S8)*S0/2+Y17015 GOSUB 70707020 IF S2<>5 THEN 70407025 Z9=07030 GOSUB 70707035 S8=S8+PI7040 NEXT S87045 RETURN7050 REM * *** LINK TO 3D PLOT7055 GOSUB 70857060 MOVE X,Y7065 RETURN7070 GOSUB 70857075 DRAW X,Y7080 RETURN7085 IF S2<3 THEN 71057090 X=X9+(X6<=Y6)*(Y9-X9)7095 Y=-Y9+(X6<=Y6 AND S2<5)*(Y9-X9)+(S2>4)*(Z9+Y9)7100 RETURN7105 T(1)=X97110 T(2)=Y97115 T(3)=Z97120 GOSUB 73207125 RETURN7130 C(1)=X07135 C(2)=Y07140 C(3)=Z07145 V(1)=X47150 V(2)=Y47155 V(3)=Z47160 GOSUB 71807165 RETURN7170 REM * *** 3D PLOT7175 REM *** INITIALIZE INTERNAL VECTORS7180 DIM T1(3),T2(3),T3(3),T4(3),T5(3)7185 T7=07190 FOR T9=1 TO 37195 T3(T9)=V(T9)-C(T9)7200 T7=T7+T3(T9)^27205 NEXT T97210 REM *** T1 IS THE ORIGIN, T2 IN NORMAL VECTOR7215 FOR T9=1 TO 37220 T1(T9)=V(T9)-S/SQR(T7)*T3(T9)7225 T2(T9)=T3(T9)/SQR(T7)7230 NEXT T97235 T3=C7240 T3(3)=T3(3)+17245 REM *** PROJECT ONTO VIEW PLANE7250 GOSUB 73707255 REM *** CALC. X,Y (T4,T5) VECTORS7260 T7=07265 FOR T9=1 TO 37270 T7=T7+(T3(T9)-T1(T9))^27275 NEXT T97280 FOR T9=1 TO 37285 T5(T9)=(T3(T9)-T1(T9))/SQR(T7)7290 NEXT T97295 T4(1)=T5(2)*T2(3)-T5(3)*T2(2)7300 T4(2)=T5(3)*T2(1)-T5(1)*T2(3)7305 T4(3)=T5(1)*T2(2)-T5(2)*T2(1)7310 RETURN7315 REM *** ENTRY POINT TO CALC. 2D VALUES7320 T3=T7325 GOSUB 73707330 X=07335 Y=07340 FOR T9=1 TO 37345 X=X+(T3(T9)-T1(T9))*T4(T9)7350 Y=Y+(T3(T9)-T1(T9))*T5(T9)7355 NEXT T97360 RETURN7365 REM *** INTERNAL ROUTINE TO PROJECT TO VIEW PLANE7370 T7=07375 T8=07380 FOR T9=1 TO 37385 T7=T7+(T1(T9)-T3(T9))*T2(T9)7390 T8=T8+(V(T9)-T3(T9))*T2(T9)7395 NEXT T97400 FOR T9=1 TO 37405 T3(T9)=(V(T9)-T3(T9))*T7/T8+T3(T9)7410 NEXT T97415 RETURN7420 REM *** END OF 3D PLOT PROGRAM ***