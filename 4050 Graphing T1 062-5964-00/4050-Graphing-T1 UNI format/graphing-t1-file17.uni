1 GO TO 1904 GO TO 490100 REM **********************************************************110 REM120 REM             Y AXIS GRAPH - 12 MONTH FORMAT130 REM140 REM     51/00-0905/0                      BY B. PILKINGTON150 REM                                       AT&T LONG LINES160 REM                                       1/2/79170 REM180 REM **********************************************************190 INIT200 REM INITIALIZE VARIABLES210 A$=" "220 B$=" "230 C$=" "240 D$=" "250 H$=" "260 I$=" "270 J$=" "280 E$=" "290 L$=" "300 F$=" "310 G$=" "320 W3=0330 W4=100340 W5=10350 DIM S(12),S1(12),S2(12),M6(3),M5(3)360 FOR I=1 TO 12370 S(I)=0380 S1(I)=0390 S2(I)=0400 NEXT I410 FOR I=1 TO 3420 M5(I)=0430 M6(I)=0440 NEXT I450 M=1460 M1=2470 D9=0480 REM  ** MENU **490 PRINT "	Y AXIS GRAPH-12 MONTH FORMATITEMNUMBER"500 PRINT " 1      ENTER MAIN TITLES"510 PRINT " 2      ENTER Y AXIS TITLE AND DOLLAR SIGN"520 PRINT " 3      ENTER X AXIS TITLE"530 PRINT " 4      ENTER LEGEND LABELS"540 PRINT " 5      ENTER Y AXIS DATA RANGES & TIC INTERVALS"550 PRINT " 6      SOLID LINE PLOT DATA"560 PRINT " 7      DASH LINE PLOT DATA"570 PRINT " 8      BAR DATA"580 PRINT " 9      SELECT BAR SHADING"590 PRINT "10      DISPLAY PARAMETERS"600 PRINT "11      SAVE PARAMETERS & DATA ON TAPE"610 PRINT "12      READ PARAMETERS & DATA FROM TAPE"620 PRINT "13      DRAW GRAPH"630 PRINT "ENTER MENU ITEM NUMBER OR M FOR NEW MENU ";640 INPUT N$650 IF N$="M" THEN 490660 N$=N$&",0"670 N=VAL(N$)680 IF N<1 OR N>13 THEN 700690 GO TO 720700 PRINT "ERROR"710 GO TO 630720 IF N>11 THEN 740730 GO TO N OF 770,1000,1230,1290,1490,1570,2010,2140,2270,2380,2580740 N=N-11750 GO TO N OF 2710,2830760 REM  ** MAIN TITLES **770 PRINT " MAIN TITLES      1  TITLE LINE A 2  TITLE LINE B"780 PRINT " 3  TITLE LINE C 4  TITLE LINE D"790 PRINT " ENTER NUMBER (1,2,3,OR 4) OR M FOR NEW MENU ";800 INPUT N$810 IF N$="M" THEN 490820 N$=N$&",0"830 N=VAL(N$)840 IF N<1 OR N>4 THEN 790850 GO TO N OF 860,890,920,950860 PRINT " ENTER TITLE A   ";870 INPUT A$880 GO TO 490890 PRINT " ENTER TITLE B   ";900 INPUT B$910 GO TO 490920 PRINT " ENTER TITLE C   ";930 INPUT C$940 GO TO 490950 PRINT " ENTER TITLE D   ";960 INPUT D$970 GO TO 490980 REM990 REM  ** Y AXIS TITLES **1000 PRINT " Y AXIS TITLES 1  LINE A 2  LINE B 3  LINE C"1010 PRINT " 4  DOLLAR SIGN"1020 PRINT "ENTER (1,2,3,OR 4) OR M FOR NEW MENU ";1030 INPUT N$1040 IF N$="M" THEN 4901050 N$=N$&",0"1060 N=VAL(N$)1070 IF N<1 OR N>4 THEN 10201080 GO TO N OF 1090,1120,1150,11801090 PRINT "ENTER LINE A   ";1100 INPUT J$1110 GO TO 4901120 PRINT "ENTER LINE B   ";1130 INPUT I$1140 GO TO 4901150 PRINT "ENTER LINE C   ";1160 INPUT H$1170 GO TO 4901180 PRINT "ENTER 1 TO ADD $ OR 0 TO REMOVE $   ";1190 INPUT D91200 IF D9<0 OR D9>1 THEN 11801210 GO TO 4901220 REM  ** X AXIS TITLE **1230 PRINT " X AXIS TITLEENTER TITLE OR M FOR NEW MENU   ";1240 INPUT N$1250 IF N$="M" THEN 4901260 E$=N$1270 GO TO 4901280 REM  ** LEGEND LABELS **1290 PRINT " LEGEND LABELS 1  LINE A (USED FOR SOLID LINE)"1300 PRINT "2  LINE B (USED FOR DASH LINE)"1310 PRINT "3  LINE C (USED FOR BARS)"1320 PRINT "ENTER (1,2,OR 3) OR M FOR NEW MENU ";1330 INPUT N$1340 IF N$="M" THEN 4901350 N$=N$&",0"1360 N=VAL(N$)1370 IF N<1 OR N>3 THEN 13201380 GO TO N OF 1390,1420,14501390 PRINT "ENTER LINE A   ";1400 INPUT L$1410 GO TO 4901420 PRINT "ENTER LINE B   ";1430 INPUT F$1440 GO TO 4901450 PRINT "ENTER LINE C   ";1460 INPUT G$1470 GO TO 4901480 REM  ** Y AXIS DATA RGE & TICS **1490 PRINT "  SET Y AXIS DATA RANGE & TIC INTERVALS"1500 PRINT "MINIMUM  ";1510 INPUT W31520 PRINT "MAXIMUM  ";1530 INPUT W41540 PRINT "TIC INTERVAL  ";1550 INPUT W51560 GO TO 4901570 REM ** ENTER DATA **1580 M5(1)=01590 M5(2)=01600 M5(3)=01610 PRINT " SOLID LINE PLOT"1620 PRINT "ENTER E TO ENTER DATAENTER C TO CHANGE OR ADD ON DATA"1630 PRINT "ENTER M FOR MENU "1640 INPUT N$1650 IF N$<>"M" AND N$<>"E" AND N$<>"C" THEN 16301660 IF N$="M" THEN 4901670 M5(1)=11680 M6(1)=11690 DIM Q$(3)1700 RESTORE 17101710 DATA "JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG"1720 DATA "SEP","OCT","NOV","DEC"1730 IF N$="C" THEN 17701740 PRINT "ENTER DATA: "1750 PRINT "ENTER M TO DISCONTINUE DATA ENTRY"1760 GO TO 18101770 PRINT " DELETE, CHANGE OR ADD ON DATA"1780 PRINT "PRESS RETURN KEY TO SKIP OVER GOOD DATA MONTHS"1790 PRINT "ENTER 0 AND RETURN TO DELETE A VALUE"1800 PRINT "ENTER VALUE AND RETURN TO WRITE OVER OR ADD ON"1810 FOR I=1 TO 121820 READ Q$1830 PRINT "";Q$;".....";1840 INPUT N$1850 IF N$="M" THEN 4901860 IF N$="0" THEN 18901870 N$=N$&",0"1880 IF VAL(N$)=0 THEN 19801890 IF M5(1)=1 THEN 19301900 IF M5(2)=1 THEN 19501910 IF M5(3)=1 THEN 19701920 GO TO 4901930 S(I)=VAL(N$)1940 GO TO 19801950 S1(I)=VAL(N$)1960 GO TO 19801970 S2(I)=VAL(N$)1980 NEXT I1990 GO TO 4902000 REM ** DASH LINE **2010 PRINT " DASH LINE PLOT"2020 PRINT "ENTER E TO ENTER DATAENTER C TO CHANGE OR ADD ON DATA"2030 PRINT "ENTER M FOR MENU "2040 INPUT N$2050 IF N$<>"M" AND N$<>"E" AND N$<>"C" THEN 20202060 IF N$="M" THEN 4902070 M5(1)=02080 M5(2)=02090 M5(3)=02100 M5(2)=12110 M6(2)=12120 GO TO 16902130 REM ** BAR ROUTINE **2140 PRINT " BAR PLOT"2150 PRINT "ENTER E TO ENTER DATAENTER C TO CHANGE OR ADD ON DATA"2160 PRINT "ENTER M FOR MENU "2170 INPUT N$2180 IF N$<>"M" AND N$<>"E" AND N$<>"C" THEN 21502190 IF N$="M" THEN 4902200 M5(1)=02210 M5(2)=02220 M5(3)=02230 M5(3)=12240 M6(3)=12250 GO TO 16902260 REM ** BAR SHADING **2270 PRINT " BAR SHADING"2280 PRINT "ENTER 0 FOR SOLID BARS ENTER 1 FOR EMPTY BARS (DEFAULT)"2290 PRINT "ENTER 2 FOR CROSS HATCHENTER M FOR MENU"2300 INPUT N$2310 IF N$<>"0" AND N$<>"1" AND N$<>"2" AND N$<>"M" THEN 22802320 IF N$="M" THEN 4902330 N$=N$&",0"2340 M=VAL(N$)2350 M1=M+12360 GO TO 4902370 REM * DISPLAY PARAMETERS *2380 RESTORE 17102390 PRINT "DISPLAY PARAMETERS:"2400 PRINT A$;"";B$;"";C$;"";D$;"";2410 PRINT "DATA:SOLID LINE     	DASH LINE     	BAR     "2420 FOR I=1 TO 122430 READ Q$2440 PRINT "";Q$;"...";S(I);"	";Q$;"...";S1(I);"	";Q$;"...";S2(I);2450 NEXT I2460 GO TO M1 OF 2470,2490,25102470 V$="SOLID FILL"2480 GO TO 25202490 V$="EMPTY"2500 GO TO 25202510 V$="CROSS HATCH"2520 PRINT "Y AXIS RANGES:";"		BAR SHADING: ";V$;2530 PRINT "MINIMUM...";W3;"MAXIMUM...";W4;"INTERVAL...";W5;2540 FOR K3=1 TO 500*32550 NEXT K32560 GO TO 4902570 REM * SAVE ON TAPE *2580 PRINT "SAVE ON TAPE"2590 PRINT "Insert your data tape & enter the tape file # ";2595 PRINT "or M for menu? ";2600 INPUT N$2610 IF N$="M" THEN 4902620 N$=N$&",0"2630 N=VAL(N$)2640 IF N=0 THEN 25902650 KILL N2660 FIND N2670 WRITE A$,B$,C$,D$,H$,I$,J$,E$,L$,F$,G$,W3,W4,W5,S,S1,S2,M6,M,D92680 CLOSE2690 GO TO 4902700 REM * READ FROM TAPE *2710 PRINT "READ FROM TAPE"2720 PRINT "Insert your data tape & enter the tape file # ";2725 PRINT "or M for menu? ";2730 INPUT N$2740 IF N$="M" THEN 4902750 N$=N$&",0"2760 N=VAL(N$)2770 IF N=0 THEN 27202780 FIND N2790 READ @33:A$,B$,C$,D$,H$,I$,J$,E$,L$,F$,G$,W3,W4,W5,S,S1,S2,M6,M,D92800 CLOSE2810 GO TO 28302820 REM  ********************DRAW ROUTINE***********************2830 PAGE2840 REM SET DEFAULTS2850 V1=202860 V2=1242870 V3=202880 V4=852890 W1=02900 W2=132910 VIEWPORT V1,V2,V3,V42920 WINDOW W1,W2,W3,W42930 AXIS 1,W52940 MOVE W2,W32950 DRAW W2,W42960 DRAW W1,W42970 REM hor axis labels2980 RESTORE 29902990 DATA "Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct"3000 DATA "Nov","Dec"3010 FOR I=1 TO 123020 READ Q$3030 MOVE I,W33040 SCALE 1,13050 RMOVE -0.5*1.55,-0.5*1.883060 RMOVE 0,-2.53070 PRINT "";3080 PRINT Q$3090 WINDOW W1,W2,W3,W43100 VIEWPORT V1,V2,V3,V43110 NEXT I3120 REM y axis labels3130 REM w5=increment3140 P$=STR(W4)3150 P=POS(P$,".",1)3160 IF P=0 THEN 31903170 A=P+23180 B1=P-13190 FOR I=W3 TO W4 STEP W53200 MOVE W1,I3210 SCALE 1,13220 RMOVE -0.5*1.55,-0.5*1.883230 P$=STR(I)3240 IF P<>0 THEN 32603250 A=LEN(P$)3260 FOR I2=1 TO A3270 PRINT "";3280 NEXT I23290 IF P=0 THEN 33203300 GOSUB 110403310 GO TO 33603320 IF I=W4 AND D9=1 THEN 33503330 PRINT I3340 GO TO 33603350 PRINT "$";I;3360 WINDOW W1,W2,W3,W43370 VIEWPORT V1,V2,V3,V43380 NEXT I3390 REM ** MAIN TITLES **3400 WINDOW 0,130,0,1003410 VIEWPORT 0,130,0,1003420 MOVE 72,893430 Z$=D$3440 GOSUB 101603450 MOVE 72,923460 Z$=C$3470 GOSUB 101603480 MOVE 72,953490 Z$=B$3500 GOSUB 101603510 MOVE 72,983520 Z$=A$3530 GOSUB 101603540 REM ** Y AXIS TITLE **3550 MOVE 3,533560 K$=J$3570 GOSUB 100603580 MOVE 6,533590 K$=I$3600 GOSUB 100603610 MOVE 9,533620 K$=H$3630 GOSUB 100603640 REM  ** X AXIS LABEL **3650 MOVE 72,113660 Z$=E$3670 GOSUB 101603680 REM ** LEGEND LABELS **3690 MOVE 27,103700 RMOVE -0.5*1.55,-0.5*1.883710 PRINT L$3720 MOVE 27,73730 RMOVE -0.5*1.55,-0.5*1.883740 PRINT F$3750 MOVE 27,43760 RMOVE -0.5*1.55,-0.5*1.883770 PRINT G$3780 WINDOW W1,W2,W3,W43790 VIEWPORT V1,V2,V3,V43800 REM ** SOLID LINE PLOTS **3810 IF M6(1)=0 THEN 39303820 MOVE 1,S(1)3830 FOR I=2 TO 123840 IF S(I)=0 THEN 38603850 GO TO 38803860 MOVE I,S(I)3870 GO TO 39103880 IF S(I-1)<>0 THEN 39003890 MOVE I,S(I)3900 DRAW I,S(I)3910 NEXT I3920 REM  ** DASH LINE ROUTINE **3930 IF M6(2)=0 THEN 39703940 N5=123950 GOSUB 105103960 REM ** BAR ROUTINE **3970 IF M6(3)=0 THEN 41103980 WINDOW W1,W2,W3,W43990 VIEWPORT V1,V2,V3,V44000 W=0.54010 FOR K=1 TO 124020 MOVE K,W34030 RDRAW -0.25,04040 Y=S2(K)4050 IF Y=0 THEN 40904060 WINDOW W1,W2,W3,W44070 VIEWPORT V1,V2,V3,V44080 GOSUB 102304090 NEXT K4100 REM LEGEND DRAW4110 WINDOW 0,130,0,1004120 VIEWPORT 0,130,0,1004130 IF M6(1)=0 THEN 41704140 REM * SOLID LINE *4150 MOVE 20,104160 DRAW 25,104170 IF M6(2)=0 THEN 42504180 REM *DASH *4190 MOVE 20,74200 RDRAW 1,04210 RMOVE 1,04220 RDRAW 1,04230 RMOVE 1,04240 RDRAW 1,04250 IF M6(3)=0 THEN 44804260 REM *BARS*4270 MOVE 21.5,34280 RDRAW 0,24290 RDRAW 2,04300 RDRAW 0,-24310 RDRAW -2,04320 REM *SHADING*4330 M1=M+14340 GO TO M1 OF 4360,4480,44204350 REM *SOLID*4360 FOR I=21.5 TO 23.5 STEP 0.14370 MOVE I,34380 DRAW I,54390 NEXT I4400 GO TO 44804410 REM *CROSS HATCH*4420 MOVE 22.5,34430 DRAW 23.5,44440 MOVE 21.5,34450 DRAW 23.5,54460 MOVE 21.5,44470 DRAW 22.5,54480 PRINT "~^~"4490 INPUT N$4500 IF N$<>"S" THEN 4904510 END10000 REM **********************************************************10010 REM10020 REM                          SUBROUTINES10030 REM10040 REM **********************************************************10050 REM                      *** vert labels sub ***10060 FOR I=1 TO LEN(K$)/210070 PRINT "";10080 NEXT I10090 DIM X$(1)10100 FOR I=1 TO LEN(K$)10110 X$=SEG(K$,I,1)10120 PRINT X$;"
";10130 NEXT I10140 RETURN10150 REM                     *** CENTER TEXT SUB ***10160 L1=LEN(Z$)/210170 FOR I4=1 TO L110180 PRINT "";10190 NEXT I410200 PRINT Z$10210 RETURN10220 REM                      *** SOLID BAR SUB ***10230 DIM B(4,2)10240 INPUT @32,24:B(1,1),B(1,2)10250 DRAW K-0.25,Y10260 INPUT @32,24:B(2,1),B(2,2)10270 RDRAW W,010280 INPUT @32,24:B(3,1),B(3,2)10290 RDRAW 0,-Y10300 INPUT @32,24:B(4,1),B(4,2)10310 DRAW K+0.25,W310320 IF M=1 THEN 1043010330 VIEWPORT B(1,1),B(3,1),B(1,2),B(2,2)10340 MOVE 0,010350 SCALE 1,110360 IF M=2 THEN 1044010370 FOR I=0 TO 6 STEP 0.210380 MOVE I,010390 DRAW I,10010400 NEXT I10410 WINDOW W1,W2,W3,W410420 VIEWPORT V1,V2,V3,V410430 RETURN10440 REM cross hatch10450 FOR I=-10 TO 100 STEP 110460 MOVE 0,I10470 DRAW 100,I+10010480 NEXT I10490 GO TO 1041010500 REM10510 REM                     *** DASH LINE SUB ***10520 REM10530 REM define variables10540 REM n5=no. of points to be plotted10550 REM S1=array of data from main program10560 REM l=dash length in gdu's10570 REM j=counter for plot data10580 REM j1=x axis increment10590 REM10600 REM hor data units per gdu10610 A5=(W2-W1)/(V2-V1)10620 REM vert10630 A6=(W4-W3)/(V4-V3)10640 REM set up counter10650 J=010660 J1=010670 J=J+110680 J1=J1+110690 IF J=N5 THEN 1101010700 IF S1(J)=0 OR S1(J+1)=0 THEN 1067010710 X1=J110720 Y1=S1(J)10730 X2=X1+110740 Y2=S1(J+1)10750 D5=(X2-X1)/A510760 D6=(Y2-Y1)/A610770 D=SQR(D5^2+D6^2)10780 IF D=0 THEN 1067010790 L=0.7510800 U1=L*(D5/D)*A510810 U2=L*(D6/D)*A610820 MOVE X1,Y110830 H=X110840 V=Y110850 F=010860 GOSUB 1095010870 IF F=1 THEN 1093010880 DRAW H,V10890 GOSUB 1095010900 IF F=1 THEN 1093010910 MOVE H,V10920 GO TO 1086010930 DRAW X2,Y210940 GO TO 1067010950 H=H+U110960 V=V+U210970 IF ABS(H-X1)>ABS(X2-X1) THEN 1100010980 IF ABS(V-Y1)>ABS(Y2-Y1) THEN 1100010990 RETURN11000 F=111010 RETURN11020 END11030 REM                     *** Y AXIS DECIMAL SUB ***11040 IF I>W4-W5 AND D9=1 THEN 1106011050 GO TO 1107011060 B1=B1+311070 GO TO B1 OF 11080,11100,11120,11140,11160,11180,11200,1122011080 PRINT USING "1D.2D":I11090 RETURN11100 PRINT USING "2D.2D":I11110 RETURN11120 PRINT USING "3D.2D":I11130 RETURN11140 PRINT USING "4D.2D":I11150 RETURN11160 PRINT USING "$1D.2D":I11170 RETURN11180 PRINT USING "$2D.2D":I11190 RETURN11200 PRINT USING "$3D.2D":I11210 RETURN11220 PRINT USING "$4D.2D":I11230 RETURN