5000 REM * "@TIME3/AREA"5020 REM * DEFINITION CONTROL5021 O=45022 IF U<>3 THEN 51905024 J1=55026 J2=115028 J3=1205030 J4=955031 O0=15032 GO TO 54105190 PRINT "

"5200 GOSUB 60005300 IF K$="S" THEN 54705320 IF K$<>"P" AND K$<>"" THEN 52005330 K$="P"5340 REM PLOT AREA5350 GOSUB 65005370 IF J3<>J1 AND J2<J4 THEN 54005380 GOSUB 72005390 GO TO 52005400 IF J1>J3 THEN 54065402 O0=15404 GO TO 54105406 O0=25410 GOSUB 80005430 GOSUB 120005450 GO TO 55905460 REM SUBPLOT AREA5470 GOSUB 67005480 IF Q3<>Q1 AND Q2<Q4 THEN 55105490 GOSUB 72005500 GO TO 52005510 IF Q1>Q3 THEN 55165512 O0=15514 GO TO 55205516 O0=25520 J$=""5530 GOSUB 75005540 IF J$="ERROR" THEN 52005590 RETURN6000 REM * PLOT OR SUBPLOT6010 PRINT "	             P2      P2"6020 PRINT "	TITLE"6030 PRINT "	        S2		S2"6040 PRINT "




	S1			  S1"6050 PRINT "
        P1			         P1"6060 PRINT "	** NORMAL **	        ** ROTATED 90 **"6100 PRINT @32,21:26.85,916105 PRINT @32,20:17.9,91,17.9,63.34,53.7,63.346110 PRINT @32,20:53.7,91,44.75,91,44.75,69,26.85,696120 PRINT @32,20:26.85,91,44.75,91,44.75,85.9,26.85,85.96130 PRINT @32,21:32.22,696140 PRINT @32,20:32.22,77.46,30.43,77.46,30.43,696150 PRINT @32,20:34.01,69,34.01,74.64,32.22,74.646160 PRINT @32,21:39.38,696170 PRINT @32,20:39.38,77.44,41.17,77.46,41.17,696171 PRINT @32,20:37.59,69,37.59,74.64,39.38,74.646173 PRINT @32,21:75.18,916174 PRINT @32,20:110.98,91,110.98,63.34,75.18,63.34,75.18,916175 PRINT @32,21:85.92,696176 PRINT @32,20:85.92,83.08,82.34,83.08,82.34,69,98.45,69,98.45,83.086177 PRINT @32,20:85.92,83.086178 PRINT @32,21:98.45,74.626179 PRINT @32,20:91.29,74.62,91.26,77.44,98.45,77.44,93.08,77.446180 PRINT @32,20:93.08,80.26,98.45,80.26,98.45,71.8,93.08,71.86181 PRINT @32,20:93.08,74.626209 PRINT @32,21:0,526210 PRINT "DO YOU WANT TO DEFINE THE PLOT OR SUBPLOT AREA(P_/S)? ";6220 INPUT K$6230 PRINT "
DO YOU WANT TO SPECIFY:"6240 PRINT "
1.  BOTTOM LEFT CORNER PLUS WIDTH & HEIGHT IN INCHES"6250 PRINT "
2.  BOTH BOTTOM LEFT AND UPPER RIGHT CORNERS"6260 PRINT "
ENTER NUMBER OF DESIRED OPTION(1/2_)? ";6270 INPUT Z$6271 IF Z$<>"" THEN 62756272 Q=26273 GO TO 62806275 GOSUB 4006276 IF Z<>1 AND Z<>2 THEN 62606278 Q=Z6280 RETURN6500 REM * PLOT POINTS6520 PRINT "
MOVE PLOTTER PEN TO P1 (LOWER LEFT CORNER OF PLOT AREA)"6530 PRINT "AND PRESS 'RETURN'";6550 INPUT I$6560 INPUT @1,24:J1,J26570 PRINT "";6580 IF Q=2 THEN 66106590 GOSUB 70006600 GO TO 66906610 PRINT "
MOVE PLOTTER PEN TO P2 (UPPER RIGHT CORNER OF PLOT AREA)"6620 PRINT "AND PRESS 'RETURN'";6630 INPUT I$6640 PRINT "";6650 INPUT @1,24:J3,J46690 RETURN6700 REM * SUBPLOT POINTS6720 PRINT "
MOVE PLOTTER PEN TO S1 (LOWER LEFT CORNER OF SUBPLOT AREA)"6730 PRINT "AND 'RETURN'";6750 INPUT I$6760 INPUT @1,24:Q1,Q26770 PRINT "";6780 IF Q=2 THEN 68106790 GOSUB 70006800 GO TO 68906810 PRINT "
MOVE PLOTTER PEN TO S2 (UPPER RIGHT CORNER OF PLOT AREA)"6820 PRINT "AND 'RETURN'";6830 INPUT I$6840 PRINT "";6850 INPUT @1,24:Q3,Q46890 RETURN7000 REM * INPUT INCHES7010 PRINT "
NORMAL OR ROTATED 90 DEGREES(N_/R)? ";7012 INPUT J$7014 IF J$<>"N" AND J$<>"R" AND J$<>"" THEN 70107020 PRINT "
ENTER WIDTH DESIRED IN INCHES? ";7040 INPUT J7060 PRINT "ENTER HEIGHT DESIRED IN INCHES? ";7080 INPUT J07085 IF K$="P" THEN 71247090 IF J$="R" THEN 71207100 Q3=Q1+J*107110 Q4=Q2+J0*107119 GO TO 71227120 Q3=Q1-J0*107121 Q4=Q2+J*107122 PRINT @1,21:Q3,Q47123 GO TO 71507124 IF J$="R" THEN 71287125 J3=J1+J*107126 J4=J2+J0*107127 GO TO 71307128 J3=J1-J0*107129 J4=J2+J*107130 PRINT @1,21:J3,J47150 RETURN7200 REM * NOT FEASIBLE7220 PRINT "ERROR - PLOT AREA MUST BE EITHER NORMAL OR ROTATED 90"7260 PRINT "TRY AGAIN ***
"7280 RETURN7500 REM * GIVEN SUBPLOT WILL PLOT FIT ON PLOTTER BED7990 RETURN8000 REM * CALCULATE Z1-Z4 & H0,H1,H28010 Z1=08020 Z2=08030 Z3=08040 Z4=08042 Z5=08046 Z7=08048 Z8=08050 H0=08060 H1=18070 H2=08100 GOSUB 82008110 GOSUB 85008120 GOSUB 95008130 GOSUB 101008140 GOSUB 105008150 IF W<>32 OR L1(1)<>-1 THEN 81608155 Z3=Z3 MAX 158160 RETURN8200 REM * TITLES8230 Z8=0.78240 FOR I=1 TO A08270 IF B1(I)=0 THEN 83708290 Z8=Z8+A(I)*1.28320 Z5=(A(I)*B1(I)-(C1+1))/28330 IF Z5<0 THEN 83708340 Z1=Z1 MAX Z58350 Z3=Z3 MAX Z58370 NEXT I8390 Z4=Z4 MAX Z88410 RETURN8500 REM * SCALED AXIS8540 GOSUB 88008560 Z1=Z1 MAX Z8790 RETURN8800 REM * SCALE LABEL START8810 Z=Y18820 GOSUB 92008830 J0=Z8840 Z=Y38850 GOSUB 92008860 J0=Z MAX J08870 Z=Y28880 GOSUB 90008890 IF Z=0 THEN 89108900 Z=Z+18910 IF Y$=" " THEN 89408920 Z=(Z+J0+3.5)*B08930 GO TO 89508940 Z=(Z+J0+1.2)*B08950 RETURN9000 REM * # OF DECIMAL PLACES9010 FOR I=10 TO 0 STEP -19020 J=10^I*Z9030 K=INT(J)9040 J=J-K9050 IF J>0 AND J<0.999 THEN 90909060 NEXT I9070 Z=09080 GO TO 91009090 Z=I+19100 RETURN9200 REM * # OF DIGITS9210 Z0=INT(LGT(ABS(Z)+1.0E-4))+1 MAX 19220 Z0=Z0+INT((Z0-1)/3)9230 IF Z=>0 THEN 92509240 Z0=Z0+19250 Z=Z09260 RETURN9500 REM * TIME UNITS AXIS9530 IF X$<>" " THEN 95609540 Z5=B0*29550 GO TO 95709560 Z5=3.2*B09570 Z2=Z2 MAX Z59580 Z5=(LEN(X$)*B0-(C1+1))/29590 Z1=Z1 MAX Z59600 Z3=Z3 MAX Z59810 RETURN10100 REM * LEGEND10105 J$=SEG(N$,D0+1,1)10110 IF J$="N" THEN 1049010140 FOR I=1 TO D110150 Z$=SEG(L$,I*L0-L0+1,L0)10180 GOSUB 1150010190 IF LEN(Z$)=0 THEN 1043010200 IF J$<>"R" THEN 1026010220 Z7=(6+LEN(Z$))*L10250 GO TO 1042010260 IF L1(I)=-1 THEN 1043010265 IF J$<>"B" THEN 1031010270 Z7=(L1(I)-1)*(C1+1)+LEN(Z$)*L10280 H=L2(I)10290 GO TO 1041110310 H=(L2(I)-Y1)/(Y3-Y1)10390 Z8=(L1(I)-(Y+N-1+(F=2)))/(N-1+(F=2)*2)10400 Z7=Z8*(C1+1)+(6*(J$="B")+LEN(Z$))*L10410 Z3=Z3 MAX Z710411 IF H<1 OR H<H1 THEN 1041410412 H1=H10413 H0=L10414 IF H>0 OR H>H2 THEN 1043010415 H2=H10420 Z3=Z3 MAX Z710430 NEXT I10490 RETURN10500 REM * EXTRA TEXT10560 FOR I=1 TO S010580 IF R1(I)=0 THEN 1077010610 IF S2(I)>0 AND S2(I)<1 THEN 1070010630 IF S2(I)<=H1 THEN 1066010640 H1=S2(I)10650 H0=R(I)10660 IF S2(I)=>H2 THEN 1070010670 H2=S2(I)10700 Z5=-(C1+1)*S1(I)10710 Z1=Z1 MAX Z510730 Z7=(C1+1)*(S1(I)-1)+R1(I)*R(I)10750 Z3=Z3 MAX Z710770 NEXT I10790 RETURN11500 REM * STRIP TRAILING BLANKS11510 FOR Z=LEN(Z$) TO 1 STEP -111520 I$=SEG(Z$,Z,1)11530 IF I$<>" " THEN 1155011540 NEXT Z11550 Z$=SEG(Z$,1,Z)11560 RETURN12000 REM * CONPUTE O1,O2,P1,P212010 IF O0=2 THEN 1207012020 GOSUB 1220012040 IF (P2-O2)/I4>10 THEN 1209212050 GOSUB 1244012060 GO TO 1209212070 GOSUB 1254012080 IF (O1-P1)/I4>10 THEN 1209212090 GOSUB 1277012092 IF U<>4 THEN 1210012093 Q1=O112094 Q2=O212095 Q3=P112096 Q4=P212100 RETURN12200 REM * WIDTH DEPENDENT (NORMAL)12210 I3=(J3-J1)/(Z1+Z3+C1+1)12220 I4=I3*2.82/1.7912230 O1=J1+Z1*I312240 O2=J2+Z2*I412250 P1=J3-Z3*I312260 P2=J4-Z4*I412270 I2=P2-O212280 IF Z4*I4=>H0*I4+(H1-1)*I2 OR Z2*I4<-H2*I2 THEN 1233012300 REM * ADJUST TOP DOWN12310 P2=O2+(J4-O2-H0*I4)/H112320 GO TO 1243012330 IF Z4*I4<H0*I4+(H1-1)*I2 OR Z2*I4=>-H2*I2 THEN 1238012350 REM * ADJUST BOTTOM UP12360 O2=J2-H2/(1-H2)*(P2-J2)12370 GO TO 1243012380 IF Z4*I4=>H0*I4+(H1-1)*I2 OR Z2*I4=>-H2*I2 THEN 1243012400 REM * ADJUST TOP & BOTTOM IN12410 O2=J2+(J4-J2)*-H2/(H1-H2)12420 P2=J4-(J4-J2)*(H1-1)/(H1-H2)-H0*I412430 RETURN12440 REM * HEIGHT DEPENDENT (NORMAL)12460 I4=(J4-J2)/(10+(Z4 MAX H0+(H1-1)*10)+(Z2 MAX -H2*10))12470 I3=I4*1.79/2.8212480 K0=(J3-J1-(Z1+Z3+C1+1)*I3)/212490 O1=J1+K0+Z1*I312500 O2=J2+(Z2 MAX -H2*10)*I412510 P1=J3-K0-Z3*I312520 P2=J4-(Z4 MAX H0+(H1-1)*10)*I412530 RETURN12540 REM * WIDTH DEPENDENT (ROTATED 90)12550 I3=(J4-J2)/(Z1+Z3+C1+1)12560 I4=I3*2.82/1.7912570 O1=J1-Z2*I412580 O2=J2+Z1*I312590 P1=J3+Z4*I412600 P2=J4-Z3*I312610 I2=O1-P112620 IF Z4*I4=>H0*I4+(H1-1)*I2 OR Z2*I4<-H2*I2 THEN 1267012640 REM * ADJUST TOP DOWN12650 P1=O1-(O1-J3-H0*I4)/H112660 GO TO 1276012670 IF Z4*I4<H0*I4+(H1-1)*I2 OR Z2*I4=>-H2*I2 THEN 1272012690 REM * ADJUST BOTTOM UP12700 O1=P1+(J1-P1)/(1-H2)12710 GO TO 1276012720 IF Z4*I4=>H0*I4+(H1-1)*I2 OR Z2*I4=>-H2*I2 THEN 1276012730 REM * ADJUST TOP & BOTTOM IN12740 O1=J1-(J1-J3-H0*I4)*-H2/(H1-H2)12750 P1=J1-(J1-J3-H0*I4)*(1-H2)/(H1-H2)12760 RETURN12770 REM * HEIGHT DEPENDENT (ROTATED 90)12780 I4=(J1-J3)/(10+(Z4 MAX H0+(H1-1)*10)+(Z2 MAX -H2*10))12800 I3=I4*1.79/2.8212810 K0=(J4-J2-(Z1+Z3+C1+1)*I3)/212820 O1=J1-(Z2 MAX -H2*10)*I412830 O2=J2+K0+Z1*I312840 P1=J3+(Z4 MAX H0+(H1-1)*10)*I412850 P2=J4-K0-Z3*I312860 INPUT I$12870 RETURN