100 REM FILE#4 OF THE DEVELOPEMENT TAPE110 INIT 120 PAGE 130 PRINT "                   THIS PROGRAM PLAYS NIM."140 PRINT "  DO YOU WANT INSTRUCTIONS ?  ";150 INPUT Q$160 IF Q$="YES" THEN 200170 IF Q$="NO" THEN 310180 PRINT "TYPE YES OR NO"190 GO TO 150200 PRINT 210 PRINT "     NIM IS PLAYED BY TWO PEOPLE PLAYINGALTERNATELY.BEFORE"220 PRINT "THE PLAY STARTS, AN ARBITRARY NUMBER OF STICKS OR OBJECTS IS"230 PRINT "PUT INTO AN ARBITRARY NUMBER OF PILES,IN ANY DISTRIBUTION"240 PRINT "WHATEVER. THEN EACH PLAYER IN TURN REMOVES AS MANY"250 PRINT "STICKS AS THEY WISH FROM ANY PILE--BUT FROM ONLY ONE PILE,"260 PRINT "AND AT LEAST ONE STICK. THE PLAYER WHO TAKES THE LAST STICK"270 PRINT "IS THE WINNER"280 PRINT "  THIS PROGRAM ALLOWS YOU TO SET UP THE INITIAL ARRANGEMENT"290 PRINT "OF PILES AND STICKS. IT WILL NOT ACCEPT MORE THAN TWENTY";300 PRINT " PILES OR STICKS"310 REM THIS IS WHERE THE RANDOM WENT320 REM----------------CONFIGURATION INPUT---------------------330 DIM X(20,5),S(20),L(20),S2(20),N2(4),C(20),S3(20),V(20)340 G=0350 S2=0360 PRINT " HOW MANY PILES ";370 INPUT P380 IF P>20 THEN 400390 GO TO 420400 PRINT "ILLEGAL PILE NUMBER"410 GO TO 370420 PRINT 430 FOR I=1 TO P440 PRINT "HOW MANY STICKS IN PILE  ",I,"";450 INPUT L(I)460 IF L(I)<20 THEN 490470 PRINT "ILLEGAL STICK NUMBER";480 GO TO 450490 NEXT I500 FOR I=1 TO P510 S(I)=L(I)520 G=G+L(I)530 NEXT I540 PRINT " DO YOU WANT TO GO FIRST  ";550 INPUT Q$560 IF Q$="YES" THEN 840570 GO TO 1050580 REM-----CONTROL OF GAME REPEATS AND TESTS FOR END OF GAME------"590 IF G=0 THEN 620600 IF F=1 THEN 1060610 GO TO 780620 IF F=1 THEN 760630 PRINT " I WON!!!    DO YOU WANT TO PLAY AGAIN??  ";640 INPUT Q$650 IF Q$="YES" THEN 720660 IF Q$="NO" THEN 690670 PRINT "TYPE 'YES OR 'NO' "680 GO TO 640690 FIND 1700 OLD 710 RUN 720 PRINT " SAME ARRANGEMENT   ";730 INPUT Q$740 IF Q$="NO" THEN 340750 GO TO 500760 PRINT " YOU WON !!!!DO YOU WANT TO PLAY AGAIN??  ";770 GO TO 640780 PRINT " PILE NUMBER","STICKS LEFT"790 FOR I=1 TO P800 IF S(I)=0 THEN 820810 PRINT I,S(I)820 NEXT I830 REM---------------------PLAYERS MOVE--------------------------840 PRINT " WHICH PILE DO YOU WANT STICKS FROM ";850 INPUT N860 IF N>P THEN 910870 IF N>INT(N) THEN 910880 IF N<=0 THEN 910890 IF S(N)=0 THEN 910900 GO TO 930910 PRINT "ILLEGAL NUMBER"920 GO TO 850930 PRINT " HOW MANY STICKS  ";940 INPUT T950 IF T>S(N) THEN 990960 IF T>INT(T) THEN 990970 IF T<=0 THEN 990980 GO TO 1010990 PRINT " ILLEGAL STICK NUMBER "1000 GO TO 9401010 S(N)=S(N)-T1020 G=G-T1030 F=11040 GO TO 5901050 REM --------------------MACHINE'S MOVE-----------------------1060 FOR I=1 TO 51070 V(I)=01080 NEXT I1090 PAGE 1100 FOR I=1 TO P1110 C(I)=S(I)1120 FOR E=4 TO 0 STEP -11130 IF S(I)<2^E THEN 11601140 S2(I)=S2(I)+10^E1150 S(I)=S(I)-2^E1160 NEXT E1170 FOR Y=4 TO 0 STEP -11180 X(I,Y+1)=INT(S2(I)/10^Y)1190 S2(I)=S2(I)-X(I,Y+1)*10^Y1200 V(Y+1)=V(Y+1)+X(I,Y+1)1210 NEXT Y1220 NEXT I1230 R=01240 FOR Y=4 TO 0 STEP -11250 IF V(Y+1)/2-INT(V(Y+1)/2)=0 THEN 13601260 IF R=1 THEN 13201270 Q=INT(P*RND(-1)+1)1280 IF X(Q,Y+1)<>1 THEN 12601290 X(Q,Y+1)=01300 R=11310 GO TO 13601320 IF X(Q,Y+1)=1 THEN 13501330 X(Q,Y+1)=11340 GO TO 13601350 X(Q,Y+1)=01360 NEXT Y1370 FOR I=1 TO P1380 S2(I)=01390 FOR Y=4 TO 0 STEP -11400 S3(I)=X(I,Y+1)*10^Y1410 S2(I)=S2(I)+S3(I)1420 NEXT Y1430 FOR E=4 TO 0 STEP -11440 IF S2(I)<10^E THEN 14701450 S(I)=S(I)+2^E1460 S2(I)=S2(I)-10^E1470 NEXT E1480 NEXT I1490 IF R=1 THEN 15301500 Q=INT(P*RND(-1)+1)1510 IF S(Q)=0 THEN 14901520 S(Q)=S(Q)-11530 D=C(Q)-S(Q)1540 G=G-D1550 IF D=1 THEN 15801560 PRINT "I'LL TAKE ";D;" STICKS FROM PILE ";Q;"."1570 GO TO 15901580 PRINT " I'LL TAKE ONE STICK FROM PILE ";Q;"."1590 F=01600 GO TO 5901610 END 