10000 REM        4010 FAMILY UTILITIES in 4050 BASIC10010 REM            Ed Sawicki - Tektronix Inc.10020 REM    +--------------------------------------------------+10030 REM    |              TABDEC10                            |10040 REM    |  Convert tablet data to decimal ordinates        |10050 REM    |                                                  |10060 REM    |  Enter with 4 bytes of tablet data in I$         |10070 REM    |           ( HIY,LOY,HIX,LOX )                    |10080 REM    |  Exit with decimal ordinates in X & Y            |10090 REM    |              ( 1024 X 1024 )                     |10100 REM    |  Uses X$ as a temporary variable                 |10110 REM    +--------------------------------------------------+10120 REM  Compute Y ordinate10130 X$=SEG(I$,1,1)10140 Y=(ASC(X$)-32)*3210150 X$=SEG(I$,2,1)10160 Y=ASC(X$)-32+Y10170 REM  Compute X ordinate10180 X$=SEG(I$,3,1)10190 X=(ASC(X$)-32)*3210200 X$=SEG(I$,4,1)10210 X=ASC(X$)-32+X10220 RETURN 10230 REM    +--------------------------------------------------+10240 REM    |                TABDEC12                          |10250 REM    |   Convert tablet data to decimal ordinates       |10260 REM    |                                                  |10270 REM    |   Enter with 5 bytes of tablet data in I$        |10280 REM    |          ( HIY,XLOY,LOY,HIX,LOX )                |10290 REM    |   Exit with decimal ordinates in X & Y           |10300 REM    |                ( 4096 X 4096 )                   |10310 REM    |   Uses X$ and T for temporary variables          |10320 REM    +--------------------------------------------------+10330 X$=SEG(I$,1,1)10340 Y=(ASC(X$)-32)*12810350 X$=SEG(I$,3,1)10360 Y=(ASC(X$)-32)*4+Y10370 X$=SEG(I$,4,1)10380 X=(ASC(X$)-32)*12810390 X$=SEG(I$,5,1)10400 X=(ASC(X$)-32)*4+X10410 X$=SEG(I$,2,1)10420 T=ASC(X$)10430 IF T/2=INT(T/2) THEN 1046010440 X=X+110450 T=T-110460 IF T/4=INT(T/4) THEN 1049010470 X=X+210480 T=T-210490 IF T/8=INT(T/8) THEN 1052010500 Y=Y+110510 T=T-410520 IF T=32 THEN 1054010530 Y=Y+210540 RETURN 10550 REM    +--------------------------------------------------+10560 REM    |               DECGRAF12                          |10570 REM    |  Convert X,Y to 401X graph mode data - 12 Bit    |10580 REM    |                                                  |10590 REM    |  Enter with decimal ordinates in X & Y           |10600 REM    |              ( 4096 X 4096 )                     |10610 REM    |  Exit with graph mode data in X$                 |10620 REM    |          ( HIY,XLOY,LOY,HIX,LOX )                |10630 REM    |  Uses Y$ as a temporary variable                 |10640 REM    +--------------------------------------------------+10650 X$=CHR(INT(Y/128)+32)10660 Y$=CHR((Y-INT(Y/4)*4)*4+(X-INT(X/4)*4)+96)10670 X$=X$&Y$10680 Y$=CHR(INT(Y/4-INT(Y/128)*32)+96)10690 X$=X$&Y$10700 Y$=CHR(INT(X/128)+32)10710 X$=X$&Y$10720 Y$=CHR(INT(X/4-INT(X/128)*32)+64)10730 X$=X$&Y$10740 RETURN 10750 REM    +--------------------------------------------------+10760 REM    |                 DECGRAF10                        |10770 REM    |   Convert X,Y to 401X graph mode data - 10 Bit   |10780 REM    |                                                  |10790 REM    |  Enter with decimal ordinates in X & Y           |10800 REM    |              ( 1024 X 1024 )                     |10810 REM    |  Exit with graph mode data in X$                 |10820 REM    |       ( HIY,LOY,HIX,LOX )                        |10830 REM    |  Uses Y$ as a temporary variable                 |10840 REM    +--------------------------------------------------+10850 X$=CHR(INT(Y/32)+32)10860 Y$=CHR(INT(Y-INT(Y/32)*32)+96)10870 X$=X$&Y$10880 Y$=CHR(INT(X/32)+32)10890 X$=X$&Y$10900 Y$=CHR(INT(X-INT(X/32)*32)+64)10910 X$=X$&Y$10920 RETURN 10930 REM    +--------------------------------------------------+10940 REM    |                 OPTGRAF10                        |10950 REM    |   Convert X,Y to graph mode data - 10 Bit        |10960 REM    |          with SHORTENED ADDRESSING               |10970 REM    |  Enter with decimal ordinates in X & Y           |10980 REM    |              ( 1024 X 1024 )                     |10990 REM    |  Exit with graph mode data in X$                 |11000 REM    |    Z$ is `old' address                           |11010 REM    |  Uses Y$,V$,W$ and S9 as temporary variables     |11020 REM    +--------------------------------------------------+11030 X$=""11040 S9=011050 REM      --- Do High Y ---11060 W$=CHR(INT(Y/32)+32)11070 V$=SEG(Z$,1,1)11080 IF W$=V$ THEN 1111011090 X$=W$11100 REM      --- Now Low Y ---11110 Y$=CHR(INT(Y-INT(Y/32)*32)+96)11120 V$=SEG(Z$,2,1)11130 W$=W$&Y$11140 IF Y$=V$ THEN 1118011150 S9=111160 X$=X$&Y$11170 REM      --- Then High X ---11180 Y$=CHR(INT(X/32)+32)11190 W$=W$&Y$11200 V$=SEG(Z$,3,1)11210 IF Y$=V$ THEN 1127011220 X$=X$&Y$11230 IF S9=1 THEN 1127011240 Y$=CHR(INT(Y-INT(Y/32)*32)+96)11250 X$=REP(Y$,LEN(X$),0)11260 REM      --- Finally Low X ---11270 Y$=CHR(INT(X-INT(X/32)*32)+64)11280 W$=W$&Y$11290 X$=X$&Y$11300 IF W$<>Z$ THEN 1132011310 X$=""11320 Z$=W$11330 RETURN 11340 REM    +--------------------------------------------------+11350 REM    |                 OPTGRAF12                        |11360 REM    |   Convert X,Y to graph mode data - 12 Bit        |11370 REM    |          with SHORTENED ADDRESSING               |11380 REM    |  Enter with decimal ordinates in X & Y           |11390 REM    |              ( 4096 X 4096 )                     |11400 REM    |  Exit with graph mode data in X$                 |11410 REM    |    Z$ is `old' address                           |11420 REM    |  Uses Y$,V$,W$ and S9 as temporary variables     |11430 REM    +--------------------------------------------------+11440 X$=""11450 S8=011460 S9=011470 REM      --- Do High Y ---11480 W$=CHR(INT(Y/128)+32)11490 V$=SEG(Z$,1,1)11500 IF W$=V$ THEN 1153011510 X$=W$11520 REM      --- And XLOY ---11530 Y$=CHR((Y-INT(Y/4)*4)*4+(X-INT(X/4)*4)+96)11540 W$=W$&Y$11550 V$=SEG(Z$,2,1)11560 IF Y$=V$ THEN 1160011570 S8=111580 X$=X$&Y$11590 REM      --- Now Low Y ---11600 Y$=CHR(INT(Y/4-INT(Y/128)*32)+96)11610 W$=W$&Y$11620 V$=SEG(Z$,3,1)11630 IF Y$=V$ AND S8=0 THEN 1170011640 S9=111650 X$=X$&Y$11660 IF S8=1 THEN 1170011670 Y$=CHR((Y-INT(Y/4)*4)*4+(X-INT(X/4)*4)+96)11680 X$=REP(Y$,LEN(X$),0)11690 REM      --- Then High X ---11700 Y$=CHR(INT(X/128)+32)11710 W$=W$&Y$11720 V$=SEG(Z$,4,1)11730 IF Y$=V$ THEN 1179011740 X$=X$&Y$11750 IF S9=1 THEN 1179011760 Y$=CHR(INT(Y/4-INT(Y/128)*32)+96)11770 X$=REP(Y$,LEN(X$),0)11780 REM      --- Finally Low X ---11790 Y$=CHR(INT(X/4-INT(X/128)*32)+64)11800 W$=W$&Y$11810 X$=X$&Y$11820 IF W$<>Z$ THEN 1184011830 X$=""11840 Z$=W$11850 RETURN 11860 REM    +--------------------------------------------------+11870 REM    |                 GINGRAF10                        |11880 REM    |       Convert GIN data to GRAPH data  - 10 Bit   |11890 REM    |                                                  |11900 REM    |    Enter with GIN data in I$                     |11910 REM    |    Exit with graph data in Y$                    |11920 REM    |       ( HIY,LOY,HIX,LOX )                        |11930 REM    |    Uses X$ as a temporary variable               |11940 REM    +--------------------------------------------------+11950 X$=SEG(I$,4,1)11960 X$=CHR(ASC(X$)+64)11970 Y$=REP(X$,2,1)11980 X$=SEG(I$,2,1)11990 X$=CHR(ASC(X$)+32)12000 Y$=REP(X$,4,1)12010 X$=SEG(I$,1,1)12020 Y$=REP(X$,3,1)12030 X$=SEG(I$,3,1)12040 Y$=REP(X$,1,1)12050 RETURN 12060 REM    +--------------------------------------------------+12070 REM    |                 GINDEC10                         |12080 REM    |    Convert GIN data to decimal ordinates         |12090 REM    |                                                  |12100 REM    |    Enter with GIN data in I$                     |12110 REM    |    Exit with decimal ordinates in X & Y          |12120 REM    |         ( 1024 X 1024 )                          |12130 REM    |                                                  |12140 REM    +--------------------------------------------------+12150 REM  Compute Y ordinate12160 X$=SEG(I$,3,1)12170 Y=(ASC(X$)-32)*3212180 X$=SEG(I$,4,1)12190 Y=ASC(X$)-32+Y12200 REM  Compute X ordinate12210 X$=SEG(I$,1,1)12220 X=(ASC(X$)-32)*3212230 X$=SEG(I$,2,1)12240 X=ASC(X$)-32+X12250 RETURN 12260 REM    +--------------------------------------------------+12270 REM    |                 GETGIN                           |12280 REM    |  Get GIN data and check if legal                 |12290 REM    |                                                  |12300 REM    |   Returns with keyboard character in K$ and      |12310 REM    |    GIN data in I$. E9 is returned as zero if     |12320 REM    |    data is OK and one if error.                  |12330 REM    |   Uses I9 and X$ as temporary variables          |12340 REM    +--------------------------------------------------+12350 REM12360 E9=012370 INPUT @40:I$12380 IF LEN(I$)=0 THEN 1243012390 K$=SEG(I$,1,1)12400 I$=REP("",1,1)12410 IF ASC(K$)=4 AND LEN(I$)=5 THEN 1239012420 IF LEN(I$)=4 THEN 1245012430 E9=112440 GO TO 1250012450 FOR I9=1 TO 412460 X$=SEG(I$,I9,1)12470 IF ASC(X$)<64 AND ASC(X$)>31 THEN 1249012480 E9=112490 NEXT I912500 RETURN 