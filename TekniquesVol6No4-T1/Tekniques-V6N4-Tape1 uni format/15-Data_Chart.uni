3 GO TO 1004 GO TO 50020 D=3221 PAGE 22 GO TO 2015024 GO TO 21010100 REM  *****************************************************101 REM  *****************************************************104 REM  ******          DATA CHART PROGRAM           ********105 REM  ******      DEVELOPED BY HAYWARD HULICK      ********106 REM  ******    1982  NEW CUMBERLAND ARMY DEPOT    ********107 REM  *****************************************************108 REM  *****************************************************110 INIT 115 SET KEY 120 DIM X(4,15),A$(290),L$(51),F$(41),Y(4,6),M$(106)130 DIM Y$(1)165 Z=0170 M=0180 X=-1.0E+305190 L$="                                        Scale Note*"200 F$="C8D       C8D       C8D       C8D       *"210 A$=""220 FOR I=1 TO 4230 A$=A$&"                                                           "232 A$=A$&"             "240 NEXT I250 A$=A$&"**"260 Y=1290 S0=0295 S1=0297 S2=0300 L=4310 P=4320 M$="  JAN    FEB    MAR    APR    MAY    JUN    JUL    AUG  "330 M$=M$&"  SEP    OCT    NOV    DEC    JAN    FEB    MAR  "340 IF M THEN 1200500 REMARK *************  MAIN MENU **********************510 PRINT "	       MAIN MENU_________"520 PRINT "




	PLOT CHART          (1)"530 PRINT "	
LOOK/CHANGE         (2)"540 PRINT "	
STORE FILE          (3)"550 PRINT "	
RECALL FILE         (4)"560 PRINT "	
CREATE NEW CHART    (5)"570 PRINT "	
FINISHED            (6)



"580 PRINT "
	     Which #?:";590 INPUT Z$592 Z$=Z$&",0"594 M=VAL(Z$)595 Z=0597 K=0600 GO TO M OF 20000,1000,11000,11235,180,620610 GO TO 500620 PRINT "

	GOODBYE."630 FOR I=1 TO RND(0)*1000640 NEXT I650 PAGE 660 END 1000 REM **************  LIST OR CHANGE  *****************1005 IF Z<>0 THEN 12301010 PRINT "	        LOOK / CHANGE_____________"1020 PRINT "


	TITLE                      (1)"1030 PRINT "
	PERIODS (X AXIS)           (2)"1040 PRINT "
	SCALE                      (3)"1050 PRINT "
	LINE HEADINGS              (4)"1060 PRINT "
	SOURCE OF DATA             (5)"1070 PRINT "
	STYLE OF PLOT              (6)"1080 PRINT "
	DATA                       (7)"1090 PRINT "
	DECIMALS PRINTED           (8)"1092 PRINT "
	# OF DATA LINES            (9)

"1094 PRINT "
	 PRESS RETURN FOR MAIN MENU 


"1100 PRINT "
	     Which #?:";1110 INPUT Z$1115 Z$=Z$&",0"1117 K=VAL(Z$)1120 GO TO K OF 2000,3400,4000,5000,6500,7500,8000,10000,45001130 GO TO 5001200 REM  *******  NEW CHART  *******1210 FOR Z=1 TO 91220 GO TO Z OF 2000,3000,4000,4500,5000,6000,8000,10000,110001230 NEXT Z1240 GO TO 5002000 REM  ******************  TITLE  *************************2010 PRINT "	CHART TITLE



"2070 FOR I=1 TO 42080 B$=SEG(A$,(I-1)*72+1,Y(I,1))2090 PRINT "(";I;")		    ";2100 FOR J=1 TO LEN(B$)/22110 PRINT "";2120 NEXT J2130 PRINT B$;"
"2140 NEXT I2150 GOSUB 120002160 IF I=0 THEN 10002200 FOR X1=0 TO 64 STEP 82210 A$=REP("        ",(I-1)*72+X1+1,8)2220 NEXT X12230 GOSUB 22502240 GO TO 20102250 PRINT "
TITLE LINE ";I;":";2260 INPUT B$2270 A$=REP(B$,(I-1)*72+1,LEN(B$))2280 Y(I,1)=LEN(B$)2290 RETURN 3000 REM  ****************   PERIODS  ******************3010 PRINT "	PERIODS"3020 PRINT "

	HOW MANY PERIODS? (X AXIS) (15 MAXIMUM):";3030 INPUT P3040 IF P<1 OR P>15 THEN 30203050 PRINT "

	MONTHS (1), QUARTERS (2), OR OTHER (3)?:";3060 INPUT I3070 GO TO I OF 3080,3190,32303080 M$="  JAN    FEB    MAR    APR    MAY    JUN    JUL    AUG  "3090 M$=M$&"  SEP    OCT    NOV    DEC  "3100 PRINT "

	STARTING MONTH? # (1=JAN,2=FEB,ETC.):";3110 INPUT M3120 IF M=1 THEN 33403130 FOR I=1 TO M-13140 B$=SEG(M$,1,7)3150 M$=REP("",1,7)3160 M$=M$&B$3170 NEXT I3180 GO TO 33403190 M$="1st QTR2nd QTR3rd QTR4th QTR"3210 PRINT "

	STARTING QUARTER? # (1-4):";3220 GO TO 31103230 PRINT "
	7 SPACES MAX FOR EACH LABEL."3232 M$=""3240 FOR M=1 TO P3245 M$=M$&"       "3247 GOSUB 32503248 NEXT M3249 GO TO 33403250 PRINT "
 PERIOD ";M;" LABEL:_______";3260 INPUT B$3270 IF LEN(B$)=>7 THEN 33203300 B$=B$&" "3310 GO TO 32703320 B$=SEG(B$,1,7)3325 M$=REP(B$,(M-1)*7+1,7)3330 RETURN 3340 REMARK *****  ADD PERIODS IF P<15 ******************3360 J=03365 IF LEN(M$)=105 THEN 33923370 B$=SEG(M$,J*7+1,7)3380 M$=M$&B$3390 J=J+13391 GO TO 33653392 M$=M$&"*"3395 IF Z THEN 10003397 GO TO 34103400 REM  ****************  LIST PERIODS  ********************3401 PRINT "


	YOU HAVE ";P;" PERIODS."3402 PRINT "
	CHANGE IT? (Y/N) : ";3403 INPUT Y$3404 IF Y$<>"Y" THEN 34103405 PRINT "

	HOW MANY PERIODS?:";3406 INPUT P3407 IF P>15 OR P<1 THEN 34053410 PRINT "	        PERIODS

"3420 FOR I=1 TO P3430 IF I<>9 THEN 34503440 PRINT "

"3450 B$=SEG(M$,(I-1)*7+1,7)3460 IF I<9 THEN 34803470 PRINT "		";3480 PRINT USING "L,7A,2D,9A,7A":"PERIOD ";I;" LABEL: ";B$3490 NEXT I3500 PRINT USING "FA,20L,FA,S":"","	Change (#,A=All,or 0/RETURN=none)"3510 INPUT Z$3515 IF Z$="A" THEN 30403520 Z$=Z$&",0"3530 M=VAL(Z$)3540 IF M=0 THEN 10003580 GOSUB 32503590 GO TO 34104000 REM  *****************  SCALE  *******************************4010 PRINT "		SCALE


"4020 I=04030 PRINT "

	  (1)  MINIMUM: ";4040 IF I THEN 40704050 PRINT S04060 GO TO 40904070 INPUT S04080 GO TO 40004090 PRINT "

	  (2)  MAXIMUM: ";4100 IF I THEN 41304110 PRINT S14120 GO TO 41504130 INPUT S14140 GO TO 40004150 PRINT "

	  (3) INTERVAL: ";4160 IF I THEN 41904170 PRINT S24180 GO TO 42104190 INPUT S24195 S2=ABS(S2)4200 GO TO 40004210 PRINT "

	  (4) SCALE NOTE: ";4220 IF I THEN 42604230 B$=SEG(L$,41,10)4240 PRINT B$4250 GO TO 43404260 PRINT "(10 CHARACTERS MAX):";4270 INPUT B$4280 IF LEN(B$)=>10 THEN 43104290 B$=B$&" "4300 GO TO 42804310 B$=SEG(B$,1,10)4315 L$=REP(B$,41,10)4320 IF I THEN 40004340 GOSUB 120004390 GO TO I OF 4030,4090,4150,42104400 IF S0>S1 THEN 44204410 GO TO 10004420 X1=S04430 S0=S14440 S1=X14450 GO TO 10004500 PRINT "	    NUMBER OF LINES"4520 PRINT "





	CURRENTLY ";L;" LINES OF DATA. "4560 PRINT "


	# DATA LINES? (RETURN=No change): ";4570 INPUT Z$4580 Z$=Z$&",0"4590 I=VAL(Z$)4600 GO TO I+1 OF 10004630 L=I4640 GO TO 45005000 REM *****************  LINE HEADINGS  **********************5010 PRINT "	   LINE HEADINGS (10 Char max)"5020 FOR I=1 TO L5030 PRINT "

	LINE ";I;" HEADING:";5050 B$=SEG(L$,(I-1)*10+1,10)5060 PRINT B$5070 GO TO 51305130 NEXT I5150 GOSUB 120005160 IF I=0 THEN 10005210 PRINT "

	LINE ";I;" NEW HEADING:__________";5220 INPUT B$5230 IF LEN(B$)=>10 THEN 52605240 B$=B$&" "5250 GO TO 52305260 B$=SEG(B$,1,10)5265 L$=REP(B$,(I-1)*10+1,10)5270 GO TO 50106000 REM  *************   SOURCE         **********************6010 FOR I=1 TO L6020 PRINT "	

 SOURCE OF DATA FOR LINE ";I;"  :
"6030 PRINT "    (1)  DATA FROM KEYBOARD"6035 IF L=1 THEN 63806040 PRINT "    (2)  TRENDLINE"6050 PRINT "    (3)  LINE MINUS LINE "6060 PRINT "    (4)  LINE / LINE"6070 PRINT "    (5)  PERCENT"6080 PRINT "
    YOUR CHOICE:";6090 INPUT Y(I,2)6100 IF Y(I,2)>1 THEN 61206110 GO TO 63806120 GO TO Y(I,2)-1 OF 6130,6180,6280,62806130 PRINT "

 OF WHICH LINE OF DATA?:";6140 INPUT Y(I,3)6150 IF Y(I,3)<=L AND Y(I,3)<>I THEN 63806160 GOSUB 64106170 GO TO 61306180 PRINT "

 SUBTRACT LINE #:";6190 INPUT Y(I,4)6200 IF Y(I,4)<=L AND Y(I,4)<>I THEN 62306210 GOSUB 64106220 GO TO 61806230 PRINT "	      FROM LINE #:";6240 INPUT Y(I,3)6250 IF Y(I,3)<=L AND Y(I,3)<>I THEN 63806260 GOSUB 64106270 GO TO 62306280 PRINT "

DIVIDE LINE #:";6290 INPUT Y(I,3)6300 IF Y(I,3)<=L AND Y(I,3)<>I THEN 63306310 GOSUB 64106320 GO TO 62806330 PRINT "	      BY LINE #:";6340 INPUT Y(I,4)6350 IF Y(I,4)<=L AND Y(I,4)<>I THEN 63806360 GOSUB 64106370 GO TO 63306380 IF Z=0 THEN 65006390 GO TO 70006400 NEXT I6405 GO TO 10006410 PRINT "
	SORRY. IMPOSSIBLE!


"6420 RETURN 6500 REM  *******************  LIST SOURCE  *****************6510 PRINT "	     SOURCE


"6520 FOR I=1 TO L6530 GO TO Y(I,2) OF 6620,6640,6670,6740,68106540 PRINT "
	LINE ";I;" IS ";B$6550 NEXT I6560 GOSUB 120006570 IF I=0 THEN 90006605 PRINT "

"6610 GO TO 60306620 B$="INPUT FROM KEYBOARD"6630 GO TO 65406640 Z$=STR(Y(I,3))6650 B$="TREND OF LINE"&Z$6660 GO TO 65406670 B$="LINE"6680 Z$=STR(Y(I,3))6690 B$=B$&Z$6700 B$=B$&" MINUS LINE"6710 Z$=STR(Y(I,4))6720 B$=B$&Z$6730 GO TO 65406740 B$="LINE"6750 Z$=STR(Y(I,3))6760 B$=B$&Z$6770 B$=B$&"/ LINE"6780 Z$=STR(Y(I,4))6790 B$=B$&Z$6800 GO TO 65406810 B$="LINE"6820 Z$=STR(Y(I,3))6830 B$=B$&Z$6840 B$=B$&" PERCENT OF LINE"6850 Z$=STR(Y(I,4))6860 B$=B$&Z$6870 GO TO 65407000 REM  *******  TYPE LINE  ************7020 PRINT "

"7030 PRINT "

		         STYLE FOR LINE ";I;":"7040 PRINT "		           NOT PLOTTED   (0)"7050 PRINT "			LINE   (1)"7060 PRINT "			 BAR   (2)"7070 PRINT "
		          YOUR CHOICE:";7080 INPUT Y(I,5)7090 IF Y(I,5)=0 THEN 72507100 IF Y(I,5)=2 THEN 71907110 PRINT "





		         LINE STYLE 
"7120 PRINT "		             SOLID LINE   (1)"7130 PRINT "		   - - - -  DASHED LINE   (2)"7140 PRINT "		   .......  DOTTED LINE   (3)"7150 PRINT "		    - . - DASH/DOT LINE   (4)"7160 PRINT "		
          YOUR CHOICE:";7170 INPUT Y(I,6)7180 GO TO 72507190 PRINT "






		          BAR STYLE 
"7200 PRINT "			OPEN BOX   (1)"7210 PRINT "			SOLID BOX   (2)"7220 PRINT "		         VERTICAL LINES   (3)"7230 PRINT "		       HORIZONTAL LINES   (4)"7240 GO TO 71607250 IF Z=0 THEN 75007260 GO TO 64007500 REM  ********************   LIST  STYLE/SOURCE  *************7510 PRINT "	     STYLE


"7520 FOR I=1 TO L7550 GOSUB Y(I,5)+1 OF 7640,7660,77507560 PRINT "
    LINE ";I;" IS ";B$7570 NEXT I7580 GOSUB 120007590 IF I=0 THEN 10007630 GO TO 70007640 B$="NOT PLOTTED"7650 RETURN 7660 GO TO Y(I,6) OF 7670,7690,7710,77307670 B$="A SOLID LINE"7680 RETURN 7690 B$="A DASHED LINE"7700 RETURN 7710 B$="A DOTTED LINE"7720 RETURN 7730 B$="A DASH/DOT LINE"7740 RETURN 7750 GO TO Y(I,6) OF 7760,7780,7800,78207760 B$="AN OPEN BAR"7770 RETURN 7780 B$="A SOLID BAR"7790 RETURN 7800 B$="A VERTICAL LINE BAR"7810 RETURN 7820 B$="A HORIZONTAL LINE BAR"7830 RETURN 8000 REM *******    INPUT/ LIST/CHANGE   DATA  **********8010 PRINT "		DATA"8020 K=08030 X1=18040 X2=L8050 B$="            "8060 FOR I=X1 TO X28065 IF Y(I,2)<>1 AND Z THEN 82408070 HOME 8080 Z$=SEG(L$,(I-1)*10+1,10)8090 PRINT "

";B$;" LINE ";I;"
";Z$;"

"8100 FOR J=1 TO P8110 IF I>X1 THEN 81408120 Z$=SEG(M$,(J-1)*7+1,7)8130 PRINT USING "2D,2X,7A,A":J,Z$,""8140 PRINT B$;8150 IF Z OR K THEN 82108160 IF X(I,J)<-1.0E+300 THEN 81908165 Z$=SEG(F$,(I-1)*10+1,10)8170 PRINT USING Z$:X(I,J)8180 GO TO 82208190 PRINT 8200 GO TO 82208210 GOSUB 84508220 NEXT J8230 B$=B$&"               "8240 NEXT I8250 IF Z=0 AND K THEN 80008260 IF Z THEN 90008270 PRINT "

       Change Line #?:(0 or RETURN=None):";8280 INPUT Z$8290 Z$=Z$&",0"8300 I=VAL(Z$)8310 IF I=0 THEN 90008315 K=18320 PRINT "
	Period#? (RETURN=All): ";8330 INPUT Z$8340 Z$=Z$&",0"8350 J=VAL(Z$)8360 IF J=0 THEN 84008370 PRINT "
	New value : ";8380 GOSUB 84508390 GO TO 80008400 X1=I8410 X2=I8430 PAGE 8440 GO TO 80508450 REM********   INPUT SUBROUTINE  *******8460 INPUT Z$8470 Z$=Z$&",-1E+305"8490 X(I,J)=VAL(Z$)8500 RETURN 9000 REMARK ***********  COMPUTATIONS FOR DATA ****************9010 FOR I=1 TO L9020 D1=Y(I,3)9025 B1=Y(I,4)9030 GOSUB Y(I,2) OF 9070,9080,9260,9310,93109040 NEXT I9060 GO TO 10009070 RETURN 9080 REM  ************   TREND LINE *******9090 DATA 0,0,0,0,09100 RESTORE 90909110 READ X1,X3,Y1,Y2,X29120 FOR J=1 TO P9130 IF X(D1,J)<-1.0E+200 THEN 91909140 X1=X1+X(D1,J)9150 X3=X3+X(D1,J)*J9160 Y1=Y1+J9170 Y2=Y2+J^29180 X2=X2+19190 NEXT J9200 B=(X2*X3-Y1*X1)/(X2*Y2-Y1^2)9210 D2=(X1-B*Y1)/X29220 FOR J=1 TO P9230 X(I,J)=D2+B*J9240 NEXT J9250 RETURN 9260 REM **************  DIFFERENCE **************9270 FOR J=1 TO P9272 X(I,J)=-1.0E+3059275 IF X(D1,J)<-1.0E+200 OR X(B1,J)<-1.0E+200 THEN 92909280 X(I,J)=X(D1,J)-X(B1,J)9290 NEXT J9300 RETURN 9310 REM **********   DIVISION   /  PCT  **********9315 X1=1+99*(Y(I,2)=5)9320 FOR J=1 TO P9330 X(I,J)=-1.0E+3059340 IF X(D1,J)<-1.0E+200 OR X(B1,J)<-1.0E+200 THEN 93909350 IF X(B1,J)=0 THEN 93909380 X(I,J)=X(D1,J)/X(B1,J)*X19390 NEXT J9400 RETURN 10000 REM  ************   FORMAT  INPUT   *****************10010 PRINT "	      DECIMALS PRINTED"10020 GO TO 1027010090 PRINT "

	DECIMALS FOR LINE ";I;":";10100 INPUT J10102 IF J<7 AND J=>0 THEN 1011010104 PRINT "
	I CAN'T DO THAT. TRY AGAIN."10106 GO TO 1009010110 B$="C8D       "10120 IF J=0 THEN 1025010130 S=7-J10140 Z$=STR(S)10150 Z$=REP("C",1,1)10170 B$=Z$&"D."10180 Z$=STR(J)10190 Z$=REP(B$,1,1)10210 B$=Z$&"D"10220 B$=B$&" "10230 IF LEN(B$)=10 THEN 1025010240 GO TO 1022010250 F$=REP(B$,(I-1)*10+1,10)10260 RETURN 10270 REM  ****************   FORMAT LIST  ******************10280 PRINT "

"10290 FOR I=1 TO L10300 B$=SEG(F$,(I-1)*10+1,10)10310 S=POS(B$,".",1)10320 IF S=0 THEN 1035010330 Z$=SEG(B$,S+1,1)10331 Z$=" "&Z$10332 IF Z$<>" D" THEN 1036010334 Z$=" 1"10340 GO TO 1036010350 Z$="NO"10360 PRINT USING "L,20X,2A,FA,D":Z$," DECIMALS FOR LINE ",I10370 NEXT I10380 GOSUB 1200010390 IF I=0 THEN 100010430 GOSUB 1009010440 GO TO 1000011000 REMARK *************  STORE FILE ****************11010 PRINT "	          STORE FILE"11020 IF Z=0 THEN 1114011030 PRINT "

Want to store this chart in a file? (N/Y or RETURN=Y):";11040 X$=" "11050 T=111055 K=111060 INPUT Y$11070 IF NOT(Y$="Y" OR LEN(Y$)=0) THEN 50011080 PRINT "


If you have a File Manager you may store this chart";11090 PRINT " on a Disk by using afile name (which must begin with a ";11100 PRINT "letter and contain NO punctuation or spaces). If you are ";11110 PRINT "using a tape then simply enter the file # (but it   ";11120 PRINT "must be already MARKed to at least 1500)."11130 GO TO 1124011140 PRINT "

	Current File: ";X$11150 PRINT "
	Create a NEW file?: (Y/N)";11155 K=011160 INPUT Y$11170 IF Y$<>"Y" THEN 1129011175 K=111180 IF NOT(T) THEN 1124011185 K=111190 PRINT "
	Want to DESTROY ";X$;"? (Y/N):";11200 INPUT Y$11210 IF Y$<>"Y" THEN 1124011220 KILL X$11230 GO TO 1124011235 REM ***********************************11240 PRINT "

	(Name for Disk or # for Tape)"11250 PRINT "	         File:";11260 INPUT X$11270 Y$=SEG(X$,1,1)11280 T=ASC(Y$)>6411290 IF T THEN 1138011300 PRINT "
	Insert the Tape and press RETURN.";11310 INPUT Y$11320 FIND VAL(X$)11330 GO TO M-2 OF 11340,1136011340 WRITE @33:X,A$,Y,L$,P,F$,L,M$,S0,S1,S211350 GO TO 1146011360 READ @33:X,A$,Y,L$,P,F$,L,M$,S0,S1,S211370 GO TO 1146011380 IF M=4 OR K=0 THEN 1140011390 CREATE X$;1500,011400 OPEN X$;1,"F",Z$11410 GO TO M-2 OF 11420,1144011420 WRITE #1:X,A$,Y,L$,P,F$,L,M$,S0,S1,S211430 GO TO 1145011440 READ #1:X,A$,Y,L$,P,F$,L,M$,S0,S1,S211450 CLOSE 111460 IF Z THEN 100011470 GO TO 50012000 REM ********  CHANGES? ********12010 PRINT "



	Change which? (0 or RETURN=none):";12020 INPUT Z$12030 Z$=Z$&",0"12035 I=VAL(Z$)12070 RETURN 20000 REM ****************  PLOT ******************************20020 PRINT "	       PLOT CHART"20030 PRINT "

     Set up the Plotter to do the outline,title,scale ";20040 PRINT ",and data.You will be prompted to change pens for each ";20110 PRINT "line.Press RETURN when ready.";20130 INPUT Y$20140 D=120150 V=130+20*(D=1)21010 REM  *************  OUTLINE  / TITLE  / DATA LINES ***********21020 VIEWPORT 0,V,0,10021030 WINDOW 0,V,0,10021035 I=021040 MOVE @D:15,2521050 PRINT @D,20:15,85,V,85,V,25,15,2521055 I=I+121057 IF I<2 THEN 2105021060 MOVE @D:V/2,9721070 PRINT @D,17:2,2.721080 FOR J=1 TO 421090 B$=SEG(A$,(J-1)*72+1,Y(J,1))21100 FOR I=1 TO Y(J,1)*0.521110 PRINT @D:"";21120 NEXT I21130 PRINT @D:B$;21140 MOVE @D:V/2,97-J*3.7521150 NEXT J21160 REM ***************  SCALE NOTE *******21170 MOVE @D:5,97-2*3.7521180 B$=SEG(L$,41,10)21190 PRINT @D:B$;21200 REM ***********   DATA LINES ****************21205 IF D=32 THEN 2128021210 MOVE @D:0,(4-L)*521220 DRAW @D:0,2021230 FOR I=(4-L)*5 TO 20 STEP 521240 MOVE @D:0,I21250 RDRAW @D:V,021260 NEXT I21270 REM **********************  PRINT LINE TITLES IF NOT PLOTTED ***21275 PRINT @1,17:1,321280 FOR I=1 TO L21290 IF Y(I,5)>0 THEN 2133021300 B$=SEG(L$,(I-1)*10+1,10)21310 MOVE @D:2,(4-I)*5+121320 PRINT @D:B$;21330 NEXT I21340 PRINT @D,7:22000 VIEWPORT 15,V,0,2522010 WINDOW 0,P,0,522020 REMARK *******************************  X AXIS LABELS ********22025 IF D=32 THEN 2210022030 K=(V-15)/P*0.95/7 MIN 3.0522040 PRINT @1,17:K,322050 FOR I=1 TO P22060 MOVE @D:I-0.5-3.5*K/((V-15)/P),4.322070 B$=SEG(M$,(I-1)*7+1,7)22080 PRINT @D:B$;22090 NEXT I22100 REM ******************* SEGMENT DATA LINES ************22110 FOR I=0 TO P22120 MOVE @D:I,(4-L)*(D=1)+4.5*(D=32)22130 RDRAW @D:0,522140 NEXT I22150 REM  *****************  PRINT DATA  ****************22155 IF D=32 THEN 2300022160 PRINT @1,17:K*7/9,322170 FOR I=4 TO 5-L STEP -122180 B$=SEG(F$,(4-I)*10+1,10)22190 FOR J=1 TO P22200 IF X(5-I,J)<-1.0E+300 THEN 2223022210 MOVE @D:J-0.5-4*K*7/9/((V-15)/P),I-0.8522220 PRINT @D: USING B$:X(5-I,J)22230 NEXT J22240 NEXT I23000 REMARK ****************   SCALE  **********************23010 VIEWPORT 0,15,25,8523020 WINDOW 0,15,S0,S123030 PRINT @D,17:1.4,2.623035 B$="C8D    "23040 I=0 MAX (ABS(S0-INT(S0)) MAX ABS(S1-INT(S1)))23050 I=I MAX ABS(S2-INT(S2))23051 IF I=0 THEN 2315023052 Z$=STR(I)23054 I=LEN(Z$)-323080 J=7-I23090 Z$=STR(J)23100 Z$=REP("C",1,1)23110 B$=Z$&"D."23120 Z$=STR(I)23130 Z$=REP(B$,1,1)23140 B$=Z$&"D"23150 B=023160 X1=S123170 X2=S223180 J=023190 IF S0<0 AND S1>0 THEN 2327023200 IF S0=>0 THEN 2325023210 J=S123220 X1=S023230 X2=-S223240 GO TO 2326023250 J=S023260 B=123270 FOR I=J TO X1 STEP X223275 IF I>S1 OR I<S0 THEN 2332023280 MOVE @D:13,I23290 DRAW @D:15,I23300 MOVE @D:1,I23310 PRINT @D: USING B$:I23320 NEXT I23330 IF B THEN 2350023340 J=-S223350 GO TO 2322023500 REM **************  DRAW ZERO LINE **************23510 VIEWPORT 15,V,25,8523520 WINDOW 0,P,S0,S123525 IF S0=0 OR S1=0 THEN 2400023530 MOVE @D:0,023540 DRAW @D:P,024000 REM *******************  PLOT LINES/BARS ********************24010 REM ********  HOW MANY BARS? ******************24020 B2=024030 B=024040 FOR I=1 TO L24050 IF Y(I,5)<>2 THEN 2407024060 B=B+124070 NEXT I24080 B1=B*3+124090 REM *****************  LINE COUNTER ************24110 FOR I=1 TO L24120 IF Y(I,5)=0 THEN 2460024130 T2=P24145 IF D=32 THEN 2423024150 PRINT @D,21:0,024160 PRINT "

Change PEN for LINE ";I;" Then press RETURN.";24170 INPUT Y$24230 GO TO 2701024240 GO TO Y(I,5) OF 24270,2437024250 REM ****************  LINE ***************24270 D2=024280 S=124290 K=124300 X3=224310 S7=P/(V-15)24320 S8=(S1-S0)/(85-25)24330 D1=124340 Z=1/S724350 GO TO 2450024360 REM ************  BARS **********24370 X2=024380 IF Y(I,6)<>2 THEN 2440024390 X2=1/((V-15)/P*5)24400 IF Y(I,6)<>3 THEN 2442024410 X2=1/((V-15)/P)24420 B2=B2+124430 GO TO 2451024500 REM *****************  TIME INCREMENT *****24505 T2=P-124510 FOR J=1 TO T224520 GOSUB Y(I,5) OF 25010,2601024530 NEXT J24600 NEXT I24610 PRINT @D,21:V,10024620 PRINT @D:"";24625 IF D=32 THEN 2464024630 GO TO 50024640 INPUT Y$24650 GO TO 50025000 REM **************************  SOLID LINE  ********25010 IF Y(I,6)<>1 THEN 2507025020 IF X(I,J)<-1.0E+300 OR X(I,J+1)<-1.0E+300 THEN 2505025030 MOVE @D:J-0.5,X(I,J)25040 DRAW @D:J+0.5,X(I,J+1)25050 RETURN 25060 REM  **********  PLOT   LINES    ***************************25070 IF X(I,J)<-1.0E+300 OR X(I,J+1)<-1.0E+300 THEN 2535025080 X1=J-0.525090 Y1=X(I,J)25100 IF Y(I,6)=1 THEN 2526025110 M=(X(I,J+1)-X(I,J))/S825120 H=SQR(Z^2+M^2)25130 X2=X3*(Z/H)*S725140 Y2=X3*(M/H)*S825150 REM  *****************************************************25160 D2=NOT(D2)25170 GO TO D2+1 OF 25260,2518025180 MOVE @D:X1,Y125190 IF K<>1 THEN 2528025200 S=NOT(S)25210 GO TO Y(I,6) OF 25260,25280,25220,2524025220 D1=025230 GO TO 2528025240 D1=S25250 GO TO 2528025260 DRAW @D:X1,Y125270 D1=125280 X1=X1+X2*D1*K25290 Y1=Y1+Y2*D1*K25300 IF K=1 THEN 2533025310 K=125320 GO TO 2517025330 IF X1<=J+0.5 THEN 2516025340 K=SQR((X1-J-0.5)^2+(Y1-X(I,J+1))^2)/SQR(X2*X2+Y2*Y2)25350 RETURN 26000 REM  *****************  PLOT  BARS  ***********************26010 IF X(I,J)<-1.0E+300 OR X(I,J)=0 THEN 2621026011 S=0 MIN S126012 IF S0<=0 THEN 2602026013 S=0 MAX S026020 M=J-1+(1+(B2-1)*3)/B126030 K=M26040 MOVE @D:M,S26050 DRAW @D:M,X(I,J)26060 DRAW @D:M+2/B1,X(I,J)26070 DRAW @D:M+2/B1,S26080 MOVE @D:M,S26090 IF X2=0 THEN 2613026095 X2=X2 MIN 1/B126097 M=M+X226099 MOVE @D:M,S26100 IF M=>K+2/B1 THEN 2621026105 DRAW @D:M,X(I,J)26120 GO TO 2609726130 IF Y(I,6)<>4 THEN 2621026140 Z=026145 X1=126150 Z=(S1-S0)/40+Z26160 IF Z>ABS(X(I,J)-S) THEN 2621026170 RMOVE @D:0,(S1-S0)/40*SGN(X(I,J))26180 RDRAW @D:2/B1*X1,026190 X1=-X126200 GO TO 2615026210 RETURN 27000 REM ************  PRINT HEADING *************27010 VIEWPORT 0,15,0,2027020 WINDOW 0,15,0,427030 PRINT @D,17:1,327040 MOVE @D:0.1,4-I+0.227050 GO TO Y(I,5) OF 27060,2750027060 GO TO Y(I,6) OF 27070,27110,27140,2722027070 RMOVE @D:1,0.227080 RDRAW @D:3,027090 RMOVE @D:1,-0.227100 GO TO 2727027110 PRINT @D:"- -";27120 RMOVE @D:5,027130 GO TO 2727027140 RMOVE @D:1,0.227150 RDRAW @D:0,027160 RMOVE @D:1,027170 RDRAW @D:0,027180 RMOVE @D:1,027190 RDRAW @D:0,027200 RMOVE @D:2,-0.227210 GO TO 2727027220 RMOVE @D:1,0.227230 RDRAW @D:1,027240 RMOVE @D:1,027250 RDRAW @D:0,027260 RMOVE @D:2,-0.227270 B$=SEG(L$,(I-1)*10+1,10)27280 PRINT @D,17:1,327290 PRINT @D:B$;27300 VIEWPORT 15,V,25,8527310 WINDOW 0,P,S0,S127320 GO TO 2424027500 REM ********   BARS *********27510 RMOVE @D:1,027520 RDRAW @D:2.5,027530 RDRAW @D:0,0.527540 RDRAW @D:-2.5,027550 RDRAW @D:0,-0.527560 GO TO Y(I,6) OF 27570,27590,27680,2770027570 RMOVE @D:4,027580 GO TO 2727027590 X2=0.227600 X1=127610 FOR J=X2 TO 2.5 STEP X227620 RMOVE @D:X2,027630 RDRAW @D:0,X1*0.527640 X1=-X127650 NEXT J27660 RMOVE @D:1.5,027670 GO TO 2727027680 X2=0.627690 GO TO 2760027700 X1=127710 FOR J=0.2 TO 0.5 STEP 0.227720 RMOVE @D:0,0.227730 RDRAW @D:2.5*X1,027740 X1=-X127750 NEXT J27760 RMOVE @D:4,-0.427770 GO TO 27270