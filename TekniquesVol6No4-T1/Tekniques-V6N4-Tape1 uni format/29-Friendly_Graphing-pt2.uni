3 GOSUB 1004 GOSUB 3307 END 8 GOSUB 273010 GOSUB 33011 RETURN 12 GOSUB 475014 GOSUB 33015 RETURN 16 GOSUB 372018 GOSUB 33019 RETURN 20 GOSUB 641022 GOSUB 33023 RETURN 24 GOSUB 685026 GOSUB 33027 RETURN 28 GOSUB L9<M8 OF 558030 GOSUB 33031 RETURN 32 GOSUB 760034 GOSUB 33035 RETURN 36 GOSUB 836038 GOSUB 33039 RETURN 40 A0=3241 GOSUB 979042 GOSUB 62043 END 44 GOSUB 1433046 GOSUB 33047 RETURN 48 GOSUB 794049 GOSUB 33051 RETURN 52 GOSUB 822054 GOSUB 33055 RETURN 56 GOSUB L9>1 OF 523058 GOSUB 33059 RETURN 60 GOSUB 124062 GOSUB 33063 END 64 GOSUB 733066 GOSUB 33067 RETURN 68 GOSUB 603070 GOSUB 33071 RETURN 72 GOSUB 874074 GOSUB 33075 RETURN 76 GOSUB 887078 GOSUB 33079 RETURN 80 A0=181 GOSUB 979082 GOSUB 33083 RETURN 90 REM **EOF(0) FLAG**91 F9=192 RETURN 95 PRINT "__I'm goin' as fast as I can, so LAY OFF THE CALL BUTTON!!!G_G_G_G_   "96 INPUT @A0,27:T1,T1,T197 RETURN 100 PRINT "L_FRIENDLY GRAPHING              BY PAUL HOWARD__K_I_I_I_22-NOV-82"110 REM **VARIABLE SPECS ON FILE # 1**120 INIT 130 SET DEGREES 140 ON EOF (0) THEN 90150 ON SRQ THEN 95160 PRINT @32,17:4170 M8=6180 M9=52190 DIM A$(M8*16+1),B$(66),C$(16),D$(32*66+1),F$(56),G$(41),Q$(1),R$(1)200 DIM S$(41),T$(110),V$(10),W$(10),X$(17),Y$(17),Z$(17),L$(M9*16+1)210 DIM B1(M8),C0(2,M8),C9(M8),D1(M8),D9(6,4),W1(M8),Y0(M9,M8),Y6(M9)220 RESTORE 230230 DATA 1.5,1.5,1.5,1.5,3,3,3,3,1.5,1.5,0.1,1.5,3,3,0.1,3240 DATA 0.1,1.5,0.1,1.5,5,1.5,5,1.5,0,0,1,2.816,-9999999,1.792250 READ D9,F6,F7,G2,L0,N9,S0260 PRINT "____DATE:____DD-MMM-YY____ ___ __K___G_";270 INPUT W$280 IF LEN(W$)<>9 OR POS(W$,"-",3)<>3 THEN 260290 GOSUB 690300 GOSUB 910310 GOSUB 1120320 RETURN 330 REM **MENU**340 GOSUB 620350 T$=SEG(D$,15,32)360 PRINT "L_MENU FOR: ";T$;"__K_I_I_I_   DATE: ";W$;"____GRAPH: #";370 PRINT USING "2D,"" '"",40A,""'    DATE: "",9A":G3;G$;V$380 PRINT " ZOOM: EVENTS ";Z6;" THRU ";Z8;" (MAX=";L8;"),";390 PRINT " CURVES ";Z7;" THRU ";Z9;" (MAX=";L9;")"400 PRINT "____UDK FUNCTION____ 1  MENU"410 PRINT "11  LIST ALL CURVE DATA ON THE SCREEN/PLOTTER@1:/PRINTER@51:"420 PRINT "12  DRAW 2, 3, OR 4 GRAPHS ON ONE PLOTTER PAGE"430 PRINT " 2  MODIFY GRAPH PARAMETERS"440 PRINT " 3  MODIFY GRAPH LABELS"450 PRINT "13  COPY A GRAPH TO ANOTHER FRIENDLY GRAPHING TAPE"460 PRINT " 4  MODIFY CURVE PARAMETERS"470 PRINT "14  MOVE A CURVE"480 PRINT " 5  MODIFY A CURVE'S DATA"490 PRINT "15  CREATE A NEW GRAPH(& DELETE PRESENT GRAPH FROM MEMORY!!)"500 PRINT " 6  ADD(INSERT DATA BETWEEN EXISTING) DATA TO ALL CURVES"510 PRINT "16  DELETE DATA FROM ALL CURVES"520 PRINT " 7  ADD(INSERT A CURVE BEFORE) A CURVE"530 PRINT "17  DELETE A CURVE"540 PRINT " 8  LOAD A CURVE FROM THE TAPE"550 PRINT "18  SAVE A CURVE ONTO THE TAPE"560 PRINT " 9  LOAD A GRAPH FROM THE TAPE"570 PRINT "19  SAVE A GRAPH ONTO THE TAPE"580 PRINT "10  DRAW A GRAPH ON THE SCREEN"590 PRINT "20  DRAW A GRAPH ON THE PLOTTER@1:"600 PRINT "__PRESS THE DESIRED User Definable Key: __G_"610 RETURN 620 REM **RESET TO 1 GRAPH PER PAGE**630 VIEWPORT 0,130,0,100640 WINDOW 0,130,0,100650 RESTORE 660660 DATA 32,0,1,1,0,1,0,1670 READ A0,E1,G1,G9,V1,V2,V3,V4680 RETURN 690 REM **INITIALIZE NEW GRAPH VARS**700 RESTORE 710710 DATA 0,0,1,0,0,0,1,1,13,5,1,1,5,0,100,1,1,1,1720 READ F1,F2,F3,F4,F5,G3,L8,L9,T8,T9,X9,Y5,Y7,Y8,Y9,Z6,Z8,Z7,Z9730 DATA " "," "," "," "," "," "740 READ F$,G$,S$,X$,Y$,Z$750 B1=0760 C0=1770 C9=0780 D1=1790 W1=1800 Y0=N9810 R$=CHR(13)820 L$=""830 FOR L1=1 TO M9840    L$=L$&"                "850 NEXT L1860 A$=SEG(L$,1,M8*16)870 B$=SEG(L$,1,65)880 B$=B$&R$890 V$=W$900 RETURN 910 REM **INIT DIRECTORY FILE # 4 IF NEW OR LAST**920 FIND 4930 PRINT @33,0:0,0,1940 FIND 4950 PRINT @33,0:0,0,0960 INPUT @33:T$970 IF POS(T$,"NEW",9)<>9 AND POS(T$,"LAST",9)<>9 THEN 1110980 PRINT USING "/19A30X""'H_""30(""H__H_"")""H_'G_"",S":"ENTER TAPE TITLE:"990 INPUT T$1000 T$=SEG(T$,1,30)1010 D$=B$&B$1020 D$=REP("DIRECTORY FOR:",1,14)1030 D$=REP(T$,INT(31-LEN(T$)/2),LEN(T$))1040 D$=REP("REVISED:",47,8)1050 D$=REP(W$,57,LEN(W$))1060 D$=REP(" TYPE:   G#            GRAPH(OR CURVE) TITLE",66+1,44)1070 D$=REP("            SAVE-DATE",66+45,21)1080 FIND 41090 MARK 1,30721100 GOSUB 94401110 RETURN 1120 PRINT "__LOADING THE GRAPH DIRECTORY FROM THE TAPE."1130 FIND 41140 D$=""1150 F9=01160 INPUT @33:T$1170 IF F9=1 THEN 12201180 M$=B$1190 M$=REP(T$,1,LEN(T$))1200 D$=REP(M$,LEN(D$)+1,0)1210 GO TO 11601220 F8=LEN(D$)/66-2+11230 RETURN 1240 REM **CREATE A NEW GRAPH**1250 GOSUB 6901260 GOSUB 22701270 PRINT "L_GRAPH '";G$;"':____# OF EVENTS PER CURVE";1280 L8=121290 PRINT "(MAX=";M9;",<RETURN>=";L8 MIN M9;"): # G_";1300 INPUT T$1310 GOSUB 96801320 IF T$="" THEN 13501330 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>M9 THEN 12701340 L8=VAL(T$)1350 PRINT "__USER-INPUT(U); AUTO-SEQUENCE BY NUMBER(N), WEEK(W),"1360 PRINT "PERIOD(P), OR MONTH(M) EVENT LABELS(<RETURN>=M): G_";1370 INPUT Q$1380 PAGE 1390 GO TO POS(" UNWPM",Q$,1)+1 OF 1350,1950,1400,1460,1670,1800,19501400 FOR L1=1 TO L81410    PRINT USING "8A,2D,18X,""'H_"",16(""H__H_""),""H_'G_"",S":"LABEL #";L        1;1420    INPUT C$1430    L$=REP(C$,(L1-1)*16+1,LEN(C$))1440 NEXT L11450 GO TO 20701460 T1=11470 PRINT "STARTING NUMBER(<RETURN>=";T1;"): # G_";1480 INPUT T$1490 GOSUB 96801500 IF T$="" THEN 15301510 IF E1<>0 THEN 14601520 T1=VAL(T$)1530 T2=11540 PRINT "__INCREMENT(<RETURN>=";T2;"): # G_";1550 INPUT T$1560 GOSUB 96801570 IF T$="" THEN 16001580 IF E1<>0 THEN 15301590 T2=VAL(T$)1600 FOR L1=1 TO L81610    T$=STR(T1)1620    T$=REP("",1,1)1630    L$=REP(T$,(L1-1)*16+1,LEN(T$))1640    T1=T1+T21650 NEXT L11660 GO TO 20701670 T1=11680 PRINT "STARTING WEEK(1-";M9;",<RETURN>=";T1;"): # G_";1690 INPUT T$1700 GOSUB 96801710 IF T$="" THEN 17401720 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>M9 THEN 16701730 T1=VAL(T$)1740 FOR L1=1 TO L81750    M$="00"1760    GOSUB 22101770    T1=(T1+1)*(T1<M9)+1*(T1=>M9)1780 NEXT L11790 GO TO 20701800 T1=3011810 PRINT "STARTING PERIOD(<RETURN>=";T1;"): # G_";1820 INPUT T$1830 GOSUB 96801840 IF T$="" THEN 18701850 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>913 THEN 18001860 T1=VAL(T$)1870 FOR L1=1 TO L81880    M$="000"1890    GOSUB 22101900    T2=T1-INT(T1/100)*1001910    T1=(T1+1)*(T2<13)+((INT(T1/100)+1)*100+1)*(T2=>13)1920    T1=T1*(T1<=913)+1*(T1>913)1930 NEXT L11940 GO TO 20701950 T1=11960 PRINT "STARTING MONTH(1=JAN...12=DEC,<RETURN>=";T1;"): # G_";1970 INPUT T$1980 GOSUB 96801990 IF T$="" THEN 20202000 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>12 THEN 19502010 T1=VAL(T$)2020 FOR L1=1 TO L82030    T$=SEG("JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC",(T1-1)*3+1,3)2040    L$=REP(T$,(L1-1)*16+1,LEN(T$))2050    T1=(T1+1)*(T1<12)+1*(T1=>12)2060 NEXT L12070 L9=12080 PRINT "__NUMBER OF CURVES(1-";M8;",<RETURN>=";L9;"): # G_";2090 INPUT T$2100 IF T$="" THEN 21302110 IF T$<"1" OR T$>"6" THEN 20702120 L9=VAL(T$)2130 FOR L2=1 TO L92140    C$=SEG(A$,(L2-1)*16+1,16)2150    GOSUB 38002160    Z9=L22170    GOSUB 42102180 NEXT L22190 GOSUB 86802200 RETURN 2210 REM **PUT T1 PADDED WITH "00" OR "000" INTO L$**2220 T$=STR(T1)2230 T$=REP("",1,1)2240 L$=REP(M$,(L1-1)*16+1,LEN(M$))2250 L$=REP(T$,(L1-1)*16+LEN(M$)+1-LEN(T$),LEN(T$))2260 RETURN 2270 PRINT USING 2280:"L_GRAPH";G$2280 IMAGE /FA" TITLE:__(<RETURN>='",40A,"'):"/,51X,"'H_",40("H__H_"),"H_'G_"S2290 INPUT T$2300 IF T$="" THEN 23202310 G$=T$2320 PRINT USING 2280:"2nd GRAPH";S$2330 INPUT T$2340 IF T$="" THEN 23602350 S$=T$2360 PRINT USING 2370:"FREE(<N>=NONE)";F$2370 IMAGE /FA" TITLE:__(<RETURN>='",55A,"'):"/,66X,"'H_",55("H__H_"),"H_'G_"S2380 INPUT T$2390 IF T$="" AND F$=" " THEN 25902400 IF T$="" THEN 24802410 IF T$<>"N" THEN 24602420 F$=" "2430 T8=132440 T9=52450 GO TO 25902460 F$=T$2470 T8=T8 MIN 73-LEN(F$)2480 PRINT "__FREE TITLE X,Y COORDINATES__X=1 TO ";73-LEN(F$);2490 PRINT ",Y=1 TO 35,<RETURN>=";T8;",";T9;"): #,# G_";2500 INPUT T$2510 IF T$="" THEN 25902520 IF POS(T$,",",1)=0 THEN 24802530 T$=REP("-",POS(T$,",",1),1)2540 GOSUB 96802550 IF E1<>0 THEN 24802560 T8=VAL(T$) MAX 1 MIN 73-LEN(F$)2570 T$=REP("",1,POS(T$,"-",2))2580 T9=VAL(T$) MAX 1 MIN 352590 PRINT USING 2600:"X-AXIS";X$2600 IMAGE /FA" TITLE:__(<RETURN>='",16A,"'):"/,27X,"'H_",16("H__H_"),"H_'G_"S2610 INPUT C$2620 IF C$="" THEN 26402630 X$=C$2640 PRINT USING 2600:"LEFT  Y-AXIS";Y$2650 INPUT C$2660 IF C$="" THEN 26802670 Y$=C$2680 PRINT USING 2600:"RIGHT Y-AXIS";Z$2690 INPUT C$2700 IF C$="" THEN 27202710 Z$=C$2720 RETURN 2730 PRINT "L_MODIFY GRAPH PARAMETERS:"2740 T$=SEG("NY",G2+1,1)2750 PRINT "__    DISPLAY GRAPH #(G#,<RETURN>=";T$;")? G_";2760 INPUT Q$2770 G2=(Q$="Y")+G2*(Q$="")2780 T$=SEG("NY",F2+1,1)2790 PRINT "__   REMOVE HIDDEN LINES(<RETURN>=";T$;")? G_";2800 INPUT Q$2810 F2=(Q$="Y")+F2*(Q$="")2820 T$=SEG("NY",F4+1,1)2830 PRINT "__  STAGGER EVENT LABELS(<RETURN>=";T$;")? G_";2840 INPUT Q$2850 F4=(Q$="Y")+F4*(Q$="")2860 PRINT "__ZOOM EVENTS AND/OR CURVES(<RETURN>=N)? G_";2870 INPUT Q$2880 IF Q$="Y" THEN 29102890 GOSUB 86802900 GO TO 31902910 PAGE 2920 GOSUB 75302930 PRINT "ZOOM FROM EVENT(<RETURN>= ";Z6;"): # G_";2940 INPUT T$2950 GOSUB 96802960 IF T$="" THEN 29902970 IF E1<>0 THEN 29302980 Z6=VAL(T$) MAX 1 MIN L82990 PRINT "       TO EVENT(<RETURN>=";Z8;"): # G_";3000 INPUT T$3010 GOSUB 96803020 IF T$="" THEN 30503030 IF E1<>0 THEN 29903040 Z8=VAL(T$) MAX Z6 MIN L83050 GOSUB 51603060 PRINT "__ZOOM FROM CURVE(<RETURN>= ";Z7;"): # G_";3070 INPUT T$3080 GOSUB 96803090 IF T$="" THEN 31203100 IF E1<>0 THEN 30603110 Z7=VAL(T$) MAX 1 MIN L93120 PRINT "       TO CURVE(<RETURN>= ";Z9;"): # G_";3130 INPUT T$3140 GOSUB 96803150 IF T$="" THEN 31803160 IF E1<>0 THEN 31203170 Z9=VAL(T$) MAX Z7 MIN L93180 PAGE 3190 T$=SEG("MA",F3+1,1)3200 PRINT "__AUTO(A) or MANUAL(M) SCALE Y-AXIS(<RETURN>=";T$;"): G_";3210 INPUT Q$3220 F3=(Q$="A")+F3*(Q$="")3230 IF Q$="" OR F3=1 THEN 34703240 PRINT "__    Y-AXIS UPPER LIMIT(<RETURN>=";Y9;"): # G_";3250 INPUT T$3260 GOSUB 96803270 IF T$="" THEN 33003280 IF E1<>0 THEN 32403290 Y9=VAL(T$)3300 PRINT "__    Y-AXIS LOWER LIMIT(<RETURN>=";Y8;"): # G_";3310 INPUT T$3320 GOSUB 96803330 IF T$="" THEN 33603340 IF E1<>0 OR VAL(T$)=>Y9 THEN 33003350 Y8=VAL(T$)3360 IF Y7=>(Y9-Y8)/30 AND Y7<=Y9-Y8 THEN 33903370 Y7=Y7 MAX (Y9-Y8)/30 MIN Y9-Y83380 Y5=Y73390 PRINT "__Y-AXIS LABEL INCREMENT(<RETURN>=";Y7;"): # G_";3400 INPUT T$3410 GOSUB 96803420 IF T$="" THEN 34703430 IF E1<>0 THEN 33903440 Y7=VAL(T$) MAX (Y9-Y8)/30 MIN Y9-Y83450 Y5=Y73460 IF VAL(T$)<(Y9-Y8)/30 OR VAL(T$)>Y9-Y8 THEN 33903470 T$=SEG("NYXB",F5+1,1)3480 PRINT "__DRAW X-AXIS(X), Y-AXIS(Y), BOTH(B), OR NO(N) ";3490 PRINT "GRID(<RETURN>=";T$;"): G_";3500 INPUT Q$3510 F5=F5*(Q$="")+(POS("NYXB",Q$,1)-1 MAX 0)*(Q$<>"")3520 IF Q$="" OR F3=1 OR F5=0 THEN 37103530 IF F5<>2 AND F5<>3 THEN 36303540 PRINT "__ X-AXIS GRID INCREMENT(<RETURN>=";X9;"): # G_";3550 INPUT T$3560 GOSUB 96803570 IF T$="" THEN 36203580 IF E1<>0 THEN 35403590 X9=VAL(T$) MAX L8/200 MIN L83600 X9=INT(X9+0.5)*(X9=>1)+1/INT(1/X9+0.5 MAX 1)*(X9<1)3610 IF X9<>VAL(T$) THEN 35403620 IF F5<>1 AND F5<>3 THEN 37103630 PRINT "__ Y-AXIS GRID INCREMENT(<RETURN>=";Y5;"): # G_";3640 INPUT T$3650 GOSUB 96803660 IF T$="" THEN 37103670 IF E1<>0 THEN 36303680 Y5=VAL(T$) MAX (Y9-Y8)/150 MIN Y9-Y83690 Y5=Y7*INT(Y5/Y7+0.5)*(Y5=>Y7)+Y7/INT(1/(Y5/Y7)+0.5 MAX 1)*(Y5<Y7)3700 IF Y5<>VAL(T$) THEN 36303710 RETURN 3720 PRINT "L_MODIFY A CURVE:"3730 GOSUB 86803740 GOSUB 94903750 IF E1<>0 THEN 37903760 GOSUB 38003770 GOSUB 42103780 GO TO 37203790 RETURN 3800 PRINT USING 3810:"CURVE: #";L2;" NAME(<RETURN>='";C$;"'):";3810 IMAGE P,8A,3D,16A,16A,3A,/,43X,"'H_",16("H__H_"),"H_'G_",S3820 INPUT T$3830 IF T$="" THEN 38703840 GOSUB 77803850 C$=T$3860 A$=REP(C$,(L2-1)*16+1,LEN(C$))3870 REM **CURVE PARAMETERS**3880 T$=SEG("CSLDDDDDDTP",C9(L2)+3,1)3890 PRINT "__COMPARATIVE BAR(C), STACKED BAR(S), SOLID LINE(L) ";3900 PRINT "DASHED LINE(D),__TRILINE(T) OR PHANTOM(P) CURVE";3910 PRINT "(<RETURN>=";T$;"): G_";3920 INPUT Q$3930 IF Q$="" THEN 42003940 GO TO POS("CSLDTP",Q$,1)+1 OF 3890,3950,3950,4170,4080,4170,41703950 REM **BAR**3960 C9(L2)=-1*(Q$="S")-2*(Q$="C")3970 PRINT "__SHADING LINES ON BARS:__"3980 PRINT " POSTIVE  # ( 1 >  20) FOR VERTICAL"3990 PRINT " NEGATIVE # (-1 > -20) FOR HORIZONTAL"4000 PRINT " ZERO       (   0    ) FOR NONE"4010 PRINT "__SHADING LINES(<RETURN>=";B1(L2);"): # G_";4020 INPUT T$4030 GOSUB 96804040 IF T$="" THEN 42004050 IF E1<>0 THEN 40104060 B1(L2)=INT(VAL(T$)) MAX -20 MIN 204070 GO TO 42004080 REM **DASHED LINE**4090 PRINT "__ 1  - - - - -__ 2  --  --  --__ 3  - . - . -"4100 PRINT " 4  -- . -- .__ 5  ..........__ 6  ---- ----"4110 PRINT "__ SELECT DASH STYLE (1-6,<RETURN>=";C9(L2);"): # G_";4120 INPUT Q$4130 IF Q$="" THEN 41904140 IF Q$<"1" OR Q$>"6" THEN 41104150 C9(L2)=VAL(Q$)4160 GO TO 41904170 REM **SOLID LINE,TRILINE, OR PHANTOM**4180 C9(L2)=0*(Q$="S")+7*(Q$="T")+8*(Q$="P")4190 B1(L2)=04200 RETURN 4210 PRINT "L_CREATE CURVE: # ";L2;" '";C$;"' DATA FROM:__"4220 PRINT "  1 KEYBOARD    DATA INPUT."4230 PRINT "  2 A CURVE     DATA FILE ."4240 PRINT "  3 A CONSTANT  DATA VALUE."4250 PRINT "  4 THE RUNNING AVERAGE   OF A   PREVIOUS CURVE ."4260 PRINT "  5 THE MOVING  AVERAGE   OF A   PREVIOUS CURVE ."4270 PRINT "  6 THE CUMULATIVE SUM    OF A   PREVIOUS CURVE ."4280 PRINT "  7 THE LEAST SQUARES FIT OF A   PREVIOUS CURVE ."4290 PRINT "  8 THE DIFFERENCE        OF TWO PREVIOUS CURVES."4300 PRINT "  9 THE PERCENTAGE        OF TWO PREVIOUS CURVES."4310 PRINT " 10 THE AVERAGE           OF ALL PREVIOUS CURVES."4320 PRINT " 11 THE SUM               OF ALL PREVIOUS CURVES."4330 D1(L2)=D1(L2) MAX 14340 PRINT "__ DATA SOURCE(<RETURN>=NO CHANGE=";D1(L2);"): # G_";4350 INPUT T$4360 GOSUB 96804370 IF T$="" THEN 44704380 IF E1<>0 OR VAL(T$)<1 OR (L2=1 AND VAL(T$)=>4) THEN 42104390 IF VAL(T$)>11 OR (L2<=2 AND (VAL(T$)=8 OR VAL(T$)=9)) THEN 42104400 D2=VAL(T$)4410 GOSUB D2=2 OF 78404420 IF E1<>0 THEN 42104430 D1(L2)=D24440 D2=L24450 GOSUB D1(D2) OF 6490,4470,4480,4550,4550,4550,4550,4550,45504460 L2=D24470 RETURN 4480 PRINT "__CURVE: # ";L2;" '";C$;"' CONSTANT(<RETURN>=";W1(L2);"): # G_     ";4490 INPUT T$4500 GOSUB 96804510 IF T$="" THEN 45404520 IF E1<>0 THEN 44804530 W1(D2)=VAL(T$)4540 RETURN 4550 PRINT "L_COMPUTE CURVE: # ";D2;" '";C$;"'____FROM PREVIOUS SOURCE:"4560 Z9=D2-1 MAX 14570 GOSUB 94904580 IF E1<>0 OR L2=>D2 THEN 45504590 C0(1,D2)=L24600 C0(2,D2)=14610 IF D1(D2)<>5 THEN 46804620 PRINT "__MOVING AVERAGE WINDOW(<RETURN>=";W1(D2);" EVENTS): G_";4630 INPUT T$4640 GOSUB 96804650 IF T$="" THEN 46804660 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>L8 THEN 46204670 W1(D2)=VAL(T$)4680 IF D1(D2)<>8 AND D1(D2)<>9 THEN 47304690 PRINT "AND  PREVIOUS SOURCE:"4700 GOSUB 94904710 IF E1<>0 OR L2=>D2 OR L2=C0(1,D2) THEN 45504720 C0(2,D2)=L24730 GOSUB 86804740 RETURN 4750 PRINT "L_MODIFY GRAPH TITLES:__"4760 PRINT USING 4770:"GRAPH";G$4770 IMAGE 13A," TITLE(T): '",40A,"'"4780 PRINT USING 4770:"2nd";S$4790 T$=SEG(F$,1,40)4800 PRINT USING 4770:"FREE";T$4810 PRINT USING 4820:"X-AXIS";X$4820 IMAGE 13A," TITLE(T): '",16A,"'"4830 PRINT USING 4820:"Y-AXIS(LEFT)";Y$4840 PRINT USING 4820:"Y-AXIS(RIGHT)";Z$4850 GOSUB 51604860 GOSUB 75304870 PRINT "MODIFY LABEL(<T>,<C>, OR <E>;<RETURN>=NONE):   G_";4880 INPUT Q$4890 GO TO POS(" TCE",Q$,1)+1 OF 4750,5150,4900,4920,49204900 GOSUB 22704910 GO TO 47504920 T1=Q$="E"4930 N$=SEG("CURVE EVENT",T1*6+1,5)4940 PRINT "     MODIFY ";N$;" LABEL(<RETURN>=NO CHANGE): # G_";4950 INPUT T$4960 GOSUB 96804970 IF T$="" THEN 47504980 IF E1<>0 OR VAL(T$)<1 THEN 47504990 IF VAL(T$)>L9 AND T1=0 OR (VAL(T$)>L8 AND T1=1) THEN 47505000 L1=VAL(T$)5010 IF T1<>0 THEN 50405020 C$=SEG(A$,(L1-1)*16+1,16)5030 GO TO 50505040 C$=SEG(L$,(L1-1)*16+1,16)5050 PRINT USING 5060:"REPLACE:  '";C$;"'";"WITH(<RETURN>=NO CHANGE:"5060 IMAGE 36X,11A,16A,1A,/,20X,27A,16X,"'H_",16("H__H_"),"H_'G_",S5070 INPUT T$5080 IF T$="" THEN 47505090 GOSUB 77805100 IF T1<>0 THEN 51305110 A$=REP(T$,(L1-1)*16+1,16)5120 GO TO 47505130 L$=REP(T$,(L1-1)*16+1,16)5140 GO TO 47505150 RETURN 5160 PRINT "__CURVE(C) LABELS:__"5170 FOR L1=1 TO L95180    T$=SEG(A$,(L1-1)*16+1,16)5190    PRINT USING "1A,2D,3A,16A,2A,S":"#";L1;"= '";T$;"'"5200 NEXT L15210 PRINT 5220 RETURN 5230 PRINT "L_MOVE A CURVE:"5240 GOSUB 86805250 GOSUB 94905260 IF E1<>0 THEN 55705270 T1=B1(L2)5280 T2=C0(1,L2)5290 T3=C0(2,L2)5300 T4=C9(L2)5310 T5=D1(L2)5320 T6=W1(L2)5330 FOR L1=1 TO L85340    Y6(L1)=Y0(L1,L2)5350 NEXT L15360 GOSUB 61605370 GOSUB 86805380 PRINT "MOVE CURVE: '";C$;"'"5390 GOSUB 57105400 IF E1<>0 THEN 53805410 IF L2>T2 AND L2>T3 OR T5<=3 THEN 54505420 PRINT "__CURVE: '";C$;"' CAN'T BE MOVED BELOW ITS SOURCE ";5430 PRINT "CURVE: # ";T2 MAX T3;" !!!G_G_G_"5440 GO TO 53805450 GOSUB 58405460 A$=REP(C$,(L2-1)*16+1,LEN(C$))5470 B1(L2)=T15480 C0(1,L2)=T25490 C0(2,L2)=T35500 C9(L2)=T45510 D1(L2)=T55520 W1(L2)=T65530 FOR L1=1 TO L85540    Y0(L1,L2)=Y6(L1)5550 NEXT L15560 GO TO 52305570 RETURN 5580 PRINT "L_ADD(INSERT A CURVE BEFORE)A CURVE:"5590 GOSUB 86805600 GOSUB 57105610 IF E1<>0 THEN 57005620 GOSUB 58405630 L3=L25640 GOSUB 134505650 GOSUB 77305660 C$="                "5670 GOSUB 38005680 GOSUB 42105690 GO TO 55805700 RETURN 5710 REM **SELECT CURVE # TO ADD**5720 GOSUB 96205730 PRINT "BEFORE CURVE(<RETURN>=NONE,<A>=AFTER CURVE: #";L9;"): # G_";5740 INPUT T$5750 E1=15760 IF T$="" OR L9=>M8 THEN 58305770 L2=L9+15780 IF T$="A" THEN 58205790 GOSUB 96805800 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>L9+1 THEN 57105810 L2=VAL(T$)5820 E1=05830 RETURN 5840 REM **SHIFT CURVES UP TO MAKE ROOM FOR CURVE: # L2**5850 A$=REP("",(M8-1)*16+1,16)5860 A$=REP("                ",(L2-1)*16+1,0)5870 IF L2=>L9+1 THEN 60105880 FOR L1=L9 TO L2 STEP -15890    B1(L1+1)=B1(L1)5900    C0(1,L1+1)=C0(1,L1)5910    C0(2,L1+1)=C0(2,L1)5920    C9(L1+1)=C9(L1)5930    D1(L1+1)=D1(L1)5940    W1(L1+1)=W1(L1)5950    FOR L3=1 TO L85960       Y0(L3,L1+1)=Y0(L3,L1)5970    NEXT L35980 NEXT L15990 T7=16000 GOSUB 63506010 L9=L9+16020 RETURN 6030 PRINT "L_DELETE A CURVE:"6040 GOSUB 86806050 GOSUB 94906060 IF E1<>0 OR L9<=1 THEN 61506070 PRINT "DELETE CURVE: # ";L2;" '";C$;"' ? G_";6080 INPUT Q$6090 IF Q$<>"Y" THEN 60306100 GOSUB 61606110 L3=L9+16120 GOSUB 134506130 GOSUB 77306140 GO TO 60306150 RETURN 6160 REM **DELETE CURVE: # L2 BY SHIFTING CURVES DOWN**6170 A$=REP("",(L2-1)*16+1,16)6180 A$=REP("                ",(M8-1)*16+1,0)6190 IF L2=>L9 THEN 63306200 FOR L1=L2 TO L9-16210    B1(L1)=B1(L1+1)6220    C0(1,L1)=C0(1,L1+1)6230    C0(2,L1)=C0(2,L1+1)6240    C9(L1)=C9(L1+1)6250    D1(L1)=D1(L1+1)6260    W1(L1)=W1(L1+1)6270    FOR L3=1 TO L86280       Y0(L3,L1)=Y0(L3,L1+1)6290    NEXT L36300 NEXT L16310 T7=-16320 GOSUB 63506330 L9=L9-16340 RETURN 6350 REM **UPDATE CURVE SOURCES C0 WHEN ADDING/DELETING CURVES**6360 FOR L1=L2 TO L9+T76370    C0(1,L1)=C0(1,L1)+T7*(C0(1,L1)=>L2)*(D1(L1)=>4 AND D1(L1)<=9) MA        X 16380    C0(2,L1)=C0(2,L1)+T7*(C0(2,L1)=>L2)*(D1(L1)=>4 AND D1(L1)<=9) MA        X 16390 NEXT L16400 RETURN 6410 PRINT "L_MODIFY A CURVE'S DATA:"6420 GOSUB 86806430 GOSUB 94906440 IF E1<>0 THEN 64806450 IF D1(L2)>2 THEN 64106460 GOSUB 64906470 GO TO 64106480 RETURN 6490 REM **MODIFY CURVE: # L2 DATA**6500 L3=06510 PRINT "L_DATA FOR   CURVE: # ";L2;"  '";C$;"'"6520 PRINT "(<RETURN>=NEXT,<N>=NONE,<J#>=JUMP,<E>=END):"6530 L4=06540 L4=L4+16550 IF L4>26 AND L3<L8 THEN 65106560 L3=L3+16570 IF L3>L8 THEN 68406580 C$=SEG(L$,(L3-1)*16+1,11)6590 PRINT USING "2A,2D,2A,11A,14A,S":"#";L3;" '";C$;"' OLD DATA = #"6600 IF Y0(L3,L2)<>N9 THEN 66306610 PRINT " NONE"6620 GO TO 66406630 PRINT Y0(L3,L2)6640 PRINT "K_I_I_          NEW DATA = # G_";6650 INPUT T$6660 IF T$="" THEN 65406670 IF T$="E" THEN 68406680 IF T$<>"N" THEN 67106690 Y0(L3,L2)=N96700 GO TO 65406710 IF POS(T$,"J",1)<>1 THEN 67806720 T$=REP("",1,1)6730 GOSUB 96806740 IF T$="" THEN 64906750 IF E1<>0 THEN 48606760 L3=(VAL(T$) MAX 1 MIN L8)-16770 GO TO 65406780 GOSUB 96806790 IF E1=0 THEN 68206800 L3=L3-16810 GO TO 65406820 Y0(L3,L2)=VAL(T$) MAX N9 MIN -N96830 GO TO 65406840 RETURN 6850 PRINT "L_ADD DATA TO ALL CURVES:"6860 GOSUB 86806870 GOSUB 75306880 PRINT "INSERT ADDITIONAL EVENTS BEFORE EVENT"6890 PRINT "(<RETURN>=NONE,<A>=AFTER LAST PRESENT EVENT #";L8;"): # G_";6900 INPUT T$6910 L4=L8+16920 IF T$="A" THEN 69706930 GOSUB 96806940 IF T$="" THEN 73206950 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>L8 THEN 68506960 L4=VAL(T$)6970 PRINT "__NUMBER OF ADDITIONAL EVENTS";6980 PRINT "(<RETURN>=NONE,MAX=";M9-L8;"): # G_";6990 INPUT T$7000 GOSUB 96807010 IF T$="" THEN 73207020 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>M9-L8 THEN 69707030 L5=VAL(T$)7040 IF L4=>L8+1 THEN 71007050 FOR L3=1 TO L97060    FOR L1=L8+L5 TO L4+L5 STEP -17070       Y0(L1,L3)=Y0(L1-L5,L3)7080    NEXT L17090 NEXT L37100 FOR L2=L4 TO L4+L5-17110    PRINT "L_ADDITIONAL EVENT LABEL:    # ";L2;7120    PRINT USING "18X,""'H_"",16(""H__H_""),""H_'G_"",S":7130    INPUT T$7140    GOSUB 77807150    L$=REP("",(M9-1)*16+1,16)7160    L$=REP(T$,(L2-1)*16+1,0)7170    PRINT "__ADDITIONAL DATA FOR EVENT: # ";L2;" '";T$;"'__"7180    FOR L3=1 TO L97190       IF D1(L3)>2 THEN 72807200       C$=SEG(A$,(L3-1)*16+1,16)7210       PRINT "CURVE: # ";L3;" '";C$;"' DATA(<RETURN>=NONE): # G_";7220       INPUT T$7230       Y0(L2,L3)=N97240       GOSUB 96807250       IF T$="" THEN 72807260       IF E1<>0 THEN 72007270       Y0(L2,L3)=VAL(T$) MAX N9 MIN -N97280    NEXT L37290 NEXT L27300 L8=L8+L57310 GO TO 68507320 RETURN 7330 PRINT "L_DELETE DATA FROM ALL CURVES:"7340 GOSUB 86807350 GOSUB 75307360 PRINT "DELETE DATA FROM ALL CURVES FOR EVENT(<RETURN>=NONE): # G_";7370 INPUT T$7380 GOSUB 96807390 IF T$="" OR L8<=1 THEN 75207400 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>L8 THEN 73307410 L2=VAL(T$)7420 IF L2=>L8 THEN 75007430 L$=REP("",(L2-1)*16+1,16)7440 L$=REP("                ",(M9-1)*16+1,0)7450 FOR L3=1 TO L97460    FOR L1=L2 TO L8-17470       Y0(L1,L3)=Y0(L1+1,L3)7480    NEXT L17490 NEXT L37500 L8=L8-17510 GO TO 73307520 RETURN 7530 PRINT "__EVENT(E) LABELS:__"7540 FOR L1=1 TO L87550    T$=SEG(L$,(L1-1)*16+1,8)7560    PRINT USING "2A,2D,4A,8A,2A,S":"#";L1;" = '";T$;"'"7570 NEXT L17580 PRINT "__"7590 RETURN 7600 PRINT "L_LOAD A CURVE:"7610 GOSUB 86807620 GOSUB 94907630 IF E1<>0 THEN 77207640 GOSUB 78407650 IF E1<>0 THEN 76007660 GOSUB 77307670 D1(L3)=27680 GOSUB 77807690 C$=T$7700 A$=REP(C$,(L2-1)*16+1,16)7710 GOSUB 38007720 RETURN 7730 REM **INIT CURVE: # L3**7740 RESTORE 77507750 DATA 0,1,1,0,1,17760 READ B1(L3),C0(1,L3),C0(2,L3),C9(L3),D1(L3),W1(L3)7770 RETURN 7780 REM **PAD T$ WITH TRAILING BLANKS TO 16 CHARACTERS**7790 T$=SEG(T$,1,16)7800 IF LEN(T$)=>16 THEN 78307810 T$=T$&" "7820 GO TO 77807830 RETURN 7840 REM **LOAD A CURVE**7850 N$="CURVE"7860 GOSUB 84707870 IF E1<>0 THEN 79307880 L3=L27890 GOSUB 134507900 FOR L1=1 TO T1 MIN M97910    INPUT @33:Y0(L1,L2)7920 NEXT L17930 RETURN 7940 PRINT "L_# OF GRAPHS ON THE PAGE(<RETURN>=NONE,MIN=2,MAX=4): # G_";7950 INPUT T$7960 IF T$="" THEN 82107970 IF T$<>"2" AND T$<>"3" AND T$<>"4" THEN 79407980 A0=17990 G9=VAL(T$)8000 GO TO G9 OF 7940,8010,8040,80708010 RESTORE 80208020 DATA 0,0.5,0.25,0.75,0.5,1,0.25,0.758030 GO TO 80908040 RESTORE 80508050 DATA 0,0.5,0.5,1,0,0.5,0,0.5,0.5,1,0.25,0.758060 GO TO 80908070 RESTORE 80808080 DATA 0,0.5,0.5,1,0,0.5,0,0.5,0.5,1,0.5,1,0.5,1,0,0.58090 FOR G1=1 TO G98100    READ V1,V2,V3,V48110    GOSUB 83608120    IF E1<>0 THEN 82008130    PRINT "L_MODIFY GRAPH ";G1;" OF ";G9;",____GRAPH: # ";G3;" '";G$;"'        __"8140    PRINT "LABELS AND/OR PARAMETERS BEFORE PLOTTING? G_";8150    INPUT Q$8160    IF Q$<>"Y" THEN 81908170    GOSUB 47508180    GOSUB 27308190    GOSUB 97908200 NEXT G18210 RETURN 8220 REM **COPY GRAPH ON FILE: # F1+4 TO ANOTHER GRAPHING TAPE**8230 GOSUB 83608240 IF E1<>0 THEN 83508250 FIND 48260 PRINT "L_INSERT TAPE TO COPY GRAPH TO, THEN PRESS <RETURN>: G_";8270 INPUT Q$8280 GOSUB 11208290 G1=G38300 GOSUB 88708310 G3=G18320 PRINT "L_INSERT ORIGINAL GRAPHING TAPE, THEN PRESS <RETURN>: G_";8330 INPUT Q$8340 GOSUB 11208350 RETURN 8360 REM **LOAD A GRAPH**8370 N$="GRAPH"8380 GOSUB 84708390 IF E1<>0 THEN 84608400 L8=T18410 INPUT @33:L9,T8,T9,X9,Y5,Y7,Y8,Y9,F2,F3,F4,F58420 INPUT @33:V$,G$,S$,F$,X$,Y$,Z$,A$,L$8430 INPUT @33:B1,C0,C9,D1,W1,Y08440 G3=F18450 GOSUB 86808460 RETURN 8470 PRINT "L_";D$;"__LOAD ";N$;" FROM G(<RETURN>=NONE): # G_";8480 INPUT T$8490 E1=18500 IF T$="" THEN 86708510 GOSUB 96808520 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)=>F8 THEN 84708530 F1=VAL(T$)8540 T$=SEG(D$,(F1+2-1)*66+1,5)8550 IF T$<>N$ THEN 85908560 FIND F1+48570 INPUT @33:T$8580 IF POS(T$,N$,1)<>0 THEN 86308590 PRINT "L_G# ";F1;" DOES NOT CONTAIN A ";N$;"!!!G_G_G_"8600 PRINT "__I_PRESS <RETURN> TO CONTINUE: G_";8610 INPUT Q$8620 GO TO 84708630 IF N$<>"CURVE" THEN 86508640 INPUT @33:T$,T$8650 INPUT @33:T18660 E1=08670 RETURN 8680 REM **RESET X & Y ZOOM TO NO ZOOM**8690 Z6=18700 Z8=L88710 Z7=18720 Z9=L98730 RETURN 8740 PRINT "L_SAVE A CURVE:"8750 N$="CURVE"8760 GOSUB 94908770 IF E1<>0 THEN 88608780 GOSUB 89908790 IF E1<>0 THEN 87408800 PRINT @33:"CURVE DATA FILE: # ";F1+4;R$;V$;R$;C$;R$;L88810 FOR L1=1 TO L88820    PRINT @33:"";Y0(L1,L2)8830 NEXT L18840 CLOSE 8850 GOSUB 93008860 RETURN 8870 REM **SAVE A GRAPH**8880 N$="GRAPH"8890 GOSUB 89908900 IF E1<>0 THEN 89808910 PRINT @33:"GRAPH DATA FILE: # ";F1+4;R$;L8;R$;L9;R$;T8;R$;T98920 PRINT @33:"";X9;R$;Y5;R$;Y7;R$;Y8;R$;Y9;R$;F2;R$;F3;R$;F4;R$;F58930 PRINT @33:V$;R$;G$;R$;S$;R$;F$;R$;X$;R$;Y$;R$;Z$;R$;A$;R$;L$8940 PRINT @33:B1;C0;C9;D1;W1;Y0;8950 CLOSE 8960 G3=F18970 GOSUB 93008980 RETURN 8990 PRINT "L_";D$;"__SAVE__";N$;": # ";G3;9000 M$=G$9010 IF N$="GRAPH" THEN 90309020 M$=C$9030 PRINT " '";M$;"'K_K___        ONTO G(<RETURN>=NONE,<N>=NEXT): # G_";9040 INPUT T$9050 E1=19060 IF T$="" THEN 92909070 F1=F89080 IF T$="N" AND F8<=30 THEN 91209090 GOSUB 96809100 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>F8 MIN 30 THEN 89909110 F1=VAL(T$)9120 PAGE 9130 IF F1<F8 OR LEN(D$)=>32*66 THEN 91909140 FIND F1+49150 MARK 1,64009160 D$=REP(B$,LEN(D$)+1,0)9170 F8=LEN(D$)/66-2+19180 GO TO 92409190 T$=SEG(D$,(F1+2-1)*66+1,54)9200 PRINT "     REPLACE:'";T$;"'"9210 PRINT USING "14A,FA,9A,40A,4A,S":"WITH PRESENT:'";N$;":";M$;"'?G_"9220 INPUT Q$9230 IF Q$<>"Y" THEN 89909240 FIND F1+49250 GOSUB 86809260 GOSUB 133809270 V$=W$9280 E1=09290 RETURN 9300 REM **UPDATE DIRECTORY D$**9310 T$=B$9320 T$=REP(N$,1,LEN(N$))9330 T$=REP(": #",6,3)9340 C$=STR(F1)9350 T$=REP(C$,12-LEN(C$),LEN(C$))9360 T$=REP(M$,15,LEN(M$))9370 T$=REP(W$,57,LEN(W$))9380 M$=SEG(D$,(F1+2-1)*66+1,66)9390 IF T$=M$ THEN 94309400 D$=REP(T$,(F1+2-1)*66+1,66)9410 D$=REP(W$,57,LEN(W$))9420 GOSUB 94409430 RETURN 9440 PRINT "__SAVING  THE GRAPH DIRECTORY ONTO THE TAPE."9450 FIND 49460 PRINT @33:D$;9470 CLOSE 9480 RETURN 9490 REM **SELECT CURVE**9500 GOSUB 96209510 PRINT "CURVE(<RETURN>=NONE, MAX=";Z9;"): # G_";9520 INPUT T$9530 PRINT 9540 E1=19550 IF T$="" THEN 96109560 GOSUB 96809570 IF E1<>0 OR VAL(T$)<1 OR VAL(T$)>L9 THEN 94909580 L2=VAL(T$)9590 C$=SEG(A$,(L2-1)*16+1,16)9600 E1=09610 RETURN 9620 REM **LIST CURVE TITLES**9630 A0=329640 PRINT 9650 GOSUB 152609660 PRINT 9670 RETURN 9680 REM **T$=A VALID #?**9690 E1=09700 IF T$="" THEN 97809710 FOR L1=1 TO LEN(T$)9720    Q$=SEG(T$,L1,1)9730    IF POS("0123456789.-",Q$,1)<>0 THEN 97709740    E1=19750    T$=STR(N9)9760    PRINT "G_G_G_";9770 NEXT L19780 RETURN 9790 REM **DRAW GRAPH**9800 VIEWPORT (130+20*(A0<>32))*V1,(130+20*(A0<>32))*V2,100*V3,100*V49810 WINDOW 0,130,0,1009820 PAGE 9830 IF A0>15 THEN 99709840 IF G1<>1 THEN 98909850 T$=SEG("NY",F6+1,1)9860 PRINT "CHANGE GRAPH PEN COLORS(<RETURN>=";T$;")? G_";9870 INPUT Q$9880 F6=(Q$="Y")+F6*(Q$="")9890 GOSUB 147909900 T$=T$&"____ASSURE PEN COLOR FOR GRAPH TITLES,"9910 T$=REP("",LEN(T$)-7,7*(F6=0))9920 IF F6=0 OR F7<>1 OR G1<>1 THEN 99509930 PRINT "__MULTI-PEN OPTION SELECTED.______PEN FUNCTION:__"9940 PRINT "1>6 CURVES 1>6__ 7  X & Y LABELS__ 8  GRAPH TITLES__"9950 GOSUB F6=1 AND F7<>1 OR G1=1 OF 150809960 PRINT @A0,17:S0*(V2-V1 MAX 0.5)*150/130,L0*(V4-V3 MAX 0.5)9970 REM **GRAPH TITLES**9980 FOR L1=1 TO 29990    MOVE @A0:66-LEN(G$)/2*S0,9710000    PRINT @A0:G$;10010 NEXT L110020 IF G2=0 OR G3=0 THEN 1005010030 MOVE @A0:20,9710040 PRINT @A0:"# ";G3;10050 MOVE @A0:120-LEN(V$)*S0,9710060 PRINT @A0:V$;10070 MOVE @A0:66-LEN(S$)/2*S0,9410080 PRINT @A0:S$;10090 MOVE @A0:(T8-1)*S0,100-T9*L010100 PRINT @A0:F$;10110 FOR L2=1 TO LEN(Z$)10120    Q$=SEG(Z$,L2,1)10130    MOVE @A0:128,52.4+(LEN(Z$)/2-L2+1)*L010140    PRINT @A0:Q$;10150 NEXT L210160 MOVE @A0:66-LEN(X$)/2*S0,510170 PRINT @A0:X$;10180 FOR L2=1 TO LEN(Y$)10190    Q$=SEG(Y$,L2,1)10200    MOVE @A0:0,52.4+(LEN(Y$)/2-L2+1)*L010210    PRINT @A0:Q$;10220 NEXT L210230 IF A0>15 OR F6=0 THEN 1029010240 IF F7<>1 THEN 1027010250 PRINT @A0,8:710260 GO TO 1029010270 T$="__CHANGE PEN COLOR FOR X & Y AXIS LABELS,"10280 GOSUB 1508010290 IF G9<>1 THEN 1036010300 MOVE @A0:128,10010310 RDRAW @A0:2,010320 RDRAW @A0:0,-210330 MOVE @A0:0,210340 RDRAW @A0:0,-210350 RDRAW @A0:2,010360 MOVE @A0:20,2010370 FOR L1=0 TO 0.4 STEP 0.110380    DRAW @A0:20-L1,20-L110390    DRAW @A0:120+L1,20-L110400    DRAW @A0:120+L1,90+L110410    DRAW @A0:20-L1,90+L110420    DRAW @A0:20-L1,20-L110430 NEXT L110440 X5=100/(Z8-Z6+1)10450 REM **LABEL X-AXIS**10460 T1=010470 T3=X9*(F3=0)+1*(F3<>0)10480 FOR L1=Z6-INT(0.5/T3)*T3*(T3<0.5) TO Z8+0.5 STEP T3 MIN 110490    T4=L1-Z610500    IF T4=>0 THEN 1052010510    T4=INT(T4*10^13+1)/10^1310520    X1=20+X5*(T4+0.5)10530    T2=T4/5=INT(T4/5+1.0E-6)=0 AND Z8-Z6+1>2610540    T2=T2 OR T4<>INT(T4+1.0E-6)10550    IF T2=1 THEN 1061010560    T$=SEG(L$,(L1-1)*16+1,16)10570    GOSUB 1294010580    MOVE @A0:X1+0.4-LEN(T$)/2*S0,20-5-T1*L010590    PRINT @A0:T$;10600    T1=NOT(T1) AND (F4=1 OR (Z8-Z6+1>13 AND Z8-Z6+1<=26))10610    MOVE @A0:X1,20-2+2/3*T210620    T2=F5=2 OR F5=3 AND T4/T3=INT(T4/T3+1.0E-6)10630    DRAW @A0:X1,20+70*T210640 NEXT L110650 REM **FIND Y-AXIS MAX**10660 GOSUB 1338010670 IF F3=0 THEN 1100010680 Y6=010690 Y8=010700 Y9=010710 FOR L3=1 TO Z910720    IF C9(L3)=8 THEN 1079010730    FOR L1=1 TO L810740       IF Y0(L1,L3)=N9 THEN 1078010750       Y8=Y8 MIN Y0(L1,L3)10760       Y6(L1)=Y6(L1)+Y0(L1,L3)*(C9(L3)=-1) MAX Y0(L1,L3)10770       Y9=Y9 MAX Y6(L1)10780    NEXT L110790 NEXT L310800 REM **FIND SPIFFY Y-AXIS LABELS**10810 T2=510820 IF Y9>0 OR Y8=>0 THEN 1084010830 Y9=ABS(Y8) MAX ABS(Y9)10840 L1=-1110850 L1=L1+110860 T1=Y9/10^(L1-1)10870 IF T1>10 AND L1<=10 THEN 1085010880 L2=010890 L2=L2+T2/1010900 IF T1>L2*T2 THEN 1089010910 Y9=L2*T2*10^(L1-1)10920 IF Y8=>0 THEN 1098010930 L1=010940 L1=L1+Y9/T210950 IF ABS(Y8)>L1 THEN 1094010960 Y8=-L110970 T2=T2+T2*L1/Y910980 Y7=(Y9-Y8)/T210990 Y5=Y711000 REM **LABEL Y-AXIS**11010 IF Y8=>0 OR Y9<=0 THEN 1108011020 Y1=20-Y8/(Y9-Y8)*7011030 MOVE @A0:20-2,Y1+0.211040 FOR L2=0.2 TO -0.2 STEP -0.211050    DRAW @A0:120,Y1+L211060    DRAW @A0:20-2,Y1+L211070 NEXT L211080 T3=Y7 MIN Y511090 FOR L1=Y9-Y8 TO 0 STEP -T311100    Y1=20+L1/(Y9-Y8)*7011110    T1=Y9-Y8-L111120    T$=STR(INT((L1+Y8)*10^6+1.0E-6)/10^6)11130    T$=SEG(T$,2,8)11140    IF T1/Y7<>INT(T1/Y7+1.0E-6) AND T$<>"0" THEN 1117011150    MOVE @A0:(10-LEN(T$))*S0,Y1-1.111160    PRINT @A0:T$;11170    MOVE @A0:20-2+2/3*(T1/Y7<>INT(T1/Y7+1.0E-6)),Y111180    T2=F5=1 OR F5=3 AND L1>0 AND L1<Y9-Y8 AND T1/Y5=INT(T1/Y5+         1.0E-6)11190    IF T2=1 THEN 1122011200    DRAW @A0:20,Y111210    MOVE @A0:120,Y111220    DRAW @A0:20+100+2-2/3*(T1/Y7<>INT(T1/Y7+1.0E-6)),Y111230 NEXT L111240 C2=011250 FOR L1=Z7 TO Z911260    C2=C2+(C9(L1)=-2)+(C9(L1)=-1 AND C2=0)11270 NEXT L111280 W2=X5/3/(C2 MAX 1)-0.2511290 C1=-111300 C3=011310 Y6=N911320 FOR L3=1 TO Z911330    IF C9(L3)=8 THEN 1288011340    IF L3<Z7 THEN 1207011350    VIEWPORT (130+20*(A0<>32))*V1,(130+20*(A0<>32))*V2,100*V3,100*V         411360    WINDOW 0,130,0,10011370    IF A0>15 OR F6=0 THEN 1147011380    IF F7<>1 THEN 1141011390    PRINT @A0,8:L311400    GO TO 1147011410    T$="__CHANGE PEN COLOR FOR CURVE: #   '                '"11420    C$=STR(L3)11430    T$=REP(C$,33-LEN(C$),LEN(C$))11440    C$=SEG(A$,(L3-1)*16+1,16)11450    T$=REP(C$,35,16)11460    GOSUB 1508011470    REM **LABEL CURVES AND DRAW LEGENDS**11480    S1=5/(ABS(B1(L3)) MAX 1)11490    T$=SEG(A$,(L3-1)*16+1,16)11500    IF T$="                " THEN 1207011510    Y3=3.5*L0-(L3*L0*(L3<4)+(L3-3)*L0*(L3=>4))11520    X3=19*(L3<4)+110*(L3=>4)11530    GOSUB 1294011540    IF L3<4 THEN 1157011550    MOVE @A0:X3-LEN(T$)*S0,Y311560    GO TO 1158011570    MOVE @A0:X3+1.25,Y311580    PRINT @A0:T$;11590    X3=X3-14*(L3<4)+2*(L3=>4)11600    X1=X311610    X2=X1+1011620    Y2=Y3+L0/211630    Y1=Y211640    IF C9(L3)=>0 AND C9(L3)<=6 THEN 1197011650    IF C9(L3)=7 THEN 1204011660    REM **BAR**11670    MOVE @A0:X3,Y311680    DRAW @A0:X3,Y3+L011690    DRAW @A0:X3+10,Y3+L011700    DRAW @A0:X3+10,Y311710    DRAW @A0:X3,Y311720    IF B1(L3)=0 THEN 1207011730    IF B1(L3)<0 THEN 1185011740    REM **VERTICAL SHADING**11750    IF S1>10 THEN 1207011760    MOVE @A0:X3+S1,Y311770    FOR L4=S1 TO 10 STEP 2*S111780       DRAW @A0:X3+L4,Y311790       DRAW @A0:X3+L4,Y3+L011800       IF L4+S1=>10 THEN 1183011810       DRAW @A0:X3+L4+S1,Y3+L011820       DRAW @A0:X3+L4+S1,Y311830    NEXT L411840    GO TO 1207011850    REM **HORIZONTAL SHADING**11860    IF S1>Y3+L0 THEN 1207011870    MOVE @A0:X3,Y3+S111880    FOR L4=S1 TO Y3+L0 STEP 2*S111890       IF L4>L0 THEN 1195011900       DRAW @A0:X3,Y3+L411910       DRAW @A0:X3+10,Y3+L411920       IF L4+S1=>L0 THEN 1195011930       DRAW @A0:X3+10,Y3+L4+S111940       DRAW @A0:X3,Y3+L4+S111950    NEXT L411960    GO TO 1207011970    REM **LINE**11980    MOVE @A0:X1,Y111990    D2=112000    X4=012010    Y4=012020    GOSUB 1299012030    GO TO 1207012040    REM **TRILINE**12050    X2=X1+512060    GOSUB 1330012070    REM **DRAW CURVES**12080    T1=(130+20*(A0<>32))/130*(130*V1+20*(V2-V1))12090    T2=(130+20*(A0<>32))/130*(130*V1+120*(V2-V1))12100    VIEWPORT T1,T2,100*V3+20*(V4-V3),100*V3+90*(V4-V3)12110    WINDOW 0,100,0,7012120    IF L3<Z7 OR C9(L3)>-1 THEN 1215012130    C1=C1+(C9(L3)=-2)+(C9(L3)=-1 AND C1=-1)12140    C3=C3+112150    D2=112160    X1=012170    X4=012180    Y1=012190    Y4=012200    FOR L1=Z6 TO Z812210       REM **DONT PLOT NULL #**12220       IF Y0(L1,L3)=N9 THEN 1287012230       X2=X5*(L1-Z6+0.5)12240       Y2=(Y0(L1,L3)-Y8)/(Y9-Y8)*7012250       IF C9(L3)<=-1 THEN 1229012260       IF L3<Z7 THEN 1286012270       IF C9(L3)=>0 AND C9(L3)<=6 THEN 1270012280       IF C9(L3)=7 THEN 1283012290       REM **BAR**12300       IF Y6(L1)<>N9 AND C9(L3)<>-2 AND (C1<>0 OR C3>1) THEN 1232012310       Y6(L1)=-Y8/(Y9-Y8)*7012320       IF C9(L3)<>-1 THEN 1234012330       Y2=Y6(L1)+Y0(L1,L3)/(Y9-Y8)*7012340       IF L3<Z7 OR (Y2<Y6(L1) AND F2=1) THEN 1268012350       X3=X2+X5/3/C2*(2*(C1 MAX 0)-C2+1)12360       MOVE @A0:X3-W2,Y6(L1)12370       DRAW @A0:X3-W2,Y212380       DRAW @A0:X3+W2,Y212390       DRAW @A0:X3+W2,Y6(L1)12400       DRAW @A0:X3-W2,Y6(L1)12410       T1=Y6(L1) MAX 0 MIN 7012420       T2=Y2 MAX 0 MIN 7012430       IF B1(L3)=0 OR T1=T2 THEN 1268012440       IF B1(L3)<0 THEN 1256012450       REM **VERTICAL SHADING**12460       IF S1=>2*W2 THEN 1268012470       MOVE @A0:X3-W2+S1,Y6(L1)12480       FOR L2=S1 TO 2*W2 STEP 2*S112490          DRAW @A0:X3-W2+L2,Y6(L1)12500          DRAW @A0:X3-W2+L2,Y212510          IF L2+S1=>2*W2 THEN 1254012520          DRAW @A0:X3-W2+L2+S1,Y212530          DRAW @A0:X3-W2+L2+S1,Y6(L1)12540       NEXT L212550       GO TO 1268012560       REM **HORIZONTAL SHADING**12570       T3=T1*(T1<T2)+T2*(T2<T1)12580       T4=T1*(T1>T2)+T2*(T2>T1)12590       IF T3+S1=>T4 THEN 1268012600       MOVE @A0:X3-W2,T3+S112610       FOR L2=T3+S1 TO T4 STEP 2*S112620          DRAW @A0:X3-W2,L212630          DRAW @A0:X3+W2,L212640          IF L2+S1=>T4 THEN 1267012650          DRAW @A0:X3+W2,L2+S112660          DRAW @A0:X3-W2,L2+S112670       NEXT L212680       Y6(L1)=Y212690       GO TO 1287012700       REM **LINE**12710       IF L1=Z6 THEN 1277012720       IF Y1<0 AND Y2<0 OR (Y1>70 AND Y2>70) THEN 1280012730       IF Y1=>0 AND Y1<=70 OR C9(L3)<>0 THEN 1276012740       MOVE @A0:X1,Y112750       GO TO 1279012760       IF Y0(L1-1,L3)<>N9 AND (Y2>Y6(L1) OR F2<>1) THEN 1279012770       MOVE @A0:X2,Y212780       GO TO 1280012790       GOSUB 1299012800       X1=X212810       Y1=Y212820       GO TO 1286012830       REM **TRILINE**12840       IF Y2<Y6(L1) AND F2=1 THEN 1286012850       GOSUB 1330012860       Y6(L1)=Y2 MAX Y6(L1)12870    NEXT L112880 NEXT L312890 PRINT @A0:"G_G_";12900 IF G1<>G9 AND G9<>1 AND (F6=0 OR (F6=1 AND F7=1)) THEN 1292012910 GOSUB A0<=15 OF 1502012920 HOME 12930 RETURN 12940 REM **STRIP TRAILING BLANKS FROM T$**12950 IF POS(T$," ",LEN(T$))<>LEN(T$) OR T$="" THEN 1298012960 T$=REP("",LEN(T$),1)12970 GO TO 1294012980 RETURN 12990 REM **LINE**13000 IF C9(L3)<>0 THEN 1303013010 DRAW @A0:X2,Y213020 GO TO 1329013030 T4=Y2-Y113040 T5=X2-X113050 T6=SQR(T5^2+T4^2)13060 IF T6=0 THEN 1329013070 T2=X113080 T3=Y113090 T1=(D9(C9(L3),D2)-SQR(X4^2+Y4^2))/T613100 T2=T2+T5*T113110 T3=T3+T4*T113120 IF T3<0 OR T3>70 THEN 1323013130 X4=013140 Y4=013150 IF T2<=X2 THEN 1320013160 X4=ABS(X1-X2)13170 Y4=ABS(Y1-Y2)13180 T2=X213190 T3=Y213200 MOVE @A0:X1,Y113210 IF D2=2 OR D2=4 THEN 1323013220 DRAW @A0:T2,T313230 D2=(D2+1)*(D2<>4)+(D2=4)13240 X1=T213250 Y1=T313260 IF T2<X2 THEN 1309013270 IF X4=0 AND Y4=0 THEN 1329013280 D2=(D2-1)*(D2<>1)+4*(D2=1)13290 RETURN 13300 REM **TRILINE**13310 MOVE @A0:X2,Y213320 DRAW @A0:X2,Y213330 MOVE @A0:X2,Y2+113340 DRAW @A0:X2-0.5,Y2-0.513350 DRAW @A0:X2+0.5,Y2-0.513360 DRAW @A0:X2,Y2+113370 RETURN 13380 REM **LOAD Y0 WITH CALCULATED CURVES**13390 FOR L3=1 TO Z913400    GOSUB D1(L3)>2 OF 1345013410    GOSUB D1(L3)-2 OF 13500,13550,13650,13550,1381013420    GOSUB D1(L3)-2-5 OF 14050,14110,14180,1418013430 NEXT L313440 RETURN 13450 REM **NULL(N9) CURVE # L3**13460 FOR L6=1 TO L813470    Y0(L6,L3)=N913480 NEXT L613490 RETURN 13500 REM **CONSTANT=W1(L3)**13510 FOR L6=1 TO L813520    Y0(L6,L3)=W1(L3)13530 NEXT L613540 RETURN 13550 REM **RUNNING AVERAGE/CUMULATIVE SUM OF PREVIOUS CURVE**13560 T1=013570 T2=013580 FOR L6=1 TO L813590    IF Y0(L6,C0(1,L3))=N9 THEN 1363013600    T1=T1+Y0(L6,C0(1,L3))13610    T2=T2+(D1(L3)=4)13620    Y0(L6,L3)=T1/(T2 MAX 1)13630 NEXT L613640 RETURN 13650 REM **MOVING AVERAGE OF PREVIOUS CURVE**13660 T3=013670 FOR L6=1 TO L813680    T3=T3+(L6>W1(L3))13690    IF Y0(L6,C0(1,L3))=N9 THEN 1379013700    T1=013710    T2=013720    FOR L5=1+T3 TO L613730       IF Y0(L5,C0(1,L3))=N9 THEN 1376013740       T1=T1+Y0(L5,C0(1,L3))13750       T2=T2+113760    NEXT L513770    IF T2=0 THEN 1379013780    Y0(L6,L3)=T1/T213790 NEXT L613800 RETURN 13810 REM **LEAST SQUARES FIT Y=a+bX OF PREVIOUS CURVE**13820 L6=013830 T1=013840 T2=013850 T3=013860 T4=013870 FOR L5=1 TO L813880    IF Y0(L5,C0(1,L3))=N9 THEN 1394013890    L6=L6+113900    T1=T1+L613910    T2=T2+L6^213920    T3=T3+Y0(L5,C0(1,L3))13930    T4=T4+Y0(L5,C0(1,L3))*L613940 NEXT L513950 T5=T2*T3-T1*T413960 T6=L6*T4-T1*T313970 T7=L6*T2-T1^213980 L6=013990 FOR L5=1 TO L814000    IF Y0(L5,C0(1,L3))=N9 THEN 1403014010    L6=L6+114020    Y0(L5,L3)=(T5/L6+T6)/T7*L614030 NEXT L514040 RETURN 14050 REM **(-) OF 2 CURVES**14060 FOR L6=1 TO L814070    IF Y0(L6,C0(1,L3))=N9 OR Y0(L6,C0(2,L3))=N9 THEN 1409014080    Y0(L6,L3)=Y0(L6,C0(1,L3))-Y0(L6,C0(2,L3))14090 NEXT L614100 RETURN 14110 REM **% OF 2 CURVES**14120 FOR L6=1 TO L814130    IF Y0(L6,C0(1,L3))=N9 OR Y0(L6,C0(2,L3))=N9 THEN 1416014140    IF Y0(L6,C0(2,L3))=0 THEN 1416014150    Y0(L6,L3)=Y0(L6,C0(1,L3))/Y0(L6,C0(2,L3))*10014160 NEXT L614170 RETURN 14180 REM **AVERAGE/SUM OF PREVIOUS CURVES**14190 FOR L6=1 TO L814200    T1=014210    T2=014220    FOR L5=1 TO L3-114230       T1=T1+Y0(L6,L5)*(Y0(L6,L5)<>N9)14240       T2=T2+(Y0(L6,L5)<>N9)14250    NEXT L514260    IF D1(L3)<>11 OR T2=0 THEN 1429014270    Y0(L6,L3)=T114280    GO TO 1431014290    IF T2=0 THEN 1431014300    Y0(L6,L3)=T1/T214310 NEXT L614320 RETURN 14330 PRINT "L_LIST ON SCREEN<RETURN>, PLOTTER<P>, OR PRINTER<T>: G_";14340 INPUT Q$14350 A0=32*(Q$="" OR (Q$<>"P" AND Q$<>"T"))+1*(Q$="P")+51*(Q$="T")14360 PAGE 14370 IF A0>15 THEN 1443014380 GOSUB 1479014390 GOSUB 1508014400 PRINT @A0,17:10/10*(100/80),10/6*(150/110)14410 MOVE @A0:10/6*(150/110),2*(100/80)14420 PRINT @A0,25:9014430 GOSUB 1518014440 GOSUB 1338014450 L3=014460 FOR L2=Z6 TO Z814470    L3=L3+114480    IF L3<=26+26*(A0<>32) THEN 1455014490    L3=014500    IF A0<>32 THEN 1453014510    PRINT "__I_PRESS <RETURN> TO CONTINUE: G_";14520    INPUT Q$14530    PRINT @A0:"L_";14540    GOSUB 1518014550    C$=SEG(L$,(L2-1)*16+1,4)14560    PRINT @A0: USING "1A,2D,2A,4A,1A,S":"#",L2," '",C$,"'"14570    T1=014580    FOR L1=Z9 TO Z7 STEP -114590       T1=T1+L1*(T1=0)*(Y0(L2,L1)<>N9)14600    NEXT L114610    IF T1<Z7 THEN 1468014620    FOR L1=Z7 TO T114630       IF Y0(L2,L1)<>N9 THEN 1466014640       PRINT @A0:"          ";14650       GO TO 1467014660       PRINT @A0: USING "8D.1D,S":Y0(L2,L1) MAX N9 MIN -N914670    NEXT L114680    PRINT @A0:14690 NEXT L214700 PRINT @A0:"G_";14710 GO TO 1*(A0<=15)+2*(A0=32)+3*(A0=>41)+1 OF 14770,14720,14740,1477014720 GOSUB 1502014730 GO TO 1478014740 PRINT "__I_PRESS <RETURN> TO CONTINUE: G_";14750 INPUT Q$14760 GO TO 1478014770 PRINT @A0:"L_";14780 RETURN 14790 REM **SET PLOTTER**14800 PRINT @A0,0:014810 INPUT @A0,0:T114820 GOSUB 1493014830 IF POS(T$,"1",16-9)<>16-9 THEN 1486014840 PRINT "^_____WITH <LOAD> BUTTON DEPRESSED, PLOTTER NO GO!!!G_G_G_"14850 GO TO 1479014860 INPUT @A0,13:T1,T1,T114870 GOSUB 1493014880 F7=POS(T$,"1",16-15)=16-1514890 IF F7<>1 OR (G1<>1 AND F6=0) THEN 1491014900 PRINT @A0,8:814910 T$=SEG("____ASSURE CORRECT PLOTTER PAGE SIZE,",1,35*(G1=1))14920 RETURN 14930 REM **CONVERT T1 TO BINARY**14940 T$="0000000000000000"14950 T1=T1+2^16*(T1<0) MAX 0 MIN 2^1614960 FOR L1=15 TO 0 STEP -114970    IF T1<2^L1 THEN 1500014980    T1=T1-2^L114990    T$=REP("1",16-L1,1)15000 NEXT L115010 RETURN 15020 REM **RESET PLOTTER**15030 PRINT @A0,7:15040 IF F7<>1 THEN 1506015050 PRINT @A0,8:015060 PRINT @A0,21:150,10015070 RETURN 15080 REM **PROMPT WHEN PLOTTER READY FOR NEXT TASK**15090 PRINT @A0,21:150,10015100 GIN @A0:T1,T115110 PRINT @A0,26:115120 PRINT T$;"____THEN PRESS PLOTTER <CALL> BUTTON:"15130 PRINT @A0:"G_";15140 INPUT @A0,27:T1,T1,T115150 PRINT @A0,26:015160 PAGE 15170 RETURN 15180 REM **CURVE DATA TITLE**15190 GOSUB 1526015200 PRINT @A0:"X-AXIS # :";15210 FOR L1=Z7 TO Z915220    PRINT @A0:" ---------";15230 NEXT L115240 PRINT @A0:15250 RETURN 15260 PRINT @A0: USING "7A,2D,2A,40A/10AS":"GRAPH #";G3;":";G$;"CURVE          :"15270 FOR L1=Z7 TO Z915280    M$=SEG(A$,(L1-1)*16+1,9)15290    PRINT @A0:" ";M$;15300 NEXT L115310 PRINT @A0:R$;"LINE TYPE:";15320 T$="COMP--BARSTACK-BARSOLIDLINEDASHLINE1DASHLINE2DASHLINE3"15330 T$=T$&"DASHLINE4DASHLINE5DASHLINE6TRILINE  PHANTOM  "15340 FOR L1=Z7 TO Z915350    M$=SEG(T$,(C9(L1)+3-1)*9+1,9)15360    PRINT @A0:" ";M$;15370 NEXT L115380 PRINT @A0:R$;"SOURCE   :";15390 T$="KEYBOARD FILE-DATACONSTANT R-AVERAGEM-AVERAGECUM-SUM  "15400 T$=T$&"LEAST-SQRDIF-RENCEPERCENT  AVERAGE  SUM-ALL  "15410 FOR L1=Z7 TO Z915420    M$=SEG(T$,(D1(L1)-1)*9+1,9)15430    PRINT @A0:" ";M$;15440 NEXT L115450 PRINT @A0:R$;"CURVE  # :";15460 FOR L1=Z7 TO Z915470    PRINT @A0:" #";L1;"=";15480    GO TO D1(L1)-3 OF 15510,15510,15510,15510,15530,15550,15570,         1557015490    PRINT @A0:"KEYBRD";15500    GO TO 1558015510    PRINT @A0:"FROM ";C0(1,L1);15520    GO TO 1558015530    PRINT @A0:" ";C0(1,L1);" - ";C0(2,L1);15540    GO TO 1558015550    PRINT @A0:" ";C0(1,L1);"%OF";C0(2,L1);15560    GO TO 1558015570    PRINT @A0:"ALLPRE";15580 NEXT L115590 PRINT @A0:15600 RETURN 