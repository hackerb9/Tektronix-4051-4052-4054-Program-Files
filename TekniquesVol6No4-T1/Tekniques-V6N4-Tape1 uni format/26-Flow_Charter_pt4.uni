1 REMARK  ****    FLOWCHART PROGRAM PART IV    ****2 REMARK    THIS PROTION DRAWS THE FLOWCHART AND THEN GOES BACK TO3 REMARK  THE BEGINNING OF THE PROGRAM AND SEARCHES FOR ANY DATA4 REMARK  OR IMAGE STATEMENTS AND LIST THEM.100 INIT 105 SET DEGREES 110 PAGE 120 FIND 5130 READ @33:C3,D,C2140 DIM F(3,C3 MAX 1),F$(D MAX 1),B(C2 MAX 1)145 DIM A$(74),Q$(74)150 READ @33:F,F$,B,A$,K154 MOVE 65-LEN(A$)/2*1.792,97156 PRINT A$160 FIND 6170 READ @33:A,C1180 DIM N(2,C1 MAX 1),L$(74)190 READ @33:N210 C5=1220 C6=1230 J$=CHR(34)240 P1=1245 N1=1250 X0=32.5251 X=0252 S=5253 T=99254 L$="START"255 GOSUB 7000256 MOVE X0,T257 RDRAW 0,3258 T2=1270 L8=65300 FIND 7310 ON EOF (0) THEN 10000320 INPUT @33:L$325 IF LEN(L$)=0 THEN 310330 X=VAL(L$)331 IF K=1 AND X<100 AND X/4=INT(X/4) THEN 9000332 IF T2<>1 THEN 340334 T2=0336 F1=X339 IF C6=C2 THEN 360340 IF X=ABS(B(C6)) THEN 11000350 IF X<ABS(B(C6)) THEN 360355 C6=C6+1 MIN C2356 GO TO 339360 IF X=N(1,C5) THEN 3240370 A=POS(L$," ",1)380 A$=SEG(L$,A+1,3)390 IF A$="PRI" THEN 3600400 IF A$="LET" THEN 610410 IF A$="OFF" THEN 660420 IF A$="FOR" THEN 1010430 IF A$="AXI" THEN 1960440 IF A$="GIN" THEN 1760450 IF A$="RDR" OR A$="RMO" THEN 1860460 IF A$="FIN" THEN 1080470 IF A$="SEC" THEN 1140480 IF A$="END" OR A$="RET" OR A$="RUN" OR A$="STO" THEN 970490 IF A$="GO " THEN 2530500 IF A$="IF " THEN 3080510 IF A$="ON " THEN 740520 IF A$="GOS" THEN 2760530 IF A$="CLO" THEN 1710540 IF A$="INP" OR A$="REA" OR A$="WRI" THEN 2080550 IF A$="KIL" THEN 1190560 IF A$="MAR" THEN 1250570 IF A$="OLD" THEN 1350580 IF A$="RES" THEN 1430590 IF A$="SAV" THEN 1530600 GO TO 4340610 L$=REP("",1,A+4)620 GOSUB 5000630 S=1640 GOSUB 7000650 GO TO 310660 B$=SEG(L$,A+5,3)670 L$="Disable response to "680 GOSUB 840690 L$=L$&B$700 S=1710 GOSUB 5000720 GOSUB 7000730 GO TO 310740 B0=0750 B$=SEG(L$,A+4,3)760 GOSUB 840770 A$=SEG(L$,A+10,LEN(L$)-(A+9))780 Y=VAL(A$)790 L$=B$&"?"800 S=3810 GOSUB 5000820 GOSUB 7000830 GO TO 310840 IF B$="SRQ" THEN 890850 IF B$="EOI" THEN 910860 IF B$="EOF" THEN 930870 IF B$="SIZ" THEN 950880 GO TO 900890 B$="SERVICE REQUEST"900 RETURN 910 B$="END OF IDENTIFY"920 RETURN 930 B$="END OF FILE"940 RETURN 950 B$="SIZE ERROR"960 RETURN 970 S=5980 L$=REP("",1,A)990 GOSUB 70001000 GO TO 3101010 A=POS(L$," ",A+1)1020 A1=POS(L$," ",A+1)1030 L$=SEG(L$,A+1,A1-(A+1))1040 S=11050 GOSUB 50001060 GOSUB 70001070 GO TO 3101080 A$=SEG(L$,A+6,LEN(L$)-(A+5))1090 L$="Find file# "&A$1100 S=11110 GOSUB 50001120 GOSUB 70001130 GO TO 3101140 L$="Make program secret"1150 S=11160 GOSUB 50001170 GOSUB 70001180 GO TO 3101190 A$=SEG(L$,A+6,LEN(L$)-(A+5))1200 L$="KILL file# "&A$1210 S=41220 GOSUB 50001230 GOSUB 70001240 GO TO 3101250 A1=POS(L$,",",A)1260 A$=SEG(L$,A+6,A1-(A+6))1270 B$=SEG(L$,A1+1,LEN(L$)-A1)1280 L$="MARK "&A$1290 L$=L$&" files to "1300 L$=L$&B$1310 S=41320 GOSUB 50001330 GOSUB 70001340 GO TO 3101350 L$="Load program into memory"1360 S=41370 GOSUB 50001380 GOSUB 70001390 L$="RUN"1400 S=51410 GOSUB 70001420 GO TO 3101430 IF LEN(L$)-A<=8 THEN 14701440 A$=SEG(L$,A+9,LEN(L$)-(A+8))1450 A$="line# "&A$1460 GO TO 14801470 A$="first data point"1480 L$="Restore DATA pointer to "&A$1490 S=11500 GOSUB 50001510 GOSUB 70001520 GO TO 3101530 IF LEN(L$)-A<=5 THEN 16401540 A1=POS(L$,",",A)1550 IF A1<>0 THEN 15801560 A$=SEG(L$,A+6,LEN(L$)-(A+5))1570 GO TO 16201580 A$=SEG(L$,A+6,A1-1)1590 B$=SEG(L$,A1+1,LEN(L$)-A1)1600 A$=A$&" to "1610 A$=A$&B$1620 A$=" lines "&A$1630 GO TO 16501640 A$=" program "1650 L$="Save the"&A$1660 L$=L$&"on tape"1670 S=41680 GOSUB 50001690 GOSUB 70001700 GO TO 3101710 L$="Close the tape file"1720 S=41730 GOSUB 50001740 GOSUB 70001750 GO TO 3101760 A1=POS(L$,",",A)1770 A$=SEG(L$,A+5,A1-(A+5))1780 B$=SEG(L$,A1+1,LEN(L$)-A1)1790 L$="Assign the position of cursor to "&A$1800 L$=L$&" and "1810 L$=L$&B$1820 S=41830 GOSUB 50001840 GOSUB 70001850 GO TO 3101860 A=POS(L$," ",A+1)1870 B$=SEG(L$,A+1,LEN(L$)-A)1880 IF A$="RMO" THEN 19101890 L$="Relative DRAW "&B$1900 GO TO 19201910 L$="Relative MOVE "&B$1920 S=11930 GOSUB 50001940 GOSUB 70001950 GO TO 3101960 A1=POS(L$,",",A)1970 IF A1=0 THEN 20201980 A1=POS(L$,",",A1+1)1990 IF A1=0 THEN 20202000 A$=SEG(L$,A1+1,LEN(L$)-A1)2010 GO TO 20302020 A$="0,0"2030 L$="Draw an AXIS intersecting at "&A$2040 S=42050 GOSUB 50002060 GOSUB 70002070 GO TO 3102080 A1=POS(L$,":",A)2090 A2=POS(L$," ",A+1)2100 IF A1=0 THEN 21402110 B$=SEG(L$,A1+1,LEN(L$)-A1)2120 GOSUB 23402130 GO TO 21502140 B$=SEG(L$,A2+1,LEN(L$)-A2)2150 IF A$="INP" THEN 21802160 IF A$="REA" THEN 22202170 IF A$="WRI" THEN 22602180 IF A1<>0 THEN 22002190 C$="GS Keyboard: "2200 L$="INPUT from "&C$2210 GO TO 22902220 IF A1<>0 THEN 22402230 C$="DATA: "2240 L$="READ from "&C$2250 GO TO 22902260 IF A1<>0 THEN 22802270 C$="Mag Tape: "2280 L$="WRITE on  "&C$2290 L$=L$&B$2300 S=42310 GOSUB 50002320 GOSUB 70002330 GO TO 3102340 A=POS(L$," ",A+1)2350 A3=POS(L$,",",A)2355 IF A3=0 THEN 23702360 IF A3<A1 THEN 23802370 A3=A12380 D$=SEG(L$,A+2,A3-(A+2))2400 IF D$="32" THEN 24602410 IF D$="33" THEN 24802420 IF D$="31" THEN 25002440 C$="Unit"&D$2445 C$=C$&": "2450 RETURN 2460 C$="GS Display: "2470 RETURN 2480 C$="Mag Tape: "2490 RETURN 2500 C$="GS Keyboard: "2510 RETURN 2530 B0=02540 A1=POS(L$,"OF",A)2550 IF A1<>0 THEN 26202560 A$=SEG(L$,A+1,LEN(L$)-A)2570 Y=VAL(A$)2580 S=62590 GOSUB 50002600 GOSUB 70002610 GO TO 3102620 H$=SEG(L$,A+7,A1-1-(A+7))2630 G$=L$2640 N0=12650 G$=REP("",1,A1)2660 A1=POS(G$,",",1)2670 L$=H$&"="2680 B$=STR(N0)2685 B$=REP("",1,1)2690 L$=L$&B$2700 Y=VAL(G$)2710 S=32720 GOSUB 50002730 GOSUB 70002740 IF A1=0 THEN 3102745 N0=N0+12750 GO TO 26502760 B0=12770 A1=POS(L$,"OF",A)2780 IF A1<>0 THEN 28702790 A$=SEG(L$,A,LEN(L$)-(A-1))2800 Y=VAL(A$)2810 A$=STR(Y)2820 L$="GOSUB"&A$2830 S=22840 GOSUB 50002850 GOSUB 70002860 GO TO 3102870 A2=POS(L$," ",A+1)2880 H$=SEG(L$,A2+1,A1-1-(A2+1))2890 G$=L$2900 N0=12930 G$=REP("",1,A1)2940 A1=POS(G$,",",1)2950 L$=H$&"="2960 B$=STR(N0)2965 B$=REP("",1,1)2970 L$=L$&B$2980 Y1=VAL(G$)2990 B$=STR(Y1)3000 B$="GOSUB"&B$3010 S=33020 GOSUB 50003030 GOSUB 70003040 IF A1=0 THEN 3103045 N0=N0+13050 GO TO 29303080 B0=03090 A1=POS(L$," THEN ",A)3100 A$=SEG(L$,A1+1,LEN(L$)-A1)3110 Y=VAL(A$)3120 L$=SEG(L$,A+4,A1-(A+4))3130 S=33140 GOSUB 50003150 GOSUB 70003160 GO TO 3103240 B0=03250 C7=13260 IF N(2,C5)=F(3,C7) THEN 32903270 C7=C7+13280 GO TO 32603290 A$=SEG(F$,F(1,C7),F(2,C7))3300 A=POS(A$," ",1)3310 A=POS(A$," ",A+1)3320 A1=POS(A$,"=",A)3330 A2=POS(A$,"STE",A1)3350 G$=SEG(A$,A+1,A1-(A+1))3354 IF A2=0 THEN 33663356 A2=POS(A$," ",A2)3360 B$=SEG(A$,A2+1,LEN(A$)-A2)3364 GO TO 33703366 B$="1"3370 L$=G$&"="3380 L$=L$&G$3382 M$=SEG(B$,1,1)3384 IF M$<>"-" THEN 33903388 GO TO 34003390 L$=L$&"+"3400 L$=L$&B$3410 S=13420 GOSUB 50003430 GOSUB 70003440 L$=G$&"=<"3470 A1=POS(A$," ",A+1)3480 A1=POS(A$," ",A1+1)3485 IF A2=0 THEN 34963490 A2=POS(A$," ",A1+1)3494 GO TO 35003496 A2=LEN(A$)+13500 G$=SEG(A$,A1+1,A2-(A1+1))3510 L$=L$&G$3530 Y=N(2,C5)3540 S=33550 GOSUB 50003560 GOSUB 70003570 C5=C5+1 MIN C13580 GO TO 3103600 A1=POS(L$,J$,1)3604 IF A1<>0 THEN 37523606 A1=POS(L$,":",1)3610 A2=POS(L$," ",A+1)3620 IF A1=0 THEN 37403630 B$=SEG(L$,A1+1,LEN(L$)-A1)3640 GOSUB 23403650 A=POS(L$,",",1)3655 IF A=0 THEN 43103660 IF A>A1 THEN 43103670 A$=SEG(L$,A+1,A1-(A+1))3690 IF A$="0" AND D$="33" THEN 38003700 IF A$="26" AND D$="32" THEN 40103710 IF A$="18" AND D$="32" THEN 41203720 IF A$="20" AND D$="32" THEN 42703730 IF A$="21" AND D$="32" THEN 42903740 A=POS(L$," ",1)3750 L$=REP("",1,A)3751 GO TO 37603752 L$=REP("",1,A)3760 S=43770 GOSUB 50003780 GOSUB 70003790 GO TO 3103800 A=POS(B$,",",1)3810 X3=VAL(B$)3820 IF X3=1 THEN 38503830 L$="Set tape status to: 256 Byte,"3840 GO TO 38603850 L$="Set tape status to: 128 Byte,"3860 B$=REP("",1,A)3870 A=POS(B$,",",1)3880 X3=VAL(B$)3890 IF X3=1 THEN 39203900 L$=L$&" Checksum,"3910 GO TO 39303920 L$=L$&" No Checksum,"3930 B$=REP("",1,A)3940 A=POS(B$,",",1)3950 X3=VAL(B$)3960 IF X3=1 THEN 39903970 L$=L$&" Header Format"3980 GO TO 37603990 L$=L$&" No Header Format"4000 GO TO 37604010 X3=VAL(B$)4020 L$="Set Page Full Parameter to:   "4030 GO TO X3 OF 4060,4080,41004040 L$=L$&"Blinking ""F"""4050 GO TO 37604060 L$=L$&"HOME"4070 GO TO 37604080 L$=L$&"PAGE"4090 GO TO 37604100 L$=L$&"COPY and PAGE"4110 GO TO 37604120 X3=VAL(B$)4130 L$="Set Font  to: "4140 GO TO X3 OF 4170,4190,4210,4230,42504150 L$=L$&"US"4160 GO TO 37604170 L$=L$&"Scandinavian"4180 GO TO 37604190 L$=L$&"German"4200 GO TO 37604210 L$=L$&"General European"4220 GO TO 37604230 L$=L$&"Spanish"4240 GO TO 37604250 L$=L$&"Graphics Symbols"4260 GO TO 37604270 L$="DRAW "&B$4280 GO TO 37604290 L$="MOVE "&B$4300 GO TO 37604310 L$="PRINT to "&C$4320 L$=L$&B$4330 GO TO 37604340 L$=REP("",1,A)4345 IF A$="REM" OR A$="DAT" OR A$="IMA" THEN 3104350 IF A$="APP" OR A$="RBY" OR A$="TLI" OR A$="WBY" THEN 44004355 IF A$<>"CAL" THEN 43604356 A2=POS(L$,"BOLD",1)4357 IF A2<>0 THEN 13604360 S=14370 GOSUB 50004380 GOSUB 70004390 GO TO 3104400 S=44410 GO TO 43705000 L=15010 L0=LEN(L$)5020 IF L0>10 THEN 51405030 IF L>5 THEN 51105040 IF L>1 THEN 50805050 L1=(L0+2)*1.7925060 S1=L1*0.6666666666675070 RETURN 5080 L1=21.5045090 S1=14.3365100 RETURN 5110 S1=L*2.816+0.2565120 L1=S1*1.55130 RETURN 5140 L0=L0-105150 L=L+15160 GO TO 50207000 MOVE X0,T7010 GO TO S OF 7030,7030,7230,7700,7830,80207020 GO TO 70107030 IF T-S1-3=>2*(N1/2*1.792+1) THEN 70507040 GOSUB 81407050 F2=X7060 RDRAW -L1/2,07070 RDRAW 0,-S17080 RDRAW L1,07090 RDRAW 0,S17100 RDRAW -L1/2,07110 GOSUB 83907120 IF S=1 THEN 71907130 RMOVE -(L1/2-0.896),07140 RDRAW 0,-S17150 MOVE X0,T7160 RMOVE L1/2-0.896,07170 RDRAW 0,-S17180 IF S=2.2 THEN 72207190 T=T-S1-37200 MOVE X0,T7210 RDRAW 0,37220 RETURN 7230 IF T-S1-5=>2*(N1/2*1.792+1) THEN 72507240 GOSUB 81407250 F2=X7260 RDRAW -(L1/2+1),-(S1/2+1)7270 RDRAW L1/2+1,-(S1/2+1)7275 GIN X1,S37280 RDRAW L1/2+1,S1/2+17290 RDRAW -(L1/2+1),S1/2+17300 IF L=1 THEN 73307305 S1=S1+27310 GOSUB 83907315 S1=S1-27320 GO TO 73507330 RMOVE -(LEN(L$)/2*1.792),-(S1/2+2.408)7340 PRINT L$7350 MOVE X0,T7360 RMOVE L1/2+1,-(S1/2+1)7370 RDRAW 5,07380 GIN X1,Y17382 RDRAW -1.5,-17384 RMOVE 0,27386 RDRAW 1.5,-17390 RMOVE -4,17400 PRINT "Y"7405 MOVE X1,Y17407 S2=S1+27410 IF B0=0 THEN 75307420 L$=B$7430 GOSUB 50007440 T1=T7445 X5=X07450 T=Y1+S1/27460 X0=X1+L1/27470 S=2.27475 MOVE X0,T7480 GOSUB 70607490 T=T17500 X0=X57510 GO TO 76407530 A$=STR(Y)7540 R=(LEN(A$)-1)/2*1.792+0.57550 GIN X1,Y17560 X1=X1+R7570 RMOVE 2*R,07580 FOR I=10 TO 360 STEP 107590 DRAW R*COS(-I)+X1,R*SIN(-I)+Y17600 NEXT I7610 MOVE X1,Y17620 RMOVE -(R-1),-1.4087630 PRINT "";A$7640 T=T-(S1 MAX S2)-37650 MOVE X0,T7660 DRAW X0,S37670 RMOVE 1,-2.57680 PRINT "N"7690 RETURN 7700 IF T-S1-3=>2*(N1/2*1.792+1) THEN 77207710 GOSUB 81407720 F2=X7730 RDRAW -L1/2,07740 RDRAW -3,-S17750 RDRAW L1+3,07760 RDRAW 3,S17770 RDRAW -(L1/2+3),07780 GOSUB 83907790 T=T-S1-37800 MOVE X0,T7810 RDRAW 0,37820 RETURN 7830 IF T-6.816=>2*(N1/2*1.792+1) THEN 78357832 GOSUB 81407835 F2=X7840 RDRAW 5.376,07850 GIN X1,Y17860 Y1=Y1-1.9087870 FOR I=10 TO 180 STEP 107880 DRAW 1.908*SIN(I)+X1,1.908*COS(I)+Y17890 NEXT I7900 RDRAW -10.752,07910 GIN X1,Y17920 Y1=Y1+1.9087930 RMOVE 0,3.8167940 FOR I=10 TO 180 STEP 107950 DRAW 1.908*SIN(-I)+X1,1.908*COS(-I)+Y17960 NEXT I7964 RMOVE 0,3.8167965 RDRAW 5.376,07970 MOVE X0,T7980 RMOVE -(LEN(L$)/2*1.792),-3.3167990 PRINT L$8000 T=T-6.8168010 RETURN 8020 MOVE X0,T8030 GIN X1,Y18040 L$=STR(Y)8050 R=(LEN(L$)-1)/2*1.792+0.58052 IF T-(2*R+3)=>2*(N1/2*1.792+1) THEN 80608054 GOSUB 81408056 GO TO 80308060 Y1=Y1-R8065 F2=X8070 FOR I=10 TO 360 STEP 108080 DRAW R*SIN(I)+X1,R*COS(I)+Y18090 NEXT I8100 RMOVE -(R-0.5),-(R+1.408)8110 PRINT "";L$8120 T=T-(2*R+3)8130 RETURN 8140 D$=CHR(L8)8150 C$=""8160 FOR I=1 TO N18170 C$=C$&D$8180 NEXT I8190 GIN X1,Y18200 R=N1/2*1.792+18210 Y1=Y1-R8220 FOR I=10 TO 360 STEP 108230 DRAW R*SIN(I)+X1,R*COS(I)+Y18240 NEXT I8245 MOVE X1,Y18250 RMOVE -(N1/2)*1.792,-1.4088260 PRINT C$;8265 IF X0=32.5 THEN 83058270 MOVE 50,58280 PRINT P1;"(";F1;"-";F2;")"8290 HOME 8300 INPUT D$8301 F1=X8302 PAGE 8303 X0=32.58304 GO TO 83068305 X0=97.58306 MOVE X0,998307 GIN X1,Y18308 Y1=Y1-R8309 FOR I=10 TO 360 STEP 108310 DRAW R*SIN(I)+X1,R*COS(I)+Y18311 NEXT I8312 MOVE X1,Y18313 RMOVE -(N1/2)*1.792,-1.4088314 PRINT C$8315 MOVE X0,99-R*28316 RDRAW 0,-38317 GIN X1,T8319 IF X0=97.5 THEN 83308320 P1=P1+18330 L8=L8+18335 MOVE X0,T8340 IF L8=91 THEN 83608350 RETURN 8360 L8=658370 N1=N1+18380 RETURN 8390 L0=L8395 MOVE X0,T8396 L2=POS(L$,J$,1)8400 IF L=0 THEN 84808410 D$=SEG(L$,1,10 MIN LEN(L$))8420 L$=REP("",1,10 MIN LEN(L$))8421 L3=LEN(D$)8422 IF L2=0 THEN 84308423 FOR I=L3 TO 1 STEP -18424 N$=SEG(D$,I,1)8425 IF N$=>" " THEN 84298426 N$=CHR(ASC(N$)+64)8427 N$=N$&"_"8428 D$=REP(N$,I,1)8429 NEXT I8430 L=L-18432 IF L0=1 THEN 84908435 I1=L0/28440 FOR I=1 TO L0-L8442 I1=I1-18444 NEXT I8445 RMOVE 0,-(S1/2)8446 RMOVE -(L3/2*1.792),I1*2.8168450 PRINT D$8460 MOVE X0,T8470 GO TO 84008480 RETURN 8490 I1=-0.58500 GO TO 84459000 IF T-5.632=>2*(N1/2*1.792+1) THEN 90209010 GOSUB 81409020 MOVE X0,T9030 RMOVE -7.168,-4.2249040 PRINT "UDK # ";X/49050 T=T-5.6329060 GO TO 33210000 MOVE 50,510010 PRINT P1;"(";F1;"-";F2;")"10020 HOME 10030 INPUT D$10032 DELETE F$10034 DIM F$(1000)10036 F$=""10038 B$=CHR(13)10040 PAGE 10050 FIND 710060 ON EOF (0) THEN 1017010070 INPUT @33:L$10080 A=POS(L$," ",1)10090 A$=SEG(L$,A+1,3)10100 IF A$<>"DAT" THEN 1013010110 PRINT L$10120 GO TO 1006010130 IF A$<>"IMA" THEN 1006010140 L$=L$&B$10150 F$=REP(L$,LEN(F$)+1,0)10160 GO TO 1006010170 PRINT "

";F$10180 END 11000 MOVE X0,T11005 IF B(C6)<0 THEN 1115011010 RMOVE -15,1.511020 GIN X1,Y111030 A$=STR(B(C6))11040 R=(LEN(A$)-1)/2*1.792+0.511050 X1=X1-R11060 FOR I=10 TO 360 STEP 1011070 DRAW R*COS(I)+X1,R*SIN(I)+Y111080 NEXT I11090 MOVE X1-(R-0.75),Y1-1.40811100 PRINT "";A$11105 MOVE X1+R,Y111110 C6=C6+1 MIN C211120 RDRAW 15,011122 RDRAW -1.5,-111124 RMOVE 0,211126 RDRAW 1.5,-111130 RDRAW 0,-1.511140 GO TO 33911150 B(C6)=ABS(B(C6))11155 Q$=L$11160 L$=STR(ABS(B(C6)))11170 L$="SUB"&L$11180 S=211190 GOSUB 500011200 GOSUB 700011205 C6=C6+1 MIN C211206 L$=Q$11210 GO TO 339