1 GO TO 1004 O=325 VIEWPORT 0,130,0,1006 GOSUB 13407 RETURN 8 GOSUB 4709 RETURN 24 GOSUB 242025 GOSUB 55026 RETURN 28 GOSUB 250029 GOSUB 55030 RETURN 32 GOSUB 257033 GOSUB 55034 RETURN 36 GOSUB 264037 GOSUB 55038 RETURN 40 GO TO 100100 INIT 105 SET KEY 110 REM120 Q$="C"130 IF Q$<>"P" THEN 160140 O=1150 GO TO 170160 O=32170 PAGE 180 SET DEGREES 190 DIM T2(13),B1(13),M1(13),G1(13),E1(13),L4(13),L5(13),X1(7),Y1(7)200 DIM X2(15),Y2(15),X3(6),Y3(6),U(10),A1(13)210 RESTORE 220 DATA 2.25,2.375,2.5,2.625,2.75,2.875,3.125,3.5,3.75,3.875,4.125230 DATA 4.375,4.5240 DATA 27,30.5,34,37.5,41,44.5,48.5,53,57,60.5,64.5,67,70.5250 DATA 21.645,24.885,28.135,31.26,34.523,37.648,41.148,44.773260 DATA 48.226,51.391,54.866,58.25,61.134270 DATA 1.375,1.5,1.625,1.75,1.875,2,2.125,2.25,2.375,2.5,2.625280 DATA 3,3.625290 DATA 2.6875,2.8125,2.9375,3.125,3.25,3.4375,3.6875,4.125,4.375300 DATA 4.5625,4.8125,4.375,4.6875310 DATA 3.5,3.875,3.875,4.1875,4.375,4.75,5,5.25,5.625,6,6.25,6,5.75320 DATA 3.375,3.625,3.625,3.875,4.0625,4.5,4.625,4.8125,5.1875,5.5330 DATA 5.75,5.9375,7.1875340 DATA 30,30,30,30,30,30,30,30,30,30,30,30,30350 DEF FNA(Z)=Z-INT(Z/3)*3360 READ T2,B1,M1,G1,E1,L4,L5,A1370 Z1=0380 O1=8390 GOSUB 2420400 GOSUB 2500410 GOSUB 2570420 GOSUB 2640430 Z1=1440 SET KEY 450 GOSUB 550460 RETURN 470 O=1480 O1=13490 VIEWPORT 10,140,0,100500 GOSUB 1340510 O=32520 O1=8530 VIEWPORT 0,130,0,100540 RETURN 550 A2=(180-A)/2560 Q1=P/TAN(A2)570 L2=(2*L1-Q1)/2580 L3=L2+Q1590 R2=(2*R1-Q1)/2600 R3=R2+Q1610 T1=SQR((L3+R3*COS(A))^2+(R3*SIN(A))^2)620 X1(1)=T1/20630 Y1(1)=T1/10640 X1(2)=X1(1)+L3650 Y1(2)=T1/10660 X1(3)=COS(A)*R3+X1(2)670 Y1(3)=SIN(A)*R3+Y1(2)680 X1(6)=T1/20690 Y1(6)=Y1(1)+P700 X1(5)=X1(6)+L2710 Y1(5)=Y1(6)720 X1(4)=X1(5)+COS(A)*R2730 Y1(4)=Y1(5)+SIN(A)*R2740 X1(7)=X1(1)750 Y1(7)=Y1(1)760 P2=P+2*T2(I1)770 Q2=P2/TAN(A2)780 D=G1(I1)+L4(I1)790 L6=(2*L1-Q2)/2800 L7=L6+Q2810 Q3=(B1(I1)-P2)/2820 Q4=Q3/SIN(A1(I1))830 Q5=Q4*COS(A1(I1))840 Q5=Q5+G1(I1)850 R4=(2*(R1-Q5)-Q2)/2860 R5=R4+Q2870 X2(1)=T1/20880 Y2(1)=T1/10-T2(I1)890 X2(2)=X2(1)+L7900 Y2(2)=Y2(1)910 X2(3)=COS(A)*R5+X2(2)920 Y2(3)=SIN(A)*R5+Y2(2)930 X2(10)=T1/20940 Y2(10)=Y2(1)+P2950 X2(9)=X2(10)+L6960 Y2(9)=Y2(10)970 X2(8)=X2(9)+COS(A)*R4980 Y2(8)=Y2(9)+SIN(A)*R4990 X2(15)=X2(1)1000 Y2(15)=Y2(1)1010 A3=A-301020 IF A3=>0 THEN 10401030 A3=360+A31040 X2(4)=X2(3)+COS(A3)*Q41050 Y2(4)=Y2(3)+SIN(A3)*Q41060 A3=A+301070 X2(7)=X2(8)+COS(A3)*Q41080 Y2(7)=Y2(8)+SIN(A3)*Q41090 A3=A1100 X2(5)=X2(4)+COS(A3)*D1110 Y2(5)=Y2(4)+SIN(A3)*D1120 X2(6)=X2(7)+COS(A3)*D1130 Y2(6)=Y2(7)+SIN(A3)*D1140 X2(11)=X2(10)1150 Y2(11)=Y2(10)-T2(I1)/51160 X2(12)=X2(11)-L5(I1)1170 Y2(12)=Y2(11)1180 X2(13)=X2(12)1190 Y2(13)=Y2(1)+T2(I1)/51200 X2(14)=X2(13)+L5(I1)1210 Y2(14)=Y2(13)1220 X3(1)=X1(3)1230 Y3(1)=Y1(3)1240 X3(4)=X1(4)1250 Y3(4)=Y1(4)1260 X3(2)=X2(2)+COS(A)*(R5+Q5)1270 Y3(2)=Y2(2)+SIN(A)*(R5+Q5)1280 X3(3)=X3(2)+COS(A)*L4(I1)1290 Y3(3)=Y3(2)+SIN(A)*L4(I1)1300 X3(5)=X2(9)+COS(A)*(R4+Q5)1310 Y3(5)=Y2(9)+SIN(A)*(R4+Q5)1320 X3(6)=X3(5)+COS(A)*L4(I1)1330 Y3(6)=Y3(5)+SIN(A)*L4(I1)1340 PAGE @O:1350 Q1=T1+T1/71360 Q1=INT(Q1/12)*121370 Q2=Q1*100/1301380 WINDOW 0,Q1,0,Q21390 D=T1/1001400 MOVE @O:X1(1),Y1(1)1410 FOR J1=2 TO 71420 D2=Y1(J1)-Y1(J1-1)1430 D1=X1(J1)-X1(J1-1)1440 S1=SQR(D1^2+D2^2)1450 D1=D1*D/S11460 D2=D2*D/S11470 S=2*SQR(D1^2+D2^2)1480 FOR J2=0 TO S1-S/2 STEP S1490 RDRAW @O:D1,D21500 RMOVE @O:D1,D21510 NEXT J21520 MOVE @O:X1(J1),Y1(J1)1530 NEXT J11540 MOVE @O:X1(1),Y1(1)1550 D1=X1(3)-X1(1)1560 D2=Y1(3)-Y1(1)1570 D1=D1*D*2/T11580 D2=D2*D*2/T11590 S=2*SQR(D1^2+D2^2)1600 FOR J1=0 TO T1-S/2 STEP S1610 RDRAW @O:D1,D21620 RMOVE @O:D1,D21630 NEXT J11640 MOVE @O:X2(1),Y2(1)1650 DRAW @O:X2,Y21660 MOVE @O:X2(2),Y2(2)1670 DRAW @O:X2(9),Y2(9)1680 MOVE @O:X2(3),Y2(3)1690 DRAW @O:X2(8),Y2(8)1700 MOVE @O:X2(4),Y2(4)1710 DRAW @O:X2(7),Y2(7)1720 FOR J3=1 TO 4 STEP 31730 MOVE @O:X3(J3),Y3(J3)1740 FOR J1=J3+1 TO J3+21750 D2=Y3(J1)-Y3(J1-1)1760 D1=X3(J1)-X3(J1-1)1770 S1=SQR(D1^2+D2^2)1780 D1=D1*D/S11790 D2=D2*D/S11800 S=2*SQR(D1^2+D2^2)1810 FOR J2=0 TO S1-S/2 STEP S1820 RDRAW @O:D1,D21830 RMOVE @O:D1,D21840 NEXT J21850 MOVE @O:X3(J1),Y3(J1)1860 NEXT J11870 NEXT J31880 DEF FNB(X)=INT(X/12)1890 DEF FNC(X)=X-F*121900 MOVE @O:0,Q2*0.951910 PRINT @O: USING 1920:"PIPE DIA=",P,"''","BEND ANGLE=",A," DEGREES"1920 IMAGE 9A,4D,2A,5X,11A,4D,8A1930 F=FNB(L1)1940 I=FNC(L1)1950 PRINT @O: USING 1960:"LEFT LEG LENGTH=",F,"'",I,"''"1960 IMAGE FA,4D,1A,4D.2D,2A1970 F=FNB(R1)1980 I=FNC(R1)1990 PRINT @O: USING 1960:"RIGHT LEG LENGTH=",F,"'",I,"''"2000 F=FNB(B1(I1))2010 I=FNC(B1(I1))2020 I2=T2(I1)2030 PRINT @O: USING 2040:"BELL DIA=",F,"'",I,"''","WALL THICK=",I2,"''"2040 IMAGE FA,4D,1A,4D.2D,2A,5X,FA,4D.2D,2A2050 PRINT @O:2060 F=FNB(L2)2070 U(2)=FNC(L2)2080 U(1)=F2090 F=FNB(L3)2100 U(4)=FNC(L3)2110 U(3)=F2120 F=FNB(R2)2130 U(5)=F2140 U(6)=FNC(R2)2150 F=FNB(R3)2160 U(7)=F2170 U(8)=FNC(R3)2180 F=FNB(T1)2190 U(9)=F2200 U(10)=FNC(T1)2210 IMAGE FA,4D,"'",4D.2D,"''",5X,FA,4D,"'",4D.2D,"''"2220 PRINT @O: USING 2210:"A=",U(1),U(2),"B=",U(3),U(4)2230 PRINT @O: USING 2210:"C=",U(5),U(6),"D=",U(7),U(8)2240 PRINT @O: USING 2250:"E=",U(9),U(10)2250 IMAGE FA,4D,"'",4D.2D,"''"2260 V=INT(T1/80)2270 MOVE @O:X1(1)+L3/2,Y1(1)+V2280 PRINT @O:"B"2290 MOVE @O:X1(1)+L3/2,Y1(6)-2*V2300 PRINT @O:"A"2310 MOVE @O:X1(2)+(X1(3)-X1(2))/2,(Y1(3)-Y1(2))/2+Y1(2)+V2320 PRINT @O:"D"2330 MOVE @O:(X1(4)-X1(5))/2+X1(5),Y1(5)+(Y1(4)-Y1(5))/2-2*V2340 PRINT @O:"C"2350 MOVE @O:(X1(3)-X1(1))/4+X1(1),(Y1(3)-Y1(1))/4+Y1(1)+V/22360 PRINT @O:"E"2370 MOVE @O:Q1*0.67,Q2*0.952380 PRINT @O: USING 2390:Q1/O1/12;2390 IMAGE "SCALE=",4D.2D,"ft. to 1 in."2400 MOVE @O:0,Q2*0.672410 RETURN 2420 PRINT "PIPE DIAMETER(18 to 54 in.)? ";2430 INPUT P2431 P1=P/32432 P2=P1-INT(P1)2433 P1=INT(P1)2434 IF P2<0.5 THEN 24372435 P=(P1+1)*32436 GO TO 24402437 P=P1*32440 IF P>17 AND P<55 THEN 24802450 PRINT "INVALID PIPE DIAMETER."2460 PRINT "MUST BE 18'' TO 54'' (divisible by 3)."2470 GO TO 24202480 I1=P/3-52490 RETURN 2500 PRINT "LEFT PIPE LEG LENGTH(ft,in)? ";2510 INPUT F,I2520 IF F>0 OR I>0 THEN 25502530 PRINT "PIPE LEG LENGTH MUST BE GREATER THAN 0!"2540 GO TO 25002550 L1=F*12+I2560 RETURN 2570 PRINT "RIGHT PIPE LEG LENGTH(ft,in)? ";2580 INPUT F,I2590 IF F>0 OR I>0 THEN 26202600 PRINT "PIPE LEG LENGTH MUST BE GREATER THAN 0!"2610 GO TO 25702620 R1=F*12+I2630 RETURN 2640 PRINT "BEND ANGLE(0 to 45 deg)? ";2650 INPUT A2660 IF A>-1 AND A<46 THEN 26902670 PRINT "INVALID BEND ANGLE. MUST BE BETWEEN 0 AND 45!"2680 GO TO 26402690 RETURN  