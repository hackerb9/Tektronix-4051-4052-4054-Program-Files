100 REM ***************************************************************110 REM ***************************************************************120 REM *************** IFT:1024cplx<-->2048reals *********************130 REM *************** routine using ROM "FFT"   *********************140 REM *************** Author PIERRE THORE,LA.G.A.S. NANCY ***********150 REM ***************************************************************160 REM *************** USED ARRAYS:G(2048) <-->INPUT OUTPUT **********170 REM ***************             A1(1024)<-->WORK ARRAY   **********180 REM ***************             A2(1024,2)<-->WORK ARRAY **********190 REM ***************             A3(1024) <-->WORK ARRAY  **********200 REM ***************             A4(1024)<-->WORK ARRAY   **********210 REM *************** A1,A2,A3,A4 ARE DELETED AFTER USING  **********220 REM ***************************************************************230 REM *************** The "G"array must be presented like  **********240 REM ***************   for the IFT ROM                    **********250 REM ***************************************************************260 REM ***************************************************************270 REM***************** START OF IFT    ******************************280 DIM A1(1024),A3(1024),A4(1024)290 REM300 A3(1)=G(3)310 A4(1)=G(4)320 A1(1)=G(1)330 A1(2)=G(2)340 FOR I=1 TO 511350 A1(2*I+1)=G(4*I+1)360 A1(2*I+2)=G(4*I+2)370 A3(I+1)=G(4*I+3)380 A4(I+1)=G(4*I+4)390 NEXT I400 REM410 FOR I=1 TO 512420 A3(1025-I)=A3(I)430 A4(1025-I)=A4(I)440 A4(I)=-A4(I)450 NEXT I460 REM IFT DE A1470 CALL "IFT",A1480 REM FFT DE A3&A4490 CALL "FFT",A3500 CALL "FFT",A4510 DELETE G520 DIM A2(1024,2)530 REM540 A2(1,1)=A3(1)/2048550 A2(1,2)=A4(1)/2048560 A2(513,1)=A3(2)/2048570 A2(513,2)=A4(2)/2048580 FOR I=2 TO 512590 A2(I,1)=A3(2*I-1)/2048-A4(2*I)/2048600 A2(I,2)=A3(2*I)/2048+A4(2*I-1)/2048610 A2(1026-I,1)=A3(2*I-1)/2048+A4(2*I)/2048620 A2(1026-I,2)=A4(2*I-1)/2048-A3(2*I)/2048630 NEXT I640 DELETE A3,A4650 DIM G(2048)660 REM670 FOR I=1 TO 1024680 A2(I,2)=-A2(I,2)690 NEXT I700 A1=A1/2710 REM720 G(1)=A1(1)+A2(1,1)730 G(513)=A1(513)-A2(513,2)740 G(1025)=A1(1)-A2(1,1)750 G(1537)=A1(513)+A2(513,2)760 FOR I=2 TO 512770 B1=COS(2*PI*(I-1)/2048)780 B2=SIN(2*PI*(I-1)/2048)790 G(I)=A1(I)+B1*A2(I,1)-B2*A2(I,2)800 G(I+512)=A1(I+512)-B2*A2(I+512,1)-B1*A2(I+512,2)810 G(1024+I)=A1(I)-B1*A2(I,1)+B2*A2(I,2)820 G(I+1536)=A1(I+512)+B2*A2(I+512,1)+B1*A2(I+512,2)830 NEXT I840 REM850 DELETE A1,A2860 REM******************************** END OF IFT ********************