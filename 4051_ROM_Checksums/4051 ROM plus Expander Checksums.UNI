1 REMARKABLE    4051 ROM READER AND CHECKSUM (MDC)2 REM A$=CALL "EXEC" STRING, B$=ARGUMENT/RESULT STRING3 REM H$=HEX ADDRESS STRING, C$=HEX ADDRESS CHARACTER4 RUN 1008 RUN 220100 INIT 110 PAGE115 SET KEY 120 DIM A$(512),B$(4111),C$(1),H$(64)130 A$=""140 A$=A$&"967<3686109735<>4224=?06;=;0=67?0035=>06:6042;72>>058<10"150 A$=A$&"0?266?=>06>>078<000:2666=>06>>0;:60281202658;=::3>:600>6"160 A$=A$&"038=59;=0388;=:9=5:600>6058=4=97188=539719;=0388<>????=?"170 A$=A$&"02=>41=?008=5;=;038=78=703=;028=72=702=>00088<080026>886"180 A$=A$&"3:8=5<<>00028=408=3<=>068610<60?:707>70832843?7>:9=5<624"190 A$=A$&"2002<61;=74;20?0814026?6<13:26?28=355?8=054848484816:600"200 A$=A$&"8=2981392?0280078030840?1;39=>18:60008=?1816444444448=01"210 A$=A$&"17840?8;3081392?028;07=>16:70008=?16392504<1??2602<0??39"220 B$="@00:@8000:"222 REM "LIST ALL 4051 ROM Checksums? (Y?): ";223 GO TO 227224 INPUT H$226 IF H$<>"Y" THEN 230227 RESTORE 228 GO TO 510230 PRINT "INPUT A 2KB ALIGNED ROM ADDRESS (UPPER 2 HEX DIGITS): ";240 INPUT H$250 IF LEN(H$)<>2 THEN 230260 GOSUB 380270 B$=REP(H$,6,2)280 IF NOT(H$="88" OR H$="90" OR H$="98" OR H$="A0") THEN 340290 PRINT "INPUT ROM PACK BANK (2 HEX DIGITS): ";300 INPUT H$310 IF LEN(H$)<>2 THEN 290320 GOSUB 380330 B$=REP(H$,2,2)340 CALL "EXEC",A$350 H$=SEG(B$,LEN(B$)-3,4)360 PRINT "FLETCHER 16 CHECKSUM: ";H$370 END 380 REM  CHECK FOR VALID UPPER CASE HEXIDECIMAL390 FOR I=1 TO 2400 C$=SEG(H$,I,1)410 IF C$=>"0" AND C$<="9" OR (C$=>"A" AND C$<="F") THEN 440420 PRINT "INVALID ENTRY, HEX DIGITS MUST BE IN [0..9] OR [A..F]"430 END 440 NEXT I441 RETURN442 REM List all 4051 ROM Checksums - Monty McGraw 21 SEPT 2021443 DATA "@00:@8800:","0CE5                | System ROMs"444 DATA "@00:@9000:","     023F"445 DATA "@00:@9800:","          47E4"446 DATA "@00:@A000:","               4B29"447 DATA "@08:@8800:","E1EF                | BP Overflow ROMs"448 DATA "@08:@9000:","     B6B3"449 DATA "@08:@9800:","          0000"450 DATA "@08:@A000:","               0000"451 DATA "@10:@8800:","0000                | BP Option 1 COMM ROMs"452 DATA "@10:@9000:","     0000"453 DATA "@10:@9800:","          0000"454 DATA "@10:@A000:","               0000"455 DATA "@30:@8800:","0000                | LEFT  ROM Exp or Slot1"456 DATA "@30:@9000:","     0000"457 DATA "@30:@9800:","          0000"458 DATA "@30:@A000:","               0000"459 DATA "@31:@8800:","0000                | LEFT  ROM Exp Slot2"460 DATA "@31:@9000:","     0000"461 DATA "@31:@9800:","          0000"462 DATA "@31:@A000:","               0000"463 DATA "@32:@8800:","0000                | LEFT  ROM Exp Slot3"464 DATA "@32:@9000:","     0000"465 DATA "@32:@9800:","          0000"466 DATA "@32:@A000:","               0000"467 DATA "@33:@8800:","0000                | LEFT  ROM Exp Slot4"468 DATA "@33:@9000:","     0000"469 DATA "@33:@9800:","          0000"470 DATA "@33:@A000:","               0000"471 DATA "@34:@8800:","0000                | LEFT  ROM Exp Slot5"472 DATA "@34:@9000:","     0000"473 DATA "@34:@9800:","          0000"474 DATA "@34:@A000:","               0000"475 DATA "@35:@8800:","0000                | LEFT  ROM Exp Slot6"476 DATA "@35:@9000:","     0000"477 DATA "@35:@9800:","          0000"478 DATA "@35:@A000:","               0000"479 DATA "@36:@8800:","0000                | LEFT  ROM Exp Slot7"480 DATA "@36:@9000:","     0000"481 DATA "@36:@9800:","          0000"482 DATA "@36:@A000:","               0000"483 DATA "@37:@8800:","0000                | LEFT  ROM Exp Slot8"484 DATA "@37:@9000:","     0000"485 DATA "@37:@9800:","          0000"486 DATA "@37:@A000:","               0000"487 DATA "@28:@8800:","0000                | RIGHT ROM Exp or Slot1"488 DATA "@28:@9000:","     0000"489 DATA "@28:@9800:","          0000"490 DATA "@28:@A000:","               0000"491 DATA "@29:@8800:","0000                | RIGHT ROM Exp Slot2"492 DATA "@29:@9000:","     0000"493 DATA "@29:@9800:","          0000"494 DATA "@29:@A000:","               0000"495 DATA "@2A:@8800:","0000                | RIGHT ROM Exp Slot3"496 DATA "@2A:@9000:","     0000"497 DATA "@2A:@9800:","          0000"498 DATA "@2A:@A000:","               0000"499 DATA "@2B:@8800:","0000                | RIGHT ROM Exp Slot4"500 DATA "@2B:@9000:","     0000"501 DATA "@2B:@9800:","          0000"502 DATA "@2B:@A000:","               0000"503 DATA "@2C:@8800:","0000                | RIGHT ROM Exp Slot5"504 DATA "@2C:@9000:","     0000"505 DATA "@2C:@9800:","          0000"506 DATA "@2C:@A000:","               0000"507 DATA "@2D:@8800:","0000                | RIGHT ROM Exp Slot6"508 DATA "@2D:@9000:","     0000"509 DATA "@2D:@9800:","          0000"510 DATA "@2D:@A000:","               0000"511 DATA "@2E:@8800:","0000                | RIGHT ROM Exp Slot7"512 DATA "@2E:@9000:","     0000"513 DATA "@2E:@9800:","          0000"514 DATA "@2E:@A000:","               0000"515 DATA "@2F:@8800:","0000                | RIGHT ROM Exp Slot8"516 DATA "@2F:@9000:","     0000"517 DATA "@2F:@9800:","          0000"518 DATA "@2F:@A000:","               0000"519 DATA "z","z"520 DATA "@00:@A800:","BEC3                | A800/B0/B8/C0 SysROMs"521 DATA "@00:@B000:","     0581"522 DATA "@00:@B800:","          70A5"523 DATA "@00:@C000:","               6B55"524 DATA "z","z"525 DATA "@00:@C800:","93CE                | C800/D0/D8/E0 SysROMs"526 DATA "@00:@D000:","     5F7C"527 DATA "@00:@D800:","          EE00"528 DATA "@00:@E000:","               A171"529 DATA "z","z"530 DATA "@00:@E800:","02FD                | E800/F0/F8    SysROMs"531 DATA "@00:@F000:","     1A8A"532 DATA "@00:@F800:","          77DE"533 DATA "z","z"534 PRINT "    | Your 4051 Checksums |    MDC Checksums    |";535 PRINT " Description"536 PRINT "Bank| Adr1 Adr2 Adr3 Adr4 | Adr1 Adr2 Adr3 Adr4 |"537 PRINT "    | 8000 9000 9800 A000 | 8000 9000 9800 A000 |"538 PRINT " -- | ---- ---- ---- ---- | ---- ---- ---- ---- |";539 PRINT " -----------"540 GOSUB 2000541 PRINT " -- | ---- ---- ---- ---- | ---- ---- ---- ---- |"542 GOSUB 2000543 GOSUB 2000544 GOSUB 2000545 PRINT "System ROM Checksum differences indicate different version"546 PRINT "Option 1 COMM or ROM PACK not present if checksums are 0000"547 PRINT "Press RETURN key to return to Main Menu";548 INPUT R$549 PRI@5,9:"ROOT"550 FIND@5:1551 OLD@5:552 END1000 REM I have finished the assembly coded 4051 program that 1002 REM  can read any system ROM including the ROM PACKs.1004 REM Be aware that any ROM PACK that does I/O (including the 1006 REM  RAMPACK) may get messed up when the 8800H to A7FFH ROM 1008 REM  memory space is being read.  This is because any I/O 1010 REM  that is mapped into the region of memory is likely to 1012 REM  get it’s state changed.1014 REM Thus far, only the RAMPACK is confirmed to have that1016 REM  specific problem so you should avoid reading the RAMPACK1018 REM  using this utility since it will suddenly change1020 REM  Page Addresses during the reads.1022 REM There is one known anomaly at this time.  1024 REM  The 2KB ROM at 8000H through 87FFH will not return1026 REM  reliable checksums because the bytes starting at 87A81028 REM  are not repeatable.  1030 REM A check of the firmware listings shows that the ROM1032 REM  locations after 8780H do *not* have any code in them. 1034 REM  The ROM memory region just prior to 8780H has code1036 REM  patch routines, so this might vary with firmware1038 REM  revisions.  As a result, I haven’t restricted the1040 REM  checksum for the code free region.  Since the 2KB1042 REM  of ROM HEX code is stored in the B$ string, it will1044 REM  be easy enough for comparing that ROM between different1046 REM  Tek 4051 computers.1048 REM The 4051 BASIC program to perform firmware ROM reads1050 REM  is included above.  Note that the Bank Address1052 REM  will only be requested when you are reading the ROMs1054 REM  from 8800H through A7FFH since other locations are1056 REM  not dependent on the ROM PACK Bank Address. 1058 REM  The valid Bank Addresses are 00H, 08H, 10H, 28H …1060 REM  2FH, and 30H … 37H.  1062 REM  Other Bank Addresses will generally alias into this1064 REM  shown range.1066 REM BANK Addresses:1068 REM 00H  System ROMs1070 REM 08H  System ROMs1072 REM 10H  Option 1 Communications (built-in RS-232)1074 REM 28H  Right rear ROM PACK slot1076 REM 28H…2FH  Right rear ROM Expander1078 REM 30H  Left rear ROM PACK slot1080 REM 30H…37H  Left rear ROM Expander1082 REM 1084 REM Note that the MULTI-PACK (8 in 1) and MAXIPACK (10 in 1)1086 REM  act just like ROM Expanders.  1088 REM  I will send you my checksums in a later email.1090 REM 1092 REM Here are the Fletcher 16 Checksums for the 4051 firmware.1094 REM The format is: @<Bank>:@<ROM START ADDRESS>:1096 REM  <Fletcher 16 checksum>1098 REM Let me know what your checksums are and I will enter them1100 REM  into a globally available spreadsheet.1102 REM  1104 REM @00:@8000:F5C9    System ROM (Checksum is unreliable since1106 REM                      some nonexistent ROM areas get read)1108 REM @00:@8800:0CE5    System ROM (ROM PACK)1110 REM @00:@9000:023F    System ROM (ROM PACK)1112 REM @00:@9800:47E4    System ROM (ROM PACK)1114 REM @00:@A000:4B29    System ROM (ROM PACK)1116 REM @08:@8800:E1EF    System Overflow ROM (ROM PACK)1118 REM @08:@9000:B6B3    System Overflow ROM (ROM PACK)1120 REM @08:@9800:FFFF    No ROM present      (ROM PACK)1122 REM @08:@A000:FFFF    No ROM present      (ROM PACK)1124 REM @10:@8800:D948    Option 1 COMM (ROM PACK)1126 REM @10:@9000:5AD6    Option 1 COMM (ROM PACK)1128 REM @10:@9800:6155    Option 1 COMM (ROM PACK)1130 REM @10:@A000:186F    Option 1 COMM (ROM PACK)1132 REM @00:@A800:BEC3    System ROM1134 REM @00:@B000:0581    System ROM1136 REM @00:@B800:70A5    System ROM1138 REM @00:@C000:6B55    System ROM1140 REM @00:@C800:93CE    System ROM1142 REM @00:@D000:5F7C    System ROM1144 REM @00:@D800:EE00    System ROM1146 REM @00:@E000:A171    System ROM1148 REM @00:@E800:02FD    System ROM1150 REM @00:@F000:1A8A    System ROM1152 REM @00:@F800:77DE    System ROM1990 REM Read, CALL EXEC, PRINT up to 4 times until "z"2000 IMAGE "",2T,2A,7T,4A,29T,FA2010 IMAGE "",2T,2A,12T,4A,29T,FA2020 IMAGE "",2T,2A,17T,4A,29T,FA2030 IMAGE "",2T,2A,22T,4A,29T,FA2040 READ R$,P$2050 IF R$="z" THEN 22702055 S$=SEG(R$,2,2)2060 B$=R$2070 CALL "EXEC",A$2080 H$=SEG(B$,LEN(B$)-3,4)2090 PRINT USING 2000:S$,H$,P$2100 READ R$,P$2105 S$="  "2110 B$=R$2120 CALL "EXEC",A$2130 H$=SEG(B$,LEN(B$)-3,4)2140 PRINT USING 2010:S$,H$,P$2150 READ R$,P$2155 S$="  "2160 B$=R$2170 CALL "EXEC",A$2180 H$=SEG(B$,LEN(B$)-3,4)2190 PRINT USING 2020:S$,H$,P$2200 READ R$,P$2205 S$="  "2210 B$=R$2220 IF R$="z" THEN 22702230 CALL "EXEC",A$2240 H$=SEG(B$,LEN(B$)-3,4)2250 PRINT USING 2030:S$,H$,P$2255 PRINT2260 GO TO 20402270 RETURN