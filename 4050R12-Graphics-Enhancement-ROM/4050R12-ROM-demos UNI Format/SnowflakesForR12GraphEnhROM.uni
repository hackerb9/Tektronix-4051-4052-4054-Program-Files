1 REM default device is the screen.2 GO TO 1003 REM  user definable key 1 will use the plotter4 INIT 5 U=16 V=1307 GO TO 210100 REM  SNOWFLAKES110 REM  TEKniques, Vol 1 no 10120 REM  Modified for "FAST GRAPHICS"   1 NOV '86  by TOM HILL130 REM140 REM150 INIT 160 PAGE 170 REM U IS THE UNIT NUMBER (1=PLOTTER, 32=SCREEN)180 U=32190 REM  V is the maximum viewport minus 20 (130=plotter,110=screen)200 V=110210 DIM A$(1200),B$(1200),C$(150)220 DIM F(2,3)230 SET DEGREES 240 L=90250 REM R1 is the number of flakes, (20 to 35)260 REM R1=RND(-1)*20+15270 R1=40280 DIM X1(R1),Y1(R1)290 FOR Q=1 TO R1300 REM X1,Y1 is the random location.310 X1(Q)=RND(-1)*V320 Y1(Q)=RND(-1)*80330 REM  If too close to previous flakes, try again.340 Q0=Q-1350 IF Q0=0 THEN 390360 IF ABS(X1(Q0)-X1(Q))<10 AND ABS(Y1(Q0)-Y1(Q))<10 THEN 300370 Q0=Q0-1380 GO TO 350390 REM A is the rotation angle of the flake400 A=RND(-1)*60410 REM                                                         ROTATE A420 REM J is the number of "spikes"430 J=INT(RND(-1)*4+5)440 D1=L/J450 D2=0460 REM h is the maximum length of a "spike"470 REM H=TAN(30)*.5*1/SIN(60)*2 (if you care)480 H=0.6666667*L490 F(2,2)=L500 DELETE G510 DIM G(2*J-1,3)520 G(1,1)=64530 G(1,2)=0540 G(1,3)=0550 FOR I=2 TO 2*(J-1) STEP 2560 REM d2 is the cumulative distance from center.570 D2=D2+D1580 REM M is the actual "spike" length.590 M=(H-H*ABS(D2-L/2)/(0.5*L))*RND(-1)600 REM move out a distance d610 G(I,1)=64620 G(I,2)=INT(D2)630 G(I,3)=0640 REM calculate x,y at 60 degree angle650 G(I+1,1)=0660 G(I+1,2)=INT(0.5*M+D2)670 G(I+1,3)=INT(0.87*M)680 NEXT I690 CALL "STRING",G,B$700 CALL "AMOVE",B$,20,20710 A$=B$720 CALL "RSCALE",B$,1,-1,0,0730 A$=A$&B$740 F(1,1)=64750 F(1,2)=0760 F(1,3)=0770 F(2,1)=0780 F(2,2)=L790 F(2,3)=0800 CALL "STRING",F,B$810 CALL "AMOVE",B$,20,20820 A$=A$&B$830 REM  R2 IS THE NUMBER OF HEXAGONS840 R2=INT(RND(-1)*5+1)850 DELETE K860 DIM K(R2*2+1,3)870 K(1,1)=64880 K(1,2)=0890 K(1,3)=0900 FOR J=1 TO R2*2 STEP 2910 REM S is the size of hexagon920 S=J*5+RND(-1)*20930 K(J+1,1)=64940 K(J+1,2)=S950 K(J+1,3)=0960 K(J+2,1)=0970 K(J+2,2)=-0.5*S980 K(J+2,3)=0.87*S990 NEXT J1000 CALL "STRING",K,C$1010 CALL "AMOVE",C$,20,201020 A$=A$&C$1030 B$=A$1040 CALL "AROTATE",B$,60,20,201050 A$=A$&B$1060 B$=A$1070 CALL "RROTATE",B$,120,0,01080 A$=A$&B$1090 CALL "RROTATE",B$,120,0,01100 A$=A$&B$1110 CALL "AMOVE",A$,15,151120 CALL "ASCALE",A$,0.5,0.5,0,01130 CALL "RROTATE",A$,A,0,01140 CALL "RDRAW",A$,1,X1(Q),Y1(Q)1150 NEXT Q1160 END 