1 REM {CYCLE III} FILE 15   U12
2 GOSUB 100
3 GO TO 510
4 SET NOKEY 
5 L0=1
6 GO TO 410
8 SET NOKEY 
9 L0=2
10 GO TO 410
12 SET NOKEY 
13 L0=3
14 GO TO 410
16 SET NOKEY 
17 L0=4
18 GO TO 410
20 SET NOKEY 
21 L0=5
22 GO TO 410
24 SET NOKEY 
25 L0=6
26 GO TO 410
28 SET NOKEY 
29 L0=7
30 GO TO 410
32 SET NOKEY 
33 L0=8
34 GO TO 410
36 SET NOKEY 
37 L0=9
38 GO TO 410
40 CALL "MEMTST"
43 RETURN 
44 GOSUB 2220
47 RETURN 
64 GOSUB 2050
65 CALL "MEMTST"
67 RETURN 
80 GOSUB 2320
83 RETURN 
90 REM ***SET EOF(0) FLAG***
91 F9=1
92 RETURN 
100 PRINT "4050 CYCLE III BY PAUL HOWARD 25-JAN-83"
110 REM ***I$=INSTRUMENT,S9=1 SEC FOR/NEXT,T1=SEED***
120 INIT 
130 PRINT @33,0:0,0,0
140 FIND 0
150 ON EOF (0) THEN 90
160 DIM I$(7),Q$(1),R$(1)
170 R$=CHR(13)
180 B$="                                 "&R$
190 B$="                                "&B$
200 RESTORE 210
210 DATA "4051  ",217,0.196324846518
220 DATA "4052  ",1805,0.706280095237,"4052A ",1516,0.796364876486
230 DATA "4054  ",1805,0.88093139039,"4054A ",1516,0.894514130768
240 DATA "4054  ",1805,0.505007490939,"4054A ",1516,0.590965583259
250 READ I$,S9,T1
260 IF T1<>RND(0) THEN 250
270 REM ***IF NO OPERATOR ACTION WITHIN 5 MINUTES, DO DISPLAY TESTS,***
280 REM ***MERGE PREVIOUS CYCLE ERRORS WITH CUMMULATIVE ERROR DATA,***
290 REM ***THEN WAIT 30 MINUTES(TOTAL CYCLE OF 1 HOUR) OR POWEROFF***
300 GOSUB 3590
310 PRINT "";D$
320 PRINT "PRESS UDK # 1 TO RUN DISPLAY TESTS."
330 PRINT "PRESS UDK #10 TO BEGIN CYCLE MEMORY TEST."
340 PRINT "PRESS UDK #16 TO INITIALIZE TAPE & BEGIN CYCLE MEMORY TEST."
350 PRINT "PRESS UDK #20 TO CHECK FOR ERROR DATA."
360 PRINT "PRESS UDK #11 TO CREATE A NEW 4050 CYCLE III TAPE."
370 SET KEY 
380 FOR L1=1 TO 0.5*60*S9
390 NEXT L1
400 RETURN 
410 REM ***CYCLE TESTS***
420 PRINT "";D$
430 FOR L8=L0 TO 9
440 PRINT "TEST # ";L8;":  ";D$;""
450 GOSUB L8 OF 600,680,900,990,1080,1240,1430,1800,1940
460 SET KEY 
470 SET NOKEY 
480 FOR L1=1 TO 5*S9
490 NEXT L1
500 NEXT L8
510 PRINT ""
520 CALL "MTPACK"
530 GOSUB 2590
540 PRINT ""
550 FOR L1=1 TO 60*60*S9
560 NEXT L1
570 CALL "MTPACK"
580 CALL "MEMTST"
590 REM ***CYCLE TAPE EVERY 60   MINUTES***
600 REM ***PAGE OF APLHANUMERIC CHARACTERS***
610 T$="[1234567890:-]QWERTYUIOP@ASDFGHJKL;"
620 T$=T$&"ZXCVBNM,./{!#$%&'()0*=}~`+|<>?+-*/^E!"
630 FOR L1=2 TO 34
640 PRINT T$
650 NEXT L1
660 PRINT T$;
670 RETURN 
680 REM ***GAP TEST***
690 DIM D1(12)
700 PRINT @32,21:0,0
710 RESTORE 720
720 DATA 98,0,98,98,0,98,0,0,98,98,0,0
730 READ D1
740 PRINT @32,20:D1
750 PRINT @32,21:53,49
760 PRINT "this gap must be < 3 mm!!"
770 FOR L1=1 TO 5
780 PRINT @32,21:45,55
790 PRINT @32,20:49,51
800 PRINT @32,20:48,51
810 PRINT @32,21:49,51
820 PRINT @32,20:49,52
830 PRINT @32,21:55,45
840 PRINT @32,20:51,49
850 PRINT @32,20:51,48
860 PRINT @32,21:51,49
870 PRINT @32,20:52,49
880 NEXT L1
890 RETURN 
900 REM ***GRID PATTERN***
910 FOR L1=0 TO 131 STEP 0.128*8
920 PRINT @32,21:L1,0
930 PRINT @32,20:L1,98
940 PRINT @32,21:0,L1
950 IF L1>99 THEN 970
960 PRINT @32,20:130,L1
970 NEXT L1
980 RETURN 
990 REM ***DECREASING RECTANGLE***
1000 FOR L1=15*0.128 TO 383*0.128 STEP 0.128*8
1010 PRINT @32,21:L1,L1
1020 PRINT @32,20:1015*0.128-L1,L1
1030 PRINT @32,20:1015*0.128-L1,781*0.128-L1
1040 PRINT @32,20:L1,781*0.128-L1
1050 PRINT @32,20:L1,L1
1060 NEXT L1
1070 RETURN 
1080 REM ***RANDOM ROTATING ELLIPSES***
1090 T1=RND(-1)*180
1100 T2=RND(-2)*180
1110 T3=65*RND(-5)
1120 T4=50*RND(-6)
1130 T5=50*RND(-8)
1140 T6=65*RND(-3)
1150 T7=50*RND(-4)
1160 T8=65*RND(-7)
1170 FOR L1=PI/25 TO 2*PI STEP PI/25
1180 PRINT @32,21:T3*SIN(L1+T2)+65,T4*COS(L1+T2)+50
1190 PRINT @32,20:T6*SIN(L1+T1)+65,T7*COS(L1+T1)+50
1200 PRINT @32,20:T8*SIN(L1+(T1-T2))+65,T5*COS(L1+(T1-T2))+50
1210 PRINT @32,20:T3*SIN(L1+T2)+65,T4*COS(L1+T2)+50
1220 NEXT L1
1230 RETURN 
1240 REM ***SINE AND COSINE GRAPH***
1250 AXIS 5,4,65,50
1260 MOVE 0,98
1270 FOR L1=0 TO 2*PI STEP PI/50
1280 T1=130/(2*PI)*L1
1290 T2=48*COS(L1)+50
1300 PRINT @32,20:T1,T2
1310 T2=48*SIN(L1)+50
1320 PRINT @32,21:T1,T2
1330 NEXT L1
1340 PRINT @32,21:0,50
1350 FOR L1=0 TO 2*PI STEP PI/50
1360 T1=130/(2*PI)*L1
1370 T2=48*SIN(L1)+50
1380 PRINT @32,20:T1,T2
1390 T2=48*COS(L1)+50
1400 PRINT @32,21:T1,T2
1410 NEXT L1
1420 RETURN 
1430 REM ***SPIDER WEB***
1440 SET DEGREES 
1450 WINDOW -5,135,-5,105
1460 T1=55
1470 MOVE 65,T1+50
1480 FOR L1=0 TO 360 STEP 22.5
1490 T2=T1*SIN(L1)+65
1500 T3=T1*COS(L1)+50
1510 DRAW T2,T3
1520 IF T1<55 THEN 1550
1530 DRAW 130-T2,100-T3
1540 DRAW T2,T3
1550 NEXT L1
1560 T1=T1-5
1570 IF T1<=0 THEN 1590
1580 GO TO 1470
1590 MOVE 120,50
1600 DRAW 120.6,20
1610 DRAW 120,16.5
1620 PRINT "o"
1630 FOR L1=119.5 TO 120.5 STEP 0.5
1640 MOVE L1,18
1650 PRINT "O"
1660 NEXT L1
1670 FOR L1=16.5 TO 18.5 STEP 0.66666
1680 MOVE 118.5,L1
1690 PRINT "/"
1700 NEXT L1
1710 FOR L1=16.5 TO 18.5 STEP 0.66666
1720 MOVE 121.5,L1
1730 PRINT "\"
1740 NEXT L1
1750 MOVE 120,19.1
1760 PRINT "A"
1770 SET RADIANS 
1780 WINDOW 0,130,0,100
1790 RETURN 
1800 REM ***ROTATING DECREASING SQUARE***
1810 WINDOW -65,65,-50,50
1820 MOVE 0,0
1830 FOR L1=50 TO 0.1 STEP -4*0.128
1840 ROTATE L1/50*2*PI
1850 RMOVE 0,L1
1860 RDRAW L1,-L1
1870 RDRAW -L1,-L1
1880 RDRAW -L1,L1
1890 RDRAW L1,L1
1900 RMOVE 0,-L1
1910 NEXT L1
1920 WINDOW 0,130,0,100
1930 RETURN 
1940 REM ***3 DIMENSIONAL DRAWING***
1950 SET DEGREES 
1960 FOR L1=0 TO 180 STEP 1
1970 MOVE 65,50
1980 ROTATE L1
1990 RDRAW 0,SIN(L1)*40
2000 RDRAW COS(L1)*20,0
2010 RDRAW 0,SIN(L1)*20
2020 NEXT L1
2030 SET RADIANS 
2040 RETURN 
2050 REM ***CUMMULATIVE(FILE 2) & LAST PASS(FILE 3) ERROR TABLE INIT***
2060 D$=I$&"SERIAL: # B______  IN: __._.__   PASS:   0   PASSED"
2070 PRINT "ENTER ";I$;"SERIAL NUMBER(B0XXXXX): _______";
2080 INPUT T$
2090 IF LEN(T$)<>7 OR POS(T$,"B",1)<>1 THEN 2050
2100 D$=REP(T$,17,7)
2110 PRINT "ENTER DATE(WK.D.HR): _______..";
2120 INPUT T$
2130 IF LEN(T$)<>7 OR POS(T$,".",3)<>3 THEN 2110
2140 D$=REP(T$,30,7)
2150 FIND 0
2160 FIND 2
2170 MARK 2,12032
2180 FIND 2
2190 PRINT @33:D$;
2200 CLOSE 
2210 RETURN 
2220 PRINT "MARK FILES AND SAVE PROGRAM--";
2230 FIND 0
2240 MARK 3,12032
2250 FIND 1
2260 SAVE 
2270 PRINT "DONE"
2280 FIND 1
2290 OLD 
2300 PAGE 
2310 END 
2320 REM ***CHECK FOR ERRORS ON FILE: # 2(TOTAL) & FILE: # 3(SINGLE)***
2330 GOSUB 3590
2340 IF F9<>0 THEN 2380
2350 PRINT "";D$
2360 PRINT "			 CYCLE  TOTAL			FAILED FAILED"
2370 GOSUB 2450
2380 PRINT "PRESS <RETURN> TO CONTINUE: ";
2390 INPUT Q$
2400 PRINT "";D$;", LAST CYCLE:"
2410 FIND 3
2420 GOSUB 2450
2430 FIND 0
2440 END 
2450 REM ***LOAD AND DISPLAY ERRORS ON THE SCREEN***
2460 E1=0
2470 F9=0
2480 INPUT @33:T$
2490 IF F9=1 THEN 2540
2500 IF LEN(T$)<=5 OR LEN(T$)=18 THEN 2480
2510 E1=E1+1
2520 PRINT T$
2530 GO TO 2480
2540 IF E1<>0 THEN 2570
2550 PRINT "NO ERRORS DETECTED"
2560 GO TO 2580
2570 PRINT "";E1;" ERRORS DETECTED"
2580 RETURN 
2590 REM ***MERGE FILE: # 3 ERRORS INTO FILE: # 2 CUMMULATIVE ERRORS***
2600 REM ***FORMATS ARE: i t P,i t F aaaaa ee rr bbbbbbbb,***
2610 REM ***C t ssss eeee rrrr,D E P,D E F w***
2620 REM ***i=TEST INITIAL,t=PRODUCT TYPE,P=PASS,F=FAIL,a=ADDRESS***
2630 REM ***e=EXPECTED,r=RECEIVED,b=bit pattern,C=CRC,s=START ADDRESS***
2640 REM ***e=END ADDRESS,r=CRC,w=DATA REGISTER ERROR CODE***
2650 DELETE F$
2660 M9=MEMORY-500 MIN 10000
2670 DIM F$(M9)
2680 ON EOF (0) THEN 90
2690 REM ***LOAD CUMMULATIVE ERROR DATA FROM FILE 2***
2700 GOSUB 3590
2710 T$=SEG(D$,46,3)
2720 D$=REP("   ",46,3)
2730 T$=STR(VAL(T$)+1 MIN 999)
2740 T$=REP("",1,1)
2750 D$=REP(T$,46+3-LEN(T$),LEN(T$))
2760 F$=D$&R$
2770 IF F9<>0 THEN 3520
2780 INPUT @33:T$
2790 IF F9=1 OR LEN(F$)+LEN(T$)+1>M9 THEN 2830
2800 T$=T$&R$
2810 F$=REP(T$,LEN(F$)+1,0)
2820 GO TO 2780
2830 REM ***MERGE FILE 3 LAST PASS ERROR DATA WITH CUM. ERROR DATA***
2840 REM ***1<=PASS THAT FAILED<=999 IN COLUMNS 58-60***
2850 REM ***1<=TOTAL FAILED BY ERROR TYPE<=9999 IN COLUMNS 62-65***
2860 FIND 3
2870 F9=0
2880 INPUT @33:T$
2890 IF F9=1 OR LEN(F$)+LEN(B$)+1>M9 THEN 3520
2900 IF LEN(T$)<=5 OR LEN(T$)>26 THEN 2880
2910 IF POS(T$,"C",1)<>1 THEN 3320
2920 IF POS(T$,"N",3)<>3 THEN 3130
2930 REM ***4052/54 V4.4 CRCS***
2940 RESTORE 2950
2950 DATA "C N 4601 4801 5440"
2960 DATA "C N 4600 4800 B0DB"
2970 DATA "C N 4401 4601 A7E3"
2980 DATA "C N 4400 4600 AEED"
2990 DATA "C N C001 FF01 8AF0"
3000 DATA "C N C000 FF00 3BC5"
3010 DATA "C N 8001 C001 3FE5"
3020 DATA "C N 8000 C000 7403"
3030 DATA "C N 4801 8001 95BC"
3040 DATA "C N 4800 8000 00F1"
3050 DATA "C N 4001 4401 7132"
3060 DATA "C N 4000 4400 3EAB"
3070 DATA "C N E001 FF01 1F38"
3080 DATA "C N E000 FF00 5B67"
3090 DATA "C O 0000 2000 2435"
3100 DATA "C O 0000 2000 844A"
3110 DATA "C O 2000 4000 21D8"
3120 DATA "END"
3130 REM ***4052A/54A V1.4 CRCS***
3140 RESTORE 3150
3150 DATA "C G E000 FF00 68DF"
3160 DATA "C G E001 FF01 7F39"
3170 DATA "C G 4000 8000 F696"
3180 DATA "C G 4001 8001 DA3C"
3190 DATA "C G 8000 C000 7DDF"
3200 DATA "C G 8001 C001 59EE"
3210 DATA "C G C000 FF00 B463"
3220 DATA "C G C001 FF01 7117"
3230 DATA "C G 0000 4000 C8A7"
3240 DATA "C G 0001 4001 9E0D"
3250 DATA "C O 0000 2000 2435"
3260 DATA "C O 0000 2000 844A"
3270 DATA "C O 2000 4000 21D8"
3280 DATA "END"
3290 READ D$
3300 IF T$=D$ THEN 2880
3310 IF D$<>"END" THEN 3290
3320 F$=REP("FAILED",52,6)
3330 D$=SEG(T$,1,3)
3340 T1=POS(F$,D$,1)
3350 IF T1=0 THEN 3440
3360 T2=POS(F$,T$,1)
3370 IF T2=0 THEN 3450
3380 T$=SEG(F$,T2-1+62,4)
3390 T$=STR(VAL(T$)+1 MIN 9999)
3400 T$=REP("",1,1)
3410 F$=REP("    ",T2-1+62,4)
3420 F$=REP(T$,T2-1+62+4-LEN(T$),LEN(T$))
3430 GO TO 2880
3440 T1=LEN(F$)+1
3450 D$=B$
3460 D$=REP(T$,1,LEN(T$))
3470 T$=SEG(F$,46,3)
3480 D$=REP(T$,58,3)
3490 D$=REP("1",65,1)
3500 F$=REP(D$,T1,0)
3510 GO TO 2880
3520 REM ***SAVE MERGED DATA ONTO FILE: # 2***
3530 FIND 2
3540 PRINT @33:F$;
3550 CLOSE 
3560 D$=SEG(F$,1,57)
3570 DELETE F$
3580 RETURN 
3590 REM ***CHECK THAT FILE: #2 HAS BEEN INITIALIZED WITH A SERIAL #***
3600 PRINT @33,0:0,0,0
3610 FIND 2
3620 PRINT @33,0:0,0,1
3630 FIND 2
3640 PRINT @33,0:0,0,0
3650 INPUT @33:T$
3660 IF POS(T$,"NEW",9)<>9 THEN 3710
3670 PRINT "WARNING: CYCLE TAPE HAS NOT BEEN INITIALIZED!!!"
3680 D$=I$&"SERIAL: # B______  IN: __._.__   PASS:   0   PASSED"
3690 F9=1
3700 GO TO 3740
3710 FIND 2
3720 INPUT @33:D$
3730 F9=0
3740 RETURN 
