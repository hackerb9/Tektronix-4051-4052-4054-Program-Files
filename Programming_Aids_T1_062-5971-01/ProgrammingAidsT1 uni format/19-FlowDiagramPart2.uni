101 IF P3>0 THEN 80111 T=0121 Z=0131 Z1=0141 R=0151 W1=0161 W2=0171 M=32181 PAGE 191 S=1201 GOSUB 231211 GOSUB 331221 END 231 REM .....draw grid.....241 FOR I=40 TO 120 STEP 20251 MOVE @M:I,0261 DRAW @M:I,100-10*SGN((I+40)/80-INT((I+40)/80))271 NEXT I281 FOR I=0 TO 100 STEP 10291 MOVE @M:40,I301 DRAW @M:120,I311 NEXT I321 RETURN 331 REM .....select boxes.....341 FOR J=2 TO 10351 FOR I=1 TO 4361 MOVE 30+20*I,105-10*J371 PRINT "?";381 K=0391 INPUT K$401 IF K=10 THEN 361411 T(I,J)=K*S421 NEXT I431 NEXT J441 GO TO 80451 REM461 REM .....box routines.....471 A=24+20*I481 F=0491 GOSUB 511501 RETURN 511 B=110-10*J521 C=A-F531 D=B-8541 GOSUB 2221551 A=C+12561 B=D571 GOSUB 2221581 C=A+F591 D=B+8601 GOSUB 2221611 A=C-12621 B=D631 GOSUB 2221641 RETURN 651 A=25.5+20*I661 F=3671 GOSUB 511681 RETURN 691 A=24+20*I701 B=110-10*J711 C=A721 D=B-9731 GOSUB 2221741 B=D751 A=C+2761 GOSUB 2221771 C=A+2781 D=B+0.3791 GOSUB 2221801 A=C+2811 B=D+0.7821 GOSUB 2221831 C=A+2841 D=B+0.7851 GOSUB 2221861 A=C+2871 B=D+0.3881 GOSUB 2221891 C=A+2901 D=B911 GOSUB 2221921 A=C931 B=D+7941 GOSUB 2221951 C=A-12961 D=B971 GOSUB 2221981 RETURN 991 A=27+20*I1001 B=110-10*J1011 C=A-31021 D=B-41031 GOSUB 22211041 B=B-81051 GOSUB 22211061 D=B1071 C=A+81081 GOSUB 22211091 B=B+11101 A=C+0.51111 GOSUB 22211121 C=C+0.751131 D=D+21141 GOSUB 22211151 B=B+21161 A=A+0.41171 GOSUB 22211181 C=C+0.251191 D=D+21201 GOSUB 22211211 B=B+21221 GOSUB 22211231 C=C-0.251241 D=D+21251 GOSUB 22211261 A=A-0.41271 B=B+21281 GOSUB 22211291 C=C-0.751301 D=D+21311 GOSUB 22211321 A=C-81331 B=B+11341 GOSUB 22211351 RETURN 1361 D=41371 GOSUB 21811381 A=30+20*I1391 B=102-10*J1401 C=A+51411 D=B1421 GOSUB 22211431 RETURN 1441 A=30+20*I1451 B=110-10*J1461 C=A-61471 D=B-41481 GOSUB 22211491 B=B-81501 GOSUB 22211511 C=C+121521 GOSUB 22211531 B=B+81541 GOSUB 22211551 RETURN 1561 A=26+20*I1571 B=110-10*J1581 C=A-21591 D=B-21601 GOSUB 22211611 A=C1621 B=D-61631 GOSUB 22211641 C=A+121651 D=B1661 GOSUB 22211671 A=C1681 B=D+81691 GOSUB 22211701 C=A-101711 D=B1721 GOSUB 22211731 RETURN 1741 A=25+20*I1751 B=110-10*J1761 GOSUB 27111771 D=B1781 C=A+121791 GOSUB 22211801 A=C1811 B=D+81821 C=C-121831 D=B1841 GOSUB 22211851 GOSUB 27111861 RETURN 1871 A=30+20*I1881 B=110-10*J1891 C=A1901 D=B-11911 GOSUB 22211921 A=C-31931 B=D1941 GOSUB 22211951 C=A1961 D=B-31971 GOSUB 22211981 A=C+31991 B=D-22001 GOSUB 22212011 C=C+62021 GOSUB 22212031 A=C2041 B=D+32051 GOSUB 22212061 C=A-32071 D=B2081 GOSUB 22212091 RETURN 2101 D=2.52111 GOSUB 21812121 A=32.5+20*I2131 C=A+3.52141 B=106-10*J2151 D=B2161 GOSUB 22212171 RETURN 2181 A=30+20*I2191 B=106-10*J2201 GOSUB 29512211 RETURN 2221 REM .....draw from a,b to c,d.....2231 IF A=C AND B=D THEN 24912241 A9=A2251 B9=B2261 C9=C2271 D9=D2281 IF C<>W1 OR D<>W2 THEN 23312291 A9=C2301 B9=D2311 C9=A2321 D9=B2331 IF R=0 THEN 24312341 A9=125-B*1.252351 B9=A*1.25-502361 C9=125-D*1.252371 D9=C*1.25-502381 IF C9<>W1 OR D9<>W2 THEN 24312391 A9=C92401 B9=D92411 C9=125-B*1.252421 D9=A*1.25-502431 IF S<>1 THEN 25012441 IF A9=W1 AND B9=W2 THEN 24612451 MOVE @M:A9,B92461 DRAW @M:C9,D92471 W1=C92481 W2=D92491 RETURN 2501 IF B9<>D9 AND A9<>C9 THEN 25212511 GO TO 25412521 IF ABS(B9-D9)>ABS(A9-C9) THEN 25512531 GO TO 26312541 IF B9=D9 THEN 26312551 FOR N9=B9 TO D9 STEP SGN(D9-B9)2561 E9=(C9-A9)*(N9-B9)/(D9-B9)+A92571 MOVE @M:E9,N92581 DRAW @M:E9,N92591 W1=E92601 W2=N92611 NEXT N92621 RETURN 2631 FOR E9=A9 TO C9 STEP SGN(C9-A9)2641 N9=(D9-B9)*(E9-A9)/(C9-A9)+B92651 MOVE @M:E9,N92661 DRAW @M:E9,N92671 W1=E92681 W2=N92691 NEXT E92701 RETURN 2711 C=A-0.52721 D=B-12731 GOSUB 22212741 A=A-0.752751 B=B-22761 GOSUB 22212771 C=C-0.42781 D=D-22791 GOSUB 22212801 A=A-0.252811 B=B-22821 GOSUB 22212831 D=D-22841 GOSUB 22212851 A=A+0.252861 B=B-22871 GOSUB 22212881 C=C+0.52891 D=D-22901 GOSUB 22212911 A=A+0.752921 B=B-22931 GOSUB 22212941 RETURN 2951 REM .....circle.....2961 D8=D2971 A8=A2981 B8=B2991 L=13051 FOR N=1 TO 253061 C=D8*C5(N)+A83071 D=D8*S5(N)+B83081 IF N=1 THEN 31313091 IF S=1 THEN 31213101 L=L+13111 IF L<2 THEN 31313121 GOSUB 22213131 A=C3141 B=D3151 NEXT N3161 RETURN 3171 REM