90 REM 51/00-8002/0 LIST PROGRAM'S VARIABLES100 DIM A$(3),B$(2),L$(74),N$(572),S$(52)110 REM ----- GET FILE NUMBER -----120 PAGE 130 PRINT "SORT AND LIST PROGRAM VARIABLES"140 PRINT "Enter File Number: ";150 INPUT F160 IF INT(F)<>F OR F<=0 THEN 140170 FIND F180 ON EOF (0) THEN 320190 PRINT "Is this a continuation of a previous run?: ";200 INPUT A$210 A$=SEG(A$,1,1)220 IF A$<>"N" THEN 290230 REM ----- INITIALIZE240 N=0250 S=0260 N$=""270 S$=""280 REM ----- PROCESS FILE -----290 INPUT @33:L$300 GOSUB 570310 GO TO 290320 PAGE 330 REM ----- PRINT NUMERIC VARIABLE NAMES -----340 IF N=0 THEN 440350 PRINT "NUMERIC VARIABLES"360 PRINT 370 FOR I=1 TO N380 A$=SEG(N$,I*2-1,2)390 PRINT A$;"                ";400 NEXT I410 PRINT 420 PRINT 430 REM ----- PRINT STRING VARIABLE NAMES -----440 IF S=0 THEN 540450 PRINT "STRING VARIABLES"460 PRINT 470 FOR I=1 TO S480 A$=SEG(S$,I*2-1,2)490 PRINT A$;"                ";500 NEXT I510 PRINT 520 PRINT 530 REM ----- GO AWAY -----540 FIND 0550 END 560 REM ----- SUBROUTINE TO FETCH VARIABLE NAMES FROM INPUT LINE -----570 L$=L$&"  "580 REM ----- CHECK FOR REMARK AND IMAGE STATEMENTS -----590 I=POS(L$," ",1)600 A$=SEG(L$,I+1,3)610 IF A$="REM" OR A$="IMA" THEN 1130620 F=0630 FOR I=2 TO LEN(L$)640 A$=SEG(L$,I,1)650 A=ASC(A$)660 REM ----- IGNORE CHARACTERS BETWEEN QUOTES (") -----670 IF F=0 THEN 710680 IF A<>34 THEN 1120690 F=0700 GO TO 1120710 IF A<>34 THEN 740720 F=1730 GO TO 1120740 IF A<65 OR A>90 THEN 1120750 REM ----- CHECK PREVIOUS CHARACTER -----760 B$=SEG(L$,I-1,1)770 B=ASC(B$)780 IF B>64 AND B<91 OR (B>96 AND B<123) THEN 1120790 IF B>47 AND B<58 THEN 1120800 REM ----- CHECK NEXT CHARACTER -----810 B$=SEG(L$,I+1,1)820 B=ASC(B$)830 IF B>64 AND B<91 OR (B>96 AND B<123) THEN 1120840 REM ----- ONE CHARACTER OR TWO CHARACTER NAME -----850 IF B=32 OR B=36 OR (B>47 AND B<58) THEN 870860 B$=" "870 A$=A$&B$880 IF B$="$" THEN 1020890 REM ----- SAVE NUMERIC VARIABLE NAMES -----900 IF N=0 THEN 980910 FOR J=1 TO N920 B$=SEG(N$,J*2-1,2)930 IF A$=B$ THEN 1120940 IF B$<A$ THEN 970950 N$=REP(A$,J*2-1,0)960 GO TO 990970 NEXT J980 N$=N$&A$990 N=N+11000 GO TO 11201010 REM ----- SAVE STRING VARIABLE NAMES -----1020 IF S=0 THEN 11001030 FOR J=1 TO S1040 B$=SEG(S$,J*2-1,2)1050 IF A$=B$ THEN 11201060 IF B$<A$ THEN 10901070 S$=REP(A$,J*2-1,0)1080 GO TO 11101090 NEXT J1100 S$=S$&A$1110 S=S+11120 NEXT I1130 RETURN 