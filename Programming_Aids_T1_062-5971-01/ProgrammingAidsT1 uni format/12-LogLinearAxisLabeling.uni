90 REM 51/00-9504/0 LOG/LINEAR AXIS LABELING ROUTINE100 DEF FNF(Q)=Q+1.0E-3110 DEF FNG(Q)=SIN(Q)*Q MAX Q*SQR(1/Q)111 PRINT "DOMAIN FROM ";112 INPUT X1113 PRINT "TO ";114 INPUT X2115 PRINT "RANGE FROM ";116 INPUT Y1117 PRINT "TO ";118 INPUT Y2120 T1=10121 PRINT " CHOOSE FROM THE FOLLOWING LIST:"122 PRINT "          0 LIN-X LIN-Y"123 PRINT "          1 LOG-X LIN-Y"124 PRINT "          2 LIN-X LOG-Y"125 PRINT "          3 LOG-X LOG-Y"126 PRINT "WELL ";127 INPUT T0130 T2=12140 W1=X1150 W2=X2160 W3=Y1170 W4=Y2180 V1=0190 V2=130200 V3=0210 V4=100220 PAGE 230 GOSUB 5030240 MOVE FNX(FNF(X1)),FNY(FNG(X1))250 FOR I=X1 TO X2 STEP (X2-X1)/100260 DRAW FNX(FNF(I)),FNY(FNG(I))270 NEXT I280 HOME 290 END 5000 REM THIS SUBROUTINE GENERATES A NEATLY LABELED AXIS WITH ANY5010 REM RANGE, ANY SIZE, ANYWHERE ON THE SCREEN. IT CAN GIVE YOU5020 REM LOGARITHMIC OR LINEAR TIC-MARKS AND LABELS ON EITHER AXIS.5030 REM PARAMETERS: V1-MIN X VIEWPORT  V2-MAX X VIEWPORT5040 REM             V2-MIN Y VIEWPORT  V4-MAX Y VIEWPORT5050 REM             W1-MIN X WINDOW    W2-MAX X WINDOW5060 REM             W3-MIN Y WINDOW    W4-MAX Y WINDOW5070 REM             T1-NUMBER OF TICS ON X AXIS (MINIMUM)(IF LIN-X)5080 REM             T2-NUMBER OF TICS ON Y AXIS (MINIMUM)(IF LIN-Y)5090 REM             T0-OPTION CHOICE: IF 0 THEN LIN-X LIN-Y5100 REM                                  1 THEN LOG-X LIN-Y5110 REM                                  2 THEN LIN-X LOG-Y5120 REM                                  3 THEN LOG-X LOG-Y5130 REM THIS ROUTINE WILL STEAL SOME OF THE ALLOWED VIEWPORT FOR THE5140 REM LABELING AND THEN ADJUST V1,V2,V3,V4,W1,W2,W3,W4 AND PASS THEM5150 REM BACK. IT ALSO EXECUTES THE VIEWPORT AND WINDOW COMMANDS5160 REM IMMEDIATELY BEFORE RETURNING.5170 REM    IF IT IS NECESSARY TO CHANGE THE WINDOW OR VIEWPORT, THEY5180 REM CAN BE RESTORED BY:5190 REM             VIEWPORT V1,V2,V3,V45200 REM             WINDOW W1,W2,W3,W45210 REM INTERNAL VARIABLES USED: T3,T4,T5,X$,Y$,FNZ,FNY,FNX,FNW5220 REM    FNX AND FNY ARE SET-UP TO BE TRANSFORMATION FUNCTIONS.5230 REM WHENEVER YOU DO A MOVE OR DRAW WHEN PLOTTING THE FUNCTION,5240 REM DO:5250 REM             MOV FNX(X-COORD),FNY(Y-COORD)5260 REM             DRAW FNX(X-COORD),FNY(Y-COORD)5270 REM THIS WILL PUT YOU AT THE RIGHT POINT WITH RESPECT TO THE AXIS5280 REM (IF THE VIEWPORT AND WINDOW ARE RESET OR NEVER TOUCHED)5290 REM THIS ROUTINE PLAYS WITH FUZZ! SO SET IT BACK WHEN IT RETURNS.5300 FUZZ 10,1.0E-95310 DEF FNW(Q)=INT(Q*(1+SGN(Q)*1.0E-10))5320 DIM T3(31)5330 DEF FNZ(Q)=FNW(LGT(ABS(Q)+(Q=0)))5340 IF V2<126 THEN 53605350 V2=1265360 T3(10)=15370 IF T0=1 OR T0=3 THEN 54605380 T3(12)=W2-W15390 T3(13)=T15400 T3(15)=W15410 T3(16)=W25420 GOSUB 66205430 W2=T3(16)5440 W1=T3(15)5450 T3(1)=T3(14)5460 T3(5)=T3(10)5470 T3(10)=15480 REM CALL FOR Y5490 IF T0=>2 THEN 55805500 T3(12)=W4-W35510 T3(13)=T25520 T3(15)=W35530 T3(16)=W45540 GOSUB 66205550 W4=T3(16)5560 W3=T3(15)5570 T3(2)=T3(14)5580 T3(7)=T3(10)5590 DELETE X$,X,Y$,Y5600 DIM X$(16),Y$(4)5610 VIEWPORT 0,130,0,1005620 WINDOW 0,130,0,1005630 MOVE V1+8.9,V3+8.375640 PRINT @32,20:V2,V3+8.37,V1+8.9,V3+8.37,V1+8.9,V4-35650 IF T3(7)=1 THEN 56805660 MOVE V1+7,V4-2.85670 PRINT "E";FNZ(T3(7));5680 IF T3(5)=1 THEN 57105690 MOVE V1+7,V35700 PRINT "E";FNZ(T3(5));5710 VIEWPORT V1+8.92,V2,0,1005720 IF T0=1 OR T0=3 THEN 70305730 WINDOW W1,W2,0,1005740 FOR T5=W1 TO W2 STEP T3(1)5750 MOVE T5,V3+8.375760 DRAW T5,V3+95770 NEXT T55780 VIEWPORT 0,130,V3+8.37,V4-35790 IF T0=>2 THEN 72405800 WINDOW 0,130,W3,W45810 FOR T5=W3 TO W4 STEP T3(2)5820 MOVE V1+8.92,T55830 DRAW V1+9.3,T55840 NEXT T55850 REM TICS X AND Y5860 REM NOW THE LABELS5870 IF T0=1 OR T0=3 THEN 61205880 VIEWPORT V1+8.92,V2,0,1005890 WINDOW W1,W2,0,1005900 DEF FNX(Q)=Q5910 T3(20)=(W2/T3(5)-W1/T3(5))*11/(V2-V1-8.92)5920 T3(20)=T3(20)/(T3(1)/T3(5))5930 IF T3(20)=INT(T3(20)) THEN 59705940 T3(20)=INT(T3(20)+1)5950 T3(23)=T3(1)5960 GOSUB 69105970 T3(26)=FNW(W1/T3(20))*T3(20)5980 T3(27)=FNW(W2/T3(20))*T3(20)5990 T3(28)=T3(20)6000 IF T3(26)=>W1 THEN 60206010 T3(26)=T3(26)+T3(20)6020 IF T3(27)<=W2 THEN 60306030 FOR T5=T3(26) TO T3(27) STEP T3(28)6040 MOVE T5,V3+8.376050 DRAW T5,V3+7.56060 T3(21)=T5/T3(5)6070 X$=STR(T3(21)*(T3(21)<>0)*(1+10^(FNZ(T3(21))-6)))6080 Y$=SEG(X$,2,4)6090 MOVE T5-0.89*(W2-W1)/(V2-V1-8.95)*LEN(Y$),V3+46100 PRINT Y$;6110 NEXT T56120 IF T0=>2 THEN 63806130 VIEWPORT 0,130,V3+8.37,V4-36140 WINDOW 0,130,W3,W46150 DEF FNY(Q)=Q6160 T3(20)=(W4/T3(7)-W3/T3(7))*11/(V4-V3-11.37)6170 T3(20)=T3(20)/(T3(2)/T3(7))6180 IF T3(20)=INT(T3(20)) THEN 62106190 T3(20)=INT(T3(20)+1)6200 T3(23)=T3(2)6210 GOSUB 69106220 T3(29)=FNW(W3/T3(20))*T3(20)6230 T3(30)=FNW(W4/T3(20))*T3(20)6240 T3(31)=T3(20)6250 IF T3(29)=>W3 THEN 62706260 T3(29)=T3(29)+T3(20)6270 IF T3(30)<=W4 THEN 62906280 T3(30)=T3(30)-T3(20)6290 FOR T5=T3(29) TO T3(30) STEP T3(31)6300 T5=T5*(ABS(T5)>T3(2)/3)6310 MOVE V1+8.92,T56320 DRAW V1+7.75,T56330 MOVE V1+1,T56340 X$=STR(T5/T3(7))6350 Y$=SEG(X$,2,4)6360 PRINT Y$;6370 NEXT T56380 V1=V1+8.926390 V3=V3+8.376400 V4=V4-36410 VIEWPORT V1,V2,V3,V46420 WINDOW W1,W2,W3,W46430 FOR T5=T3(29) TO T3(30) STEP T3(31)6440 FOR T4=T3(26) TO T3(27) STEP T3(28)6450 MOVE T4,T56460 DRAW T4,T56470 NEXT T46480 NEXT T56490 IF T0<>0 THEN 66006500 IF SGN(W3)*SGN(W4)<>-1 THEN 65506510 FOR T5=W1 TO W2 STEP T3(1)6520 MOVE T5,06530 DRAW T5,06540 NEXT T56550 IF SGN(W1)*SGN(W2)<>-1 THEN 66006560 FOR T5=W3 TO W4 STEP T3(2)6570 MOVE 0,T56580 DRAW 0,T56590 NEXT T56600 DELETE T3,T4,T5,X$,Y$6610 RETURN 6620 REM SUBROUTINE TO MODIFY PASSED PARAMETERS SO AS TO MAKE6630 REM THEM CLEAN; AND COMPUTE FACTOR FOR LABELING6640 T3(14)=T3(12)/T3(13)6650 T3(24)=FNZ(T3(14))6660 T3(25)=T3(14)/10^T3(24)6670 IF T3(25)=>2 THEN 67006680 T3(25)=16690 GO TO 67706700 IF T3(25)=>2.5 THEN 67306710 T3(25)=26720 GO TO 67706730 IF T3(25)=>5 THEN 67606740 T3(25)=2.56750 GO TO 67706760 T3(25)=56770 T3(14)=T3(25)*10^T3(24)6780 T3(15)=T3(14)*FNW(T3(15)/T3(14))6790 T3(17)=T3(14)*INT(T3(16)/T3(14))6800 IF T3(16)=T3(17) THEN 68206810 T3(16)=T3(14)*(INT(T3(16)/T3(14))+1)6820 T3(10)=16830 T3(17)=06840 IF T3(15)=0 THEN 68606850 T3(17)=FNZ(T3(15))6860 IF T3(16)=0 THEN 68806870 T3(17)=T3(17) MAX FNZ(T3(16))6880 IF ABS(T3(17))+(T3(17)<0)<2 THEN 69006890 T3(10)=10^T3(17)6900 RETURN 6910 T5=T3(20)6920 T3(21)=T5*T3(23)6930 T3(22)=T3(21)/10^FNZ(T3(21)+1.0E-10*SGN(T3(21)))6940 IF T5<>T3(20) THEN 69506950 IF T3(22)=1 THEN 70106960 IF T3(22)=2 THEN 70106970 IF T3(22)=2.5 THEN 70106980 IF T3(22)=5 THEN 70106990 T5=T5+17000 GO TO 69207010 T3(20)=T3(21)7020 RETURN 7030 W1=10^FNZ(W1)7040 W2=10^-FNW(-LGT(W2))7050 WINDOW FNZ(W1),FNZ(W2),0,1007060 VIEWPORT V1+8.92,V2,0,1007070 T3(3)=W17080 MOVE LGT(T3(3)),V3+8.377090 T3(4)=FNZ(T3(3)*1.001)7100 DRAW LGT(T3(3)),V3+9.27110 IF T3(3)/10^T3(4)<>1 THEN 71507120 DRAW LGT(T3(3)),V3+7.57130 MOVE LGT(T3(3))-3.56*(FNZ(W2)-FNZ(W1))/(V2-V1-8.92),V3+47140 PRINT "1E";T3(4)7150 T3(3)=T3(3)+10^T3(4)7160 IF T3(3)<=W2 THEN 70807170 W1=FNZ(W1)7180 W2=-FNW(-LGT(W2))7190 DEF FNX(Q)=LGT(Q)7200 T3(26)=W17210 T3(27)=W27220 T3(28)=17230 GO TO 57807240 W3=10^FNZ(W3)7250 W4=10^-FNW(-LGT(W4))7260 WINDOW 0,130,FNZ(W3),FNZ(W4)7270 VIEWPORT 0,130,V3+8.37,V4-37280 DEF FNY(Q)=LGT(Q)7290 T3(3)=W37300 MOVE V1+8.92,LGT(T3(3))7310 T3(4)=FNZ(T3(3)*1.001)7320 DRAW V1+9.8,LGT(T3(3))7330 IF T3(3)/10^T3(4)<>1 THEN 73707340 DRAW V1+8,LGT(T3(3))7350 MOVE V1,LGT(T3(3))7360 PRINT "1E";T3(4)7370 T3(3)=T3(3)+10^T3(4)7380 IF T3(3)<=W4 THEN 73007390 W3=FNZ(W3)7400 W4=-FNW(-LGT(W4))7410 T3(29)=W37420 T3(30)=W47430 T3(31)=17440 GO TO 5870