1 REM * REMARK OUTLINER PROGRAM  '$OUTLINE'  - 9/25/792 REM * 51/00-8035/0110 REM * CONTROL MODULE120 GOSUB 170130 GOSUB 300140 GOSUB 410150 GOSUB 530160 END 170 REM * SELECT REMARK TYPE AND FILE NUMBER180 INIT 190 DIM I9(50)200 I9=0210 M=0220 ON EOF (0) THEN 1420230 PRINT "ENTER SEARCH STRING FOR REMARKS SUCH AS 'REM * ' ? ";240 INPUT S$242 IF LEN(S$)<3 THEN 230244 R$=SEG(S$,1,3)246 IF R$<>"REM" THEN 230250 S=LEN(S$)260 PRINT "
ENTER TAPE FILE NUMBER OF PROGRAM TO BE OUTLINED? ";270 INPUT F280 FIND F290 RETURN 300 REM * FIRST REMARK FOR PROGRAM TITLE310 E=0320 INPUT @33:A$330 IF E=1 THEN 380340 L=POS(A$,S$,1)350 IF L=0 OR L>10 THEN 320360 T$=SEG(A$,L+S,LEN(A$)-(L+S-1))370 GO TO 400380 PRINT "
NO REMARKS START WITH '";S$;"' IN FILE # ";F390 END 400 RETURN 410 REM * FIRST PASS TO RECORD MODULE LOCATIONS420 E=0430 INPUT @33:A$440 IF E=1 THEN 520450 L=POS(A$,S$,1)460 IF L=0 OR L>10 THEN 430470 M$=SEG(A$,L+S,LEN(A$)-(L+S-1))480 M=M+1490 N$=SEG(A$,1,L-1)500 I9(M)=VAL(N$)510 GO TO 430520 RETURN 530 REM * SECOND PASS CONTROL MODULE540 E=0550 T=M560 M=0570 K0=7580 K=K0590 FIND F600 GOSUB 680610 INPUT @33:A$620 IF E=1 THEN 660630 GOSUB 760640 GOSUB 980650 GO TO 610660 COPY 670 RETURN 680 REM * PRINT FIRST REMARK AS PAGE TITLE690 PAGE 700 I=4710 PRINT @32,21:(130-LEN(T$)*1.79)/2,97.18720 PRINT T$730 PRINT "
M#  LINE#           MODULE NAME              ";740 PRINT "     MODULES CALLED"750 RETURN 760 REM * IF MODULE NAME - PRINT770 L=POS(A$,S$,1)780 IF L=0 OR L>10 THEN 970785 M=M+1790 M$=SEG(A$,L+S,LEN(A$)-(L+S-1))800 I=I+1810 IF M=1 THEN 970820 IF I<34 THEN 860830 COPY 840 I=0850 GOSUB 680860 L=0870 IF LEN(M$)<35 THEN 920880 L=POS(M$," ",25)890 IF L=0 THEN 920900 L$=SEG(M$,L+1,LEN(M$)-L)910 M$=SEG(M$,1,L-1)920 PRINT "";M-1;"	";I9(M-1);"	";M$;930 IF L=0 THEN 960940 I=I+1950 PRINT "	";L$;960 K=0970 RETURN 980 REM * EVALUATE GOSUB TYPE990 L=POS(A$,"GOSUB",3)1000 IF L=0 OR L>10 THEN 10601010 L0=POS(A$,"OF ",7)1020 IF L0<>0 THEN 10501030 GOSUB 10701040 GO TO 10601050 GOSUB 11201060 RETURN 1070 REM * NORMAL GOSUB TYPE1080 N$=SEG(A$,L+6,7)1090 S1=VAL(N$)1100 GOSUB 12401110 RETURN 1120 REM * GOSUB OF TYPE1130 H$=SEG(A$,L0+3,LEN(A$)-(L0+2))1140 J=POS(H$,",",1)1150 IF J<>0 THEN 11901160 S1=VAL(H$)1170 GOSUB 12401180 GO TO 12301190 I$=SEG(H$,1,J-1)1200 S1=VAL(I$)1210 H$=SEG(H$,J+1,LEN(H$)-J)1215 GOSUB 12401220 GO TO 11401230 RETURN 1240 REM * PRINT GOSUB MODULE NUMBER1250 IF K<>0 THEN 12801260 PRINT "		             ";1270 GO TO 13101280 IF K<K0 THEN 13101290 K=01300 PRINT "		             ";1310 IF S1=>I9(1) THEN 13401320 PRINT " *";1330 GO TO 14001340 FOR J=1 TO T-11350 IF S1<I9(J+1) THEN 13901360 NEXT J1370 PRINT " ";T;1380 GO TO 14001390 PRINT " ";J;1400 K=K+11410 RETURN 1420 REM * SET EOF FLAG1430 E=11440 RETURN 