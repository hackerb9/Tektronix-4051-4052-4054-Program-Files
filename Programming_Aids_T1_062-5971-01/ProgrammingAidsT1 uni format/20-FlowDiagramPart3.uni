3151 REM ...........redraw boxes.............3161 PAGE 3171 FOR J=2 TO 103181 FOR I=1 TO 43191 S=13201 K1=T(I,J)3211 IF K1=0 THEN 32913221 IF K1>0 THEN 32513231 S=-13241 K1=-K13251 GOSUB K1 OF 471,651,691,991,1361,1441,1561,1741,1871,1871,21013261 GOSUB 53113291 NEXT I3301 NEXT J3311 IF Z1=0 THEN 33613321 FOR I1=1 TO Z13331 GOSUB 50213341 GOSUB 36713351 NEXT I13361 I1=973371 MOVE 0,I13375 GOSUB 53613376 IF P3=1 THEN 763381 PRINT "from ";3391 INPUT K13401 IF K1=0 THEN 36613411 MOVE 17,I13421 PRINT "side ";3431 INPUT S$3441 PRINT "to   ";3451 INPUT K23461 MOVE 17,I1-2.53471 PRINT "side ";3481 INPUT T$3491 PRINT "type ";3501 INPUT T13511 I1=I1-93521 S1=23531 IF S$<>"r" THEN 35513541 S1=13551 IF S$<>"l" THEN 35713561 S1=33571 S2=43581 IF T$<>"r" THEN 36013591 S2=13601 IF T$<>"l" THEN 36213611 S2=33621 Z1=Z1+13631 Z(Z1)=(((K1*10+S1)*100+K2)*10+S2)*10+T13641 GOSUB 36713651 GO TO 33713661 END 3671 REM .....connect.....3681 J=INT((K1-1)/4)+23691 I=K1-4*(J-2)3701 E=03711 S=13721 IF T1<4 THEN 37513731 S=03741 T1=T1-33751 IF ABS(T(I,J))<>5 THEN 37913761 E=23791 A1=30+20*I3801 B1=106-10*J3811 GO TO S1 OF 3821,3871,39113821 C1=A1+103831 A1=A1+6-E3841 D1=B13851 GOSUB 44613861 GO TO 39513871 B1=B1-43881 C1=A13891 D1=B1-13901 GO TO 39513911 C1=A1-103921 A1=A1-6+E3931 D1=B13941 GOSUB 44613951 GOSUB 47013961 J=INT((K2-1)/4)+23971 I=K2-4*(J-2)3981 E=03991 IF ABS(T(I,J))<>5 THEN 40314001 E=24031 A2=30+20*I4041 B2=106-10*J4051 GO TO S2 OF 4061,4111,4151,41114061 C2=A2+104071 D2=B24081 A2=A2+6-E4091 GOSUB 45414101 GO TO 41914111 B2=B2+44121 D2=B2+14131 C2=A24132 GOSUB 47614133 L=INT((K1-1)/4)+24134 IF I-(K1-4*(L-2))<>0 OR ABS(J-L)=1 THEN 42014135 A=C2-0.54136 B=D2+1.54137 C=C24138 D=D24139 GOSUB 22214140 A=A+14141 GOSUB 22214145 GO TO 41914151 C2=A2-104161 D2=B24171 A2=A2-6+E4181 GOSUB 45414191 GOSUB 47614201 GO TO T1 OF 4211,4281,43914211 A1=C14221 B1=D24231 GOSUB 47014241 A2=A14251 B2=B14261 GOSUB 47614271 RETURN 4281 A1=(C1+C2)/24291 B1=D14301 GOSUB 47014311 C1=A14321 D1=D24331 GOSUB 47014341 GOSUB 46214351 A2=A14361 B2=D24371 GOSUB 47614381 RETURN 4391 A1=C24401 B1=D14411 GOSUB 47014421 A2=C24431 B2=D14441 GOSUB 47614451 RETURN 4461 L=INT((K2-1)/4)+24462 IF ABS(I-(K2-4*(L-2)))=1 AND J=L THEN 45314469 A=C1-1.5*SGN(C1-A1)4471 B=D1+0.54481 C=C14491 D=D14501 GOSUB 22214511 B=B-14521 GOSUB 22214531 RETURN 4541 A=A2-1.5*SGN(A2-C2)4551 B=B2+0.54561 C=A24571 D=B24581 GOSUB 22214591 B=B-14601 GOSUB 22214611 RETURN 4621 B=(D1+B1)/24631 A=A14641 C=A1-0.54651 D=B-1.5*SGN(D1-B1)4661 GOSUB 22214671 C=C+14681 GOSUB 22214691 RETURN 4701 A=A14711 B=B14721 C=C14731 D=D14741 GOSUB 22214751 RETURN 4761 A=A24771 B=B24781 C=C24791 D=D24801 GOSUB 22214811 RETURN 4815 REM4817 REM4821 REM .....delete box.....4823 REM4825 REM4831 MOVE 0,104841 PRINT "Delete box ";4851 INPUT N4861 J=INT((N-1)/4)4871 I=N-J*44881 J=J+24891 T(I,J)=04901 IF Z1=0 THEN 31514911 FOR I1=1 TO Z14921 GOSUB 50214931 IF K1=N OR K2=N THEN 49614941 NEXT I14951 GO TO 31514961 IF I1=Z1 THEN 50014971 Z(I1)=Z(Z1)4981 Z1=Z1-14991 GO TO 49015001 Z(I1)=05005 GOSUB 53615011 GO TO 49815021 K1=INT(Z(I1)/100000)5031 S1=INT(Z(I1)/10000)-K1*105041 K2=INT(Z(I1)/100)-(K1*10+S1)*1005051 S2=INT(Z(I1)/10)-((K1*10+S1)*100+K2)*105061 T1=Z(I1)-INT(Z(I1)/10)*105071 RETURN 5075 REM5077 REM5081 REM .....insert box.....5083 REM5085 REM5101 FOR J=2 TO 105111 FOR I=1 TO 45131 GOSUB 53115151 NEXT I5161 NEXT J5171 MOVE 0,155181 PRINT "insert box at ";5191 INPUT K5200 PRINT "select a box"5201 J=INT((K-1)/4)+25211 I=K-(J-2)*45221 MOVE 30+20*I,105-10*J5231 K=05241 INPUT K$5261 IF K=10 OR K=0 THEN 52415271 T(I,J)=K*S5275 GOSUB 53615281 GO TO 31515301 REM5311 MOVE 27+20*I,105-10*J5321 K$=STR(J*4-8+I)5331 PRINT K$5341 RETURN 5361 IF P3=0 THEN 53815365 FIND 65371 WRITE H$,T,Z,Z15381 RETURN 