1000 REM 51/00-8004/0 CROSS-REFERENCE & LIST VARIABLES, D. TAYLOR 4/761010 REM  CHANGE: F4=10, F5=60, J5=41   IF YOU WANT TO USE A PRINTER1020 INIT 1030 F4=61040 F5=1.0E+3001050 J5=321060 DIM A(26,12),F$(3),G$(5),H$(8),I$(12),J$(7),R$(6),S$(10)1070 J9=151080 DIM A$(1),B$(1),C$(1),K$(3),L$(75),T$(J9),V$(2),W$(3)1090 F0=MEMORY-2501100 DIM N$(F0+2*J9)1110 I$=" 0123456789$"1120 S$="          "1130 REM ----- GET FILE NUMBER1140 PRINT "CROSS-REFERENCE AND LIST PROGRAM VARIABLES"1150 PRINT "
NOTE: YOUR PROGRAM MAY BE ON SEVERAL TAPE FILES."1160 PRINT "
Begin with File Number = ";1170 INPUT F11180 IF INT(F1)<>F1 OR F1<=0 THEN 11601190 PRINT "  
End with File Number = ";1200 INPUT F21210 IF INT(F2)<>F2 OR F2<=0 THEN 11901220 REM ----- INITIALIZE1230 N=11240 N$=""1250 J7=1+1/2^161260 A=01270 SET NOCASE 1280 PRINT "
"1290 FOR F=F1 TO F21300 PRINT "
FILE # ";F1310 FIND F1320 J$=STR(F)1330 J$=REP("",1,1)1340 R$=SEG(S$,1,3-LEN(J$))1350 F$=R$&J$1360 REM SET F$="   " (3 SPACES) IF YOU DON'T WANT THE FILE NUMBER1370 ON EOF (0) THEN 13901380 GO TO 19701390 NEXT F1400 REM ----- PRINT NUMERIC VARIABLE NAMES1410 PRINT @J5:"";1420 PRINT @J5:"VARIABLES:
"1430 FOR J3=1 TO 261440 V$=CHR(64+J3)1450 FOR J4=1 TO 121460 IF A(J3,J4) THEN 14901470 PRINT @J5:"      ";1480 GO TO 15101490 W$=SEG(I$,J4,1)1500 PRINT @J5:V$;W$;"    ";1510 NEXT J41520 PRINT @J5:1530 NEXT J31540 IF J5<>32 THEN 15601550 PRINT "

"1560 PRINT @J5:"VARIABLES:
"1570 J6=1/(J7-1)1580 F6=F5-21590 F7=21600 FOR J3=1 TO 261610 V$=CHR(64+J3)1620 FOR J4=1 TO 121630 IF NOT(A(J3,J4)) THEN 19201640 W$=SEG(I$,J4,1)1650 IF F7<F6 THEN 16801660 PRINT @J5:"";1670 F7=01680 PRINT @J5:"
";V$;W$1690 F7=F7+21700 F3=01710 J2=J6*(A(J3,J4)-INT(A(J3,J4)))1720 W$=SEG(N$,J2,3)1730 T$=SEG(N$,J2+3,5)1740 C$=SEG(N$,J2+8,1)1750 F3=F3+11760 IF F3<=F4 THEN 18301770 F3=11780 PRINT @J5:1790 F7=F7+11800 IF F7<F5 THEN 18301810 PRINT @J5:"";1820 F7=01830 PRINT @J5:W$;" ";T$;" ";C$;" ";1840 T$=SEG(N$,J2+9,6)1850 J2=VAL(T$)1860 IF J2 THEN 17201870 PRINT @J5:1880 F7=F7+11890 IF F7<F5 THEN 19201900 PRINT @J5:"";1910 F7=01920 NEXT J41930 NEXT J31940 PRINT @J5:1950 RETURN 1960 REM ----- SUBROUTINE TO FETCH VARIABLE NAMES FROM INPUT LINE1970 INPUT @33:L$1980 J=POS(L$," ",2)1990 J0=J+12000 K$=SEG(L$,J0,3)2010 IF K$="REM" OR K$="IMA" THEN 19702020 J8=J0+12030 G$=SEG(L$,1,J-1)2040 R$=SEG(S$,1,5-LEN(G$))2050 G$=R$&G$2060 H$=F$&G$2070 L$=L$&"   "2080 A$=SEG(L$,J,1)2090 B$=SEG(L$,J0,1)2100 FOR J1=J8 TO LEN(L$)-22110 REM ----- IGNORE CHARACTERS BETWEEN QUOTES2120 IF B$<>"""" THEN 22002130 J=POS(L$,"""",J1)2140 J0=J+12150 J1=J0+12160 A$=SEG(L$,J,1)2170 B$=SEG(L$,J0,1)2180 GO TO 21202190 REM ----- CHECK PREVIOUS(A$) AND SUCCEEDING(C$) CHARACTER2200 C$=SEG(L$,J1,1)2210 IF B$<"A" OR B$>"Z" THEN 28602220 IF C$>"@" AND C$<"[" THEN 27902230 IF A$>"@" AND A$<"[" THEN 28602240 IF A$>"/" AND A$<":" THEN 28602250 J3=ASC(B$)-642260 REM ----- ONE OR TWO CHARACTER NAME--SKIP ONE OR TWO CHARS.2270 IF C$="$" OR (C$>"/" AND C$<":") THEN 23602280 V$=B$&" "2290 A$=C$2300 J=J12310 J1=J1+12320 J0=J12330 B$=SEG(L$,J0,1)2340 J4=12350 GO TO 24402360 J4=POS(I$,C$,2)2370 V$=B$&C$2380 J=J1+12390 A$=SEG(L$,J,1)2400 J0=J+12410 B$=SEG(L$,J0,1)2420 J1=J02430 REM ----- ASSIGNMENT ?2440 IF K$="INP" OR K$="REA" OR K$="RBY" THEN 25002450 W$=" "2460 IF A$<>"=" THEN 25202470 IF K$="IF " THEN 25202480 IF POS(L$,"=",J8)<J THEN 25202490 GO TO 25102500 IF POS(L$,":",8)>J0 THEN 25202510 W$="*"2520 J6=A(J3,J4)2530 IF J6 THEN 25802540 REM ----- FIRST OCCURRENCE OF A(J3,J4)2550 A(J3,J4)=N*J72560 GO TO 26302570 REM ----- ANOTHER OCCURRENCE2580 J$=STR(N)2590 R$=SEG(S$,1,6-LEN(J$))2600 J$=R$&J$2610 N$=REP(J$,INT(J6)+9,6)2620 A(J3,J4)=J6-INT(J6)+N2630 J$=W$&"-0END-"2640 T$=H$&J$2650 N$=REP(T$,N,0)2660 N=N+J92670 IF N<F0 THEN 29002680 PRINT @J5:"STORAGE FILLED IN THE MIDDLE OF FILE # ";F;".  ";2690 PRINT @J5:"THE PROGRAM WILL"2700 PRINT @J5:"CONTINUE WITH FILE # ";F;" AFTER ";2710 PRINT @J5:"THE FOLLOWING INFORMATION IS PRINTED:

"2720 GOSUB 14202730 A=02740 N=12750 N$=""2760 PRINT @J5:"
CONTINUING WITH FILE # ";F2770 GO TO 29002780 REM ----- SKIP NEXT CHARACTER2790 A$=C$2800 J=J12810 J1=J1+12820 J0=J12830 B$=SEG(L$,J0,1)2840 GO TO 29002850 REM ----- PREPARE FOR NEXT CHARACTER2860 J=J02870 J0=J12880 A$=B$2890 B$=C$2900 NEXT J12910 GO TO 1970