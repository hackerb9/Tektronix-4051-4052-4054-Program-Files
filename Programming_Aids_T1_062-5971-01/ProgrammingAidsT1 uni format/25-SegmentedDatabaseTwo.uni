130 PAGE 140 INIT 150 SET DEGREES 400 REM INPUT COORDINATES FOR SEGMENT WINDOW410 PRINT "ENTER LOWER LEFT COORDINATES  X,Y : ";420 INPUT X1,Y1430 PRINT "ENTER UPPER RIGHT COORDINATES  X,Y : ";440 INPUT X2,Y2460 REM   SELECT TAPE FILE 470 PRINT "ENTER FILE NUMBER 27 OR 28 : ";480 INPUT Z490 FIND Z540 MOVE X1,Y1550 DRAW X2,Y1560 DRAW X2,Y2570 DRAW X1,Y2580 DRAW X1,Y1590 DELETE X,Y600 DIM X(591),Y(591)610 ON EOF (0) THEN 890620 READ @33:N630 DELETE X,Y640 DIM X(N),Y(N)650 READ @33:X,Y660 REM   SKIP SINGLE ENDED VECTORS670 IF N=1 THEN 620680 REM PREPARE FOR FIRST POINT690 J=0700 F1=0710 GOSUB 1220720 FOR I=2 TO N730 D=X(I)740 E=Y(I)750 REM TEST FLAG FOR LAST POINT IN WINDOW760 IF F=1 THEN 2230770 REM LAST POINT IN WINDOW780 GO TO 1380790 B=D800 C=E810 NEXT I880 GO TO 620890 PRINT "FINISHED"900 END 1220 REM FIRST POINT IN ARRAY1230 B=X(1)1240 C=Y(1)1250 REM   TEST FOR POINT OUT OF WINDOW1260 IF B<X1 OR B>X2 THEN 13501270 IF C<Y1 OR C>Y2 THEN 13501280 REM POINT IS IN WINDOW1290 F=01330 MOVE B,C1340 GO TO 13701350 REM POINT IS OUT OF WINDOW1360 F=11370 RETURN 1380 REM TEST FOR NEXT POINT IN WINDOW1390 IF D<X1 OR D>X2 OR E<Y1 OR E>Y2 THEN 14701400 REM POINT IN WINDOW1440 MOVE B,C1450 DRAW D,E1460 GO TO 7901470 REM POINT EXITING FROM WINDOW1480 F=11490 IF B=D THEN 21101500 IF C=E THEN 21701510 A=(E-C)/(D-B)1520 REM   CALCULATE SLOPE OF VECTOR1530 REM SELECT SECTOR OPERATIONS1540 Z=11550 IF D>B AND E>C THEN 16401560 Z=21570 IF D<B AND E>C THEN 16401580 Z=31590 IF D<B AND E<C THEN 17801600 Z=41610 GO TO 17801620 REM   SECTORS 1 AND 2 DOCUMENTED  3 AND 4 IDENTICAL IN OPERATION1630 REM SECTORS 1 AND 21640 D1=X11650 IF Z=2 THEN 16701660 D1=X21670 REM    IS POINT ON WINDOW EDGE?1680 IF B=D1 THEN 19001690 REM   CALCULATE SLOPE INTERCEPT WITH WINDOW CORNER1700 A1=(Y2-C)/(D1-B)1710 E1=Y21720 REM   SELECT REQUIRED INTERCEPT POINT1730 IF Z=1 THEN 17601740 IF A>A1 THEN 19001750 GO TO 19301760 IF A>A1 THEN 19301770 GO TO 19001780 REM SECTORS 3 AND 41790 D1=X11800 IF Z=3 THEN 18201810 D1=X21820 IF B=D1 THEN 19001830 E1=Y11840 A1=(Y1-C)/(D1-B)1850 IF Z=3 THEN 18801860 IF A<A1 THEN 19301870 GO TO 19001880 IF A<A1 THEN 19001890 GO TO 19301900 REM CALCULATE Y INTERCEPT1910 E1=A*(D1-B)+C1920 GO TO 19501930 REM CALCULATE X INTERCEPT1940 D1=B+(E1-C)/A1950 REM OUTPUT ARRAY END OF CONTINUOUS VECTOR1960 IF F1=1 THEN 24102000 PRINT "EX";2010 MOVE B,C2020 DRAW D1,E12030 F=12100 GO TO 7902110 REM VERTICAL LINE TO WINDOW EXIT2120 D1=B2130 E1=Y22140 IF C<E THEN 19502150 E1=Y12160 GO TO 19502170 REM HORIZONTAL LINE TO WINDOW EXIT2180 E1=C2190 D1=X22200 IF B<D THEN 19502210 D1=X12220 GO TO 19502230 REM TEST FOR POINT OUTSIDE WINDOW2240 IF B>X2 AND D>X2 THEN 7902250 IF C>Y2 AND E>Y2 THEN 7902260 IF B<X1 AND D<X1 THEN 7902270 IF C<Y1 AND E<Y1 THEN 7902280 REM TEST FOR POINT ENTERING WINDOW2290 IF D=>X1 AND D<=X2 AND E=>Y1 AND E<=Y2 THEN 23202300 REM GOTO TRAVERSE CONDITION2310 GO TO 25502320 REM COMPUTE INTERCEPTS OF ENTRANCE  REVERSE OF EXIT2330 X3=B2340 B=D2350 D=X32360 X3=C2370 C=E2380 E=X32390 F1=12400 GO TO 14702410 REM   ARRAY STORAGE AND STORE ENDPOINTS2420 F1=02430 F=02450 PRINT "EN";2460 MOVE D1,E12470 DRAW B,C2540 GO TO 8102550 REM BOTH POINTS OUTSIDE WINDOW AND VECTOR TRAVERSES WINDOW2560 IF B=D THEN 25802570 A=(E-C)/(D-B)2580 REM TEST FOR VECTOR WITHIN ONE PAIR OF LIMITS2590 IF B=>X1 AND B<=X2 AND D=>X1 AND D<=X2 THEN 36102600 IF C=>Y1 AND C<=Y2 AND E=>Y1 AND E<=Y2 THEN 35002610 REM DETERMINE QUADRANT OF OPERATION2620 IF B<X1 THEN 26902630 IF B>X2 THEN 29302640 IF C<Y1 THEN 30902650 IF C>Y2 THEN 32402660 REM2670 REM   1ST QUADRANT DOCUMENTED  OTHER THREE IDENTICAL IN OPERATION2680 REM2690 REM A QUADRANT2700 B1=X12710 REM   TEST FOR SUBQUADRANT CONDITION2720 IF C>Y2 OR C<Y1 THEN 37202730 REM DETERMINE WHICH WINDOW SIDES FOR INTERCEPT2740 IF C>E THEN 28502750 REM   XMIN YMAX2760 A1=(Y2-C)/(X1-B)2770 REM   DETERMINE IF VECTOR IS IN WINDOW AREA2780 IF A>A1 THEN 7902790 A2=(Y2-C)/(X2-B)2800 REM   DETERMINE IF INTERCEPT IS WITHIN THE Y RANGE2810 IF A<=A2 THEN 35002820 E1=Y22830 GO TO 33902840 REM   XMIN YMIN2850 A1=(Y1-C)/(X1-B)2860 REM   DETERMINE IF VECTOR IS IN WINDOW AREA2870 IF A<A1 THEN 7902880 A2=(Y1-C)/(X2-B)2890 REM   DETERMINE IF INTERCEPT IS WITHIN THE Y RANGE2900 IF A=>A2 THEN 35002910 E1=Y12920 GO TO 33902930 REM B QUADRANT2940 B1=X22950 IF C>Y2 OR C<Y1 THEN 38202960 IF C>E THEN 30302970 A1=(Y2-C)/(X2-B)2980 IF A<A1 THEN 7902990 A2=(Y2-C)/(X1-B)3000 IF A>A2 THEN 35003010 E1=Y23020 GO TO 33903030 A1=(Y1-C)/(X2-B)3040 IF A>A1 THEN 7903050 A2=(Y1-C)/(X1-B)3060 IF A<A2 THEN 35003070 E1=Y13080 GO TO 33903090 REM C QUADRANT3100 E1=Y13110 IF D>B THEN 31803120 A1=(Y1-C)/(X1-B)3130 IF A>A1 THEN 7903140 A2=(Y2-C)/(X1-B)3150 IF A<A2 THEN 36103160 B1=X13170 GO TO 33903180 A1=(Y1-C)/(X2-B)3190 IF A<A1 THEN 7903200 A2=(Y2-C)/(X2-B)3210 IF A>A2 THEN 36103220 B1=X23230 GO TO 33903240 REM D QUADRANT3250 E1=Y23260 IF D>B THEN 33303270 A1=(Y2-C)/(X1-B)3280 IF A<A1 THEN 7903290 A2=(Y1-C)/(X1-B)3300 IF A>A2 THEN 36103310 B1=X13320 GO TO 33903330 A1=(Y2-C)/(X2-B)3340 IF A>A1 THEN 7903350 A2=(Y1-C)/(X2-B)3360 IF A<A2 THEN 36103370 B1=X23380 GO TO 33903390 REM ALGORITHM FOR TRAVERSE INTERCEPTS3400 C1=C+(B1-B)*A3410 D1=B1+(E1-C1)/A3420 PRINT "T";3430 REM SAVE VECTOR 3440 MOVE B1,C13450 DRAW D1,E13480 F=13490 GO TO 7903500 REM TRAVERSE WITHIN Y RANGE3510 B1=X13520 D1=X23530 IF E=C THEN 35703540 C1=C+(X1-B)*A3550 E1=C1+(X2-B1)*A3560 GO TO 34303570 REM HORIZONTAL TRAVERSE3580 C1=C3590 E1=E3600 GO TO 34303610 REM TRAVERSE WITHIN X RANGE3620 C1=Y13630 E1=Y23640 IF B=D THEN 36803650 B1=B+(C1-C)/A3660 D1=B1+(E1-C1)/A3670 GO TO 34303680 REM VERTICAL TRAVERSE3690 B1=B3700 D1=D3710 GO TO 34303720 REM   SUBQUADRANTS AD & CA3730 IF C<Y1 THEN 37803740 REM    AD SECTION3750 A2=(Y2-C)/(B1-B)3760 IF A>A2 THEN 32403770 GO TO 27403780 REM    CA SECTION3790 A2=(Y1-C)/(B1-B)3800 IF A<A2 THEN 30903810 GO TO 27403820 REM    SUBQUADRANTS DB & BC3830 IF C<Y1 THEN 38803840 REM    DB SECTION3850 A2=(Y2-C)/(B1-B)3860 IF A<A2 THEN 32403870 GO TO 29603880 REM    BC SECTION3890 A2=(Y1-C)/(B1-B)3900 IF A>A2 THEN 30903910 GO TO 2960